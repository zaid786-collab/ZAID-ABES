const t=!1,e=!1,i="1.37.5",s="playing",n="waiting",o="seeking",a="inactive",r="casting",l=[s,o,r];class u{static get ENDS_BUFFERING(){return{playing:!0,pause:!0,ended:!0,inactive:!0,seeking:!0,casting:!0}}static get ENDS_SEEKING(){return{playing:!0,pause:!0,ended:!0,inactive:!0,casting:!0}}static get ENDS_PLAYING(){return{ended:!0,inactive:!0,stopped:!0,pause:!0,stopping:!0,casting:!0}}static get ENDS_CASTING(){return{"cast-disconnected":!0}}constructor(){this.events=[],this.currentState=a}after(t){const e=new u;return e.events=this.events.filter(e=>e.timestamp>=t),e.currentState=this.currentState,e}push(t,e){let i=this.currentState;i!=r&&(l.indexOf(t)>=0||t==n&&i==s)?(this.previousState=i,this.currentState=i=t):this.currentState==r&&u.ENDS_CASTING[t]?this.currentState=i=this.previousState:((this.currentState==o&&u.ENDS_SEEKING[t]||this.currentState==n&&u.ENDS_BUFFERING[t])&&(this.currentState=i=this.previousState),this.currentState==s&&u.ENDS_PLAYING[t]&&(this.currentState=i=a)),this.events.push({name:t,state:i,time:Date.now(),timestamp:performance.now(),detail:e})}all(t,e){return e?function(t,e,i){return c(t,e.filter(t=>t.state!=i))}(t,this.events,e):c(t,this.events)}firstTimestamp(t){for(let e=0;e<this.events.length;e++)if(this.events[e].name==t)return this.events[e].timestamp;return NaN}lastTimestamp(t){for(let e=this.events.length-1;e>=0;e--)if(this.events[e].name===t)return this.events[e].timestamp;return NaN}firstIndex(t){for(let e=0;e<this.events.length;e++)if(this.events[e].name==t)return e;return-1}indexes(t){const e=[];for(let i=0;i<this.events.length;i++)this.events[i].name==t&&e.push(i);return e}first(t){const e=c(t,this.events);return e.length>0?e[0]:null}last(t){const e=c(t,this.events);return e.length>0?e[e.length-1]:null}has(t){return c(t,this.events).length>0}betweenFirst(t,e,i){const s=this.firstIndex(e),n=this.firstIndex(i),o=this.indexes(t);for(let t=0;t<o.length;t++)if(o[t]>s&&o[t]<n)return!0;return!1}before(t,e){const i=this.first(t),s=this.first(e);return!!i&&(!s||this.events.indexOf(i)<this.events.indexOf(s))}since(t,e){const i=this.last(t),s=this.last(e);return!!i&&(!s||this.events.indexOf(i)>this.events.indexOf(s))}failovers(t){let e=this.all("supplierchange");if(!Number.isFinite(t))return e.length;let i=0;for(let s=e.length-1;s>=0&&e[s].timestamp>t;s--)i++;return i}times(t){let e={playing:0,seeking:0,waiting:0,inactive:0,casting:0},i={playing:0,seeking:0,waiting:0,inactive:0,casting:0},s=function(t){let e,i=[];for(let s=0;s<t.length;s++)t[s].state!=e&&(i.push(t[s]),e=t[s].state);return i}(this.events);if(0==s.length)return e.counts=i,e;s.push({state:a,timestamp:performance.now()});let n=0;for(;n<s.length&&s[n].timestamp<t;)n++;if(0==s.length)return e.counts=i,e;if(n>0)if(isNaN(t))s.splice(0,n);else{let e={state:s[n-1].state,timestamp:t};s.splice(0,n,e)}for(let t=1;t<s.length;t++)e[s[t-1].state]+=s[t].timestamp-s[t-1].timestamp,i[s[t-1].state]++;return Object.keys(e).map(t=>{e[t]=e[t]/1e3}),e.counts=i,e}reduceToPairs(t,e,i,s){let n=c(t.concat(e),this.events),o=[],a=[];for(let r=0;r<n.length;r++)0==a.length&&n[r].name==t[0]&&(i&&!(i.indexOf(n[r].state)>=0)||s&&-1!==s.indexOf(n[r].state)||a.push(n[r])),1==a.length&&(n[r].name==t[1]&&(a.push(n[r]),o.push(a),a=[]),e.includes(n[r].name)&&(a=[]));return o}}function c(t,e){return Array.isArray(t)?e.filter(e=>t.includes(e.name)):t?e.filter(e=>e.name===t):e}class d{static get browser(){if(d._browser)return d._browser;const t=window.navigator.userAgent;let e="unknown";return/safari/i.test(t)&&!/chrome/i.test(t)?e=/mac/i.test(t)?"macSafari":"mobileSafari":/ edg\//i.test(t)?e="edge":t.indexOf("(iPad;")>0||t.indexOf("(iPhone;")>0?e="webviewApple":/Macintosh/.test(t)&&/AppleWebKit/.test(t)&&5==navigator.maxTouchPoints&&(e="ipadWebview"),d._browser=e,e}static get hasMSE(){return"MediaSource"in window}static get supportsDash(){return d.hasMSE}static get preferHls(){return d.isApple&&navigator.maxTouchPoints>0}static get swipeDownNotInFullscreen(){return d.isApple&&navigator.maxTouchPoints>0}static get supportsHLS(){return d.isApple}static get failoverOnFormatError(){return d.isApple}static get synthesisePlayingAfterSeeked(){return d.isApple}static get needsSafariCaptureIntent(){return d.isApple}static get needsFakeEnded(){return d.isApple}static get needsRepaintOnFullscreen(){return d.isApple}static get needsPreventDefaultToNotLosePanelFocus(){return d.isApple}static get isApple(){return"macSafari"===d.browser||"mobileSafari"===d.browser||"ipadWebview"===d.browser||"webviewApple"===d.browser}}function h(t){return"string"==typeof t&&t.length>0}function p(t){t||(t={});var e={options:t};return function(t){if(!h(t.mediaset))return!1;h(t.format)||(t.format="json");return!0}(t)&&(!function(t){if(!h(t.cvid))return!1;return!0}(t)?function(t){if(!h(t.vpid))return!1;return!0}(t)&&(e.url=function(t){return m(t)+"/mediaselector/6/select/version/2.0"+b(t,"vpid")}(t)):e.url=function(t){return m(t)+"/mediaselector/6/select/version/3.0"+b(t,"cvid")}(t)),e}function m(t){return t.host||(h(t.environment)||(t.environment="live"),t.host="https://open."+t.environment+".bbc.co.uk"),t.host}function g(t,e){return"/"+t+"/"+e}function b(t,e){var i="";return["mediaset",e,"format"].forEach(function(e){i+=g(e,t[e])}),["proto","transferformat","jsfunc","cors"].forEach(function(e){t[e]&&(i+=g(e,t[e]))}),i}function f(t){for(var e=[],i=[],s=0,n=0;n<t.length;n++){var o=t[n];!isNaN(o.dpw)&&o.dpw>=0&&o.dpw<=100?s+=o.dpw:-1!==o.dpw&&(o.dpw=0)}let a=[];for(;e.length<t.length;)if(s>0){for(var r=Math.random()*s,l=0;l<t.length;l++)if(-1===t[l].dpw&&e.push(l),e.indexOf(l)<0&&(r-=t[l].dpw)<=0){s-=t[l].dpw,i.push(t[l]),e.push(l);break}}else for(var u=0;u<t.length;u++)e.indexOf(u)<0&&(-1!==t[u].dpw&&a.push(t[u]),e.push(u));return a.length>0&&(a.sort(()=>Math.random()-.5),i=i.concat(a)),i}var y="No media",v="No connections",_="No connections after filtering";function k(t,i){var s={result:{},originalConnections:{},error:null},n=t.media;i||(i={}),function(t){"string"==typeof t.transferFormats&&(t.transferFormats=[t.transferFormats]);if(t.encodings&&"object"==typeof t.encodings){Object.keys(t.encodings).map(function(e){"string"==typeof t.encodings[e]&&(t.encodings[e]=[t.encodings[e]])})}t.protocols?"string"==typeof t.protocols&&(t.protocols=[t.protocols]):t.protocols=["https","http"];t.supplierDenyList?"string"==typeof t.supplierDenyList&&(t.supplierDenyList=[t.supplierDenyList]):t.supplierDenyList=[]}(i);var o=[];if(n&&n.length>0){for(var a=0;a<n.length;a++)for(var r=n[a],l=0;l<r.connection.length;l++){var u=r.connection[l];o.push(w(u,r))}if(o.length>0){var c=function(t,i){t=t.filter(function(t){return-1!==t.dpw}),i.supplierDenyList.length>0&&(t=t.filter(function(t){return!i.supplierDenyList.reduce(function(e,i){return!t.supplier||(e||t.supplier.indexOf(i)>-1)},!1)}));var s=T(t,"kind"),n=[];e;return s.forEach(function(e){var s=t.filter(function(t){return t.kind===e}),o=i.transferFormats;(function(t){return"video"===t||"audio"===t})(e)&&i.transferFormats||(o=T(s,"transferFormat")),o.forEach(function(t){var o;o=s.filter(function(e){return e.transferFormat===t});var a=i.encodings&&i.encodings[e];a||(a=T(o,"encoding")),a.forEach(function(t){var e;e=o.filter(function(e){return e.encoding===t}),i.protocols.forEach(function(t){var s=e.filter(function(e){return e.protocol===t}),o=T(s,"bitrate");(o=o.filter(function(t){return!isNaN(t)})).length>0?(o=o.filter(function(t){return!(i.bitrate&&i.bitrate.max&&t>i.bitrate.max)&&!(i.bitrate&&i.bitrate.min&&t<i.bitrate.min)}),o.sort(function(t,e){return i.bitrate&&"asc"===i.bitrate.sort?t-e:e-t}),o.forEach(function(t){var e=s.filter(function(e){return e.bitrate===t});(function(t,e){var i=e.filter(function(t){return"audio-description-broadcast-mix"===t.purpose});i.length>0&&t.push(i)})(n,e),n.push(e.filter(function(t){return"audio-description-broadcast-mix"!==t.purpose}))})):s.length>0&&n.push(s)})})})}),n}(o,i);if(c.length>0)!function(t,e){e.forEach(function(e){if(e.length>0){var i=e[0].kind;if("audio-description-broadcast-mix"==e[0].purpose)return t.result.audioDescribed||(t.result.audioDescribed=[]),void(t.result.audioDescribed=t.result.audioDescribed.concat(e));t.result[i]||(t.result[i]=[]),t.result[i]=t.result[i].concat(e)}})}(s,c.map(f));else s.error=_;s.originalConnections=function(t,e){for(var i={},s=0;s<t.length;s++){var n=t[s][e];i[n]||(i[n]=[]),i[n].push(t[s])}return i}(o,"kind")}else s.error=v}else t.result?s.error=t.result:s.error=y;return s}function w(t,e){return{href:t.href,protocol:t.protocol,supplier:t.supplier,transferFormat:t.transferFormat,dpw:parseInt(t.dpw,10),authExpires:t.authExpires,authExpiresOffset:t.authExpiresOffset,expires:e.expires,kind:e.kind,type:e.type,encoding:e.encoding,width:parseInt(e.width,10),height:parseInt(e.height,10),bitrate:parseInt(e.bitrate,10),language:e.language,purpose:e.purpose}}function T(t,e){return t.reduce(function(t,i){return t.indexOf(i[e])<0&&t.push(i[e]),t},[])}var E=new class{constructor(){this.toolTipCTAPlay="Play {title}",this.toolTipPause="Pause",this.toolTipPlay="Play",this.skipBack="Skip back {seconds} seconds",this.skipForward="Skip forward {seconds} seconds",this.seekBarName="Seek bar",this.seekBarDescription="Use the arrow keys to forward and rewind",this.audioToolTipSeekBarPrefix="Playback time is",this.audioToolTipSeekBarSuffix="of",this.toolTipEnterFullScreen="Enter full screen",this.toolTipExitFullScreen="Exit full screen",this.toolTipSubtitlesOn="Turn subtitles on",this.toolTipSubtitlesOff="Turn subtitles off",this.toolTipADOn="Turn audio description on",this.toolTipADOff="Turn audio description off",this.toolTipChromecast="Cast this programme",this.toolTipStopChromecast="Stop casting",this.toolTipTranscriptionOn="Turn transcription on",this.toolTipTranscriptionOff="Turn transcription off",this.openSubtitlesMenu="Open subtitles settings menu",this.closeSubtitlesMenu="Close subtitles settings menu",this.openADMenu="Open audio description menu",this.closeADMenu="Close audio description menu",this.openSubtitlesAndADmenu="Open audio description and subtitles menu",this.closeSubtitlesAndADmenu="Close audio description and subtitles menu",this.audioDescription="Audio description",this.subsADTitle="Audio description and subtitles",this.toolTipPicInPic="Open Picture in Picture mode",this.toolTipStopPicInPic="Exit Picture in Picture mode",this.audioToolTipBuffering="Buffering",this.toolTipEmbed="Get embed code",this.goToLivePoint="Go to live point",this.liveRestart="Watch from start",this.listenFromStart="Listen from start",this.previousItem="Previous item",this.nextItem="Next item",this.playbackSettingsHeading="Playback settings",this.autoplaySettingHeading="Autoplay",this.autoplaySettingSubheading="Play next item automatically",this.openPlaybackSettingsMenu="Open playback settings menu",this.closePlaybackSettingsMenu="Close playback settings menu",this.openPlaybackSettingsMenuNew="Open playback settings menu for autoplay and video quality settings",this.backToPlaybackSettingsMenu="Playback settings menu",this.qualitySettingHeading="Video quality",this.qualityPanelLowRowHeading="Low",this.qualityPanelMediumRowHeading="Medium",this.qualityPanelHighRowHeading="Highest available",this.qualityPanelHighRowSubtitle="Automatically selects the best quality available",this.qualitySettingOpenHighSelected="Video quality. Highest available is currently selected. Open video quality settings",this.qualitySettingOpenMediumSelected="Video quality. Medium quality is currently selected. Open video quality settings",this.qualitySettingOpenLowSelected="Video quality. Low quality is currently selected. Open video quality settings",this.qualitySettingOpenUnavailable="Currently unavailable",this.qualitySettingOpenUnavailableAccessible="Video quality settings are currently unavailable",this.qualitySettingInfo="Video quality options",this.qualitySettingLowSelect="Low quality",this.qualitySettingLowSelected="Low quality selected",this.qualitySettingMediumSelect="Medium quality",this.qualitySettingMediumSelected="Medium quality selected",this.qualitySettingHighSelect="Highest quality available",this.qualitySettingHighSelected="Highest quality available selected",this.live="LIVE",this.subtitles="Subtitles",this.useSmallestFontSize="Use font size: Smallest",this.useSmallFontSize="Use font size: Small",this.useMediumFontSize="Use font size: Medium",this.useLargeFontSize="Use font size: Large",this.useLargestFontSize="Use font size: Largest",this.aa="Aa",this.toolTipVideoPaused="Video paused",this.toolTipVideoPlaying="Video playing",this.toolTipAudioPaused="Audio paused",this.toolTipAudioPlaying="Audio playing",this.toolTipSkippedForwards="Skipped forwards {seconds} seconds",this.toolTipSkippedBackwards="Skipped backwards {seconds} seconds",this.toolTipVideoMuted="Video muted",this.toolTipVideoUnmuted="Video unmuted",this.toolTipAudioMuted="Audio muted",this.toolTipAudioUnmuted="Audio unmuted",this.toolTipFullscreenEntered="Entered fullscreen",this.toolTipFullscreenExited="Exited fullscreen",this.toolTipSubtitlesTurnedOn="Subtitles turned on",this.toolTipSubtitlesTurnedOff="Subtitles turned off",this.toolTipADTurnedOn="Audio description turned on",this.toolTipADTurnedOff="Audio description turned off",this.volumeControlDescription="Use the arrow keys to increase and decrease the volume",this.toolTipMute="Mute",this.toolTipUnmute="Unmute",this.audioToolTipVolumeMuted="Muted",this.audioToolTipVolume1="Volume level 1",this.audioToolTipVolume2="Volume level 2",this.audioToolTipVolume3="Volume level 3",this.audioToolTipVolume4="Volume level 4",this.audioToolTipVolume5="Volume level 5",this.audioToolTipVolume6="Volume level 6",this.audioToolTipVolume7="Volume level 7",this.audioToolTipVolume8="Volume level 8",this.audioToolTipVolume9="Volume level 9",this.audioToolTipVolume10="Volume level 10",this.audioToolTipVolume11="Volume level 11",this.speedTitle="Playback speed",this.openSpeedMenu="Open playback speed menu",this.closeSpeedMenu="Close playback speed menu",this.speedButton0="Set speed to 0.5 times",this.speedButton1="Set speed to 0.8 times",this.speedButton2="Set speed to normal",this.speedButton3="Set speed to 1.2 times",this.speedButton4="Set speed to 1.5 times",this.speedButton5="Set speed to 2 times",this.defaultErrorMessage="This content doesn't seem to be working.",this.contentPostAvailability="This live stream has ended.",this.programmePreAvailability="This programme is not available to play yet.",this.programmeRegionRestriction="This content is not available in your location.",this.itemRevoked="This content is no longer available",this.contentNotAvailableOnDevice="This content is not currently available on this device.",this.tryAgainLater="Please try again later.",this.tryAgain="Try Again",this.threeSixtyNotSupported="Please refresh the page to play this content",this.refreshButton="Refresh",this.networkNotAvailable="It appears your network is not available at this time.",this.codecErrorMessage="The content is not available in a compatible codec",this.insufficientBandwidth="Sorry, you don't have enough bandwidth to play this right now.",this.oJcancel="Cancel",this.oJupNextIn="Up next in",this.oJcancelUpNextIn="Cancel, up next in {seconds} seconds",this.oJplayNow="Play now",this.oJclose="Close",this.oJwatchMore="Watch more",this.autoPlugMoreContents="More",this.autoPlugMoreClips="More clips",this.autoPlugMoreProgrammes="More programmes",this.autoPlugShowMore="Show more",this.autoPlugMoreVideos="More videos",this.oJcloseWatchMore="Close watch more",this.autoPlugRightChevron="More clips",this.autoPlugLeftChevron="Previous clips",this.ccSelectDevice="Select a casting device",this.ccCastingTo="Casting to",this.ccConnecting="Connecting",this.ccDisconnecting="Disconnecting",this.customiseButtonPrimary="Settings",this.customiseButtonSecondary="Change the styling",this.customiseTooltip="Settings. Default styling is currently applied. Open subtitle settings.",this.customiseTooltipWithChanges="Settings. Custom styling is currently applied. Open subtitle settings.",this.chapterCarouselJumpTo="Jump to",this.chapterCarouselOpenJumpTo="Open jump to",this.chapterCarouselCloseJumpTo="Close jump to",this.chapterCarouselScrollLeft="Scroll carousel left",this.chapterCarouselScrollRight="Scroll carousel right",this.playQueueOn="Close Play Queue",this.playQueueOff="Open Play Queue",this.flashNotAvailable="This player no longer works properly on your device. You'll need to update your browser or device to continue.",this.deprecationMessageLongLink="Find out how to keep watching and listening."}};const C="critical",S="error",B="warning";class x{constructor(t){this.type="error",this.code=t.code,this.description=t.description||E.defaultErrorMessage,t.recoverable||(""==t.secondaryText?this.secondaryText="":this.secondaryText=t.secondaryText||E.tryAgainLater),this.refresh=t.refresh||!1,this.severity=t.severity||S,this.deprecation=t.deprecation||!1,this.recoverable=t.recoverable}toString(){return"SMPErr ("+this.code+"/"+this.severity+") - "+this.description}}const P={get NOT_AVAILABLE_YET(){return new x({code:1004,description:E.programmePreAvailability,severity:C,recoverable:!0})},get CONTENT_EXPIRED(){return new x({code:1005,description:E.contentPostAvailability,severity:C})},get MEDIATOR_REQUEST_ERROR(){return new x({code:1026,severity:C,recoverable:!0})},get MEDIATOR_PARSE_ERROR(){return new x({code:1028,severity:C,recoverable:!0})},get NO_PLAYBACK_START(){return new x({code:1041,description:E.flashNotAvailable,secondaryText:"",deprecation:!0,severity:C})},get CONTENT_NOT_AVAILABLE(){return new x({code:1052,description:E.contentNotAvailableOnDevice,severity:C})},get MEDIASELECTOR_UNKNOWN_ORIGIN(){return new x({code:1055,severity:C})},get MEDIASELECTOR_GEOLOCATION(){return new x({code:1056,description:E.programmeRegionRestriction,secondaryText:"",severity:C})},get MEDIASELECTOR_OTHER(){return new x({code:1057,description:E.contentNotAvailableOnDevice,severity:C})},get MEDIASELECTOR_UNKNOWN(){return new x({code:1058,description:E.contentNotAvailableOnDevice,severity:C})},get MEDIASELECTOR_REVOKED(){return new x({code:1059,description:E.itemRevoked,severity:C})},get ALL_ITEMS_FILTERED(){return new x({code:1062,severity:C})},get NO_PLAYLIST_ITEMS_AFTER_PARSE(){return new x({code:1064,severity:C})},get TOKEN_EXPIRED(){return new x({code:1053,severity:C})},get TOKEN_INVALID(){return new x({code:1054,severity:C})},get CONTENT_NOT_AVAILABLE_TOKEN(){return new x({code:1073,severity:C})},get TIMEOUT_WAITING_TOKEN(){return new x({code:1074,severity:C,recoverable:!0})},get ATTEMPTING_TO_PLAY_360(){return new x({code:1080,description:E.threeSixtyNotSupported,severity:C,refresh:!0})},get LIVE_NOT_INDICATED_LIVE(){return new x({code:1081,severity:B})},get NO_PLAYLIST_ITEMS(){return new x({code:1065,severity:C})},get ITEM_NO_SOURCE(){return new x({code:1071,severity:S})},get PLAY_PROMISE_REJECTED(){return new x({code:2210,severity:B})},get PLAY_PROMISE_REJECTED_INTERRUPTED(){return new x({code:2211,severity:B})},get ONLINE_AFTER_LONG(){return new x({code:2212,severity:B})},get NETWORK_UNAVAILABLE(){return new x({code:3025,description:E.networkNotAvailable,severity:C,recoverable:!0})},get MPD_LOAD_FAIL(){return new x({code:4200,severity:S})},get MPD_NO_STREAMS(){return new x({code:4201,severity:S})},get INIT_FRAGMENT_LOAD_FAIL(){return new x({code:4202,severity:S})},get STREAM_FRAGMENT_LOAD_FAIL(){return new x({code:4203,severity:S})},get DASH_MEDIASOURCE_ERROR(){return new x({code:4205,severity:B})},get INIT_FRAGMENT_DOWNLOAD_INFORMATION(){return new x({code:4223,severity:S})},get FRAGMENT_DOWNLOAD_INFORMATION(){return new x({code:4225,severity:S})},get MPD_PARSE_ERROR(){return new x({code:4226,severity:S})},get NO_SUPPORTED_CODECS(){return new x({code:4227,description:E.codecErrorMessage,severity:C,secondaryText:""})},get DASH_MPD_REFRESH_FAILED(){return new x({code:4230,severity:B})},get END_FRAGMENT_MISSING(){return new x({code:4229,severity:B})},get DASH_EXCEPTION(){return new x({code:4233,severity:B})},get DOWNLOAD_WAS_SLOW(){return new x({code:4237,description:"Slow download",severity:B})},get DOWNLOADS_OFTEN_SLOW(){return new x({code:4236,severity:S,recoverable:!0})},get DOWNLOADS_OFTEN_SLOW_FATAL(){return new x({code:4238,description:E.insufficientBandwidth,severity:C,recoverable:!0})},get LOAD_FAILED_BUFFERING(){return new x({code:4240,severity:C,recoverable:!0})},get STREAM_FRAGMENT_CONTENT_LENGTH_MISMATCH(){return new x({code:4241,severity:S})},get DASH_LIBRARY_LOAD_FAIL(){return new x({code:4242,severity:C})},get NO_ALTERNATIVE_CONNECTIONS(){return new x({code:5e3,severity:C,recoverable:!0})},get FORMAT_NOT_SUITABLE(){return new x({code:5001,severity:S})},get FORMAT_NOT_DECODED(){return new x({code:5003,severity:S})},get MEDIA_ERR_ABORTED(){return new x({code:5005,severity:S})},get MEDIA_ERR_NETWORK(){return new x({code:5007,severity:S})},get HLS_WAITING_TOO_LONG(){return new x({code:5200,severity:S})},get PLUGIN_LOAD_FAIL(){return new x({code:6100,severity:S})},get PLUGIN_INITIALISE_FAIL(){return new x({code:6101,severity:S})},get SUBTITLES_LOAD_ERROR(){return new x({code:7500,severity:S})},get THUMBNAIL_FAILOVER(){return new x({code:7501,severity:S})},get SUBTITLES_LIBRARY_ERROR(){return new x({code:7520,severity:S})},get SUBTITLES_PARSE_ERROR(){return new x({code:7600,severity:S})},shouldReturnToPreplay:t=>t.code>=2210&&t.code<=2212};class L{static getPreferredTransferFormats(t){const e=[];if(t.supportsDash&&e.push("dash"),t.supportsHLS?(e.push("hls"),e.push("plain")):(e.push("plain"),e.push("hls")),t.preferHls){const t=e.indexOf("hls");t>0&&(e.splice(t,1),e.unshift("hls"))}return e}static mediate(t,e,i){e||(e={});const s=L.getPreferredTransferFormats(d),n=["https"],o=e.overrideMediaSet||e.mediaset||"mobile-phone-main",a=e.encodings;let r,l;!0===e.http_host?r="http://"+e.host:e.host&&(r="https://"+e.host);const u={mediaset:o,host:r};e.ms6v3?u.cvid=t.cvid||"urn:bbc:pips:pid:"+t.vpid:u.vpid=t.vpid,i.addUrlOptions(u);const c=p(u);!e._disallowTokensInToucan&&t.jwtToken&&(l={Authorization:"Bearer "+t.jwtToken});const h=i.request(c.url,l,u.jsfunc).then(i=>{const r=k(i,{transferFormats:s,protocols:n,encodings:a});let l;return t.mediaset=o,t.originalConnections=r.originalConnections,l=r.result.video?"video":r.result.audio?"audio":"unknown",t.contentType=l,"unknown"!==l?(function(t,e,i){const s=t.contentType;if(t.connections={},function(t){t.forEach(t=>{t.supplier=function(t){let e=t.supplier+"";for(const i of["transferFormat","protocol"])e.includes(t[i])||(e+="_"+t[i]);return e}(t)})}(e.result[s]),t.connections[s]=function(t){return t.filter(t=>!(0==t.dpw&&(t.supplier+"").indexOf("vbidi")>=0))}(function(t,e){return e?t.filter(t=>(t.supplier+"").indexOf(e)>=0):t}(e.result[s],i.fck)),e.result.captions){let i=function(t){let e={};for(let i=0;i<t.length;i++){let s=t[i],n=s.purpose+"_"+s.language;e[n]?e[n].captions.push(s):e[n]={purpose:s.purpose,language:s.purpose,captions:[s]}}const i=Object.entries(e).map(t=>t[1].captions);return i.sort(A),i}(e.result.captions);i.length>1&&(t.connections.altCaptions=i),t.connections.captions=i[0]}e.result.thumbnails&&(t.connections.thumbnails=e.result.thumbnails);t.mediated=!0}(t,r,e),Promise.resolve(t)):r.error?Promise.reject(function(t){let e;switch(t){case"postAvailability":case"postLiveAvailability":e=P.CONTENT_EXPIRED;break;case"preAvailability":e=P.NOT_AVAILABLE_YET;break;case"regionRestriction":case"geolocation":e=P.MEDIASELECTOR_GEOLOCATION;break;case"tokeninvalid":e=P.TOKEN_INVALID;break;case"tokenexpired":e=P.TOKEN_EXPIRED;break;case"badrequest":case"unauthorized":case"serviceunavailable":case"forbidden":case"other":case"No media":case"No connections":case"No connections after filtering":e=P.MEDIASELECTOR_OTHER;break;case"notavailable":case"selectionunavailable":e=P.CONTENT_NOT_AVAILABLE;break;case"itemRevoked":e=P.MEDIASELECTOR_REVOKED;break;case"unknownorigin":e=P.MEDIASELECTOR_UNKNOWN_ORIGIN;break;default:e=P.MEDIASELECTOR_UNKNOWN}return e}(r.error)):void 0},t=>Promise.reject(t));return h}}function A(t,e){const i=t[0],s=e[0];return i.purpose==s.purpose?"en"==(i.lang+"").substring(0,2)?-1:1:"hard-of-hearing"==i.purpose?-1:"hard-of-hearing"==s.purpose?1:0}class I{constructor(t){this.history=new u,this.kind=t.kind,this.contentType=function(t){if("360"==t)return"360";if("audio"==t||"radioProgramme"==t)return"audio";return"video"}(this.kind),this.duration=t.duration,this.consumptionMode=t.consumptionMode||"ondemand",this.failureMode=t.failureMode,this.failureMode||this.isIdentOrWarning&&(this.failureMode=I.FAST_SILENT),t.live&&(this.consumptionMode="live"),t.versionID?(t.vpid=t.versionID,this.versionID=t.versionID):t.serviceID&&(t.vpid=t.serviceID,this.consumptionMode="live",this.simulcast=!0,this.serviceID=t.serviceID),t.vpid&&!t.cvid?(this.vpid=t.vpid,this.identifier=t.vpid):t.cvid?(this.cvid=t.cvid,this.identifier=t.cvid):t.href&&(this.href=t.href,function(t,e){let i={};if("string"==typeof e.href)i[t.contentType]=[{href:e.href,transferFormat:"plain"}];else{if(!Array.isArray(e.href))return void 0;i=k({media:e.href.map(O,t)},{transferFormats:L.getPreferredTransferFormats(d)}).result}e.captionsUrl&&(e.captionsUrl,1)&&(i.captions=[{href:e.captionsUrl,transferFormat:e.captionsTransferFormat}]);t.connections=i,t.history.push("premediated")}(this,t)),t.jwtTokenRequired&&(this.jwtTokenRequired=!0),t.jwtToken&&(this.jwtToken=t.jwtToken),!0===t.preferAD&&(this.preferAD=!0),!1===t.preferAD&&(this.preferAD=!1),this.is360&&this.history.push("premediated"),(t.in||t.out)&&(this.in=t.in||0,this.out=t.out)}get captionsList(){if(this.connections)return this.connections.captions}get thumbnailList(){if(this.connections)return this.connections.thumnails}get contentType(){return this._contentType}get type(){return this._contentType}set contentType(t){this._contentType=t}get is360(){return"360"==this._contentType}get failSilent(){return this.failureMode==I.SILENT||this.failureMode==I.FAST_SILENT}get failFast(){return this.failureMode==I.FAST||this.failureMode==I.FAST_SILENT}get isLive(){return"live"==this.consumptionMode}get isProgramme(){const t=this.kind;return"programme"===t||"radioProgramme"===t||"360"===t||"audio"===t||"trailer"==t||void 0===t}get isIdent(){return"ident"===this.kind}get isIdentOrWarning(){const t=this.kind;return"ident"===t||"warning"===t}get isPlaceholderItem(){return"advert"===this.kind}static verify(t,e){return!(!t.vpid&&!t.cvid)||(!!t.isPlaceholderItem||(!(!t.href||!t.connections)||(e&&e(P.ITEM_NO_SOURCE),!1)))}}function O(t){return{connection:[{href:t.url,dpw:t.dpw,transferFormat:t.format||"plain",supplier:t.supplier,protocol:t.protocol||"https"}],bitrate:t.bitrate,kind:this.contentType}}function N(t){return M(t)}function R(t){return M(t,"live")}function F(t,e){return isNaN(e)?R(t):"-"+D(Math.max(0,e-t))}function D(t,e){if(t=parseFloat(t),isNaN(t)||t<0)return"00:00";t=Math.floor(t);let i=Math.floor(t/3600),s=Math.floor(t/60)%60,n=t%60;s<10&&(s="0"+s),n<10&&(n="0"+n);let o=[s,n];if("live"==e){o.pop();const t=i<10?"0"+i:i;o.unshift(t)}else i>0&&o.unshift(i);return o.join(":")}function M(t,e){if(t>604800){(function(t){t&&t.getFullYear||(t=new Date);var e=Math.floor(1.25*t.getFullYear()),i=t.valueOf(),s=new Date(i);s.setMonth(2),s.setDate(31-(e+4)%7),s.setUTCHours(1),s.setUTCMinutes(0),s.setUTCSeconds(0);var n=new Date(i);return n.setMonth(9),n.setDate(31-(e+1)%7),n.setUTCHours(1),n.setUTCMinutes(0),n.setUTCSeconds(0),t>s&&t<n})()&&(t=parseFloat(t)+3600);const e=new Date(1e3*t);t=60*e.getUTCHours()*60+60*e.getUTCMinutes()+e.getUTCSeconds()}return D(t,e)}function H(t){if(isNaN(t)||t>604800)return;if(0==(t=Math.floor(t)))return;const e=Math.floor(t/3600);let i="PT";return e>0&&(i+=e+"H"),i+Math.floor(t/60)%60+"M"+t%60+"S"}I.NORMAL="normal",I.FAST="fast",I.FAST_SILENT="fastsilent",I.SILENT="silent";class q{constructor(t,e){this.items=[],t?(this.holdingImageURL=t.holdingImageURL,this.firstFrameImageURL=t.firstFrameImageURL,this.holdingImage=t.holdingImage,this.autoplay=t.autoplay,Array.isArray(t.items)&&t.items.forEach(t=>{let e=q.existingMediaItem(t);e?this.items.push(e):this.items.push(new I(t))}),this._simulcast=t.simulcast||!1!==t.simulcast&&this.items.some(t=>t.simulcast),this.guidance=t.guidance,this.warning=t.warning,this.title=t.title,this.displayTitle=t.displayTitle,this.displaySecondaryTitle=t.displaySecondaryTitle,this.liveTimeInfo=t.liveTimeInfo,this.programmeDuration=function(t){if(t.items)for(let e=0;e<t.items.length;e++){let i=t.items[e];if((i.isProgramme||e===t.items.length-1)&&i.duration)return N(i.duration)}return""}(this),this.programmeIsoDuration=function(t){if(t.items)for(let e=0;e<t.items.length;e++){let i=t.items[e];if((i.isProgramme||e===t.items.length-1)&&i.duration)return H(i.duration)}return null}(this),this.noItemsReason=t.noItemsReason,this.queuedPlaylist=t.queuedPlaylist,this.queuedOptions=t.queuedOptions,this.previousPlaylist=t.previousPlaylist,this.previousOptions=t.previousOptions,this.embedRights=t.embedRights||"",this.embedRight="true"==this.embedRights||"allowed"==this.embedRights,this.fromQueue=t.fromQueue):this.blank=!0,e&&(this.statsObject=e.statsObject,e.overrideHoldingImage&&(this.holdingImageURL=e.overrideHoldingImage),e.overrideCtaDuration&&(this.programmeDuration=e.overrideCtaDuration),""===this.guidance&&e.forceGuidance&&(this.guidance=e.forceGuidance),e.startTime>0&&(this._filterIdentAndWarning=!0),e.suppressItemKind&&e.suppressItemKind.length&&"string"==typeof e.suppressItemKind&&(e.suppressItemKind=e.suppressItemKind.replace(/\s+/gim,"").split(",")),this._suppressItemKind=e.suppressItemKind)}get guidance(){return this._guidance||""}set guidance(t){this._guidance=t}get firstItem(){return this.items[0]}get simulcast(){return!!this._simulcast}get filterIdentAndWarning(){return!!this._filterIdentAndWarning}get suppressItemKind(){return this._suppressItemKind||[]}get queued(){if(this.queuedPlaylist)return{playlist:this.queuedPlaylist,options:this.queuedOptions}}set queued(t){t||(t={}),this.queuedPlaylist=t.playlist,this.queuedOptions=t.options}get previous(){if(this.previousPlaylist)return{playlist:this.previousPlaylist,options:this.previousOptions}}set previous(t){t||(t={}),this.previousPlaylist=t.playlist,this.previousOptions=t.options}get onlyAdverts(){if(this.items.length>0){for(let t=0;t<this.items.length;t++)if("advert"!==this.items[t].kind)return!1;return!0}return!1}get hasAds(){if(this.items.length>0){for(let t=0;t<this.items.length;t++)if("advert"==this.items[t].kind)return!0;return!1}return!1}static existingMediaItem(t){return q.createdMediaItems&&q.createdMediaItems.has(t)?q.createdMediaItems.get(t):null}static createMediaItem(t){q.createdMediaItems||(q.createdMediaItems=new WeakMap);let e=q.existingMediaItem(t);return e||(e=new I(t),q.createdMediaItems.set(t,e)),e}static verify(e,i){const s={postAvailability:P.CONTENT_EXPIRED,postLiveAvailability:P.CONTENT_EXPIRED,preAvailability:P.NOT_AVAILABLE_YET,regionRestriction:P.MEDIASELECTOR_GEOLOCATION,selectionunavailable:P.CONTENT_NOT_AVAILABLE,geolocation:P.MEDIASELECTOR_GEOLOCATION,other:P.MEDIASELECTOR_OTHER,itemRevoked:P.MEDIASELECTOR_REVOKED,noMedia:P.CONTENT_NOT_AVAILABLE,timeout:P.MEDIASELECTOR_OTHER,error:P.MEDIASELECTOR_OTHER,nocvidmediator:P.CONTENT_NOT_AVAILABLE},n=e.items,o=e.items.filter(t=>t.isProgramme).length;e.items=e.items.filter(t=>I.verify(t,i)),e.items=e.items.filter(z,e);const a=e.items.filter(t=>t.isProgramme),r=a.length;if(r>1){t;for(let t=0;t<a.length-1;t++){let e=a[t];e.failureMode||(e.failureMode="silent")}}if(0===e.items.length||o>0&&0===r||e.onlyAdverts){t;let o=s[e.noItemsReason];return o?(o.reportAsWarning=!0,i(o)):i(n>0?P.NO_PLAYLIST_ITEMS_AFTER_PARSE:P.NO_PLAYLIST_ITEMS),!1}if(e.items.filter(t=>t.is360).length>0)return i(P.ATTEMPTING_TO_PLAY_360),!1;return!0}}function z(t){return(!this.filterIdentAndWarning||!t.isIdentOrWarning)&&-1==this.suppressItemKind.indexOf(t.kind)}class U{constructor(){this._events=new Map,this._afterEvents=new Map,this.publicEvents=["playing","play","pause","ended","timeupdate","significantTimeupdate","seeking","seeked","ratechange","loadedmetadata","canplaythrough","canplay","showCta","durationchange","volumechange","playlistLoading","playlistLoaded","playlistEnded","mediaItemChanged","waiting","uiinfo","uiControlBarShown","uiControlBarHidden","setData","fullscreenEnter","fullscreenExit","breakpointchange","error","SonarInitiatedEvent","SonarPlayEvent","SonarPauseEvent","SonarResumeEvent","SonarEndEvent","SonarSeekEvent","SonarSeekingEvent","statsConfigChanged","SonarUserActionEvent","SonarAdEvent","SonarBufferEvent","playbackInterrupted","guidanceShow","embed","pluginLoaded","pluginInitialisationFailed","pluginLoadFailed","pluginRegister","continuousPlayToggleSwitched","continuousPlayChange","audioDescriptionChange","beforeFakeFullscreen","beforeFullscreenEnter","enterFakeFullscreen","exitFakeFullscreen","picInPicStarted","picInPicStopped","qoeInfo","volumeControlExpanded","volumeControlClosed","playbackStateEntered","openSubtitleCustomisationRequest","nextRequested","previousRequested","tokenRequired","multipleaudiotracks","trackchanged","subtitles","userPlay","heightChangeRequested","playQueuePressed","showError","transcriptionPressed","mediaItemInfoChanged","statsNavigation"],this.nonPublicChromecastEvents=["volumechange"],this._publicListeners=[],this.delayedFunctions=[],window.addEventListener("message",t=>{if("SMP.asyncDelay"!=t.data);else if(this.delayedFunctions.length>0){var e=this.delayedFunctions.shift();e&&e.fn.apply(e.that,e.args)}})}registerForPublic(t){this.annotator&&this._publicListeners.push(t)}unregisterForPublic(t){for(let e=0;e<this._publicListeners.length;)this._publicListeners[e]===t?this._publicListeners.splice(e,1):e++}bind(t,e,i){let s,n;s=Array.isArray(t)?t:[t],n=i?this._afterEvents:this._events;for(let t=0;t<s.length;t++)n.has(s[t])?n.get(s[t]).push(e):n.set(s[t],[e])}unbind(t,e){let i=this._events.get(t);if(i)for(let t=0;t<i.length;)i[t]===e?i.splice(t,1):t++;if(i=this._afterEvents.get(t),i)for(let t=0;t<i.length;)i[t]===e?i.splice(t,1):t++}triggerEvent(t){return this.trigger(t.type,t)}triggerPublic(t,e){e=this.annotator.annotate(t,e);for(const t of this._publicListeners)try{t(e)}catch(t){console.error("Error emitting event to page/plugin, swallowed by Toucan",t,e)}return e}trigger(t,e,i){const s=this._events.get(t);if(s)for(const t of s)t(e);(i||this.publicEvents.includes(t))&&this.annotator&&(e=this.triggerPublic(t,e));const n=this._afterEvents.get(t);if(n)for(const t of n)t(e);return e}asyncDelay(t,e,i){this.delayedFunctions.push({fn:t,args:e,that:i}),window.postMessage&&window.postMessage("SMP.asyncDelay","*")}delayedTrigger(t,e,i){this.asyncDelay(this.trigger,[t,e,i],this)}castingOn(){this.publicEvents=this.publicEvents.filter(t=>!this.nonPublicChromecastEvents.includes(t))}castingOff(){this.publicEvents.push(...this.nonPublicChromecastEvents)}}class W extends CustomEvent{constructor(t){super("setData"),this.data=t}}class V extends CustomEvent{constructor(t){super(t.type,{detail:t.detail});const e={};Object.assign(e,t),delete e.type,delete e.detail,Object.assign(this,e)}}class j extends CustomEvent{constructor(t,e){super(t),Object.assign(this,e)}}class G extends CustomEvent{constructor(t,e){super(t),Object.assign(this,e)}}class $ extends CustomEvent{constructor(t,e){super(t);const i={};Object.assign(i,e),delete i.type,Object.assign(this,i)}}class K extends CustomEvent{constructor(t){super("uiinfo"),Object.assign(this,t)}}class Q extends CustomEvent{constructor(t){super("heightChangeRequested"),Object.assign(this,t)}}class Y extends CustomEvent{constructor(t){super(t)}}class J extends CustomEvent{constructor(t){super("configFromPlayer"),this.config=t}}class X extends CustomEvent{constructor(t,e){super(t),this.annotated=!0,Object.assign(this,e)}}const Z=["playing","mediaItemChanged","playlistLoaded","playlistLoading"],tt=["timeupdate","seeked","seeking","significantTimeupdate","durationchange","loadedmetadata"],et=["loadedmetadata"],it=["ratechange"],st=["volumechange","muted"],nt=["pause","playing","ended","play"],ot=["multipleaudiotracks"],at=Z.concat(tt,et,nt,st,it,ot),rt=["SonarPlayEvent","SonarPauseEvent","SonarResumeEvent","SonarEndEvent","SonarSeekEvent","SonarSeekingEvent","statsConfigChanged","SonarUserActionEvent","SonarBufferEvent","statsNavigation"],lt=["error"];class ut{constructor(t){this._toucan=t}annotate(t,e){if(e instanceof Event&&e.annotated)return e;let i,s={};if(Z.includes(t)&&(s.mediaItem=this._toucan.mediaItem,s.playlist=this._toucan.playlist,s.statsObject=this._toucan.settings.statsObject,s.mediaItem&&(s.kind=s.mediaItem.kind,s.live=s.mediaItem.isLive)),lt.includes(t)&&Object.assign(s,e),ot.includes(t)&&Object.assign(s,e.detail),tt.includes(t)){s.duration=this._toucan.duration,s.currentTime=this._toucan.currentTime;let t=this._toucan.playbackController;t&&(this._toucan.isLive&&(s.streamStart=t.streamStart,s.latestSeek=t.latestSeek,s.earliestSeek=t.earliestSeek,s.streamEnd=t.streamEnd,s.joinTime=t.joinTime,s.atLiveEdge=t.blockSeekToEnd,s.canSeekToLiveReStart=t.canSeekToLiveReStart,s.livePoint=s.latestSeek),s.underFiveSecsElapsed=t.underFiveSecsElapsed,s.canSeek=t.canSeek,s.canSeekForwards=t.canSeekForwards,s.canSeekBackwards=t.canSeekBackwards)}if(it.includes(t)){let t=this._toucan.playbackController;s.playbackRate=t.playbackRate}if(rt.includes(t)&&(e&&Object.assign(s,e),s.mediaItem=this._toucan.mediaItem,s.playlist=this._toucan.playlist),et.includes(t)&&this._toucan._statsProvider){let t=this._toucan._statsProvider.playback;t&&(s.transferFormat=t.transferFormat,s.cdn=t.supplier,s.width=t.videoWidth,s.height=t.videoHeight)}return nt.includes(t)&&(s.paused=this._toucan.paused,s.ended=this._toucan.ended,"playing"==t&&(s.startupTimes=this._toucan._statsProvider.startupTimes)),st.includes(t)&&(s.muted=this._toucan.muted,s.volume=s.muted?0:this._toucan.volume),at.includes(t)?i=new j(t,s):rt.includes(t)?i=new G(t,s):lt.includes(t)?i=new $(t,s):(e||(i=new CustomEvent(t)),i=e instanceof Event?e:new CustomEvent(t,{detail:e})),i.annotated=!0,i}}function ct(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*new Date%16|0;return("x"==t?e:3&e|8).toString(16)}).toUpperCase()}const dt=/[\s|!*'();:@&=+$,\/?%#\[\]]+/gm;function ht(t){return isNaN(t)?"-":Number(t).toFixed(0)}function pt(t){return isNaN(t)?"-":Number(100*t).toFixed(0)}function mt(t){return isNaN(t)?"-":Number(t).toFixed(1)}function gt(t){return"string"==typeof t?encodeURIComponent(t.replace(dt,"~")):"-"}function bt(t){return Array.isArray(t)&&0!==t.length?t.reduce((t,e)=>t+(e?"t":"f"),""):"-"}const ft={critical:"c",error:"e",warning:"w",info:"i"};function yt(t,e,i){const s=`${t.baseUrl}/${e}/av/${ht(t.formatVersion)}/${gt(t.deviceName)}/${gt(t.libraryName)}/${gt(t.libraryVersion)}/${gt(t.playerName)}/${gt(t.playerVersion)}/${gt(t.UUID)}/${ht(t.eventCount)}/${gt(t.counterName)}/${gt(t.supplier)}/${gt(t.transferFormat)}/${o=t.contentType,"audio"===o||"video"===o?o:"-"}/${n=t.consumptionMode,"live"===n||"ondemand"===n?n:"-"}/${gt(t.mediaset)}/${gt(t.identifier)}`;var n,o;return i.baseRdotInfo.eventCount++,s}function vt(t){return`/pl/${function(t){let e;switch(t){case"none":e="n";break;case"low":e="l";break;case"medium":e="m";break;case"high":e="h";break;default:e="-"}return e}(t.preload)}`}function _t(t){return`/${ht(t.downloadBitrate)}/${ht(t.playbackBitrate)}/${ht(t.bufferEvents)}/${mt(t.bufferTime)}/${mt(t.bufferLength)}/${mt(t.currentTime)}/${mt(t.liveEdgeTimestamp)}`}function kt(t,e){let i=Object.assign({},e.baseRdotInfo);return i=Object.assign(i,t),i}function wt(t,e){if(t.getEntriesByName){var i=t.getEntriesByName(e);if(i)return i[0]}}function Tt(t,e,i){const s=wt(t,e);return s?(s.startTime-i).toFixed(0):"~"}class Et{constructor(t,e,i,s,n,o,a){const r=ct();this.errorCounts={_3025:100},this.playerId=o,this.adapter=a,this.baseRdotInfo={baseUrl:t.replace(/\/e$/,""),av:"av",formatVersion:0,libraryName:e,libraryVersion:i,playerName:s,playerVersion:n,UUID:r,eventCount:0}}generateNewUUID(){this.baseRdotInfo.UUID=ct(),this.baseRdotInfo.eventCount=0}trackPlayIntent(t,e){if(!t)return;let i=yt(kt(t,this),"p",this);e&&(i+=vt(e)),this._track(i)}trackPlaySuccess(e,i){if(!e)return;const s=kt(e,this),n=`/${mt((o=s).mediationTime)}/${mt(o.startupTime)}`;var o;let a=yt(s,"ps",this)+n;i&&(a+=vt(i));const r=window.performance;try{if(r&&this.adapter&&this.adapter.hasAdsPlugin){const t=function(t,e){let i=wt(e,"ad-interrupt-"+t);if(i){const s="ad-error-"+t,n="ad-all-complete-"+t;let o="/ad";return o=o+"/"+Tt(e,"ad-started-"+t,i.startTime),o=o+"/"+Tt(e,s,i.startTime),o=o+"/"+Tt(e,n,i.startTime),o}return""}(this.playerId,r);a+=t}}catch(e){t}this._track(a)}trackPlaybackStopped(t){if(!t)return;const e=kt(t,this),i=`/${bt([(s=e).state.paused,s.state.ended,s.state.seeking])}/${mt(s.duration)}/${mt(s.played)}/${mt(s.timespent)}/${ht(s.bufferingEvents)}/${mt(s.bufferingTime)}/${ht(s.seekingEvents)}/${mt(s.seekingTime)}`;var s;const n=yt(e,"s",this);let o="";o=t.casting?function(t){return`/c/${ht(t.casting.time)}`}(e):t.alston?function(t){return`/${gt(t.alston.version)}/${pt(t.alston.stalling)}/${pt(t.alston.video)}/${pt(t.alston.score)}`}(e):"";const a=n+i+o;this._track(a,!0)}trackQOSInfo(t,e,i){if(!t||!e)return;let s=yt(kt(t,this),"i",this)+_t(e);if(i){s+=`/caa/${ht((n=i).bufferEventsSinceLast)}/${ht(n.bufferTimeSinceLast)}/${ht(n.playbackTimeSinceLast)}/${ht(n.failoversSinceLast)}/${bt([n.throttled,n.hidden,n.muted,n.inpage])}`}var n;this._track(s)}trackError(t,e,i){if(!t||!i)return;if(isNaN(this.errorCounts["_"+i.code])&&(this.errorCounts["_"+i.code]=0),this.errorCounts["_"+i.code]++>=100)return;const s=yt(kt(t,this),"e",this);e||(e={});const n=_t(e),o=""+i.code;let a=i.reportAsWarning?"w":ft[i.severity];i.extra&&(a+="~"+i.extra);var r;const l=s+n+`/${ht((r={code:o,extra:a}).code)}/${gt(r.extra)}`;this._track(l)}_track(t,e){if(e&&navigator.sendBeacon)try{if(navigator.sendBeacon(t,""))return}catch(t){}const i=new Image;i.src=t,i.onload=i.onerror=()=>{delete i.src}}}class Ct{constructor(t,e,i){this.eventBus=t,this.statsProvider=i,this.hasAdsPlugin=!1;let s=e.domid;const n=e.rdotBaseUrl||"https://r.bbci.co.uk/e";this._rdotReporter=new Et(n,"smp-toucan","1.0.0","smp-toucan",i._toucanPlayer.shortVersion,s,this),this.reportHistory={},this.eventFunctions={},this.alwaysFunctions={},this.activated=!1;for(const t of Object.keys(Ot))this.eventFunctions[t]=Ot[t].bind(this);for(const t of Object.keys(It))this.alwaysFunctions[t]=It[t].bind(this),this.eventBus.bind(t,this.alwaysFunctions[t])}on(){if(!this.activated){for(const t of Object.keys(this.eventFunctions))this.eventBus.bind(t,this.eventFunctions[t]);this.activated=!0}}off(){if(this.activated){Nt(this);for(const t of Object.keys(this.eventFunctions))this.eventBus.unbind(t,this.eventFunctions[t]);this.activated=!1}}}function St(t,e){const i=e||{};if(t){const e=t.mediaItem;i.identifier=t.identifier,e&&(i.contentType=e.contentType,i.consumptionMode=e.consumptionMode,i.mediaset=e.mediaset||t.mediaset);const s=t.playback;s&&(i.supplier=i.supplier||s.supplier,i.transferFormat=s.transferFormat),i.counterName=Bt(t.counterName,t.embedPageURL)}return i}function Bt(t,e){return t&&"smp.player.page"!=t||e&&(t=function(t){let e=t.toLowerCase().replace("www.bbc.co",""),i=["no","host"];if(e.indexOf(":")>-1){let t=e.substr(0,e.indexOf(":"));"http"==t.substr(0,4)&&(t=""),e=e.substr(e.indexOf(":")+1);let s,n,o=e.match(/([\.a-z0-9\-]+)\/(.*)/);o?(s=o[1],n=o[2].split("?")[0].split("#")[0]):(s=e.replace(/[^a-z0-9\-\.]/g,""),n=""),n=n.replace(/[^a-z0-9\-\/]/g,""),i=[t].concat(s.split(".").concat(n.split(/\/+/))),i.filter&&(i=i.filter(t=>t.length>0))}"iplayer"==i[1]&&i.splice(0,1);let s=i.join("_");for(;s.length>30&&i.length>3;)i.splice(1,1),s=i.join("_");return s}(e)),(t+"").replace(/[^a-z0-9\-\._]*/gi,"")}function xt(t){const e={};if(t){const i=t.playback;i&&(e.downloadBitrate=i.downloadBitrate,e.playbackBitrate=i.playbackBitrate,e.bufferEvents=i.bufferEvents,e.bufferTime=i.bufferTime,e.bufferLength=i.bufferLength,e.currentTime=i.currentTime,e.liveEdgeTimestamp=i.liveEdgeTimestamp)}return e}function Pt(){if(!this.reportHistory.play&&!this.reportHistory.preload){let t=this.reportHistory.preloadExtension;this._rdotReporter.trackPlayIntent(St(this.statsProvider),t)}this.reportHistory.play||(this.reportHistory.play=performance.now(),this.statsProvider._toucanPlayer._echoReporter.setIntent())}function Lt(){if(this.reportHistory.playing&&!this.reportHistory.stopped){this.reportHistory.stopped=performance.now();const t=this.statsProvider.stoppedTimes;t.alston&&t.alston.video>=0&&t.alston.stalling>=0&&t.alston.video<=1&&t.alston.stalling<=1?this.eventBus.triggerEvent(new G("qoeInfo",t.alston)):delete t.alston,this._rdotReporter.trackPlaybackStopped(St(this.statsProvider,t))}this.infoTimer&&(clearTimeout(this.infoTimer),this.infoTimer=null),this.reportHistory={}}function At(t){t&&t.changingMetadata||(this.reportHistory.play&&this._rdotReporter.generateNewUUID(),this.reportHistory={})}const It={beforeMediaItemChanged:Lt,playlistLoading:Lt,playerDestroying:Lt,playlistLoaded:function(){this._rdotReporter.generateNewUUID()},mediaItemChanged:function(t){t.detail.history.has("preload")&&this.reportHistory.preload||At.apply(this,[t])},tryAgainClicked:At},Ot={play:Pt,playbackBegin:Pt,preload:function(t){if("none"!=t.preload){if(!this.reportHistory.play&&(this.reportHistory.preload=performance.now(),this.statsProvider)){const e={},i=t.mediaItem;i&&(e.identifier=i.vpid,e.contentType=i.contentType,e.consumptionMode=i.consumptionMode,e.mediaset=i.mediaset||this.statsProvider.mediaset),e.counterName=Bt(this.statsProvider.counterName,this.statsProvider.embedPageURL),this._rdotReporter.trackPlayIntent(e,t)}}else this.reportHistory.preloadExtension=t},playing:function(){if(!this.reportHistory.playing){const e=this.statsProvider.mediaItem;if(!e.history.has("canplay"))return;this.reportHistory.playing=performance.now();var t=this.statsProvider.startupTimes;let i=null;if(e){let t=e.history.first("preload");t&&(i=t.detail)}this._rdotReporter.trackPlaySuccess(St(this.statsProvider,t),i)}Rt(this)},error:function(t){this._rdotReporter.trackError(St(this.statsProvider,t),xt(this.statsProvider),t),"critical"==t.severity&&(this.infoTimer&&clearTimeout(this.infoTimer),this.infoTimer=null)},ended:function(){this.infoTimer&&(clearTimeout(this.infoTimer),this.infoTimer=null),Ft(this,!0)},pluginRegister:function(t){"smp-ads-plugin-toucan"===t.name&&(this.hasAdsPlugin=!0)}};function Nt(t){t.infoTimer&&(clearTimeout(t.infoTimer),delete t.infoTimer)}function Rt(t){Nt(t);const e=t.reportHistory;let i=59.95;e.timeUpdate||(i=9.97);let s=e.timeUpdate+1e3*i-performance.now();s<50&&(s=50),t.infoTimer=setTimeout(Ft.bind(null,t),s)}function Ft(t,e){const i=t.statsProvider,s=t.reportHistory;e&&!s.playing&&(e=!1),(e||function(t,e){let i=!1;(!t.timeUpdate&&performance.now()>t.playing+9990||t.timeUpdate>0&&performance.now()>t.timeUpdate+59990&&(Dt(e.playback.currentTime,t.lastTime)||Dt(e.playback.downloadBitrate,t.downloadBitrate)||Dt(e.playback.bufferLength,t.bufferLength)))&&(i=!0);return i}(s,i))&&(s.timeUpdate=performance.now(),s.lastTime=i.playback.currentTime,s.downloadBitrate=i.playback.downloadBitrate,s.bufferLength=i.playback.bufferLength,t._rdotReporter.trackQOSInfo(St(t.statsProvider),xt(t.statsProvider),function(t,e){const i={};if(t){const s=t.playback;s&&(e.info?(i.playbackTimeSinceLast=1e3*t.timespent(e.info.timespentNow),i.bufferEventsSinceLast=s.bufferEvents-e.info.bufferEvents,i.bufferTimeSinceLast=1e3*(s.bufferTime-e.info.bufferTime),i.failoversSinceLast=t.failovers(e.info.timespentNow)):(i.playbackTimeSinceLast=1e3*t.timespent(),i.bufferEventsSinceLast=s.bufferEvents,i.bufferTimeSinceLast=1e3*s.bufferTime,i.failoversSinceLast=t.failovers()),i.throttled=t.throttled,i.hidden=t.hidden,i.muted=t.muted,i.inpage=t.inpage,e.info={bufferEvents:s.bufferEvents,bufferTime:s.bufferTime,timespentNow:performance.now()})}return i}(t.statsProvider,s))),Rt(t)}function Dt(t,e){return t!=e&&!isNaN(t)&&!isNaN(e)}const Mt=2.6090576;class Ht{constructor(t){this.json=t}get videoScore(){try{let t=[],e=0,i=this.json.availableRepresentations.video;if(!i)return-1;let s=this.json.plays.video;for(let n=0;n<s.length;n++){let o=s[n],a=zt(i[o.representation]);t.push(a),e+=a*o.duration}let n=e/qt(s);return n<0&&(n=0),n>1&&(n=1),n}catch(t){return-1}}get stallingScore(){let t=this.json;try{let e=t.stalls.concat();e=function(t){let e=0;for(;e<t.length;)if(t[e].duration<.75){for(let i=e+1;i<t.length;i++)t[i].elapsed-=t[e].duration;t.splice(e,1)}else e++;return t}(e),e=function(t){if(t.length<2)return t;let e=1,i=t[0];for(;e<t.length;)i.elapsed+i.duration+2.5>=t[e].elapsed?(i.duration+=t[e].duration,t.splice(e,1)):(i=t[e],e++);return t}(e);let i=1,s=-1/0;for(let t=0;t<e.length;t++){let n=e[t],o=n.elapsed-s;i=i*Ut(n.duration)*Wt(t,o),s=n.elapsed+n.duration}let n=qt(e)+qt(t.pauses)+qt(t.seeks)+qt(t.plays.audio);return i*=Wt(e.length,n),i<0&&(i=0),i>1&&(i=1),i}catch(t){return-1}}get score(){let t=this.videoScore,e=this.stallingScore;return{version:"q1",video:t,stalling:e,score:t*e}}}function qt(t){return t.reduce((t,e)=>t+e.duration,0)}function zt(t){return 1-Math.exp(-8.474502416112685e-7*Math.pow(t.width,2))}function Ut(t){return 1-(1+Mt)/Mt*(1/(1+Mt*Math.exp(-.06852021*t))-1/(1+Mt))}function Wt(t,e){return 0==t?1:1-Math.exp(-.3973559*e/t)}class Vt{constructor(t){this._toucanPlayer=t,this._counterName=this._toucanPlayer.settings.counterName,this._toucanPlayer._eventBus.bind("playlistLoaded",()=>{this._counterName=this._toucanPlayer.settings.counterName})}get mediaset(){let t=this._toucanPlayer.settings.mediator||{};return t.overrideMediaSet||t.mediaset||"mobile-phone-main"}get playback(){return this._toucanPlayer.playbackController.statsProvider}get mediaItem(){return this._toucanPlayer.mediaItem}get contentType(){let t=this.mediaItem;return t?t.contentType:"unknown"}get counterName(){return this._counterName}get embedPageURL(){return this._toucanPlayer._config.embedPageURL}get identifier(){let t=this.mediaItem;return t?t.vpid:"-"}get startupTimes(){const t={};let e=this.mediaItem;if(e){var i=e.history;t.mediationTime=i.firstTimestamp("mediated")-i.firstTimestamp("mediating");const s=i.betweenFirst("pause","active","canplay");let n=i.firstTimestamp("active");(i.has(["playback-blocked","autoplay-failed"])||i.has("cast-disconnected")&&i.before("cast-disconnected","play")||!n)&&(n=i.lastTimestamp("start")),s||(i.has("preroll-interrupt")&&i.has("post-preroll-interrupt")&&i.betweenFirst("post-preroll-interrupt","start","play")?t.startupTime=i.after(n).lastTimestamp("canplay")-i.after(n).firstTimestamp("post-preroll-interrupt")+(i.firstTimestamp("preroll-interrupt")-n):t.startupTime=i.after(n).lastTimestamp("canplay")-n)}return t}get stoppedTimes(){const t={},e=this.mediaItem;if(e){const i=e.history;i.push("stopping",{mediaTime:this._toucanPlayer.playbackController.currentTime});let s=0,n=0,o=0,a=0,r=0,l=!1,c=!1,d=NaN,h=!0,p=i.firstIndex("playing"),m=i.events[p].timestamp;for(let t=p+1;t<i.events.length;t++){let e=i.events[t];"play"==e.name&&(h=!0,m=e.timestamp),h&&u.ENDS_PLAYING[e.name]&&(h=!1,r+=Yt(e.timestamp,m),m=NaN),l&&u.ENDS_BUFFERING[e.name]&&(s+=Yt(e.timestamp,d),l=!1,d=NaN),c&&u.ENDS_SEEKING[e.name]&&(o+=Yt(e.timestamp,d),c=!1,d=NaN),l||c||"waiting"!=e.name||(l=!0,h&&!c&&(n++,d=e.timestamp)),c||"seeking"!=e.name||(c=!0,h&&(a++,d=e.timestamp))}t.timespent=(r-(s+o))/1e3,t.bufferingTime=s/1e3,t.bufferingEvents=n,t.seekingTime=o/1e3,t.seekingEvents=a,t.duration=e.isLive?NaN:this._toucanPlayer.playbackController.duration,t.state={paused:this._toucanPlayer.playbackController.paused,ended:this._toucanPlayer.playbackController.ended,seeking:this._toucanPlayer.playbackController.seeking};let g=NaN;const b=this._toucanPlayer.playbackController.played;if(b){g=0;for(let t=0;t<b.length;t++)g+=b.end(t)-b.start(t)}if(t.played=g,t.casting=this.castTimes,!t.casting)try{t.alston=this.AlstonScores}catch(t){console.log("Alston calc failed:",t)}}return t}get QOEjson(){const e={},i=this.mediaItem;if(!i)return e;const s=this.mediaItem.history;e.id=i.identifier,e.playerName="toucan",e.playerVersion=this._toucanPlayer.version,e.counterName=this._counterName,e.ua=navigator.userAgent,e.consumptionMode=i.isLive?"live":"od",e.sessionStart=Qt(s.first("active"));let n=s.first("bitrateChanged");if(!n||!n.detail||!n.detail.bitrates)return e;e.availableRepresentations=n.detail.bitrates,e.duration=i.isLive?NaN:this._toucanPlayer.playbackController.duration;let o=s.reduceToPairs(["pause","play"],["seeking","inactive","ended"],null,["casting"]);e.pauses=o.map(Kt);let a=s.reduceToPairs(["waiting","playing"],["inactive","ended","pause"],["playing","waiting"],["casting"]);e.stalls=a.map(Kt);let r=s.reduceToPairs(["seeking","seeked"],["pause","inactive","ended"],null,["casting"]);e.seeks=r.map($t);const l={audio:[],video:[]};try{let t={},e=s.all("bitrateChanged");for(let i=0;i<e.length;i++){let s=e[i].detail.streamType;t[s]||(t[s]=e[i].detail.index)}let i=s.all(["play","playing","seeked","seeking","ended","bitrateChanged","stopping"],"casting"),n={audio:{},video:{}};for(let e=0;e<i.length;e++){let s=i[e],o=s.name;if(["play","playing","seeked"].includes(o)&&(jt(n,"audio",s.detail.mediaTime,t.audio),jt(n,"video",s.detail.mediaTime,t.video)),["seeking","ended","stopping"].includes(o)&&(Gt(n,"audio",s.detail.mediaTime,l.audio),Gt(n,"video",s.detail.mediaTime,l.video)),"bitrateChanged"==o){let e=s.detail,i=e.streamType;n[i]&&t[i]!=e.index&&(Gt(n,i,e.mediaTime,l[i]),t[i]=e.index,jt(n,i,e.mediaTime,e.index))}}s.has("stopping")||(Gt(n,"audio",this._toucanPlayer.playbackController.currentTime,l.audio),Gt(n,"video",this._toucanPlayer.playbackController.currentTime,l.video))}catch(e){t}return e.plays=l,e}get castTimes(){if(!this.mediaItem)return;return this.mediaItem.history.has("casting")?{time:this.mediaItem.history.times().casting}:void 0}get AlstonScores(){let t=this.QOEjson,e=new Ht(t).score;return e.json=t,e}timespent(t){return this.mediaItem.history.times(t).playing}failovers(t){return this.mediaItem.history.failovers(t)}get throttled(){return this._toucanPlayer.throttleAvoider.throttled}get hidden(){return!this._toucanPlayer.throttleAvoider.visible}get muted(){return this._toucanPlayer.muted}get inpage(){return!this._toucanPlayer.picInPicActive}}function jt(t,e,i,s){t[e]&&isNaN(t[e].time)&&(t[e].time=i,t[e].representation=s)}function Gt(t,e,i,s){if(t[e]&&!isNaN(t[e].time)){let n=i-t[e].time;n>0&&(t[e].duration=n,s.push(t[e])),t[e]={}}}function $t(t){let e=Kt(t);return e.seekTime=t[1].detail.mediaTime,e}function Kt(t){const e=t[0],i=t[1];return{time:e.detail.mediaTime/1e3,elapsed:e.timestamp/1e3,epoch:Qt(e),duration:(i.timestamp-e.timestamp)/1e3}}function Qt(t){if(t&&t.time)return new Date(t.time).toISOString()}function Yt(t,e){return isNaN(t-e)?0:t-e}class Jt{static multiline(t){const e=t.playback;let i=`SMP-Toucan ${t._toucanPlayer.version}`;if(t.mediaItem){const e=t.mediaItem;i+=`\nvpid: ${e.vpid}\nKind: ${e.kind}\nMode: ${e.consumptionMode}`;let s=e.history.last();i+=`\nState: ${s?s.name:"notStarted"}`}return e&&(i+=`\nPlaying: ${!e.paused}\nTime: ${e.currentTime}/${e.liveEdgeTimestamp}\nFormat: ${e.transferFormat}\nSupplier: ${e.supplier}\nRender Bitrate: ${e.playbackBitrate}kbps\nStream Bitrate: ${e.downloadBitrate}kbps\nBuffer Length: ${e.bufferLength}s\nBuffer Events: ${e.bufferEvents}\nBuffer Time: ${e.bufferTime}s`),i}}class Xt{constructor(){this.segments=[]}push(t){isNaN(t.index)||(this.segments.push(t),this.segments.length>20&&this.segments.shift(),this.newFragmentResolve&&(this.newFragmentResolve(),this.newFragmentResolve=null,this.newFragmentPromise=null))}async pull(){if(0===this.segments.length&&await this.onNewFragment(),this.segments.length>0){return this.segments.shift()}return null}async onNewFragment(){this.newFragmentPromise||(this.newFragmentPromise=new Promise(t=>{this.newFragmentResolve=t})),await this.newFragmentPromise}}class Zt extends EventTarget{constructor(t){super(),this.segmentQueue=new Xt,t.playbackController.playbacks.standard.addEventListener("segmentLoaded",e=>{"video"!=e.detail.mediaType&&"both"!==e.detail.mediaType||(e.detail.chunk.earliest=t.playbackController.earliestSeek,this.segmentQueue.push(e.detail.chunk))}),t.playbackController.playbacks.standard.addEventListener("seeked",()=>{this.dispatchEvent(new CustomEvent("seeked"))}),t.playbackController.playbacks.standard.addEventListener("mediaItemChanged",()=>{this.segmentQueue=new Xt})}}class te extends Error{constructor(t,e){super("Failed to fetch object: "+(e?"code: "+e.status:" no response ")+" url: "+t),this.url=t,this.response=e,this.name="FetchError"}}class ee{constructor(t,e){this.connectionSet=t,this.errorHandler=e,this.loading=!1,this.fetch=fetch,this.aborted=!1}abort(){this.aborted=!0}async load(){if(!this.connectionSet)throw new Error("No connections");this.loading=!0;try{return await async function(e,i,s){if(e&&e.length>0)for(let n=0;n<e.length;n++){const o=e[n].href;let a=null;try{a=await s(o)}catch(e){t,i.errorHandler(new te(o));continue}if(i.aborted)throw new Error("RequestAborted");if(a.ok){return{text:await a.text(),url:e[n]}}i.errorHandler(new te(o,a))}throw new Error("No connections returned a valid response")}(this.connectionSet,this,this.fetch)}finally{this.loading=!1}}}class ie extends ee{constructor(t,e,i){super(t,e),this.segmentProvider=i}abort(){super.abort()}async load(){if(!this.connectionSet)throw new Error("No connections");this.loading=!0;try{const e=await async function(t){const e=await t.segmentProvider.segmentQueue.pull();if(t.aborted)throw new Error("RequestAborted");return e}(this);if(e){const i=await async function(e,i,s,n){let o=-1;for(let a of i){if(o++,a.blocked)continue;const r=a.href.replace("$Number$",s);let l=null;try{l=await n(r)}catch(i){t,ne(a),e.errorHandler(new te(r));continue}if(e.aborted)throw new Error("RequestAborted");if(l&&l.ok){let t=await l.text();return t=t.split(/<\?xml[^\?]+\?>/i)[1],o>0&&(i.splice(o,1),i.unshift(a)),{text:t,url:a,live:!0,segmentId:s}}ne(i),e.errorHandler(new te(r,l))}throw new Error("Live subtitle not loaded")}(this,this.connectionSet,e.index,this.fetch);return i.offset=e.offset,i}}finally{this.loading=!1}}}function se(t){t.blocked=null}function ne(t){t.blocked=!0,setTimeout(se.bind(null,t),24e4)}class oe extends Error{constructor(t,e){super(t),this.fatal=e,this.name="SubtitlesParseError"}}class ae{constructor(t){this.subtitles=t,this.errorCount=0}reset(){this.errorCount=0}info(t){return!1}warning(t){return!1}error(t){if(this.errorCount<3&&!this.subtitles.live){const e=new oe(t,!1);re(this.subtitles,e),this.errorCount++}return!1}thrownFatal(t){const e=new oe(t,!0);re(this.subtitles,e)}}function re(t,e){const i=new CustomEvent("error",{detail:e});t.dispatchEvent(i)}class le extends HTMLElement{constructor(t){super(),this.___config=t||{},this.needToCreate=!0}connectedCallback(){this.needToCreate&&(this.create(),delete this.needToCreate)}create(){const t=this.___config;if(this.attachShadow({mode:"open"}),t.stylesheet){const e=document.createElement("style");e.setAttribute("type","text/css"),e.textContent=t.stylesheet,this.shadowRoot.appendChild(e)}if(t.template){const e=t.template.content.cloneNode(!0),i=e.firstChild;this.shadowRoot.appendChild(e),t.templateName&&(this[t.templateName]=i)}}markDirty(){this.___dirty||(this.___dirty=!0,this.___animTimer=window.requestAnimationFrame(ue.bind(this)))}render(){this.___animTimer&&window.cancelAnimationFrame(this.___animTimer),this.___dirty=!1}cancelRender(){this.___animTimer&&window.cancelAnimationFrame(this.___animTimer),this.___dirty=!1}attributeChanged(){}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.attributeChanged(t)}delayedDispatch(t){window.requestAnimationFrame(dispatchEvent.bind(this,t))}}function ue(){this.___dirty=!1,this.shadowRoot&&this.render()}let ce=new Map,de=new Map;class he{static load(t,e){return de[e]?Promise.resolve(de[e]):(ce[e]||(ce[e]=new Promise(function(i,s){import(t).then(t=>{ce[e]=null,window[e]?(de[e]=window[e],i(window[e])):t&&(de[e]=t,i(t))}).catch(i=>{ce[e]=null,s(t)})})),ce[e])}}class pe{constructor(t,e){this._library=t,e&&(this._webworker=function(t){const e=`function() { importScripts("${t}"); }`,i=new Blob(["("+e+")()"],{type:"text/javascript"}),s=URL.createObjectURL(i);return new Worker(s)}(e))}fromXML(t,e,i,s){if(this._webworker)return function(t,e,i){return new Promise((s,n)=>{t.onmessage=t=>{if(t.data.result)s(t.data.result);else if(t.data.error){const e=t.data.error;i[e.severity](e.message),"thrownFatal"===e.severity&&n(e)}},t.postMessage({xmlStr:e})})}(this._webworker,t,e);{let n;try{n=this._library.fromXML(t,e,i,s)}catch(t){return e.thrownFatal(t),Promise.reject(t)}return Promise.resolve(n)}}generateISD(t,e,i){return this._library.generateISD(t,e,i)}renderHTML(t,e,i,s,n,o,a,r,l,u){return this._library.renderHTML(t,e,i,s,n,o,a,r,l,u)}}function me(t,e){const i=t.map(function(t,e){return{item:t,position:e}});i.sort(function(t,i){let s=e(t.item,i.item);return 0===s&&(s=t.position-i.position),s});const s=[];for(let t=0;t<i.length;t++)s[t]=i[t].item;return s}function ge(t,e,i,s){const n=t.getBoundingClientRect(),o=function(t){let e=0,i=0,s=0,n=0;for(let o of t)e=Math.max(e,o.top||0),i=Math.max(i,o.bottom||0),s=Math.max(s,o.left||0),n=Math.max(n,o.right||0);return{top:e,bottom:i,left:s,right:n}}(i);o.top+o.bottom>n.height&&(o.bottom=n.height-o.top);const a=new DOMRect(n.left+o.left,n.top+o.top,n.width-(o.left+o.right),n.height-(o.top+o.bottom)),r=me(e,(t,e)=>e.rect.top-t.rect.top),l=me(s,(t,e)=>e.top-t.top),u=[];for(let t=0;t<r.length;t++){const e=r[t];e.newRect=e.rect;const i=fe(e,{up:0,right:0},u,a,l,!0);e.translation=i,u.push(r[t])}u.forEach(t=>{!function(t,e){const i=t.style;i.position="relative",i.bottom=e.up+"px",i.left=e.right+"px"}(t.target,t.translation)})}function be(t,e){return new DOMRect(t.left+e.right,t.top-e.up,t.width,t.height)}function fe(t,e,i,s,n,o){o?e.up=Math.max(0,t.newRect.bottom-s.bottom):e.up+=Math.min(0,t.newRect.top-s.top),(e.up||e.right)&&(t.newRect=be(t.rect,e));for(let s=0;s<i.length;s++)ye(t,i[s].newRect,e,o);if(o)for(let i=0;i<n.length;i++)ye(t,n[i],e,o);else for(let i=n.length-1;i>=0;i--)ye(t,n[i],e,o);if(o&&t.newRect.top<s.top){const o=[];fe(t,e,o,s,n,!1),o.push(t);for(let t=i.length-1;t>=0;t--){for(let s=0;s<o.length;s++){ye(i[t],o[s].newRect,i[t].translation,!1);for(let s=0;s<n.length;s++)ye(i[t],n[s],e,!1)}o.push(i[t])}}return e}function ye(t,e,i,s){return function(t,e){const i=Math.max(t.top,e.top),s=Math.min(t.bottom,e.bottom),n=Math.max(t.left,e.left),o=Math.min(t.right,e.right);if(s>i&&o>n)return new DOMRect(n,i,o-n,s-i);return null}(t.newRect,e)&&(s?i.up+=t.newRect.bottom-e.top:i.up-=e.bottom-t.newRect.top,t.newRect=be(t.rect,i)),i}class ve{constructor(){this.compliance=!1,this.standardNode=!1,this.allowPixels=!1,this.regions=new Set}onopentag(t){if(this.compliance)return!0;if("ebuttm:conformsToStandard"===t.local?this.standardNode=!0:this.standardNode=!1,"tt"===t.local){const e=t.attributes["ttp:timeBase"];e&&"smpte"===e.value&&(e.value="media");const i=t.attributes["ttp:extent"];i&&i.value.indexOf("px")>=0&&(this.allowPixels=!0)}else if("region"===t.local&&!this.allowPixels){_e(t.attributes["tts:origin"],"5% 5%");_e(t.attributes["tts:extent"],"90% 90%")}}ontext(t){!this.compliance&&this.standardNode&&("urn:ebu:tt:distribution:2018-04"!==t&&"http://www.w3.org/ns/ttml/profile/imsc1/text"!==t||(this.compliance=!0))}postISD(t){this.compliance||ke(t,{})}}function _e(t,e){t&&t.value.indexOf("px")>=0&&(t.value=e)}function ke(t,e){if(t.contents&&t.contents.length>0)for(let i=0;i<t.contents.length;i++)e.fontFamily=e.fontFamily||we(t.contents[i]),e.backgroundColor=e.backgroundColor||Te(t.contents[i]),ke(t.contents[i],e);else e.fontFamily||(t.styleAttrs["http://www.w3.org/ns/ttml#styling fontFamily"]=["ReithSans","Arial","Roboto","proportionalSansSerif","default"]),e.backgroundColor||(t.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"]=[0,0,0,255])}function we(t){return!!t.styleAttrs["http://www.w3.org/ns/ttml#styling fontFamily"]&&0!==t.styleAttrs["http://www.w3.org/ns/ttml#styling fontFamily"].indexOf("monospaceSerif")}function Te(t){const e=t.styleAttrs["http://www.w3.org/ns/ttml#styling backgroundColor"];return!!e&&(e.length<4||e[3]>0)}function Ee(t,e,i,s=!0){const n={longName:t,shortName:e,value:i,visible:s};return Object.freeze(n),Ce.set(e,n),n}const Ce=new Map,Se=[Ee("Extra large","xl",1),Ee("Large","l",.82),Ee("Medium","m",.67),Ee("Small","s",.6),Ee("Extra small","xs",.5),Ee("Micro","mic",.37,!1),Ee("Nano","nano",.25,!1)];function Be(t){let e=Ce.get("xl");return t.videoWidth>1280?e=Ce.get("s"):"B3"!=t.breakpoint&&"B4"!=t.breakpoint||(e=Ce.get("m")),e.value}function xe(t,e,i){return t<e?e:t>i?i:t}const Pe="smp_subtitle_customisation";function Le(){try{const t=window.localStorage.getItem(Pe);return t?JSON.parse(t):{}}catch(e){t}return{}}function Ae(t,e,i){if(t){const s=xe(t,e,i);return s}}function Ie(t){if(t)return t}function Oe(t){t.textOpacity&&(t.textOpacity=Ae(t.textOpacity,0,1)),t.backgroundOpacity&&(t.backgroundOpacity=Ae(t.backgroundOpacity,0,1)),t.windowOpacity&&(t.windowOpacity=Ae(t.windowOpacity,0,1)),t.textColorMap&&(t.textColorMap=Ie(t.textColorMap)),t.backgroundColorMap&&(t.backgroundColorMap=Ie(t.backgroundColorMap)),t.windowColorMap&&(t.windowColorMap=Ie(t.windowColorMap)),isNaN(t.textSize)||(t.textSize=function(t){let e;for(let i of Se){const s=i.value;if(!(s-t>0))return t-s>e-t?e:s;e=s}return e}(t.textSize))}function Ne(t){return{sizeAdjust:t.textSize,lineHeightAdjust:t.lineHeight,colorAdjust:t.textColorMap,colorOpacityScale:t.textOpacity,textOutline:t.textOutline,fontFamily:t.fontFamily,spanBackgroundColorAdjust:t.backgroundColorMap,pBackgroundColorAdjust:t.backgroundColorMap,divBackgroundColorAdjust:t.backgroundColorMap,bodyBackgroundColorAdjust:t.backgroundColorMap,backgroundOpacityScale:t.backgroundOpacity,regionBackgroundColorAdjust:t.windowColorMap,regionOpacityScale:t.windowOpacity}}function Re(t){return t.fontVariant||t.textShadow||t.webkitTextStroke?function(e){t.fontVariant&&(e.style.fontVariant=t.fontVariant),t.textShadow&&(e.style.textShadow=t.textShadow),t.webkitTextStroke&&(e.style.webkitTextStroke=t.webkitTextStroke)}:null}class Fe extends le{constructor(t,e,i){super(),this.uiinfo=t,this._loader=i||he,this._sizeDirty=!0,this.previousVideoInfo="",this._config={},this.subtitleCustomisationSettings={},this.margins=[],this._liveTT=[],this.fixedElements=[],this._videoMargin={},this.segmentProvider=e,this._errorHandler=new ae(this)}get live(){return this._liveTT.length>0}create(){super.create();let t=document.createElement("style");t.setAttribute("type","text/css"),t.textContent='span[breakafter]::after { content:"\\A"; white-space:pre}',this.shadowRoot.appendChild(t),this._container=document.createElement("div"),this._container.setAttribute("aria-live","polite"),this._container.style.cssText="position:absolute; width:100%; height:100%;",this.shadowRoot.appendChild(this._container),this._isOn=!1}set config(t){t.contrast&&"number"==typeof t.contrast&&t.contrast>1&&(this._config.contrast=t.contrast/100),t.sizeAdjustment&&"number"==typeof t.sizeAdjustment&&t.sizeAdjustment>0&&(this._config.sizeAdjustment=t.sizeAdjustment),this._config=t}get config(){return this._config}set videoMargin(t){this._videoMargin=t||{},this._sizeDirty=!0}get videoMargin(){return this._videoMargin}get isOn(){return this._isOn}set isOn(t){if(t===this._isOn)return;t?this.on():this.off();const e=new CustomEvent("change");this.dispatchEvent(e)}get available(){return!!this._connectionSet&&!this.failed}get connectionSet(){return this._connectionSet}set connectionSet(t){if(t!=this._connectionSet){if(this.subsDoc&&this.subsDoc.abort(),t){let e=!1;if(t&&t[0]){const i=t[0].href;i&&i.indexOf("$Number$")>=0&&(e=!0)}this.subsDoc=e?new ie(t,ze.bind(null,this),this.segmentProvider):new ee(t,ze.bind(null,this))}clearTimeout(this.failoverDelay),this.failed=!1,this._tt=null,this._liveTT=[],this.earliest=void 0,this.reorderLive&&(this.segmentProvider.removeEventListener("seeked",this.reorderLive),this.reorderLive=null),clearTimeout(this.deleteTimeout),this._connectionSet=t;const e=new CustomEvent("connectionsetchange");this.dispatchEvent(e),this._isOn&&t&&De(this)}}on(){this._isOn=!0,this._connectionSet&&De(this)}off(){this.reorderLive&&(this.segmentProvider.removeEventListener("seeked",this.reorderLive),this.reorderLive=null),this._isOn=!1,this.clear()}get height(){return this._height}get width(){return this._width}sizeChanged(){this._sizeDirty=!0}updateSize(){if(this._sizeDirty){if(this._sizeDirty=!1,this.uiinfo){const t=this._container.style;let e=this.uiinfo.videoY,i=this.uiinfo.videoX,s=this.uiinfo.videoHeight,n=this.uiinfo.videoWidth;if(0===n||0===s)this._sizeDirty=!0,t.width="100%",t.height="100%";else{const o=this._videoMargin;let a=[i,e,s,n,o.left,o.right,o.top,o.bottom].join("/");if(a!=this.previousVideoInfo){this.previousVideoInfo=a,t.top=e+(isNaN(o.top)?0:o.top)+"px",t.left=i+(isNaN(o.left)?0:o.left)+"px",t.width=n-((isNaN(o.left)?0:o.left)+(isNaN(o.right)?0:o.right))+"px";let r=s-((isNaN(o.top)?0:o.top)+(isNaN(o.bottom)?0:o.bottom));this._config.disableDeconflict?t.setProperty("height","calc("+r+"px - var(--smp-subtitle-margin-bottom))"):t.height=r+"px"}}}this._height=this._container.clientHeight,this._width=this._container.clientWidth}}render(t){if((this._tt||0!=this._liveTT.length)&&Number.isFinite(t)&&this._isOn){this.clear();let e=this._tt;if(e||(e=function(t,e){for(let i=e.length-1;i>=0;i--){let s=e[i],n=s.body,o=t;if(Number.isFinite(s.offset)&&(o+=s.offset),o>=n.begin&&o<n.end)return s}return null}(t,this._liveTT)),!e)return;Number.isFinite(e.offset)&&(t+=e.offset);const i=this.imsc.generateISD(e,t,this._errorHandler);let s,n=this.config.sizeAdjustment;if(isNaN(n)&&(n=Be(this.uiinfo)),s=this._customisationSettings?Ne(this._customisationSettings):{},isNaN(n)||(s.sizeAdjust=n),!s.backgroundContrast&&this.config.contrast&&(s.backgroundContrast=this.config.contrast),!s.fontFamily&&this.connectionSet[0].adjustStyling&&(s.fontFamily="ReithSans, Arial, Roboto, proportionalSansSerif, default"),i.contents.length>0)try{if(this.compatibility.postISD(i),this.updateSize(),this.imsc.renderHTML(i,this._container,null,this.height,this.width,null,this._errorHandler,null,!1,s),this._customisationSettings){const t=Re(this._customisationSettings);t&&t(this._container)}if(!this._config.disableDeconflict){const t=this.margins.map(t=>t.getMargin()).filter(t=>!!t),e=this.fixedElements.map(t=>{if("function"==typeof t)try{return t()}catch(t){return console.error(t),null}return null}).filter(t=>t&&function(t){if(["width","height","top","left","right","bottom"].every(e=>Number.isFinite(t[e])))return!0;return!1}(t));(t.length>0||e.length>0)&&ge(this._container,function(t){const e=Array.from(t.querySelectorAll("p"));return e.map(t=>({target:t,rect:Ue(Array.from(t.children))}))}(this._container),t,e)}}catch(e){this._errorHandler.error(e.message+"~"+t)}}}clear(){if(this._container)for(;this._container.firstChild;)this._container.removeChild(this._container.firstChild)}addMargin(t){this.margins.push(t)}removeMargin(t){const e=this.margins.indexOf(t);e>0&&this.margins.splice(e,1)}addFixedElement(t){this.fixedElements.push(t)}removeFixedElement(t){const e=this.fixedElements.indexOf(t);e>0&&this.fixedElements.splice(e,1)}get customisationSettings(){return this._customisationSettings||(this._config.disableLocalStorage?this._customisationSettings={}:this._customisationSettings=Le()),this._customisationSettings}set customisationSettings(t){Oe(t),this._config.disableLocalStorage||function(t){try{window.localStorage.setItem(Pe,JSON.stringify(t))}catch(t){}}(t),this._customisationSettings=t}get enableCustomisation(){return this._customisationEnabled}set enableCustomisation(t){this._customisationSettings||this._config.disableLocalStorage||(this._customisationSettings=Le()),this._customisationEnabled=t}async getImscWrapper(){return this.imsc||await Me(this),this.imsc}}function De(t){let e=[];if(!t._tt&&t.subsDoc&&!t.subsDoc.loading){t._errorHandler.reset();const i=async function(t){let e;try{e=await t.subsDoc.load()}catch(t){throw t.message,t}if(e&&t.connectionSet.indexOf(e.url)>=0)return e}(t);e.push(i)}const i=Me(t);i&&e.push(i),e.length>0&&Promise.all(e).then(e=>He(t,e[0])).catch(e=>{if("RequestAborted"!=e.message){t.failed=!0;const i=new CustomEvent("subtitlesFailed",{detail:e});t.dispatchEvent(i)}})}function Me(t){if(!t.imsc){const e=t._config.useWebworker,i=/imscDebug=true/.test(document.cookie);let s="https://emp.bbci.co.uk/emp/imsc/1.0.11-7/";return s+=e?i?"imsc.nonworker.debug.mjs":"imsc.nonworker.min.mjs":i?"imsc.all.debug.mjs":"imsc.all.min.mjs",t._loader.load(s,"imsc").then(s=>{let n;if(t.compatibility=new ve,e){const t="https://emp.bbci.co.uk/emp/imsc/1.0.11-7/"+(i?"imsc.webworker.debug.js":"imsc.webworker.min.js");n=new pe(s.default,t)}else n=new pe(s.default);t.imsc=n},e=>{let i=new Error("Subtitle library load error");throw i.name="LibraryError",ze(t,i),console.error(e),e})}}async function He(t,e){if(!e)return void qe(t);const i=e.text,s=await t.imsc.fromXML(i,t._errorHandler,null,t.compatibility);if(e.live){if(t.earliest=e.earliest-120,function(t,e,i){0==t.events[0]&&t.events.shift(),t.events.length>0&&(e.connectionSet[0].adjustStyling&&(t.head.styling.initials={"http://www.w3.org/ns/ttml#styling displayAlign":"after","http://www.w3.org/ns/ttml#styling overflow":"visible","urn:ebu:tt:style linePadding":"0.4c"}),t.body.begin=t.events[0],t.offset=i,e._liveTT.push(t))}(s,t,e.offset),Number.isFinite(e.offset))for(let t=0;t<s.events.length;t++)s.events[t]-=e.offset}else{if(-1==(i+"").indexOf("<ebuttm:conformsToStandard>")&&s&&s.head&&s.head.styling&&(s.head.styling.initials={"urn:ebu:tt:style linePadding":"0.4c"}),s&&s.head&&s.head.layout&&s.head.layout.regions)for(let t of Object.keys(s.head.layout.regions))s.head.layout.regions[t].styleAttrs["http://www.w3.org/ns/ttml#styling overflow"]||(s.head.layout.regions[t].styleAttrs["http://www.w3.org/ns/ttml#styling overflow"]="visible");t._tt=s}const n={times:s.events},o=new CustomEvent("subtitlesLoaded",{detail:n});t.dispatchEvent(o),e.live&&(qe(t),t.reorderLive||(t.reorderLive=We.bind(null,t),t.segmentProvider.addEventListener("seeked",t.reorderLive)),t._liveTT.length>0&&t.earliest&&t._liveTT[0].body.begin<t.earliest&&(clearTimeout(t.deleteTimeout),t.deleteTimeout=setTimeout(()=>{if(!isNaN(t.earliest)&&t._liveTT.length>1){let e=1;for(;t._liveTT[e++].begin<t.earliest;);t._liveTT.splice(0,e)}},1e3)))}async function qe(e){let i;try{i=await e.subsDoc.load()}catch(i){t,e.failoverDelay=setTimeout(qe.bind(null,e),6e4)}i&&He(e,i)}function ze(t,e){const i=new CustomEvent("error",{detail:e});t.dispatchEvent(i)}function Ue(t){if(t.length>0){const e=t[0].getBoundingClientRect();let i=1;if(1===t.length){if(0==t[0].children.length)return e;t=t[0].children,i=0}let s=e.top,n=e.bottom,o=e.left,a=e.right;for(let e=i;e<t.length;e++){const i=t[e].getBoundingClientRect();s=Math.min(i.top,s),n=Math.max(i.bottom,n),o=Math.min(i.left,o),a=Math.max(i.right,a)}return new DOMRect(o,s,a-o,n-s)}}function We(t){t._liveTT.sort((t,e)=>t.body.begin-e.body.begin)}function Ve(t,e,i,s){if(i&&i.length>0)return function(t,e,i,s){var n=function(t){var e=t.textTracks;for(let t=0;t<e.length;t++)if("Subtitles"==e[t].label)return e[t];const i=t.addTextTrack("captions","Subtitles");return i.mode="hidden",i}(t);const o=window.VTTCue||window.TextTrackCue;for(let t=0;t<e.length;t++){const a=e[t];let r=!0;for(let t=n.cues.length-1;t>=0;t--)if(n.cues[t].startTime==a){r=!1;break}if(r){const e=new o(a,a,""),r=s?s[t]:a;e.onenter=()=>{i(r)},n.addCue(e)}}return n}(e,i,t.render.bind(t),s)}customElements.get("smp-subtitles")||customElements.define("smp-subtitles",Fe);class je{constructor(t,e){this.toucanPlayer=t,this.setDataOverride=!1,function(t,e,i){function s(){const e=t.toucanPlayer.uiSettings,s=t.toucanPlayer.mediaItem;if(s.connections&&s.connections.captions){let t=s.connections.captions;if(t&&t[0]&&e&&e.subtitles&&!e.subtitles.supportLiveSubtitles){let e=t[0].href;if(e&&e.indexOf("$Number$")>0)return void(i.connectionSet=null)}let n=s.connections.altCaptions;if(n&&e.subtitles.preferredLanguage){const t=(e.subtitles.preferredLanguage+"").split(",");let s=n.filter(e=>t.indexOf(e[0].language)>-1);if(s.length>0)return s.sort((e,i)=>t.indexOf(e[0].language)-t.indexOf(i[0].language)),void(i.connectionSet=s[0])}i.connectionSet=s.connections.captions}else i.connectionSet=null}function n(){t.toucanPlayer.subtitlesOn=!1;const e=t.toucanPlayer.uiSettings;e&&e.subtitles&&e.subtitles.defaultOn&&(e.subtitles.defaultOn=!1)}e.bind(["mediaItemChanged","mediated"],()=>{const e=t.toucanPlayer.uiSettings;e&&e.subtitles&&e.subtitles.defaultOn&&(i.isOn=!0),t.setDataOverride||s()}),e.bind("setData",e=>{"SMP.subtitlesHref"==e.data.name&&(e.data.data?e.data.data.url&&(i.connectionSet=[{href:e.data.data.url}],t.setDataOverride=!0):t.setDataOverride=!1)}),e.bind("playing",()=>{if(t._times&&!t._track){t._track=Ve(i,t.toucanPlayer.videoElement,t._times),t.toucanPlayer._eventBus.trigger("subtitlesLoaded");let e=t.toucanPlayer.currentTime;i.render(e)}}),e.bind("subtitles-toggle",()=>{t.toucanPlayer.subtitlesOn?n():t.toucanPlayer.subtitlesOn=!0}),e.bind("turnSubtitlesOn",()=>{t.toucanPlayer.subtitlesOn=!0}),e.bind("turnSubtitlesOff",()=>{n()}),e.bind(["mediaItemChanged","playlistLoading"],()=>{t.clearThings()}),e.bind(["seeking","seeked","turnSubtitlesOn","uiControlBarShown","uiControlBarHidden","continuousGuidanceToggle","markersUpdated"],()=>{Ge(t,i)}),e.bind("uiConfigUpdated",e=>{if(!e||!e.subtitles)return;let n;if(e&&e.subtitles&&(n=e.subtitles.yOffset),void 0!==n&&(t.yOffsetMargin&&(i.removeMargin(t.yOffsetMargin),t.yOffsetMargin=null),!isNaN(n)&&n>0&&(t.yOffsetMargin={getMargin:()=>({bottom:t.videoHeight-n})},i.addMargin(t.yOffsetMargin))),e.subtitles.defaultOn&&!i.isOn&&(i.isOn=!0),i.videoMargin=e.subtitles.videoMargin,void 0!==e.subtitles.preferredLanguage){const e=t.toucanPlayer.mediaItem;e&&e.connections.altCaptions&&s()}t._track&&Ge(t,i)}),e.bind("uiinfo",e=>{if(e.videoHeight>0){i.sizeChanged();let s=t.toucanPlayer.currentTime;i.render(s),t.videoHeight=e.videoHeight}})}(this,t._eventBus,e),function(t,e,i){function s(){e._eventBus.trigger("subtitlesAvailability",{available:i.available,enabled:i.isOn})}i.addEventListener("subtitlesLoaded",s=>{t._times=s.detail.times;let n=e.videoElement;if(n.seekable.length>0){if(t._times&&t._times.length>0){const s=t._times.map(t=>e.playbackController.utcToMedia(t));t._track=Ve(i,n,s,t._times)}if(e._eventBus.trigger("subtitlesLoaded"),!i.live){let t=e.currentTime;i.render(t)}}}),i.addEventListener("error",t=>{const i=t.detail;let s;"SubtitlesParseError"===i.name?(s=P.SUBTITLES_PARSE_ERROR,s.extra=i.message):"FetchError"===i.name?(s=P.SUBTITLES_LOAD_ERROR,s.extra=""+i.url,i.response&&(s.extra+="_"+i.response.status)):"LibraryError"===i.name&&(s=P.SUBTITLES_LIBRARY_ERROR),e._eventBus.trigger("error",s)}),i.addEventListener("subtitlesFailed",()=>{e._eventBus.trigger("subtitlesFailed"),s()}),i.addEventListener("change",()=>{if(s(),i.isOn){let t=e.currentTime;i.render(t)}}),i.addEventListener("connectionsetchange",()=>{s(),t.clearThings()})}(this,t,e),this.clearThings=()=>{if(e.clear(),this._track)for(;this._track.cues.length;)this._track.removeCue(this._track.cues[0]);this._track=null,this._times=null}}}function Ge(t,e){e.sizeChanged();let i=t.toucanPlayer.currentTime;e.render(i)}class $e{constructor(t){this.dirty=!1,this.toucanPlayer=t;let e=t._eventBus;this._subtitles=!1,this._isFullscreen=!1,this._videoX=0,this._videoY=0,this._videoHeight=0,this._videoWidth=0,this._breakpoint=null,this._isPortrait=!1,this._controlsTop=0,this._controlsLeft=0,this._controlsHeight=0,this._controlsWidth=0,this._seekBarLeft=0,this._seekBarRight=0,this._markersBarVisible=!1,this._subtitlesEnabled=t._uiConfig.subtitles.defaultOn,e.bind("subtitlesAvailability",t=>{const e=this.subtitles;this.subtitles=t.enabled&&t.available,this.subtitlesEnabled=t.enabled,e!=this.subtitles&&this.toucanPlayer._eventBus.triggerEvent(new X("subtitles",{active:this.subtitles}))}),e.bind("controlsUpdated",t=>{Ye(this),this.controlBarVisible=t.controlBarVisible,this.seekBarVisible=t.seekBarVisible}),e.bind("markersUpdated",t=>{this.markersBarVisible=t.markersBarVisible}),e.bind("uiConfigUpdated",()=>{this.toucanPlayer._uiConfig.subtitles.defaultOn&&(this.subtitlesEnabled=!0)}),e.bind("breakpointchange",t=>{this.breakpoint=t.breakpoint,this.isPortrait=t.isPortrait}),e.bind("fullscreenEnter",()=>{window.requestAnimationFrame(Ke.bind(this))}),e.bind("fullscreenExit",()=>{window.requestAnimationFrame(Ke.bind(this))});var i=this;function s(){let t=i.toucanPlayer.playbackController.playbacks.standard.videoHeight,e=i.toucanPlayer.playbackController.playbacks.standard.videoWidth;if(i.containerHeight=i.toucanPlayer.playbackController.playbacks.standard.containerHeight,i.containerWidth=i.toucanPlayer.playbackController.playbacks.standard.containerWidth,0!==t){e/t<i.containerWidth/i.containerHeight?(i.videoWidth=e*i.containerHeight/t,i.videoHeight=i.containerHeight,i.videoX=(i.containerWidth-i.videoWidth)/2,i.videoY=0):(i.videoWidth=i.containerWidth,i.videoHeight=t*i.containerWidth/e,i.videoX=0,i.videoY=(i.containerHeight-i.videoHeight)/2)}}e.bind("fixSize",()=>{Ye(this),s()}),e.bind("resize",s)}markDirty(){this.___dirty||(this.___dirty=!0,window.requestAnimationFrame(Qe.bind(this)))}get uiObject(){var t={};return t.subtitles=this.subtitles,t.subtitlesEnabled=this.subtitlesEnabled,t.controlBarVisible=this.controlBarVisible,t.seekBarVisible=this.seekBarVisible,t.markersBarVisible=this.markersBarVisible,t.controlsTop=this.controlsTop,t.controlsLeft=this.controlsLeft,t.controlsHeight=this.controlsHeight,t.controlsWidth=this.controlsWidth,t.seekBarLeft=this.seekBarLeft,t.seekBarRight=this.seekBarRight,t.seekBarTop=this.seekBarTop,t.seekBarBottom=this.seekBarBottom,t.isFullscreen=this.isFullscreen,t.breakpoint=this.breakpoint,t.isPortrait=this.isPortrait,t.videoX=this.videoX,t.videoY=this.videoY,t.videoHeight=this.videoHeight,t.videoWidth=this.videoWidth,t.height=this.containerHeight,t.width=this.containerWidth,t}get subtitles(){return this._subtitles}set subtitles(t){this._subtitles!=t&&(this._subtitles=t,this.markDirty())}get subtitlesEnabled(){return this._subtitlesEnabled}set subtitlesEnabled(t){this._subtitlesEnabled!=t&&(this._subtitlesEnabled=t,this.markDirty())}get isFullscreen(){return this._isFullscreen}set isFullscreen(t){this._isFullscreen!=t&&(this._isFullscreen=t,this.markDirty())}get controlBarVisible(){return this._controlBarVisible}set controlBarVisible(t){this._controlBarVisible!=t&&(this._controlBarVisible=t,this.markDirty())}get seekBarVisible(){return this._seekBarVisible}set seekBarVisible(t){this._seekBarVisible!=t&&(this._seekBarVisible=t,this.markDirty())}get markersBarVisible(){return this._markersBarVisible}set markersBarVisible(t){this._markersBarVisible!=t&&(this._markersBarVisible=t,this.markDirty())}get controlsTop(){return this._controlsTop}set controlsTop(t){this._controlsTop!=t&&(this._controlsTop=t,this.markDirty())}get controlsLeft(){return this._controlsLeft}set controlsLeft(t){this._controlsLeft!=t&&(this._controlsLeft=t,this.markDirty())}get controlsHeight(){return this._controlsHeight}set controlsHeight(t){this._controlsHeight!=t&&(this._controlsHeight=t,this.markDirty())}get controlsWidth(){return this._controlsWidth}set controlsWidth(t){this._controlsWidth!=t&&(this._controlsWidth=t,this.markDirty())}get seekBarLeft(){return this._seekBarLeft}set seekBarLeft(t){this._seekBarLeft!=t&&(this._seekBarLeft=t,this.markDirty())}get seekBarRight(){return this._seekBarRight}set seekBarRight(t){this._seekBarRight!=t&&(this._seekBarRight=t,this.markDirty())}get videoX(){return this._videoX}set videoX(t){this._videoX!=t&&(this._videoX=t,this.markDirty())}get videoY(){return this._videoY}set videoY(t){this._videoY!=t&&(this._videoY=t,this.markDirty())}get videoHeight(){return this._videoHeight}set videoHeight(t){this._videoHeight!=t&&(this._videoHeight=t,this.markDirty())}get videoWidth(){return this._videoWidth}set videoWidth(t){this._videoWidth!=t&&(this._videoWidth=t,this.markDirty())}get breakpoint(){return this._breakpoint}set breakpoint(t){this._breakpoint!=t&&(this._breakpoint=t,this.markDirty())}get isPortrait(){return this._isPortrait}set isPortrait(t){this._isPortrait!=t&&(this._isPortrait=t,this.markDirty())}}function Ke(){this.isFullscreen=this.toucanPlayer.isFullscreen}function Qe(){if(this.___dirty=!1,this.toucanPlayer.shouldSendUIInfoEvents){var t=new K(this.uiObject);this.toucanPlayer._eventBus.trigger("uiinfo",t)}}function Ye(t){let e=t.toucanPlayer.getControlsPositioning();t.seekBarTop=e.seekBarTop,t.seekBarBottom=e.seekBarBottom,t.seekBarLeft=e.seekBarLeft,t.seekBarRight=e.seekBarRight,t.controlsTop=e.controlsTop,t.controlsLeft=e.controlsLeft,t.controlsHeight=e.controlsHeight,t.controlsWidth=e.controlsWidth}var Je=".fadedOut{opacity:0;transition:opacity .25s cubic-bezier(.2,0,.3,1)}.fadedOut.fadeOutFast{transition:none}.fadedIn{opacity:1;transition:opacity .5s cubic-bezier(0,.81,.23,1)}:host(:not(.smp_B4)) smp-volume-controller{--smp-volume-button-transform:scale(0.85)}:host(:not(.smp_B4)) .fadedIn smp-volume-controller{--smp-volume-button-transition:transform 0.5s cubic-bezier(0.2,0.0,0.0,1.0);--smp-volume-button-transform:scale(1)}:host(:not(.smp_B4)) .fadedOut smp-volume-controller{--smp-volume-button-transition:transform 0.25s cubic-bezier(0.79,0.09,0.48,0.96)}:host(smp-plugin){display:block;height:100%;width:100%}";const Xe="position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden;";function Ze(){console.log("NOT IMPLEMENTED YET")}class ti{constructor(t,e){if(this._toucanPlayer=t,this._eventBus=new U,this._regions=[],this._regionFunctions=[],e){let t=document.createElement("div");t.style.cssText=Xe,e.appendChild(t),this.container=t}this._toucanPlayer._eventBus.registerForPublic(t=>{this._eventBus.trigger(t.type,t)})}get language(){return E}get datastore(){return this._toucanPlayer._datastore}get settings(){return this._toucanPlayer.settings}set settings(t){this._toucanPlayer.settings=t}get volume(){return this._toucanPlayer.volume}set volume(t){this._toucanPlayer.volume=t}get muted(){return this._toucanPlayer.muted}set muted(t){this._toucanPlayer.muted=t}get listenerObject(){return{}}set listenerObject(t){if(t)for(let e of Object.keys(t))this.addEventListener(e,t[e])}play(){this._toucanPlayer.play()}pause(){this._toucanPlayer.pause()}get paused(){return this._toucanPlayer.playbackController.paused}get currentTime(){return this._toucanPlayer.playbackController.currentTime}set currentTime(t){this._toucanPlayer.playbackController.currentTime=t}get audioTrack(){return this._toucanPlayer.audioTrack}set audioTrack(t){this._toucanPlayer.audioTrack=t}get audioTracks(){return this._toucanPlayer.audioTracks}get currentItem(){return this._toucanPlayer.mediaItem}get duration(){return this._toucanPlayer.playbackController.duration}get hasGuidancePassed(){return this._toucanPlayer.hasGuidancePassed}get canShowControls(){return Ze()}get inError(){return"error"==this._toucanPlayer._layoutChooser.currentState}get hasPrevious(){return Ze()}get hasNext(){return Ze()}get isFromIdent(){return!!this._toucanPlayer.mediaItem&&this._toucanPlayer.mediaItem.isIdent}get pluginManagerFailedArray(){return Ze(),[]}addEventListener(t,e){this._eventBus.bind(t,e)}removeEventListener(t,e){this._eventBus.unbind(t,e)}stop(){this._toucanPlayer.preplay()}get playlist(){return this._toucanPlayer.playlist}loadPlaylist(t,e){t.queueCurrentPlaylist&&this._toucanPlayer.readyCurrentPlaylistForQueuing(),this._toucanPlayer.resetForPlaylist(),e&&(this._toucanPlayer.settings=e),this._toucanPlayer.playlist=t}suspend(){this._toucanPlayer.pause()}showSubtitles(t){t?this._toucanPlayer._eventBus.trigger("turnSubtitlesOn"):this._toucanPlayer._eventBus.trigger("turnSubtitlesOff")}dispatchEvent(t){if(t){const e=new V(t);this._toucanPlayer._eventBus.trigger(e.type,e,!0)}}updateUiConfig(t){this._toucanPlayer.uiSettings=t}get uiSettings(){return this._toucanPlayer.uiSettings}get uiInfo(){return this._toucanPlayer._uiinfo.uiObject}setData(t){this._toucanPlayer.setData(t)}setPreviousPlaylist(t){try{t=JSON.parse(JSON.stringify(t))}catch(t){}this._toucanPlayer.previousItem=t}queuePlaylist(t){try{t=JSON.parse(JSON.stringify(t))}catch(t){}this._toucanPlayer.queuedItem=t}previous(){this._toucanPlayer.previous()}next(t){this._toucanPlayer.next(t)}trackAction(t,e,i){return this._toucanPlayer._echoReporter.trackAction(t,e,i)}log(e){t}toggleFullscreen(){this._toucanPlayer.toggleFullscreen()}addContextMenuItem(t,e,i){this._toucanPlayer._debugAdapter._debugMenu.addPluginItem(t,e,i)}updateContextMenuItem(t,e){this._toucanPlayer._debugAdapter._debugMenu.updatePluginItem(t,e)}focusPlayPauseButton(){this._toucanPlayer._eventBus.trigger("focusOnPlayPause")}requestBackgroundContainer(){return this._backgroundElement||(this._backgroundElement=document.createElement("smp-plugin-background"),this._toucanPlayer.shadowRoot.insertBefore(this._backgroundElement,this._toucanPlayer.inPagePlayback)),this._backgroundElement.element}setPoster(t){t&&t.effect&&console.warn("poster effects not implemented in Toucan"),t&&t.url&&this._toucanPlayer.playlist&&(this._toucanPlayer.playlist.holdingImageURL=t.url,this._eventBus.trigger("updatePoster"))}addRegion(t){const e={rect:t,domRectFn:()=>t};this._regions.push(e),this.addRegionFunction(e.domRectFn)}removeRegion(t){for(let e=0;e<this._regions.length;e++)if(this._regions[e].rect===t){this.removeRegionFunction(this._regions[e].domRectFn),this._regions.splice(e,1);break}}addRegionFunction(t){this._regionFunctions.push(t),this._toucanPlayer.subtitles.addFixedElement(t),this._toucanPlayer.subtitles.render(this._toucanPlayer.currentTime)}removeRegionFunction(t){const e=this._regionFunctions.indexOf(t);e>0&&this._regionFunctions.splice(e,1),this._toucanPlayer.subtitles.removeFixedElement(t),this._toucanPlayer.subtitles.render(this._toucanPlayer.currentTime)}removeAllRegions(){for(;this._regionFunctions.length;)this._toucanPlayer.subtitles.removeFixedElement(this._regionFunctions.pop());for(;this._regions.length;)this._regions.pop();this._toucanPlayer.subtitles.render(this._toucanPlayer.currentTime)}getSubtitleCustomisationSettings(){return this._toucanPlayer.subtitles.customisationSettings}setSubtitleCustomisationSettings(t){if(this._toucanPlayer.subtitles.customisationSettings=t,this._toucanPlayer.subtitles.render(this._toucanPlayer.currentTime),t.textSize){let e="";for(const i of Se)if(t.textSize===i.value){e=i.shortName;break}const i={newSize:e,value:t.textSize};this._toucanPlayer._eventBus.trigger("externalSubtitleSizeChange",i)}const e=new CustomEvent("subtitleCustomisationConfigChange",{detail:this.getSubtitleCustomisationSettings()});this._toucanPlayer._eventBus.trigger("subtitleCustomisationConfigChange",e)}enableSubtitleCustomisation(){this._toucanPlayer.subtitles.enableCustomisation=!0;const t=new CustomEvent("subtitleCustomisationEnabled",{detail:this.getSubtitleCustomisationSettings()});this._toucanPlayer._eventBus.trigger("subtitleCustomisationEnabled",t)}async getSubtitleRenderer(t){const e=this._toucanPlayer.subtitles,i=await e.getImscWrapper(),s=await i.fromXML(t,e._errorHandler,null,e.compatibility);return{render:async function(t,n,o,a){Oe(o);const r=Ne(o),l=i.generateISD(s,n,a);if(i.renderHTML(l,t,null,e.uiinfo.videoHeight,e.uiinfo.videoWidth,null,a,null,!1,r),o){const e=Re(o);e&&e(t)}}}}captureIntent(){return this._toucanPlayer.playbackController.captureIntent()}_registerForCssHelpers(t){this.registerAsPluginControl(t)}registerAsPluginControl(t){const e=this._toucanPlayer;t&&(t.forEach?t.forEach(t=>{e.registerControl(t)}):e.registerControl(t))}requestVideoElement(t){if(t)return this._toucanPlayer.videoElement;Ze()}requestAudioElement(){Ze()}releaseVideoElement(){Ze()}releaseAudioElement(){Ze()}readyPlaylist(){Ze()}loadPlaylistFromCollection(){Ze()}preloadFromCollection(){Ze()}pauseAt(){Ze()}}class ei extends le{create(){super.create();let t=document.createElement("div");t.style.cssText=Xe,this.shadowRoot.appendChild(t),this.element=t}}customElements.get("smp-plugin-background")||customElements.define("smp-plugin-background",ei);class ii{constructor(){this.plugins=new Map}getUtils(t){if(this.plugins.has(t))return this.plugins.get(t).utils;var e=this;let i={},s={};return s.playerInterface=new ti(t.toucanPlayer,t.shadowRoot),s.register=function(e){i.name=e.name,t.register(e)},s.getPluginList=function(){return Array.from(e.plugins.values())},s.relativeUrl=function(e){if(!e.indexOf)return e;if(0!==e.indexOf("http:")&&0!==e.indexOf("https:")){var i=t.url;return-1!=i.indexOf("?")&&(i=i.substring(0,i.indexOf("?"))),i.substring(0,i.lastIndexOf("/"))+"/"+e}return e},s.loadCSS=function(e,i){if(e){var n=s.relativeUrl(e),o=document.createElement("link");o.type="text/css",o.rel="stylesheet",o.href=n,o.addEventListener("load",function(){s.playerInterface._eventBus.trigger("cssLoaded",{type:"cssLoaded",path:e,url:n,id:i})}),o.addEventListener("error",function(){s.playerInterface._eventBus.trigger("cssLoadFailed",{type:"cssLoadFailed",path:e,url:n,id:i})}),t.shadowRoot.appendChild(o)}},i.utils=s,this.plugins.set(t,i),s}setPluginObject(t,e){this.plugins.has(t)&&(this.plugins.get(t).plugin=e)}}class si extends le{constructor(){super({stylesheet:Je})}set toucanPlayer(t){this._toucanPlayer=t,t._pluginUtils||(t._pluginUtils=new ii)}get toucanPlayer(){return this._toucanPlayer}get name(){return this._name||""}get pluginObject(){return this._pluginObject}register(t){this._name=t.name,this._toucanPlayer._eventBus.trigger("pluginRegister",this)}loadPlugin(e,i,s){this.url=e;let n=this._toucanPlayer._eventBus,o=this._toucanPlayer._echoReporter,a=this,r=function(t,i){const s=t.detail;i.extra=""+e,t.response&&(i.extra+="_"+s.response.status),n.trigger("error",i);let r="pluginLoadFailed",l="plugin_load_failed";i.code==P.PLUGIN_INITIALISE_FAIL.code&&(r="pluginInitialisationFailed",l="plugin_initialisation_failed"),o.trackAction("plugin_manager",l,{plugin_url:e,is_background:!0}),n.trigger(r,{url:e}),a.dispatchEvent(new CustomEvent("done"))};if(i){let i=this._toucanPlayer;try{require([e],function(){try{let t=i._pluginUtils.getUtils(a);a._pluginObject=runPlugin(t,s),i._pluginUtils.setPluginObject(a,a._pluginObject),a._pluginObject.pluginInitialisation(t),o.trackAction("plugin_manager","plugin_loaded",{plugin_url:e,is_background:!0}),n.trigger("pluginLoaded",{url:e,name:a.name}),a.dispatchEvent(new CustomEvent("done"))}catch(e){t,r(e,P.PLUGIN_INITIALISE_FAIL)}},function(t){r(t,P.PLUGIN_LOAD_FAIL)})}catch(e){t,r(e,P.PLUGIN_LOAD_FAIL)}return}import(e).then(t=>{let i=this._toucanPlayer._pluginUtils.getUtils(this);try{this._pluginObject=t.runPlugin(i,s),this._toucanPlayer._pluginUtils.setPluginObject(this,this._pluginObject),this._pluginObject.pluginInitialisation(i),o.trackAction("plugin_manager","plugin_loaded",{plugin_url:e,is_background:!0}),n.trigger("pluginLoaded",{url:e,name:t.name}),this.dispatchEvent(new CustomEvent("done"))}catch(t){r(t,P.PLUGIN_INITIALISE_FAIL)}}).catch(t=>{r(t,P.PLUGIN_LOAD_FAIL)})}triggerEvent(t,e){const i=this._toucanPlayer._pluginUtils.getUtils(this);i&&i.playerInterface._eventBus.trigger(t,e)}}customElements.get("smp-plugin")||customElements.define("smp-plugin",si);class ni extends HTMLElement{constructor(t){super();const e=this.attachShadow({mode:"open"});this._shadow=e;const i=document.createElement("style");i.setAttribute("type","text/css"),i.textContent=".debugMenuContainer{background-color:#fff;border:1px solid #333;border-radius:3px;color:#000;font-size:1rem;margin:0;max-width:350px;padding:0;position:absolute;z-index:200}.debugMenuContainer ul{list-style-type:none;margin:5px;padding-inline-start:5px;white-space:nowrap}.debugMenuContainer ul li{cursor:pointer;font-size:.75rem;line-height:22px;overflow:hidden;text-overflow:ellipsis}.debugSpanHoverable:hover{background:#333;color:#fff}:host{display:none;position:absolute}",e.appendChild(i);const s=document.createElement("div");this.debugMenuDiv=s,s.classList.add("debugMenuContainer");const n=document.createElement("ul");n.title="Debug Menu",this.list=n,s.appendChild(n),e.appendChild(s),this.debugMenuDiv=s,this._toucanPlayer=t,this.style.display="none",this.pluginItems=new Map}update(){if("none"==this.style.display)return;let t=this._toucanPlayer;this.list.innerHTML="";const e=t._statsProvider.playback,i="audio"===t._statsProvider.contentType;let s;if(t._statsProvider.mediaItem?s=t._statsProvider.mediaItem.vpid:t.playlist&&t.playlist.firstItem&&(s=t.playlist.firstItem.identifier),s||(s="No VPID available"),this.addMenuLineItem(this.list,[t.version],ai.bind(null,t)),e){const n=Math.round(e.downloadBitrate),o=[n>0?n+"kbps":"unknown bitrate",e.transferFormat,e.supplier];let a;if(i)a=[s];else{const e=t._statsProvider.playback.videoWidth,i=t._statsProvider.playback.videoHeight;a=[s,e+" x "+i]}const r=function(){console.log(a.concat(o).join("\n"))};this.addMenuLineItem(this.list,o,r),this.addMenuLineItem(this.list,a,r),e.transferFormat}else this.addMenuLineItem(this.list,[s]);this.mostRecentError&&(this.addErrorLineItem(this.mostRecentError,!1,oi.bind(null,this.mostRecentError)),this.mostRecentError.parent&&this.addErrorLineItem(this.mostRecentError.parent,!0,oi.bind(null,this.mostRecentError)));for(const[t,e]of this.pluginItems.entries())e.hidden||this.addMenuLineItem(this.list,[e.text],e.callback)}copyToClipboard(t){var e=t.target.textContent;if(navigator.clipboard){navigator.clipboard.writeText(e).catch(function(){console.log(e+" - Unable to copy to clipboard")})}else console.log(e+" - Unable to copy to clipboard")}setError(t){this.mostRecentError=t}addMenuLineItem(t,e,i){const s=document.createElement("li"),n=e.map(t=>{const e=document.createElement("span");return e.classList.add("debugSpan"),e.textContent=t,e});for(let t=0;t<n.length;t++)if(s.appendChild(n[t]),t!=n.length-1){let t=document.createElement("span");t.textContent=" | ",s.appendChild(t)}i&&(s.classList.add("debugSpanHoverable"),s.addEventListener("pointerdown",i)),t.appendChild(s)}addErrorLineItem(t,e,i){const s=["Error: "+t.code];e&&(s[0]=">> "+s[0]),t.extra&&("object"==typeof t.extra?s.push(JSON.stringify(t.extra)):s.push(t.extra)),this.addMenuLineItem(this.list,s,i)}addPluginItem(t,e,i){this.pluginItems.has(t)?this.updatePluginItem(t,e):(this.pluginItems.set(t,{text:e,callback:i}),this.update())}updatePluginItem(t,e){this.pluginItems.has(t)&&(this.pluginItems.get(t).text=e,this.pluginItems.get(t).hidden=!1,this.update())}hidePluginItem(t){this.pluginItems.has(t)&&(this.pluginItems.get(t).hidden=!0,this.update())}}function oi(t){let e="Error code : "+t.code+"\nSeverity : "+t.severity+"\nDescription : "+t.description;t.extra&&("object"==typeof t.extra?e+="\n"+JSON.stringify(t.extra):e+="\n"+t.extra),console.log(e,t)}function ai(t){console.log(t.version),console.log(t._statsProvider.mediaItem),console.log(t.playlist),console.log(t.settings),console.log(t.uiSettings),console.log(navigator.userAgent)}customElements.get("smp-debug-menu")||customElements.define("smp-debug-menu",ni);class ri{constructor(t){this._toucanPlayer=t;const e=new ni(t);t.shadowRoot.appendChild(e),this._debugMenu=e,t.addEventListener("touchstart",t=>{t.targetTouches.length>2&&ui(this,t)},{passive:!0}),t.addEventListener("contextmenu",ui.bind(null,this)),t._eventBus.bind("loadedmetadata",()=>{this._debugMenu.update()}),t._eventBus.bind("error",t=>{this._debugMenu.setError(t),this._debugMenu.update()}),t._eventBus.bind("playlistLoaded",e=>{e.embedRight&&t._uiConfig.embed.enabled&&t.settings.externalEmbedUrl?this._debugMenu.addPluginItem("embedItem",E.toolTipEmbed,()=>{t.pause(),t.exitFullscreen(),t._eventBus.trigger("embed",{type:"embed"}),t._echoReporter.trackAction("embed","click")}):this._debugMenu.hidePluginItem("embedItem"),this._debugMenu.update()})}}function li(t,e){const i=t._toucanPlayer,s=t._debugMenu;"keydown"===e.type&&"Escape"!==e.key||(document.documentElement.removeEventListener("keydown",t._hideFn),i.removeEventListener("click",t._hideFn),i.removeEventListener("touchstart",t._hideFn),s.style.display="none")}function ui(t,e){const i=t._toucanPlayer,s=t._debugMenu;if("block"==s.style.display)return void(s.style.display="none");let n,o;"contextmenu"===e.type?(n=e.offsetX,o=e.offsetY):"touchstart"===e.type?(n=e.touches[0].clientX,o=e.touches[0].clientY):(n=10,o=10),e.preventDefault(),s.style.display="block",s.style.top=o+"px",s.style.left=n+"px",s.update(),t._hideFn=li.bind(null,t),document.documentElement.addEventListener("keydown",t._hideFn),i.addEventListener("click",t._hideFn),i.addEventListener("touchstart",t._hideFn)}const ci=32,di=13,hi=[320,384,432,480,512,608,640,688,720,768,800,832,976,1024,1376,1920],pi=[180,216,243,270,288,342,360,387,405,432,450,468,549,576,774,1080];function mi(t){return t.shortcut?"shortcut_key_press_"+t.key:0===t.clientX&&0===t.clientY?"key_press":"click"}function gi(t,e,i){return i=i||{},function(s){const n=mi(s);"pointerup"==s.type&&"mouse"==s.pointerType||e&&e.isDisabled||s.button&&0!==s.button||(i.allowPropagation||s.stopPropagation(),i.allowDefault||s.preventDefault(),t(s,n,e))}}function bi(t,e,i,s){for(let n=0;n<e.length;n++)t.addEventListener(e[n],i,s)}function fi(t,e,i){i=!!i,t.addEventListener("pointermove",function(t){"mouse"==t.pointerType&&e(t)},i)}function yi(t,e,i){i=!!i,t.addEventListener("pointerleave",function(t){"mouse"==t.pointerType&&e(t)},i)}const vi={192:{l:"108",s:"192",p:"288"},224:{l:"126",s:"224",p:"336"},256:{l:"144",s:"256",p:"384"},320:{l:"180",s:"320",p:"480"},368:{l:"207",s:"368",p:"552"},416:{l:"234",s:"416",p:"624"},480:{l:"270",s:"480",p:"720"},512:{l:"288",s:"512",p:"768"},608:{l:"342",s:"608",p:"912"},640:{l:"360",s:"640",p:"960"},688:{l:"387",s:"688"},720:{l:"405",s:"720"},768:{l:"432",s:"768"},800:{l:"450",s:"800"},832:{l:"468",s:"832"},976:{l:"549",s:"976"},1376:{s:"1376",l:"774"},1920:{l:"1080",s:"1920"}},_i=["192","320","416","512","640"];function ki(t,e,i,s,n){let o,a,r;if(s&&s.url&&"string"==typeof s.orientation)return function(t,e,i,s){let n=i.orientation.charAt(0),o=i.url;if("p"!=n&&"s"!=n&&(n="l"),t&&isNaN(s)&&(s=4),!isNaN(s)){let t=_i[s],e="p"==n?"n":vi[t][n];return o.replace(/[\${]recipe}?/,t+"x"+e)+".webp"}const a=window.devicePixelRatio,r=Math.max(window.innerWidth,window.innerHeight)*a;let l=[];return Object.keys(vi).filter(t=>Number(t)<=r).forEach(t=>{let e="p"==n?"n":vi[t][n];l.push(o.replace(/[\${]recipe}?/,t+"x"+e)+".webp "+t+"w")}),l.toString()}(e,0,s,n);if(!t||"string"!=typeof t)return"";r=i&&"string"==typeof i?i.split(","):null;const l=r||hi;if(!e&&isNaN(n)){const e=window.devicePixelRatio,i=Math.max(window.innerWidth,window.innerHeight)*e;let s=[],n=!1;for(let e=0;e<l.length;e++){let o=hi[e]+"x"+pi[e];if(a=r||l[e]<=1024?l[e]:1536,n)break;n=l[e]>i,s.push(t.replace(/[\${]recipe}?/,o).replace(/[\${]width}?/,a)+" "+(a||hi[e])+"w")}o=s.toString()}else if(isNaN(n)&&e){const e=hi[0]+"x"+pi[0];a=l[0],o=t.replace(/[\${]recipe}?/,e).replace(/[\${]width}?/,a)}else if(!isNaN(n)){n=Number(n);const e=hi[n]+"x"+pi[n];a=l[n],o=t.replace(/[\${]recipe}?/,e).replace(/[\${]width}?/,a)}return o}function wi(t,e,i){let s,n,o={};if(t)for(s of Object.keys(e))void 0!==e[s]&&(n=e[s],s in t&&(t[s]===n||s in o&&o[s]===n)||("object"==typeof t[s]&&null!==t[s]?t[s]=wi(t[s],n,i):t[s]=i(n)));return t}function Ti(t){if(!t||"object"!=typeof t)return t;let e,i,s;if(t instanceof Array)for(e=[],i=0,s=t.length;i<s;++i)i in t&&e.push(Ti(t[i]));else e={};return wi(e,t,Ti)}function Ei(){let t=Ti(arguments[0]);if(t)for(let e=1;e<arguments.length;e++)arguments[e]&&(t=wi(t,arguments[e],Ti));return t}function Ci(t){const e=function(t,e){let i,s,n,o;return"#"==t.charAt(0)&&(t=t.substring(1)),3==t.length?(i=t.substring(0,1)+t.substring(0,1),s=t.substring(1,2)+t.substring(1,2),n=t.substring(2,3)+t.substring(2,3),o=t.substring(3,4)+t.substring(3,4)):(i=t.substring(0,2),s=t.substring(2,4),n=t.substring(4,6),o=t.substring(6,8)),i=parseInt(i,16),s=parseInt(s,16),n=parseInt(n,16),isNaN(e)?(o=(parseInt(o,16)/255).toFixed(2),"NaN"==o&&(o="1")):o=e,"rgba("+i+","+s+","+n+","+o+")"}(t).split(/[,\(\)]+/);return 1-(.299*e[1]+.587*e[2]+.114*e[3])/255<.3}function Si(t){t=encodeURIComponent(t);const e=new RegExp(t+"=([^;\\s]*)","i").exec(document.cookie);return e?decodeURIComponent(e[1]):null}function Bi(t,e,i){if(!function(t){let e=!1,i=!1;0===t.indexOf("ckps_")?e=!0:0===t.indexOf("ckpf_")&&(i=!0);const s=document.cookie.match(/ckns_policy=([0,1])([0,1])([0,1])/i);return!!(s&&"1"===s[2]&&e||s&&"1"===s[3]&&i)}(t)&&!i)return;const s=new Date;s.setTime(s.getTime()+15552e6*(i?-1:1)),i||(s.setDate(15),s.setHours(12),s.setMinutes(0),s.setSeconds(0));const n=s.toUTCString();let o=location.hostname;-1!==o.indexOf(".bbc.co.uk")&&(o=".bbc.co.uk"),-1!==o.indexOf(".bbc.com")&&(o=".bbc.com");try{document.cookie=encodeURIComponent(t)+"="+encodeURIComponent(e)+"; expires="+n+"; domain="+o+"; path=/"}catch(t){}}function xi(e){const i=Si("ckps_smpSettings");if(i)try{e=Ei(JSON.parse(i),e)}catch(e){t}Bi("ckps_smpSettings",JSON.stringify(e))}function Pi(t,e){let i=e.colour,s=e.foreColour,n=e.baseColour,o=Ci(s)?s:"#FFFFFF",a="#FFFFFF",r="#000000",l="#000000",u="#3A3C3E",c="#B0B2B4",d="#FFFFFF",h="#FFFFFF",p="#545658",m=e.skinMode;if("audio"==e.skin){void 0===m&&void 0===n?m="dark":void 0===m&&(m=Ci(n)?"dark":"light");const t="light"===m?"#141414":"#FFFFFF";n=n||t,a=Ci(i)?"#141414":"#FFFFFF",r=Ci(n)?"#141414":"#FFFFFF",p="light"===m?"#E6E8EA":"#545658",d=n,h=t}else n=n||"#FFFFFF",e.cssColour&&e.cssForeColour&&(s=Ai(e.cssForeColour,s),i=Ai(e.cssColour,i),e.cssBaseColour&&(n=Ai(e.cssBaseColour,n)));let g="";e.livePulseColour&&(g=e.livePulseColour),window.matchMedia("(forced-colors : active)").matches&&(u="ButtonFace",c="ButtonText",d="ButtonText",h="CanvasText",p="Highlight",n="ButtonText",r="Highlight",l="Highlight",g="ButtonText","audio"!==e.skin?(i="Highlight",s="HighlightText",o="ActiveText",a="HighlightText"):(i="CanvasText",s="HighlightText",o="HighlighText",a="HighlightText")),t.style.setProperty("--smp-colour-on-base-colour",r),t.style.setProperty("--smp-controls-text-colour",n),t.style.setProperty("--smp-live-pulse-colour",g),t.style.setProperty("--smp-controls-fill",n),t.style.setProperty("--smp-colour-on-highlight-colour",a),t.style.setProperty("--smp-colour-toggle-focus-visible",i),t.style.setProperty("--smp-colour",i),t.style.setProperty("--smp-base-colour",n),t.style.setProperty("--smp-colour-toggle-border","solid "+i),t.style.setProperty("--smp-toggle-slider-button-background-color",s),t.style.setProperty("--smp-toggle-slider-button-background-color-off",l),t.style.setProperty("--smp-setting-overlay-line-indicator",d),t.style.setProperty("--smp-overlay-panels-controls-fill",h),t.style.setProperty("--smp-fore-colour-hover",o),t.style.setProperty("--smp-fore-colour-tab",s),t.style.setProperty("--smp-cta-fore-colour-hover",s),t.style.setProperty("--smp-cta-fore-colour-tab",s),t.style.setProperty("--smp-subtitles-size-button-tab-colour",s),t.style.setProperty("--smp-seek-bar-unavailable-colour",u),t.style.setProperty("--smp-seek-bar-available-colour",c),t.style.setProperty("--smp-setting-overlay-outline",p),t.style.setProperty("--smp-setting-overlay-outline-hover",p),"audio"!==e.skin?t.classList.remove("audio"):t.classList.add("audio")}function Li(t,e,i){if(t&&t instanceof Array)for(const s of t)s&&s instanceof HTMLElement&&(i?s.classList.remove(e):s.classList.add(e))}function Ai(t,e){return 0==(""+t).indexOf("-")?"var("+t+", "+e+")":t}function Ii(t){return!(!t.showing||t.isDisabled)&&(t.takeFocus(),!0)}function Oi(t,e){let i=Object.entries(t).filter(t=>t[1].index>=e&&t[1].button.showing).sort((t,e)=>t.index<e.index);return i.length>0&&(i[0][1].button.takeFocus(),!0)}const Ni={buffer:{enabled:!0,colour:"#0071F1",foreColour:"#ffffff",width:50,thickness:10,top:"50%",left:"50%",forceShow:!1},poster:{enabled:!0,effects:!1,availableWidths:"320,384,432,480,512,608,640,688,720,768,800,832,976,1024,1376,1920"},cta:{enabled:!0,visiblyHidden:!1,ignoreAudio:!1,backgroundColour:"#808080"},errorDialog:{enabled:!0},controls:{enabled:!0,mode:"default",always:!1,speed:!0,availableOnMediaEnded:!1,enableLiveRewind:!0,spaceControlsPlayback:!0,experimentalShortcuts:!1,hideTimes:!1,muteButtonOnly:!1,volumeSlider:!0,volumeDismissTime:2e3,timeout:3e3,timeoutTouch:5e3,includeForwardIntervalButton:!0,includeBackIntervalButton:!0,includeLiveRestartButton:!0,includeJumpToLiveButton:!0,includePreviousButton:!1,includeNextButton:!1,displayJumpButtonText:!0,slimlineB2Scrubbar:void 0},markers:{enabled:!0,suppressMarkerKinds:[],hideBelowWidth:600},transcription:{enabled:!1,on:!1},subtitles:{enabled:!0,desnakeLiveSubtitles:!0,blockDesnake:!1,reformatLiveSubtitles:!0,supportLiveSubtitles:!0,contrast:.6,defaultOn:!1,yOffset:NaN,kind:"subtitles",margins:[],useNarrative:!1},language:{audioDescription:!0},guidance:{enabled:!0,pinRequired:!1,displayContinuousGuidanceInQueuePlaylist:!1,displayGuidanceInAutoplay:!0},fullscreen:{enabled:!0,dblclick:!0,useCloseIconForExitFullscreen:!1},playQueue:{enabled:!1,on:!1},video:{transform:null,transformTransition:null,displayOnEnded:!1},embed:{enabled:!0},embedded:{enabled:!1},swipable:{enabled:!1,direction:"Y"},miniMode:{enabled:!1,backgroundColour:"#ffffff"},locale:{lang:"en",path:"/emp/translations/smp/{lang}.xml"},chromecast:{enabled:!0,shiftCentralControls:!1},thumbnail:{enabled:!0},pictureInPicture:{enabled:!0,audioEnabled:!1},useInPlayerGuidance:!0,mediaSessionAPI:{enabled:!0},colour:"#0071F1",colourOnHighlightColour:"#ffffff",accessibility:{enhanceBrightColoursContrast:!1},colourOnBaseColour:"#000000",foreColour:"#ffffff",playbackSettingsPanel:{enabled:!1,continuousPlaySetting:!1,highlightMenuColour:"#ffffff",qualitySetting:!1},skin:"classic",titleHeader:{enabled:!0},addExtraTopSpace:0,skipInterval:10};class Ri{get(t){return t.settings.noTracking?new Fi:new Di(t)}}class Fi{trackAction(){}setIntent(){}}class Di{constructor(t){this._toucanPlayer=t,this.eventBus=this._toucanPlayer._eventBus,this.hasPlayed=!1,this.isPaused=!1,function(t,e){e._eventBus.bind("waiting",()=>{t.dispatchResume=!0}),e._eventBus.bind("playbackBegin",()=>{t.isPaused=!1}),e._eventBus.bind("playing",()=>{t.isPaused=!1,t.hasPlayed?t.dispatchResume&&(t._setResume(),t.dispatchResume=!1):(t.hasPlayed=!0,t._setPlaying())}),e._eventBus.bind("ended",()=>{t.hasPlayed=!1,t.dispatchResume=!1,t._setEnded()}),e._eventBus.bind(["playlistLoaded","mediaItemChanged"],()=>{t.hasPlayed=!1,t.dispatchResume=!1}),e._eventBus.bind("pause",()=>{t.dispatchResume=!1,t.hasPlayed=!1,e.playbackController.ended||t.isPaused||t._setPaused(),t.isPaused=!0}),e._eventBus.bind("seeking",()=>{t._setSeeking()}),e._eventBus.bind("seeked",()=>{t._setSeeked()}),e._eventBus.bind(["playerDisconnected","playerDestroying"],()=>{t.dispatchResume=!1,t.hasPlayed=!1,t._setPaused()}),e._eventBus.bind("statsBuffering",()=>{t._setBuffering()}),e._eventBus.bind("error",e=>{const i={is_background:!0};e.extra&&"string"==typeof e.extra&&(i.bbc_smp_detail=e.extra),t.trackAction("error_"+e.code,"error",i)})}(this,t)}sonarEvent(t,e){this._toucanPlayer.shouldEchoReport&&this.eventBus.trigger(t,e)}setIntent(){this.sonarEvent("SonarInitiatedEvent")}_setPlaying(){this.sonarEvent("SonarPlayEvent")}_setResume(){this.sonarEvent("SonarResumeEvent")}_setPaused(){this.sonarEvent("SonarPauseEvent")}_setSeeking(){let e;try{e={before:this._toucanPlayer.mediaItem.history.last("seeking").detail.mediaTime}}catch(e){t}this.sonarEvent("SonarSeekingEvent",e)}_setSeeked(){this.sonarEvent("SonarSeekEvent")}_setBuffering(){this.sonarEvent("SonarBufferEvent")}_setEnded(){this.sonarEvent("SonarEndEvent")}trackAction(t,e,i){const s={controlId:t,actionType:e,labels:i};this.eventBus.delayedTrigger("SonarUserActionEvent",s)}}class Mi{set(t){t&&"string"==typeof t.name&&""!==t.name&&"get"!=t.name&&"set"!=t.name&&(this[t.name]=t.data)}get(t){return this[t]}}class Hi{constructor(){this.alreadySetFromBumpAPI=!1}static isSupported(){return window.navigator&&navigator.mediaSession&&navigator.mediaSession.setActionHandler}setCallbacks(t,e,i,s,n,o,a,r,l){let u=function(){};this.playCallback=t||u,this.pauseCallback=e||u,this.seekForwardCallback=i||u,this.seekBackwardCallback=s||u,this.nextTrackCallback=n||u,this.previousTrackCallback=o||u,this.backToStartCallback=a||u,this.nextJustEventsCallback=r||u,this.previousJustEventsCallback=l||u}setMetadata(t,e){const i=this;if(i.alreadySetFromBumpAPI&&!t.fromBumpAPI)return;const s=window.MediaMetadata;if(!s)return;t.fromBumpAPI&&(i.alreadySetFromBumpAPI=!0);const n=navigator.mediaSession;i.title=t.title||"",i.posterURL=t.posterImg||t.holdingImageURL||"",i.holdingImage=t.holdingImage,i.album=t.album||"",i.artist=t.artist||"";const o=""!==e&&"string"==typeof e;let a=[];if(""===i.posterURL||o){if(""!==i.posterURL&&o){const t=!!o&&e.split(",");a=ki(i.posterURL,null,e).split(",").slice(0,5);for(let t=0;t<a.length;t++)a[t]=a[t].substr(0,a[t].length-5);i.availableWidthsSizes=[];for(let e=0;e<t.length;e++)i.availableWidthsSizes.push(t[e])}}else i.posterURLxl=ki(i.posterURL,null,null,i.holdingImage,4),i.posterURLl=ki(i.posterURL,null,null,i.holdingImage,3),i.posterURLm=ki(i.posterURL,null,null,i.holdingImage,2),i.posterURLs=ki(i.posterURL,null,null,i.holdingImage,1),i.posterURLxs=ki(i.posterURL,null,null,i.holdingImage,0);const r={title:i.title,artist:i.artist,album:i.album};if(i.posterURLxl||i.posterURLl||i.posterURLm||i.posterURLs||i.posterURLxs)r.artwork=[{src:i.posterURLxl,sizes:"512x288",type:"image/jpg"},{src:i.posterURLl,sizes:"480x270",type:"image/jpg"},{src:i.posterURLm,sizes:"432x243",type:"image/jpg"},{src:i.posterURLs,sizes:"384x216",type:"image/jpg"},{src:i.posterURLxs,sizes:"320x180",type:"image/jpg"}];else if(a){r.artwork=[];for(let t=0;t<a.length;t++)r.artwork.push({src:a[t],sizes:i.availableWidthsSizes[t]+"x"+i.availableWidthsSizes[t],type:"image/jpg"})}try{n.metadata=new s(r)}catch(t){console.error("Error setting Metadata",t,r)}i.setControls()}reset(){this.alreadySetFromBumpAPI=!1}setControls(){const t=this,e=navigator.mediaSession;e.setActionHandler("seekforward",function(){t.seekForwardCallback()}),e.setActionHandler("seekbackward",function(){t.seekBackwardCallback()}),e.setActionHandler("play",function(){t.playCallback()}),e.setActionHandler("pause",function(){t.pauseCallback()})}setNextButtonControl(t,e){const i=this,s=navigator.mediaSession;t?e?s.setActionHandler("nexttrack",function(){i.nextJustEventsCallback()}):s.setActionHandler("nexttrack",function(){i.nextTrackCallback()}):s.setActionHandler("nexttrack",null)}setPrevButtonControl(t,e,i){const s=this,n=navigator.mediaSession;t?e?n.setActionHandler("previoustrack",function(){s.previousJustEventsCallback()}):i?n.setActionHandler("previoustrack",function(){s.backToStartCallback()}):n.setActionHandler("previoustrack",function(){s.previousTrackCallback()}):n.setActionHandler("previoustrack",null)}}const qi="call_to_action",zi="play",Ui="pause",Wi="enter_full_screen",Vi="exit_full_screen",ji="subtitles_on",Gi="subtitles_off",$i="back_interval_button",Ki="forward_interval_button",Qi="mute",Yi="unmute",Ji="volume_slider",Xi="seek_bar",Zi="marker",ts="play_mediaSessionApi",es="pause_mediaSessionApi",is="seekforward_mediaSessionApi",ss="seekbackward_mediaSessionApi",ns="nextTrack_mediaSessionApi",os="previoustrack_mediaSessionApi",as="exit_picture_in_picture_mode",rs="enter_picture_in_picture_mode",ls="playback_settings_continuous_play_toggle_off",us="playback_settings_continuous_play_toggle_on",cs="back_to_start_button",ds="to_live_button",hs="previous_button",ps="next_button",ms="open_playback_settings_panel",gs="close_playback_settings_panel",bs="playback_settings_low_option",fs="playback_settings_medium_option",ys="playback_settings_high_option",vs="cast_connected_player",_s="cast_connected_browser",ks="cast_disconnected_player",ws="cast_disconnected_browser",Ts="cast_button",Es="open_playback_speed_panel",Cs="close_playback_speed_panel",Ss="speed_control_0.5x",Bs="speed_control_0.8x",xs="speed_control_1x",Ps="speed_control_1.2x",Ls="speed_control_1.5x",As="speed_control_2x",Is="play_queue",Os="transcription",Ns="audio_description_on",Rs="audio_description_off";class Fs{constructor(t){const e=t._eventBus;this.mediaSessionApi=new Hi,e.bind("playlistLoaded",()=>{this.mediaSessionApi.reset();const e=t.playlist;this.mediaSessionApi.setMetadata(e,t.uiSettings.poster.availableWidths)}),e.bind("durationchange",()=>{this.skipTime=3*t.duration/100}),e.bind("setData",e=>{const i=e.data;"SMP.mediaSessionAPI"==i.name&&(i.fromBumpAPI=!0,this.mediaSessionApi.setMetadata(i,t.uiSettings.poster.availableWidths))}),e.bind(["mediaItemChanged","queueChanged","uiConfigUpdated"],()=>{if(!t.playbackController._playlistModel.playlist)return;let e=t.uiSettings.controls,i=e.includeNextButton&&(t.playbackController._playlistModel.moreRemainingOrAnotherPlaylist||e.alwaysEnableNextButton);this.mediaSessionApi.setNextButtonControl(i,e.previousNextJustEvents);let s=e.includePreviousButton&&(t.playbackController._playlistModel.previousItemsOrPlaylistAvailable||e.alwaysEnablePreviousButton);this.mediaSessionApi.setPrevButtonControl(s,e.previousNextJustEvents)}),this.setupMediaSessionApiCallbacks(t)}setupMediaSessionApiCallbacks(t){this.mediaSessionApi.setCallbacks(()=>{t.play(),t._echoReporter.trackAction(ts,"mediaSessionApi_interaction")},()=>{t.pause(),t._echoReporter.trackAction(es,"mediaSessionApi_interaction")},()=>{t.currentTime=t.currentTime+this.skipTime,t._echoReporter.trackAction(is,"mediaSessionApi_interaction")},()=>{t.currentTime=t.currentTime-this.skipTime,t._echoReporter.trackAction(ss,"mediaSessionApi_interaction")},()=>{t.next(null,null,"mediasession"),t._echoReporter.trackAction(ns,"mediaSessionApi_interaction")},()=>{t.previous(null,"mediaSession"),t._echoReporter.trackAction(os,"mediaSessionApi_interaction","previousTrack")},()=>{t.currentTime=t.earliestSeek,t._echoReporter.trackAction(os,"mediaSessionApi_interaction","backToStart")},()=>{t._eventBus.trigger("nextRequested"),t._echoReporter.trackAction(ns,"mediaSessionApi_interaction","nextTrack")},()=>{t._eventBus.trigger("previousRequested"),t._echoReporter.trackAction(os,"mediaSessionApi_interaction","previousTrack")})}static isSupported(){return Hi.isSupported()}}const Ds=["B1","B2","B3","B4"],Ms=[0,320,500,860],Hs=new WeakMap;function qs(t){document.addEventListener("keydown",e=>{if(t.shadowRoot.activeElement&&!e.altKey&&!e.ctrlKey&&!e.metaKey&&!e.shiftKey){if("error"===t._layoutChooser.currentState)return;let i,s=t._layoutChooser.layouts.playback;switch(e.code){case"Space":if(!t.uiSettings.controls.spaceControlsPlayback)return;e.preventDefault();case"KeyK":case"MediaPlayPause":i=zs(t,e.code);break;case"MediaPause":case"MediaStop":if(t.paused)return;i=zs(t,e.code);break;case"MediaPlay":if(!t.paused)return;i=zs(t,e.code);break;case"ArrowLeft":case"ArrowRight":if(t.elementHasFocusInShadowDOM([s.seekGroup.seekbar,s.volumeControl]))return;case"KeyJ":case"KeyL":let n,o;"ArrowLeft"===e.code||"KeyJ"===e.code?(n=s.coreControls.backwardIntervalButton,o=t.uiSettings.controls.includeBackIntervalButton):(n=s.coreControls.forwardIntervalButton,o=t.uiSettings.controls.includeForwardIntervalButton);if(n.isDisabled||!o||"playback"!==t._layoutChooser.currentState)return;e.preventDefault(),i=function(t,e){let i={shortcut:!0,key:e};t.animateAndTriggerActionFunc(i);let s="left"===t.direction?"Backwards":"Forwards";return E["toolTipSkipped"+s].replace("{seconds}",t.interval)}(n,e.code);break;case"MediaTrackNext":case"MediaNextTrack":return t._echoReporter.trackAction(ps,"shortcut_key_press_"+e.code),void t.next(null,null,"keyboard");case"MediaTrackPrevious":case"MediaPreviousTrack":return t._echoReporter.trackAction(hs,"shortcut_key_press_"+e.code),void t.previous(null,"keyboard");case"KeyM":if("playback"!==t._layoutChooser.currentState)return;i=function(t,e){let i=!t.muted;t.muted=i,t._echoReporter.trackAction(i?Qi:Yi,"shortcut_key_press_"+e);let s="audio"===t.mediaItem.contentType?"Audio":"Video";return E["toolTip"+s+(i?"Muted":"Unmuted")]}(t,e.code);break;case"KeyF":if(t.isAudioSkin||!t.uiSettings.fullscreen.enabled||"preplay"===t._layoutChooser.currentState)return;i=function(t,e){t.toggleFullscreen(),t._echoReporter.trackAction(t.isFullscreen?Vi:Wi,"shortcut_key_press_"+e);let i="toolTipFullscreen"+(t.isFullscreen?"Entered":"Exited");return E[i]}(t,e.code);break;case"Digit8":if(t._remoteInput=t._remoteInput?t._remoteInput+"8":"8","888"!==t._remoteInput)return;t._remoteInput="";case"KeyS":if("playback"!==t._layoutChooser.currentState||!t.subtitlesAvailable||!t.uiSettings.subtitles.enabled||t.isAudioSkin)return;i=function(t,e){let i=!t.subtitlesOn;return t.showSubtitles(i),t._echoReporter.trackAction(i?ji:Gi,"shortcut_key_press_"+e),E["toolTipSubtitlesTurned"+(i?"On":"Off")]}(t,e.code);break;default:return}return void s.keyboardShortcutAnnouncer.alert(i)}})}function zs(t,e){let i=t.paused?zi:Ui;t._eventBus.trigger("play-toggle"),t._echoReporter.trackAction(i,"shortcut_key_press_"+e);let s="audio"===t.mediaItem.contentType?"Audio":"Video",n=t.paused?"Paused":"Playing";return E["toolTip"+s+n]}let Us,Ws,Vs;class js{constructor(t){var e=this;this.videoLayout=t,t.eventBus.bind(["queueChanged","playlistLoaded"],()=>{e.queueChanged()});let i=t.uiConfig.swipable,s=i.direction;"Y"!=s&&(s="X"),this.direction=s;let n=window.matchMedia("(prefers-reduced-motion: reduce)"),o=()=>{n.matches&&i.reduceMotion||i.noMotion?(Us=Ws="transform 0s ease-out",Vs=5):(Us="transform 0.01s ease-out",Ws="transform 0.3s ease-out",Vs=400)};n.onchange=o,o();let a=t.toucanPlayer.playbackController.playbacks.standard,r=document.createElement("div");r.style.cssText="position:absolute;height:100%;width:100%;clip-path:content-box;";let l=this.dragCont2=document.createElement("div");l.style.cssText="position:absolute;height:100%;width:100%;",t.toucanPlayer.shadowRoot.insertBefore(r,a),r.appendChild(l),l.appendChild(a);let u=document.createElement("smp-holding-image");u.className="holdingImage swipe",u.displaying=!0;let c="left",d="right";"Y"==s&&(c="bottom",d="top"),u.style[c]="100%",u.style.top="unset",l.appendChild(u);let h,p=document.createElement("smp-holding-image");p.className="holdingImage swipe",p.displaying=!0,p.style[d]="100%",l.appendChild(p);let m=this.topTitle=document.createElement("smp-title-header"),g=this.bottomTitle=document.createElement("smp-title-header");t.containerDiv.appendChild(m),t.containerDiv.appendChild(g),m.style.opacity=0,g.style.opacity=0,t.holdingImage.classList.add("swipe"),l.appendChild(t.holdingImage),this.draggingContainer=l,l.style.transition="transform var(--transition-fast,0.15s) ease-out",t.style.pointerAction="none",t.style.touchAction="none";const b=e=>{l.style.transform="translate"+s+"("+-100*e+"%)";let i=Math.min(2*Math.abs(e),1);e<0?(m.style.opacity=i,g.style.opacity=0,t.titleHeader.style.opacity=1-i):e>0?(g.style.opacity=i,m.style.opacity=0,t.titleHeader.style.opacity=1-i):(m.style.opacity=0,g.style.opacity=0,t.titleHeader.style.opacity=1)};let f,y=0;this.downTime=!1;let v=!1;t.addEventListener("wheel",e=>{if(e.stopPropagation(),e.preventDefault(),this.downTime||h)return;v||(t.swipeStart(),v=!0);let i=e["delta"+s];if((i<0&&!t.toucanPlayer.playbackController._playlistModel.previousItemsOrPlaylistAvailable||i>0&&!t.toucanPlayer.playbackController._playlistModel.moreRemainingOrAnotherPlaylistAvailable)&&(i=0),y+=i,0==y)return;clearTimeout(f);let n=y/1e3;n>1&&(n=1),n<-1&&(n=-1),b(n),n>.4&&(v=!1,this.moveNext("wheel")),n<-.4&&(this.movePrevious("wheel"),v=!1),this.downTime?y=0:f=setTimeout(()=>{y=0,b(0),t.swipeEnd(),v=!1},3e3)},{passive:!1}),t.addEventListener("pointerdown",i=>{if(h)return void 0;let n=!1,o=i["client"+s],a=0,r="Y"==s?t.getBoundingClientRect().height:t.getBoundingClientRect().width;t.setPointerCapture(i.pointerId),h=i.pointerId;const u=performance.now();let c=!1;const d=e=>((e<0&&!t.toucanPlayer.playbackController._playlistModel.previousItemsOrPlaylistAvailable||e>0&&!t.toucanPlayer.playbackController._playlistModel.moreRemainingOrAnotherPlaylistAvailable)&&(e=0),e<-r?-r:e>r?r:e),p=i=>{if(i.pointerId!==h)return;c||(c=!0,e.videoLayout.swipeStart());let l=o-i["client"+s],u=d(l);!n&&u>0&&(n=!0,t.toucanPlayer.playbackController.readyNextItem()),a=u/r,b(a)},f=e=>{y(e);let i=o-e["client"+s],n=d(i);a=n/r*100;const c=performance.now()-u,h=Math.abs(n)/c,p=Math.abs(a);h>.25||p>40?(a>0?this.moveNext("swipe"):this.movePrevious("swipe"),e.stopPropagation(),e.preventDefault()):(t.swipeEnd(),l.style.transition=Us,l.style.transform="",m.style.opacity=0,g.style.opacity=0,t.titleHeader.style.opacity=1)},y=e=>{h=null,t.removeEventListener("pointermove",p),t.removeEventListener("pointerup",f,{capture:!0}),t.removeEventListener("pointercancel",y),t.releasePointerCapture(e.pointerId)};t.addEventListener("pointermove",p),t.addEventListener("pointercancel",y),t.addEventListener("pointerup",f,{capture:!0})})}moveNext(t){this.downTime=!0,setTimeout(()=>{this.downTime=!1},1700);let e=this.dragCont2;e.style.transition=Ws,e.style.transform="translate"+this.direction+"(-100%)",setTimeout(()=>{this.videoLayout.toucanPlayer.next(void 0,!0,t),this.videoLayout.swipeEnd(),e.style.transition=Us,e.style.transform="",this.topTitle.style.opacity=0,this.bottomTitle.style.opacity=0,this.videoLayout.titleHeader.style.opacity=1},Vs)}movePrevious(t){this.downTime=!0,setTimeout(()=>{this.downTime=!1},1700);let e=this.dragCont2;e.style.transition=Ws,e.style.transform="translate"+this.direction+"(100%)",setTimeout(()=>{this.videoLayout.toucanPlayer.previous(!0,t),this.videoLayout.swipeEnd(),e.style.transition=Us,e.style.transform="",this.topTitle.style.opacity=0,this.bottomTitle.style.opacity=0,this.videoLayout.titleHeader.style.opacity=1},Vs)}queueChanged(){const t=this.videoLayout,e=t.uiConfig.poster.availableWidths;if(this.draggingContainer){this.draggingContainer.style.transition="",this.draggingContainer.style.transform="",t.titleHeader.style.opacity=1;let i=this.draggingContainer.querySelectorAll("smp-holding-image"),s=i[0],n=i[1],o=this.topTitle,a=this.bottomTitle,r=this.videoLayout.toucanPlayer.playbackController._playlistModel;if(r.previousItemsOrPlaylistAvailable&&r._playlist.previous){let t=r._playlist.previous.playlist,i=t.firstFrameImageURL||t.holdingImageURL;s.setSrcset(i,null,e,t.holdingImage),$s(o,t)}else s.setSrcset("",null,e,null),$s(o,{});if(r.moreRemainingOrAnotherPlaylistAvailable&&r._playlist.queued){let t=r._playlist.queued.playlist,i=t.firstFrameImageURL||t.holdingImageURL;n.setSrcset(i,null,e,t.holdingImage),$s(a,t)}else n.setSrcset("",null,e,null),$s(a,{})}}}function Gs(...t){for(;t.length;){let e=t.shift();if(e||""===e)return e}return""}function $s(t,e){const i=Gs(e.displayTitle,e.title),s=Gs(e.displaySecondaryTitle),n=Gs(e.liveTimeInfo);t.title=i,t.secondaryTitle=s,t.liveText=n,t.style.opacity=0}class Ks extends le{create(){super.create(),this.subgroups=Array.prototype.slice.call(this.shadowRoot.querySelectorAll("[smp-context]")),this.subgroups.forEach(t=>{"function"==typeof t.setParent&&t.setParent(this)})}onRooted(){this.subgroups.forEach(t=>{"function"==typeof t.onRooted&&t.onRooted()}),this.toucanPlayer._eventBus.bind("breakpointchange",this.breakpointchange.bind(this))}setParent(t){this._parent=t}get toucanPlayer(){return this._parent.toucanPlayer}get eventBus(){return this._parent.eventBus}get layout(){return this._parent.layout}get echoReporter(){return this._parent.echoReporter}get settings(){return this._parent.settings}updateSettings(t){this.subgroups.forEach(e=>{"function"==typeof e.updateSettings&&e.updateSettings(t)})}get uiConfig(){return this._parent.uiConfig}updateUiConfig(t){this.subgroups.forEach(e=>{"function"==typeof e.updateUiConfig&&e.updateUiConfig(t)}),this.uiConfig&&("audio"!==this.uiConfig.skin?this.classList.remove("audio"):this.classList.add("audio"))}breakpointchange(t){for(const e of this.subgroups)"function"==typeof e.breakpointchange?e.breakpointchange(t):Ys(e,t);Ys(this,t)}focusChange(t){for(const e of this.subgroups)"function"==typeof e.focusChange?e.focusChange(t):Qs(e,t);Qs(this,t)}fadeChange(t,e){for(const i of this.subgroups)"function"==typeof i.fadeChange?i.fadeChange(t,e):Js(i,t,e);Js(this,t,e)}hasInteractingControls(){for(const t of this.subgroups)if("function"==typeof t.hasInteractingControls&&t.hasInteractingControls())return!0;return null!==this.shadowRoot.querySelector("[interacting]")}removeTabindex(){this.shadowRoot.querySelectorAll("[smp-tabbable]").forEach(t=>{t.removeTabindex()})}addTabindex(){this.shadowRoot.querySelectorAll("[smp-tabbable]").forEach(t=>{t.addTabindex()})}}function Qs(t,e){e?t.classList.add("show-focus"):t.classList.remove("show-focus")}function Ys(t,e){const i=e.all;for(let e=0;e<i.length;e++)t.classList.remove("smp_"+i[e]);t.classList.add("smp_"+e.breakpoint),t.breakpoint=e.breakpoint,e.isPortrait?t.classList.add("portrait"):t.classList.remove("portrait"),e.minimode?t.classList.add("minimode"):t.classList.remove("minimode"),e.tiny?t.classList.add("smp_tiny"):t.classList.remove("smp_tiny")}function Js(t,e,i){e?(t.classList.remove("fadeOutFast","fadedOut"),t.classList.add("fadedIn")):(i&&t.classList.add("fadeOutFast"),t.classList.remove("fadedIn"),t.classList.add("fadedOut","fadingOut"),setTimeout(function(){t.classList.remove("fadingOut")},260))}class Xs extends Ks{constructor(t){t.stylesheet=":host { position:absolute; width:100%; height:100%; outline:none; }"+(t.stylesheet?t.stylesheet:""),super(t),this.layoutOff(),this._toucanPlayer=t.toucanPlayer}create(){super.create(),this.onRooted();const t=this;this.eventBus.bind("playlistLoaded",e=>{t.playlistLoaded(e)}),this.___config.templateName&&(this[this.___config.templateName].classList.add("layout"),this.shouldStopTouchOnLayoutOn&&(clearTimeout(this.layoutOnNotCompletedTimeout),this[this.___config.templateName].classList.add("layoutOnNotCompleted"))),this.addEventListener("touchend",t=>{t.cancelable&&t.preventDefault()})}playlistLoaded(t){this.updatePoster(t)}layoutOff(){this.cancelOn=!0,this.style.display="none",this.setAttribute("tabIndex","-1"),this.setAttribute("aria-hidden","true"),this.shouldStopTouchOnLayoutOn&&this.___config&&this[this.___config.templateName]&&(clearTimeout(this.layoutOnNotCompletedTimeout),this[this.___config.templateName].classList.add("layoutOnNotCompleted"))}moveFocusOnAppearance(){}layoutOn(t){const e=this;this.cancelOn=!1,window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){e.cancelOn||(e.style.display="block",e.setAttribute("aria-hidden","false"),e.removeAttribute("tabIndex"),t&&e.moveFocusOnAppearance(),e.layoutOnCompleted())})})}layoutOnCompleted(){if(this.shouldStopTouchOnLayoutOn){clearTimeout(this.layoutOnNotCompletedTimeout);let t=this;this.layoutOnNotCompletedTimeout=setTimeout(function(){t[t.___config.templateName]&&t[t.___config.templateName].classList.remove("layoutOnNotCompleted")},300)}}get shouldStopTouchOnLayoutOn(){return!1}updateUiConfig(t){super.updateUiConfig(t),this.needToCreate||function(t){if(t.holdingImage){t.uiConfig.poster.enabled?t.holdingImage.displaying&&(t.holdingImage.style.display="block"):t.holdingImage.style.display="none"}}(this)}updatePoster(t){if(this.holdingImage){this.holdingImage.style.display=this.uiConfig.poster.enabled?"":"none";let e=t&&t.holdingImageURL||this.toucanPlayer.holdingImageURL;this.holdingImage.setSrcset(e,null,this.uiConfig.poster.availableWidths,t?.holdingImage)}}get toucanPlayer(){return this._toucanPlayer}get eventBus(){return this._toucanPlayer._eventBus}get layout(){return this}get echoReporter(){return this._toucanPlayer._echoReporter}get settings(){return this._toucanPlayer._config}get uiConfig(){return this._toucanPlayer._uiConfig}}class Zs extends le{static get STATE(){return{NO_DEVICES_AVAILABLE:"NO_DEVICES_AVAILABLE",NOT_CONNECTED:"NOT_CONNECTED",SELECT_DEVICE:"SELECT_DEVICE",CONNECTING:"CONNECTING",CONNECTED:"CONNECTED",DISCONNECTING:"DISCONNECTING"}}constructor(t,e){super(),this.toucanPlayer=t,this._playbackController=e,this.castState=Zs.STATE.NO_DEVICES_AVAILABLE,this.settings=t.settings;let i=this;if(window.__onGCastApiAvailable=function(t){t&&i._initializeCastApi()},!function(){let t=document.getElementsByTagName("script");for(let e=0;e<t.length;e++)if("https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1"===t[e].src)return!0;return!1}()){let t=document.createElement("script");t.async=!0,t.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",document.getElementsByTagName("head")[0].appendChild(t)}this._activeSubtitleTracks=[],this.subsAvailable=!1,this.__subsOn=!1,this.liveTimes={}}get settings(){return this._config}set settings(t){this._config=t}reset(){this.liveTimes={}}get statsProvider(){}_calculateTimes(){if(!this.isLive||!this._mediaSession)return;let t={},e=this._mediaSession.getEstimatedLiveSeekableRange(),i=this._mediaSession.customData;if(!i)return;let s=i.earliestSeek;t.earliestSeek=t.streamStart=e.start+s,t.latestSeek=t.streamEnd=e.end+s,t.duration=t.streamEnd-t.streamStart,t.currentTime=i.currentTime-i.offsetTime+this._mediaSession.getEstimatedTime(),Math.abs(t.latestSeek-t.currentTime)<10&&(t.latestSeek=t.currentTime),this.liveTimes=t}utcToMedia(t){if(t<36e4)return t;let e=this._mediaSession.customData;return e?t-e.currentTime+e.offsetTime:t}_initializeCastApi(){if(!this.toucanPlayer.settings||!chrome.cast)return;this._castContext=cast.framework.CastContext.getInstance(),this._castContext.setOptions({receiverApplicationId:tn(this.toucanPlayer.settings),autoJoinPolicy:chrome.cast.AutoJoinPolicy.PAGE_SCOPED}),this._addRemotePlayerListeners();let t=this._castContext.getCastState();this._setCastState(t),this._castContext.addEventListener(cast.framework.CastContextEventType.CAST_STATE_CHANGED,()=>{let t=this._castContext.getCastState();this._setCastState(t)}),this.toucanPlayer._eventBus.bind("chromecastDeviceSelection",()=>{this._triggerDeviceSelectionMenu()})}_addRemotePlayerListeners(){const t=this;this._remotePlayer=new cast.framework.RemotePlayer,this._remotePlayerController=new cast.framework.RemotePlayerController(this._remotePlayer),this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_CONNECTED_CHANGED,function(){t._remotePlayer.isConnected?t._connected():t._disconnected()}),this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.CURRENT_TIME_CHANGED,()=>{this._calculateTimes();const t=new CustomEvent("timeupdate");this.dispatchEvent(t)}),this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.DURATION_CHANGED,t=>{if(t.value){const t=new CustomEvent("durationchange");this.dispatchEvent(t)}});const e=()=>{const t=new CustomEvent("volumechange");this.dispatchEvent(t)};this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.IS_MUTED_CHANGED,e),this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.VOLUME_LEVEL_CHANGED,e),this._remotePlayerController.addEventListener(cast.framework.RemotePlayerEventType.PLAYER_STATE_CHANGED,t=>{switch(this._calculateTimes(),t.value){case chrome.cast.media.PlayerState.PLAYING:this._setPaused(!1);break;case chrome.cast.media.PlayerState.PAUSED:this._setPaused(!0);break;case chrome.cast.media.PlayerState.BUFFERING:const t=new CustomEvent("waiting");this.dispatchEvent(t);break;case chrome.cast.media.PlayerState.IDLE:this._currentlyPlayingItem=!1,this._setPaused(!0)}})}_connected(){const t=this;this.toucanPlayer._echoReporter.trackAction(this.playerInitiatedConnection?vs:_s),this.playerInitiatedConnection=!1,this.toucanPlayer._eventBus.castingOn();const e=new CustomEvent("chromecastConnected");this.dispatchEvent(e),this.mostRecentCastSession=this._castContext.getCurrentSession(),this.mostRecentCastSession.addMessageListener("urn:x-cast:uk.co.bbc.general",function(e,i){const s=JSON.parse(i);switch(s.type){case"subtitlesAvailable":t.subsAvailable=s.value,t.toucanPlayer._eventBus.trigger("subtitlesAvailability",{available:t.subsAvailable,enabled:t.__subsOn});break;case"subtitlesPreference":t.__subsOn=s.value,t.toucanPlayer._eventBus.trigger("subtitlesAvailability",{available:t.subsAvailable,enabled:t.__subsOn})}})}_disconnected(){this.toucanPlayer._echoReporter.trackAction(this.playerInitiatedDisconnection?ks:ws),this.playerInitiatedDisconnection=!1,this.toucanPlayer._eventBus.castingOff();let t,e=0,i=this.mostRecentCastSession.getMediaSession();if(i){if(this.isLive){let t=i.customData;t&&(e=t.currentTime-t.offsetTime+i.getEstimatedTime())}else e=i.getEstimatedTime();t=i.playerState}let s,n=this.mostRecentCastSession.getVolume(),o=this.mostRecentCastSession.isMute();t===chrome.cast.media.PlayerState.PLAYING?s="PLAYING":t===chrome.cast.media.PlayerState.PAUSED&&(s="PAUSED");let a=this.__subsOn;this.subsAvailable=!1,this.__subsOn=!1;const r=new CustomEvent("chromecastDisconnected",{detail:{lastKnownTime:e,lastKnownPlayerState:s,lastKnownVolume:n,subsOn:a,lastKnownMutedStatus:o}});this.dispatchEvent(r)}_setPaused(t){if(t){const t=new CustomEvent("pause");this.dispatchEvent(t)}else{const t=new CustomEvent("play");this.dispatchEvent(t);const e=new CustomEvent("playing");this.dispatchEvent(e)}}get _castSession(){let t;return this._castContext&&(t=this._castContext.getCurrentSession()),t}get _mediaSession(){let t;return this._castSession&&(t=this._castSession.getMediaSession()),t}get audioTrack(){try{let t=this._mediaSession;if(t&&t.media){let e=t.media.tracks;if(e){let i=t.activeTrackIds;return e.find(t=>-1!=i.indexOf(t.trackId)&&"AUDIO"==t.type)}}}catch(e){t}}set audioTrack(e){try{let i=this._mediaSession;if(i&&i.media){let s=i.media.tracks;if(s[e]||(e=s.findIndex(t=>t.roles&&-1!=t.roles.indexOf("main")),s[e]||(e=0)),s){let n=s[e].trackId,o=new chrome.cast.media.EditTracksInfoRequest([n]),a=()=>{t},r=e=>{t};i.editTracksInfo(o,a,r)}}}catch(e){t}}get audioTracks(){let t=this._mediaSession;if(t&&t.media){let e=t.media.tracks;if(e){for(let t=0;t<e.length;t++)e[t].roles&&"alternate"==e[t].roles[0]&&(e[t].audioDescription=!0);return e}}return[]}get isLive(){return this.mediaItem&&this.mediaItem.isLive}get currentTime(){return this.isLive?this.liveTimes.currentTime:this._remotePlayer.currentTime}set currentTime(t){if(this._mediaSession){const e=new chrome.cast.media.SeekRequest;this.isLive?e.currentTime=this.utcToMedia(t):e.currentTime=t,this._mediaSession.seek(e)}}get volume(){return this._castSession?this._castSession.getVolume():this._volume}set volume(t){this._volume=t,this._castSession?this._castSession.setVolume(t):this.dispatchEvent(new CustomEvent("volumechange"))}get muted(){return this._castSession?this._castSession.isMute():this._muted}set muted(t){this._muted=t,this._castSession?this._castSession.setMute(t):this.dispatchEvent(new CustomEvent("volumechange"))}set _subsOn(e){if(this._castSession){let i=new chrome.cast.media.EditTracksInfoRequest;i.enableTextTracks=e,this._mediaSession.editTracksInfo(i,()=>{},()=>{t})}}get _subsOn(){return this.__subsOn}get mediaItem(){return this._playbackController.mediaItem}get canSeek(){return this.isLive?this.liveTimes.duration>30:this.duration>0}get neverCanSeek(){return!1}get canSeekForwards(){return this.currentTime<this.latestSeek-.2}get blockSeekToEnd(){return!1}get canSeekToLiveReStart(){return!!this.isLive&&this.currentTime<this.latestSeek}get canChangeQuality(){return!1}get quality(){}set quality(t){}get earliestSeek(){return this.isLive?this.liveTimes.earliestSeek:0}get streamStart(){return this.isLive?this.liveTimes.streamStart:0}get streamEnd(){return this.isLive?this.liveTimes.streamEnd:this.duration}get latestSeek(){return this.isLive?this.liveTimes.latestSeek:this.duration}get joinTime(){}get ended(){}get played(){}get seeking(){}get videoHeight(){}get videoWidth(){}get containerHeight(){}get containerWidth(){}get webcastData(){}set webcastData(t){}get playbackRate(){}set playbackRate(t){}get shouldReadyNextItem(){}setInterestedAgain(){}get canPreload(){return!1}swappingItem(){}preload(){}get elementInUse(){}get _shouldShowPlayerControls(){return![Zs.STATE.NO_DEVICES_AVAILABLE,Zs.STATE.NOT_CONNECTED].includes(this.castState)}_setCastState(t){switch(t){case cast.framework.CastState.NO_DEVICES_AVAILABLE:t=Zs.STATE.NO_DEVICES_AVAILABLE;break;case cast.framework.CastState.NOT_CONNECTED:t=Zs.STATE.NOT_CONNECTED;break;case cast.framework.CastState.CONNECTING:t=this.castState===Zs.STATE.SELECT_DEVICE||this.castState===Zs.STATE.NOT_CONNECTED?Zs.STATE.CONNECTING:Zs.STATE.DISCONNECTING;break;case cast.framework.CastState.CONNECTED:t=Zs.STATE.CONNECTED}if(this.castState!=t){let e;if(this.castState=t,this._castSession){let t=this._castSession.getCastDevice();t&&(e=t.friendlyName)}const i=new CustomEvent("chromecastStateChange",{detail:{newState:t,deviceName:e}});this.dispatchEvent(i)}}_triggerDeviceSelectionMenu(){const t=this;if(this.toucanPlayer.playbackController.currentPlayback!==this){this.playerInitiatedConnection=!0;let e=this.toucanPlayer.paused;this.toucanPlayer.pause(),this._setCastState(Zs.STATE.SELECT_DEVICE),this._castContext.requestSession().then(function(){},function(i){t.playerInitiatedConnection=!1,t._setCastState(t._castContext.getCastState()),e||t.toucanPlayer.play()})}else t.playerInitiatedDisconnection=!0,this._castContext.requestSession()}async play(){this._currentlyPlayingItem===this.mediaItem?this._remotePlayerController.playOrPause():(this._currentlyPlayingItem=this.mediaItem,this._loadMedia())}pause(){this._remotePlayerController.playOrPause()}stop(){}get duration(){return this._remotePlayer.duration}_loadMedia(){let e=this;this.liveTimes={};let i=this.mediaItem.vpid,s=new chrome.cast.media.MediaInfo(i);s.streamType=this.isLive?"LIVE":"BUFFERED";let n=new chrome.cast.media.GenericMediaMetadata,o=this._playbackController.playlist;n.title=o.displayTitle||o.title,n.subtitle=o.displaySecondaryTitle||"";let a,r=1280,l=720;if(o.holdingImage){let t=o.holdingImage.orientation.charAt(0);"p"==t?(r=720,l=1280):(r=1280,l="s"==t?1280:720),a=o.holdingImage.url.replace(/[\${]recipe}?/,r+"x"+l)}if(o.holdingImageURL&&(a=o.holdingImageURL.replace(/[\${]recipe}?/,"1280x720").replace(/[\${]width}?/,"1280")),a){let t=new chrome.cast.Image;t.url=a,t.height=l,t.width=r,n.images=[t]}s.metadata=n,s.customData||(s.customData={}),s.customData.liveRewind=!0,this.settings.counterName&&(s.customData.counterName=this.settings.counterName),this.settings.castMediator&&(s.customData.mediator=this.settings.castMediator),this.settings.statsObject.bbcHashedIdentity&&(s.customData.bbcHashedIdentity=this.settings.statsObject.bbcHashedIdentity);let u=new chrome.cast.media.LoadRequest(s);u.currentTime=this.transferTime,this.transferTime=null;let c=!1;this._castSession.loadMedia(u).then(()=>{this._castSession.getSessionObj().addMediaListener(()=>{let i=e._mediaSession;if(!c&&i){e.toucanPlayer.subtitles.isOn&&(e._subsOn=!0),i.addUpdateListener(()=>{if(i.idleReason==chrome.cast.media.IdleReason.FINISHED){e._currentlyPlayingItem=!1;const t=new CustomEvent("ended");e.dispatchEvent(t)}});try{let t=i.media.tracks;t&&t.length>1&&this.dispatchEvent(new CustomEvent("multipleaudiotracks",{detail:{tracks:t}}))}catch(e){t}c=!0}})},e=>{t})}}function tn(t){let e;if(t.forceCastReceiver)return t.forceCastReceiver;switch(t.product){case"iplayer":e="2BA92214";break;case"sounds":e="D350F6A9";break;case"sport":e="15983BD8";break;default:e="1F306A22"}return e}customElements.get("smp-chromecast-playback")||customElements.define("smp-chromecast-playback",Zs);var en=":host{display:block}:host([disabled]){pointer-events:none}:host([disabled]) .seek_bar_slider,:host([readonly]) .seek_bar_slider{display:none!important}.transitions{transition:all var(--smp-seek-bar-progress-animation-duration) linear}.seek_bar_holder{-webkit-tap-highlight-color:transparent;box-sizing:border-box;cursor:pointer;padding:var(--smp-seek-bar-base-padding-three-times,24px) var(--smp-seek-bar-base-padding,8px);touch-action:none;width:100%}#helpText{display:none}.seek_bar{-webkit-tap-highlight-color:transparent;cursor:pointer;height:var(--smp-seek-bar-height,4px);position:relative}.seek_bar_seek_base{height:var(--smp-seek-bar-height,4px);opacity:var(--smp-seek-bar-base-opacity,.2)}.seek_bar_seek_available,.seek_bar_seek_base{background-color:var(--smp-base-colour,#fff);position:absolute;width:100%}.seek_bar_seek_available{height:100%;opacity:var(--smp-seek-bar-available-opacity,.35)}.seek_bar_progress{height:100%;pointer-events:none;width:0}.seek_bar_progress,.seek_bar_slider{background-color:var(--smp-colour,#0071f1);cursor:pointer;position:absolute}.seek_bar_slider{border:0;border-radius:50%;clip-path:var(--smp-seek-bar-slider-clip-path);display:var(--smp-seek-bar-slider-display,block);height:var(--smp-seek-bar-slider-width-height,12px);left:var(--smp-seek-bar-slider-initial-left);outline:none;padding:0;top:var(--smp-seek-bar-slider-top,-4px);transform:scale(var(--smp-seek-bar-slider-scale,1));transition:var(--smp-seek-bar-slider-transform-transition,none);width:var(--smp-seek-bar-slider-width-height,12px);z-index:1}.seek_bar_accessible_slider{opacity:0;pointer-events:none;position:relative;top:-6px;width:100%;z-index:3}@media (hover:hover) and (pointer:fine){.seek_bar_holder:hover .seekThumbHalo{transform:scale(1)}}.seek_bar_holder.touched .seekThumbHalo{transform:scale(1)}.seek_bar_accessible_slider:focus-visible+.seek_bar_slider .seekThumbHalo{transform:scale(1)}.seekThumbHalo{border-radius:50%;height:24px;left:-6px;opacity:.4;top:-6px;transform:scale(0);transition:transform .2s linear;width:24px}.seekThumbHalo,.seek_bar_line_indicator{background-color:var(--smp-colour,#0071f1);position:absolute}.seek_bar_line_indicator{clip-path:var(--smp-seek-bar-slider-clip-path);display:var(--smp-seek-bar-line-indicator-display,block);height:100%;pointer-events:none;visibility:hidden;width:3px;z-index:4}:host([readonly]) .seek_bar,:host([readonly]) .seek_bar_holder,:host([readonly]) .seek_bar_progress{cursor:default}";const sn=document.createElement("template");sn.innerHTML=`<div class="seek_bar_holder">\n                                    <div class="seek_bar">\n                                        <div class="seek_bar_seek_base"></div>\n                                        <div class="seek_bar_seek_available"></div>\n                                        <div class="seek_bar_progress"></div>\n                                        <div class="seek_bar_line_indicator"></div>\n                                        <input class="seek_bar_accessible_slider" aria-controls="smpVideoElement" type="range" min="0" max="100" value="0" step="2" aria-valuetext="${on("00:00","00:00")}" >\n                                        <div class="seek_bar_slider">\n                                            <div class="seekThumbHalo"></div>\n                                        </div>\n                                    </div>\n                                <div>`;class nn extends le{static get observedAttributes(){return["disabled","readonly"]}constructor(){super({stylesheet:en,template:sn,templateName:"progressBar"})}create(){var t;super.create(),this.seekBar=this.progressBar.getElementsByClassName("seek_bar")[0],this.slider=this.progressBar.getElementsByClassName("seek_bar_slider")[0],this.slider.style.display="none",this.accessibleSlider=this.progressBar.getElementsByClassName("seek_bar_accessible_slider")[0],this.progress=this.progressBar.getElementsByClassName("seek_bar_progress")[0],this.progressAvailable=this.progressBar.getElementsByClassName("seek_bar_seek_available")[0],this.lineIndicator=this.progressBar.getElementsByClassName("seek_bar_line_indicator")[0],this.accessibleSlider.setAttribute("title",E.seekBarName),this.accessibleSlider.setAttribute("aria-label",E.seekBarName),this.seekBarPadding=8,this.sliderWidth=12,this.progressPercent=0,this.slider.style.setProperty("--smp-seek-bar-slider-initial-left","-"+this.sliderWidth/2+"px"),this.animationEnabled=!1,this.progressBar.addEventListener("pointerdown",function(t){let e,i,s,n=!1;function o(r){if(s=r&&r.clientX,e=dn(s,t),isNaN(e)){t.hasPointerCapture(r.pointerId)&&(t.releasePointerCapture(r.pointerId),delete t.pointerId),r.stopPropagation(),r.preventDefault();let e=r.srcElement.ownerDocument;return e.removeEventListener("pointermove",o,!0),e.removeEventListener("pointerup",a,!0),void(t.isInteracting=!1)}t.setTime(e,!0),t.seekedFunctionOnDragging&&t.seekedFunction(e),Math.abs(i-s)>2&&(n=!0)}function a(i){let r=s||i.clientX;s=null,e=dn(r,t),t.setTime(e,!0);t.hasPointerCapture(i.pointerId)&&(t.releasePointerCapture(i.pointerId),delete t.pointerId),t.isInteracting=!1,t.seekedFunction(e);let l=i.srcElement.ownerDocument;l.removeEventListener("pointermove",o,!0),l.removeEventListener("pointerup",a,!0);const u={seek_time:Math.floor(e),before_seek_time:Math.floor(t.startingTime)};if(n)clearTimeout(t.dragInfoEventTimeout),t.dragInfoEventTimeout=setTimeout(function(){const e=new CustomEvent("sliderpointerdragging",{detail:u});t.dispatchEvent(e)},2e3);else{const e=new CustomEvent("sliderpointerup",{detail:u});t.dispatchEvent(e)}n=!1}return function(e){if(t.readonly||t.disabled)return;t.setAttribute("interacting","interacting"),t.isInteracting=!0,t.startingTime=t.currentTime,i=e.clientX,s=null,clearTimeout(t.dragInfoEventTimeout);let n=e.srcElement.ownerDocument;n.addEventListener("pointermove",o,!0),n.addEventListener("pointerup",a,!0),t.pointerId=e.pointerId,t.setPointerCapture(e.pointerId),e.stopPropagation(),e.preventDefault()}}(this),!0),this.addEventListener("pointermove",(t=this,function(e){t.setAttribute("interacting","interacting"),t.setAttribute("hovering","hovering");const i=dn(e&&e.clientX,t),s=t.getBoundingClientRect();let n=function(t,e,i){let s=t;if(e.latestAllowableSeek!=e.streamEnd){let t=(e.latestAllowableSeek-e.streamStart)/(e.streamEnd-e.streamStart),n=(i.width-2*e.seekBarPadding)*t+i.left+e.seekBarPadding;s>n&&(s=n)}return s<i.left+e.seekBarPadding?i.left:s>i.right-e.seekBarPadding?i.right-2*e.seekBarPadding:s-e.seekBarPadding}(e.x,t,s);if(this.readonly){let e=this.seekBar.getBoundingClientRect();const i={xCoordinate:this.progressPercent/100*e.width+e.left-this.sliderWidth/2-2,time:this.currentTime};mn(t,i)}else{mn(t,{xCoordinate:n,time:i});let e=n-s.left-.95;e=e<0?0:e,t.lineIndicator.style.left=e+"px",t.lineIndicator.style.visibility="visible"}}),!0),this.addEventListener("pointerleave",function(t){return function(){t.removeAttribute("interacting"),t.removeAttribute("hovering"),pn(t),t.lineIndicator.style.visibility="hidden"}}(this),!1),this.accessibleSlider.addEventListener("change",function(t){let e,i;return function(){if(t.readonly)return;if(t.startingTime=t.currentTime,e=t.accessibleSlider.value/(t.accessibleSlider.max-t.accessibleSlider.min)*100,i=un(t.streamEnd,t.streamStart,e),i=i>t.latestAllowableSeek?t.latestAllowableSeek:i,Math.abs(t.currentTime-i)<.5)return;t.setTime(i,!0),t.seekedFunction(i);let s=t.seekBar.getBoundingClientRect(),n=e/100*s.width+s.left-t.sliderWidth/2-2;mn(t,{xCoordinate:n,time:i});const o=Math.floor(i),a=Math.floor(t.startingTime),r=new CustomEvent("sliderassistivetech",{detail:{seek_time:o,before_seek_time:a}});t.dispatchEvent(r)}}(this),!1);const e=this;this.progressBar.addEventListener("pointerdown",function(t){e.progressBar.readonly||e.progressBar.disabled||"touch"==t.pointerType&&e.progressBar.classList.add("touched")}),bi(this.progressBar,["pointerup","pointercancel"],function(){e.progressBar.classList.remove("touched")},!0),this.setActionFunctions(),this.isInteracting=!1,this.addEventListener("click",function(){e.shadowRoot.activeElement!==e.accessibleSlider&&e.accessibleSlider.focus()}),this.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()})}setRewindWindow(t,e,i,s,n){this.streamStart=t||0,this.streamEnd=e||0,this.latestAllowableSeek=function(t,e){return t&&t<=e?t:e}(i,this.streamEnd),this.scheduledStart=s,this.readonly!=(!1===n)&&(this.readonly=!1===n),an(this,i)}get isLive(){return this._isLive}set isLive(t){this._isLive=t}get atLiveEdge(){return this._atLiveEdge}set atLiveEdge(t){this._atLiveEdge=t}get disabled(){return null!==this.getAttribute("disabled")}set disabled(t){t?(this.shadowRoot.activeElement&&this.dispatchEvent(new CustomEvent("disablingWithFocus",{bubbles:!0,composed:!0})),this.setAttribute("disabled",""),rn(this,null,0),ln(this,0),an(this)):this.removeAttribute("disabled")}get readonly(){return null!==this.getAttribute("readonly")}set readonly(t){t?(this.setAttribute("readonly",""),this.accessibleSlider.setAttribute("aria-readOnly",!0)):(this.removeAttribute("readonly"),this.accessibleSlider.removeAttribute("aria-readOnly"))}reset(){this.streamStart=0,this.scheduledStart=0,this.streamEnd=0,this.currentTime=0,this.latestAllowableSeek=0,this.progressPercent=0,rn(this,null,0),ln(this,0),an(this)}setTime(t,e){if(isNaN(t))return;t=t>this.latestAllowableSeek?this.latestAllowableSeek:t,this.currentTime=t,this.currentPosition=t,this.disabled?this.progressPercent=0:this.readonly?this.scheduledStart?this.progressPercent=cn(t,this.streamEnd,this.scheduledStart):this.progressPercent=100:this.progressPercent=cn(t,this.streamEnd,this.streamStart);const i=t>14e6,s=!e&&this.animationEnabled&&!i&&this.latestAllowableSeek==this.streamEnd;if(!this.isInteracting||e){if(this.updateTime){let e=this.seekBar.getBoundingClientRect();mn(this,{xCoordinate:this.progressPercent/100*e.width+e.left-this.sliderWidth/2-2,time:t},!0)}s?rn(this,null,t):(this.progress.classList.remove("transitions"),this.slider.classList.remove("transitions"),rn(this,this.progressPercent,t),ln(this,this.progressPercent))}}enableAnimation(t){this.animationEnabled=t}startAnimation(){if(!this.animationEnabled)return;const t=un(this.latestAllowableSeek,this.streamStart,this.progressPercent),e=this.latestAllowableSeek-t;this.progress.classList.add("transitions"),this.slider.classList.add("transitions"),this.seekBar.style.setProperty("--smp-seek-bar-progress-animation-duration",e+"s"),rn(this,100,t),ln(this,100)}stopAnimation(){if(!this.animationEnabled)return;this.progress.classList.remove("transitions"),this.slider.classList.remove("transitions");const t=un(this.streamEnd,this.streamStart,this.progressPercent);rn(this,this.progressPercent,t),ln(this,this.progressPercent)}resetAnimation(){this.animationEnabled&&(this.progressPercent=0,this.progress.classList.remove("transitions"),this.slider.classList.remove("transitions"),rn(this,null,0),ln(this,0))}setActionFunctions(t,e){var i;e&&(this.accessibleSlider.addEventListener("focusin",(i=this,function(){clearTimeout(i.seekingOverFocusInTimeout);let t=510;window.matchMedia("(prefers-reduced-motion: reduce)").matches&&(t=0),i.seekingOverFocusInTimeout=setTimeout(hn,t,i)})),this.accessibleSlider.addEventListener("focusout",function(t){return function(){t.hasPointerCapture(t.pointerId)||(clearTimeout(t.seekingOverFocusInTimeout),t.isInteracting=!1,pn(t))}}(this))),this.seekedFunction=t||function(){}}setCustomAccessibleSliderValues(t){for(let e of Object.keys(t)){let i=t[e];this.accessibleSlider.setAttribute(e,i)}}updateAccessibleSlider(t){const e=on(N(t),N(this.streamEnd),this.isLive,this.atLiveEdge);this.accessibleSlider.setAttribute("aria-valuetext",e),this.accessibleSlider.setAttribute("aria-valuenow",Math.floor(this.progressPercent)),this.accessibleSlider.value=this.progressPercent}get liveEdgeXOffset(){return this.progress.getBoundingClientRect().width}attributeChangedCallback(t){"disabled"===t&&(this.disabled?this.accessibleSlider.setAttribute("disabled",""):this.accessibleSlider.removeAttribute("disabled"))}}function on(t,e,i,s){let n=t;i&&s&&(n=E.live.toLowerCase());return E.audioToolTipSeekBarPrefix+" "+n+(!i&&e?" "+E.audioToolTipSeekBarSuffix+" "+e:"")}function an(t,e){if(!t.disabled&&e){const i=cn(e,t.streamEnd,t.streamStart);t.progressAvailable.style.width=i+"%"}else t.progressAvailable.style.width="0%"}function rn(t,e,i){t.updateAccessibleSlider(i),null!==e?(t.slider.style.left="calc("+e+"% - "+t.sliderWidth/2+"px)",t.slider.style.display=""):t.slider.style.display="none"}function ln(t,e){t.progress.style.width=e+"%"}function un(t,e,i){return i/100*(t-e)+e}function cn(t,e,i){let s=(t-i)/(e-i)*100;return s=Math.max(0,Math.min(s,100)),s}function dn(t,e){let i,s=t||NaN;const n=isNaN(s)?100:function(t,e){const i=t.seekBar.clientWidth,s=e-t.seekBar.getBoundingClientRect().left;return Math.max(0,Math.min(s,i))/i*100}(e,s);return i=un(e.streamEnd,e.streamStart,n),i=i>e.latestAllowableSeek?e.latestAllowableSeek:i,i}function hn(t){let e=t.seekBar.getBoundingClientRect();mn(t,{xCoordinate:t.progressPercent/100*e.width+e.left-t.sliderWidth/2-2,time:t.currentTime})}function pn(t){t.updateTime=!1,clearTimeout(t.hideInfoTimeout),t.dispatchEvent(new CustomEvent("hideInfo"))}function mn(t,e,i){if(e.time<0||t.isLive&&0==e.time)return;const s=new CustomEvent("showInfo",{detail:e});t.dispatchEvent(s);let n="hovering"==t.getAttribute("hovering");t.updateTime=!n,n?clearTimeout(t.hideInfoTimeout):i||(clearTimeout(t.hideInfoTimeout),t.hideInfoTimeout=setTimeout(pn,4e3,t,!0))}customElements.get("smp-progress-bar")||customElements.define("smp-progress-bar",nn);const gn={"aria-valuemin":0,"aria-valuemax":11,"aria-valuenow":0,"aria-valuetext":E.volumeControlDescription,title:"","aria-label":"",min:0,max:11,step:1,value:0};class bn extends nn{constructor(t){super(t)}create(){super.create(),this.setCustomAccessibleSliderValues(gn),this.accessibleSlider.removeAttribute("aria-controls"),this.seekedFunctionOnDragging=!0}setRange(t,e){super.setRewindWindow(t,e)}setVolume(t,e){if(!this.isInteracting){const i=Math.abs(t-this.currentPosition)>.5||0===t||(this.progressPercent=100);this.currentPosition&&!i||super.setTime(t,e)}}setActionCallback(t){this.actionCallback=t}updateAccessibleSlider(t){const e=Math.round(t);let i;switch(e){case 0:i=E.audioToolTipVolumeMuted;break;case 1:i=E.audioToolTipVolume1;break;case 2:i=E.audioToolTipVolume2;break;case 3:i=E.audioToolTipVolume3;break;case 4:i=E.audioToolTipVolume4;break;case 5:i=E.audioToolTipVolume5;break;case 6:i=E.audioToolTipVolume6;break;case 7:i=E.audioToolTipVolume7;break;case 8:i=E.audioToolTipVolume8;break;case 9:i=E.audioToolTipVolume9;break;case 10:i=E.audioToolTipVolume10;break;case 11:i=E.audioToolTipVolume11}this.accessibleSlider.setAttribute("aria-valuetext",i),this.accessibleSlider.setAttribute("aria-label",i),this.accessibleSlider.setAttribute("title",i),this.accessibleSlider.setAttribute("aria-valuenow",e),this.accessibleSlider.value=e,this.actionCallback&&this.actionCallback(e)}}customElements.get("smp-volume-slider")||customElements.define("smp-volume-slider",bn);const fn=document.createElement("template");fn.innerHTML='<button class="button">\n                                <div class="highlight_button_circle">\n                                    <div class="button_inner" aria-hidden="true"></div>\n                                </div>\n                            </button>';class yn extends le{constructor(t){t||(t={stylesheet:""}),t.stylesheet=".button{-webkit-tap-highlight-color:transparent;background-color:transparent;border:0;cursor:pointer;display:block;font-family:inherit;height:100%;margin:0;opacity:1;outline:0;padding:0;transition:opacity 1s linear;user-select:none;width:100%}.button:not(.touched_animation) svg{transition:transform .1s linear}.button .button_inner{align-items:center;background-color:var(--smp-button-background-colour,transparent);display:flex;height:100%;justify-content:center;position:relative;width:100%}.button[disabled]{cursor:default;pointer-events:none}.button[disabled] .button_inner{opacity:.4}.button:not([disabled]).hovering svg{fill:var(--smp-fore-colour-hover)}.button .highlight_button_circle{border:0;border-radius:var(--smp-highlight-button-circle-radius,0);height:100%;margin:0;padding:0;pointer-events:none;width:100%}:host(.show-focus) .button:focus-visible .highlight_button_circle{background:var(--smp-colour,#0071f1);box-shadow:0 0 0 var(--smp-button-box-shadow,5px) var(--smp-colour,#0071f1);transform:translateZ(0);transition:all .25s ease-in-out}:host(.show-focus) .button:focus-visible .button_inner svg{fill:var(--smp-fore-colour-tab)}:host(.show-focus) .button:focus-visible.pressed .highlight_button_circle{transform:scale(.9);transition:transform .2s ease-in-out}:host(smp-volume-button) .button.touched .highlight_button_circle,:host(smp-volume-button) .button.touched_animation .highlight_button_circle{background:hsla(0,0%,100%,.22);box-shadow:0 0 0 var(--smp-button-box-shadow-touched,5px) hsla(0,0%,100%,.22);overflow:overlay;transition:all .25s cubic-bezier(.215,.61,.355,1)}.button.touched.pressed{--smp-forward-interval-icon-number-top:43%}:host(.show-focus) .button:focus-visible{--smp-forward-interval-icon-number-top:42%}:host(.smp_B3.show-focus) .button:focus-visible,:host(.smp_B4.show-focus) .button:focus-visible{--smp-forward-interval-icon-number-top:43%}:host(.play_pause.show-focus) .button:focus-visible{--smp-button-box-shadow:15px}:host(.smp_B4.play_pause.show-focus) .button:focus-visible{--smp-button-box-shadow:8px}:host(.smp_B1.play_pause) .button,:host(.smp_B2.play_pause) .button{--smp-button-box-shadow-touched:10px}:host(.smp_B3.play_pause) .button{--smp-button-box-shadow-touched:15px}:host(.audio_ui) .button:not([disabled]).hovering svg{fill:var(--smp-colour)}:host(.audio_ui.show-focus) .button:focus-visible.hovering .button_inner svg,:host(.audio_ui.show-focus) .button:focus-visible.hovering svg{fill:var(--smp-colour-on-highlight-colour)}:host(.audio_ui) .button:not([disabled]) svg{fill:var(--smp-base-colour,#fff)}:host(.audio_ui) .button[disabled] svg{fill:var(--smp-base-colour,#fff)}:host(.audio_ui.show-focus) .button:focus-visible .button_inner svg{fill:var(--smp-colour-on-highlight-colour,#fff)} "+t.stylesheet,t.template=fn,t.templateName="button",super(t)}create(){super.create();const t=this,e=this.button;this.buttonInner=this.shadowRoot.querySelector(".button_inner"),fi(e,vn.bind(this)),yi(e,_n.bind(this));const i=kn.bind(this),s=wn.bind(this);e.addEventListener("pointerdown",i),e.addEventListener("pointerup",s,!0),e.addEventListener("pointercancel",s,!0),e.addEventListener("keyup",s,!0),e.addEventListener("keydown",function(e){e.keyCode!=di&&e.keyCode!=ci||(i(e),e.stopPropagation(),clearTimeout(t.interactingTimeout),t.interactingTimeout=setTimeout(()=>{t.removeAttribute("interacting")},250))}),e.addEventListener("focusin",function(){if(e.classList.add("focused"),!t.noFocusInEvent&&!e.noFocusInEvent){const t=new CustomEvent("buttonFocusin",{bubbles:!0,composed:!0});e.dispatchEvent(t)}t.noFocusInEvent=!1}),e.addEventListener("focusout",function(){e.classList.remove("focused")}),e.addEventListener("pointerdown",function(t){"touch"==t.pointerType&&(clearTimeout(e.touchedAnimationTimeout),e.classList.add("touched"),e.classList.add("touched_animation"))}),bi(e,["pointerup","pointercancel"],function(){e.classList.remove("touched"),e.touchedAnimationTimeout=setTimeout(function(){e.classList.remove("touched_animation")},210)},!0),e.addEventListener("contextmenu",function(t){e.classList.contains("touched")&&(t.stopPropagation(),t.preventDefault())}),this.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()})}get accessibleTitle(){return this.button.title}set accessibleTitle(t){t?(this.button.setAttribute("aria-label",t),this.button.title=t):(this.button.removeAttribute("aria-label"),delete this.button.title)}get hasFocusVisible(){return this.button.matches(":focus-visible")}show(){this.classList.remove("hidden"),this.classList.contains("removed")||(this.button.setAttribute("aria-hidden","false"),this.classList.contains("disabled")||(this.button.disabled=!1))}hide(){this.classList.add("hidden"),this.button.setAttribute("aria-hidden","true"),this.button.disabled=!0,wn.apply(this),_n.apply(this)}get showing(){return!(this.classList.contains("hidden")||this.classList.contains("removed"))}showHide(t){t?this.show():this.hide()}remove(){this.classList.add("removed"),this.removed=!0,this.button.setAttribute("aria-hidden","true"),this.button.disabled=!0,wn.apply(this),_n.apply(this)}restore(){this.classList.remove("removed"),this.removed=!1,this.classList.contains("hidden")||(this.button.setAttribute("aria-hidden","false"),this.classList.contains("disabled")||(this.button.disabled=!1))}restoreRemove(t){t?this.restore():this.remove()}disable(){this.shadowRoot.activeElement&&this.dispatchEvent(new CustomEvent("disablingWithFocus",{bubbles:!0,composed:!0})),this.markDirty(),this._dirtyDisabled=!0,wn.bind(this)(),_n.bind(this)()}enable(){this.markDirty(),this._dirtyDisabled=!1}removeTabindex(){this.button.tabIndex=-1}addTabindex(){this.button.tabIndex=0}render(){!0===this._dirtyDisabled?(this.classList.add("disabled"),this.button.disabled=!0):!1===this._dirtyDisabled&&(this.classList.remove("disabled"),this.classList.contains("hidden")||this.classList.contains("removed")||(this.button.disabled=!1)),delete this._dirtyDisabled}get isDisabled(){return this.classList.contains("disabled")||!0===this._dirtyDisabled}setActionFunction(t,e){bi(this.button,["pointerup","click"],gi(t,this,e))}takeFocus(){this.noFocusInEvent=!0,this.button.focus()}}function vn(){this.button.classList.add("hovering"),this.setAttribute("interacting","interacting")}function _n(){this.button.classList.remove("hovering"),this.button.classList.contains("pressed")||this.removeAttribute("interacting")}function kn(t){t&&"pointerdown"===t.type&&this.preventDefaultOnPressed&&t.preventDefault(),!t||this.preventDefaultOnPressed&&!this.stopPropagationOnPressed||t.stopPropagation(),this.button.classList.add("pressed"),clearTimeout(this.interactingTimeout),this.setAttribute("interacting","interacting")}function wn(){this.button.classList.remove("pressed"),this.button.classList.contains("hovering")||(clearTimeout(this.interactingTimeout),this.interactingTimeout=setTimeout(()=>{this.removeAttribute("interacting")},250))}customElements.get("smp-button")||customElements.define("smp-button",yn);class Tn extends yn{constructor(t){super(t),this.svgA=t.svgA,this.svgB=t.svgB,this.svgC=t.svgC,this.labelA=t.labelA,this.labelB=t.labelB,this.labelC=t.labelC}create(){super.create(),this.buttonInner.appendChild(this.svgA),this.buttonInner.appendChild(this.svgB),this.buttonInner.appendChild(this.svgC),this.stateA()}stateA(){"A"!=this.state&&(this.svgA.style.display="block",this.svgB.style.display="none",this.svgC.style.display="none",this.state="A",this.accessibleTitle=this.labelA)}stateB(){"B"!=this.state&&(this.svgB.style.display="block",this.svgA.style.display="none",this.svgC.style.display="none",this.state="B",this.accessibleTitle=this.labelB)}stateC(){"C"!=this.state&&(this.svgC.style.display="block",this.svgA.style.display="none",this.svgB.style.display="none",this.state="C",this.accessibleTitle=this.labelC)}}customElements.get("smp-three-state-button")||customElements.define("smp-three-state-button",Tn);function En(t,e){const i=document.createElementNS("http://www.w3.org/2000/svg",t);e.focusable=!1;for(let t of Object.keys(e))i.setAttributeNS(null,t,e[t]);return i}function Cn(t,e,i){const s=En("svg",{viewBox:"0 0 32 32"});let n=En("text",{"text-anchor":"middle","dominant-baseline":"central",x:t,y:e,"font-size":i});return s.appendChild(n),s}function Sn(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M14,5.2l-6,6.1H2.2c-0.6,0-1.2,0.5-1.2,1.2v6.9c0,0.6,0.5,1.2,1.2,1.2h5.8l6.1,6.1c0.7,0.7,2,0.2,2-0.8V6\n\t\t\tC16,5,14.7,4.5,14,5.2z M13.7,22.9l-4.6-4.6H3.3c0,0,0.1-4.7,0-4.6h5.8L13.7,9V22.9z M25.8,17.2l4.1,4.1l-1.6,1.6l-4.1-4.1L20,22.9\n\t\t\tl-1.6-1.6l4.1-4.1l-4.1-4.1l1.6-1.6l4.1,4.1l4.1-4.1l1.6,1.6L25.8,17.2z"});return t.appendChild(e),t}function Bn(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M21.6,5.5l-1.8,1.9c2.1,2.3,3.3,5.3,3.3,8.6c0,3.3-1.2,6.3-3.3,8.6l1.8,1.9c2.5-2.7,4.1-6.4,4.1-10.5\n\t\t\tC25.7,11.9,24.1,8.2,21.6,5.5 M14,5.2l-6,6.1H2.2c-0.6,0-1.2,0.5-1.2,1.2v6.9c0,0.6,0.5,1.2,1.2,1.2h5.8l6.1,6.1\n\t\t\tc0.7,0.7,2,0.2,2-0.8V6C16,5,14.7,4.5,14,5.2z M13.7,22.9l-4.6-4.6H3.3c0,0,0.1-4.7,0-4.6h5.8L13.7,9V22.9z"});return t.appendChild(e),t}function xn(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M25.3,1.7C28.8,5.4,31,10.5,31,16c0,5.5-2.2,10.6-5.7,14.3l-1.8-1.9c3.1-3.2,4.9-7.6,4.9-12.4\n\t\t\tc0-4.8-1.8-9.2-4.9-12.4L25.3,1.7 M21.6,5.5l-1.8,1.9c2.1,2.3,3.3,5.3,3.3,8.6c0,3.3-1.2,6.3-3.3,8.6l1.8,1.9\n\t\t\tc2.5-2.7,4.1-6.4,4.1-10.5C25.7,11.9,24.1,8.2,21.6,5.5 M14,5.2l-6,6.1H2.2c-0.6,0-1.2,0.5-1.2,1.2v6.9c0,0.6,0.5,1.2,1.2,1.2h5.8\n\t\t\tl6.1,6.1c0.7,0.7,2,0.2,2-0.8V6C16,5,14.7,4.5,14,5.2z M13.7,22.9l-4.6-4.6H3.3c0,0,0.1-4.7,0-4.6h5.8L13.7,9V22.9z"});return t.appendChild(e),t}class Pn extends Tn{constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-volume-button-svg-dimension,22px);width:var(--smp-volume-button-svg-dimension,22px)}:host(.smp_B4) svg{height:var(--smp-volume-button-svg-dimension,24px);width:var(--smp-volume-button-svg-dimension,24px)}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}:host(.audio_ui.smp_B1) .button svg{height:32px;width:32px}",svgA:Sn(),svgB:Bn(),svgC:xn(),labelA:E.toolTipUnmute,labelB:E.toolTipMute,labelC:E.toolTipMute}),this.mute=this.stateA,this.half=this.stateB,this.full=this.stateC}}customElements.get("smp-volume-button")||customElements.define("smp-volume-button",Pn);const Ln=document.createElement("template");Ln.innerHTML='<div class="wrap">\n                                    <smp-volume-button smp-context></smp-volume-button>\n                                    <smp-volume-slider aria-hidden="true"></smp-volume-slider>\n                                    <div class="number_wrap" aria-hidden="true"><span class="number_span"></span></div>\n                                </div>';class An extends Ks{constructor(){super({stylesheet:".wrap{--smp-seek-bar-base-padding:0;--smp-seek-bar-line-indicator-display:none;display:flex}:host([slidedirection=left]) smp-volume-slider{order:2;transform-origin:right}:host([slidedirection=left]) smp-volume-button{order:3}:host([slidedirection=left]) .number_wrap{order:1}smp-volume-slider{bottom:var(--smp-volume-slider-bottom,2px);height:48px;opacity:0;order:2;position:relative;transform-origin:left;transition:all .4s ease-in-out;width:0}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-volume-slider,:host([audioLayout].slim_controls.slim_height) smp-volume-slider{height:40px}.expanded smp-volume-slider{opacity:1;width:93px}smp-volume-button{height:48px;order:1;transform:var(--smp-volume-button-transform,none);transition:var(--smp-volume-button-transition,none);width:48px}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-volume-button,:host([audioLayout].slim_controls.slim_height) smp-volume-button{height:40px;width:40px}.number_wrap{align-items:center;display:flex;font-size:.875rem;height:var(--smp-volume-controller-number-wrap-size,48px);justify-content:center;opacity:0;order:3;transition:all .2s ease-in-out .3s;user-select:none;width:var(--smp-volume-controller-number-wrap-size,48px)}.expanded smp-volume-slider button:focus .number_wrap{transition:all .2s ease-in-out}.expanded .number_wrap{opacity:1}smp-volume-button.audio_ui.smp_B1{height:64px;width:64px}",template:Ln,templateName:"volume"}),this._expand=this._expand.bind(this),this._buttonFocus=this._buttonFocus.bind(this),this._close=this._close.bind(this),this._captureSliderPointer=this._captureSliderPointer.bind(this),this._releaseSliderPointer=this._releaseSliderPointer.bind(this),this._pressedOnArrowKeys=this._pressedOnArrowKeys.bind(this),this._releasedOnArrowKeys=this._releasedOnArrowKeys.bind(this),this._pressed=this._pressed.bind(this),this._released=this._released.bind(this)}_buttonFocus(){this.slider.accessibleSlider.focus()}_expand(t){const e=this;if(e.volume.classList.contains("expanded"))return;const i=t&&"touch"===t.pointerType;clearTimeout(e.sliderTimeout);setTimeout(function(){e.numberWrap.style.display="flex",e.numberWrap.clientWidth,e.volume.classList.add("expanded"),e.eventBus.trigger("volumeControlExpanded"),e.expandedCallback&&e.expandedCallback()},i?150:0)}_close(){const t=this;t.volume.classList.contains("pressed")||(t.volume.classList.remove("expanded"),t.eventBus.trigger("volumeControlClosed"),t.closedCallback&&t.closedCallback())}_captureSliderPointer(t){this.slider.setPointerCapture(t.pointerId)}_releaseSliderPointer(t){this.slider.releasePointerCapture(t.pointerId)}_pressedOnArrowKeys(t){37!=t.keyCode&&39!=t.keyCode&&38!=t.keyCode&&40!=t.keyCode||(this._expand(),this._pressed())}_releasedOnArrowKeys(t){37!=t.keyCode&&39!=t.keyCode&&38!=t.keyCode&&40!=t.keyCode||this._released()}_pressed(){this.volume.classList.add("pressed"),clearTimeout(this.interactingTimeout),this.setAttribute("interacting","interacting")}_released(){if(setTimeout(()=>{this.volume.classList.remove("pressed")},140),!this.volume.classList.contains("hovering")){let t=this;clearTimeout(this.interactingTimeout),this.interactingTimeout=setTimeout(function(){t.removeAttribute("interacting")},250)}}create(){super.create();const t=this;this.button=this.volume.getElementsByTagName("smp-volume-button")[0],this.numberWrap=this.volume.getElementsByClassName("number_wrap")[0],this.number=this.volume.getElementsByClassName("number_span")[0],this.slider=this.volume.getElementsByTagName("smp-volume-slider")[0],this.numberWrap.style.display="none",this.numberWrap.addEventListener("transitionend",function(){"0"===getComputedStyle(t.numberWrap).getPropertyValue("opacity")&&(t.numberWrap.style.display="none")}),this.slider.setRange(0,11),fi(this.volume,On.bind(this)),yi(this.volume,Nn.bind(this)),this.volume.addEventListener("pointerdown",this._pressed,!0),this.volume.addEventListener("pointerup",this._released,!0),this.volume.addEventListener("pointerout",this._released,!0),this.setActionFunctions(),function(t){function e(){return t.toucanPlayer.muted?Qi:Ji}t.slider.addEventListener("sliderpointerup",function(){t.echoReporter.trackAction(e(),"click",Dn(t.toucanPlayer))}),t.slider.addEventListener("sliderpointerdragging",function(){t.echoReporter.trackAction(e(),"drag",Dn(t.toucanPlayer))}),t.slider.addEventListener("sliderassistivetech",function(){t.echoReporter.trackAction(Ji,"fromATorKeyboard",Dn(t.toucanPlayer))})}(this),this.isAudio?this.button.classList.add("audio_ui"):this.button.classList.remove("audio_ui")}configureMuteOnly(t){t?(this.slider.disabled=!0,this.button.removeAttribute("tabIndex"),this.button.setAttribute("aria-hidden","false"),this.slider.setAttribute("aria-hidden","true"),this.button.removeEventListener("pointerover",this._expand),this.slider.removeEventListener("focusin",this._expand),this.button.removeEventListener("pointerup",this._buttonFocus),this.removeEventListener("pointerleave",this._close),this.removeEventListener("focusout",this._close),this.slider.removeEventListener("pointerdown",this._captureSliderPointer),this.slider.removeEventListener("pointerup",this._releaseSliderPointer),this.volume.removeEventListener("keydown",this._pressedOnArrowKeys),this.volume.removeEventListener("keyup",this._releasedOnArrowKeys,!0)):(this.slider.disabled=!1,this.toucanPlayer.muted?this.setVolume(0):this.setVolume(this.toucanPlayer.volume),this.button.setAttribute("tabIndex","-1"),this.button.setAttribute("aria-hidden","true"),this.slider.setAttribute("aria-hidden","false"),this.button.addEventListener("pointerover",this._expand),this.slider.addEventListener("focusin",this._expand),this.button.addEventListener("pointerup",this._buttonFocus),this.addEventListener("pointerleave",this._close),this.addEventListener("focusout",this._close),this.slider.addEventListener("pointerdown",this._captureSliderPointer),this.slider.addEventListener("pointerup",this._releaseSliderPointer),this.volume.addEventListener("keydown",this._pressedOnArrowKeys),this.volume.addEventListener("keyup",this._releasedOnArrowKeys,!0));In(this,this.toucanPlayer.muted?0:Math.round(11*this.toucanPlayer.volume))}onRooted(){super.onRooted(),this.configureMuteOnly(this.muteOnly),this.toucanPlayer.muted?this.setVolume(0):this.setVolume(this.toucanPlayer.volume),this.bindEvents(),this.dispatchEvent(new CustomEvent("takeFocusNames",{bubbles:!0,composed:!0,detail:{names:["volume"]}}))}bindEvents(){let t=this.eventBus;t.bind("volumechange",()=>{if(this.toucanPlayer.muted)this.setVolume(0);else{const t=this.toucanPlayer.volume;this.setVolume(t)}}),t.bind("focusButton",t=>{"volume"==t.group||"volume"==t.name&&!t.after?this.button.showing?this.slider.disabled?this.button.takeFocus():this.slider.accessibleSlider.focus():this.eventBus.trigger("focusOnPlayPause"):"volume"==t.name&&t.after&&this.dispatchEvent(new CustomEvent("focusGroup",{bubbles:!0,composed:!0,detail:{group:"seek"}}))})}setActionFunctions(){let t=Rn.bind(this),e=Fn.bind(this);this.slider.setActionFunctions(e);const i=this;this.slider.addEventListener("keydown",function(e){e.keyCode!=di&&e.keyCode!=ci||(t(e),e.stopPropagation(),e.preventDefault())}),this.button.setActionFunction(function(e){("touch"!==e.pointerType||i.volume.classList.contains("expanded")||i.muteOnly)&&t(e)})}get isAudio(){return this.hasAttribute("audioLayout")}setVolume(t){let e=11*t;this.slider.setVolume(e,!0),e=Math.round(e),In(this,e)}setExpandedAndClosedCallbacks(t,e){this.expandedCallback=t,this.closedCallback=e}close(){clearTimeout(this.sliderTimeout),this.volume.classList.remove("expanded")}show(){this.classList.add("show")}hide(){this.classList.remove("show")}get showing(){return this.classList.contains("show")}get slideDirection(){return this.getAttribute("slidedirection")}set slideDirection(t){this.slideDirection!=t&&this.setAttribute("slidedirection",t)}get muteOnly(){return this.hasAttribute("muteonly")}set muteOnly(t){this.muteOnly!=t&&(t?this.setAttribute("muteonly",""):this.removeAttribute("muteonly"),this.configureMuteOnly(t))}}function In(t,e){0===e?t.button.mute():e>=6||t.muteOnly?t.button.full():t.button.half(),t.number.textContent=e}function On(){this.classList.contains("show")&&(this.classList.add("hovering"),this.setAttribute("interacting","interacting"))}function Nn(){this.classList.remove("hovering"),this.removeAttribute("interacting")}function Rn(t){this.toucanPlayer.muted=!this.toucanPlayer.muted,this.toucanPlayer.muted?this.setVolume(0):this.setVolume(this.toucanPlayer.volume);const e=t&&"keydown"===t.type?"key_press":"click";let i=this.toucanPlayer.muted?Qi:Yi;this.echoReporter.trackAction(i,e,Dn(this.toucanPlayer))}function Fn(t){if(isNaN(t))return;let e=t/11;e=e.toFixed(2),this.toucanPlayer.volume=Number(e)}function Dn(t){return{includeVolume:!0,volume:t.volume}}customElements.get("smp-volume-controller")||customElements.define("smp-volume-controller",An);function Mn(t,e,i,s,n){const o=t,a=e;n=n||256;const r=2*Math.PI/n;let l,u,c,d=1,h=d/(n-1),p=[[i,s-o],[i,s-a]],m=En("g",{});for(let t=1;t<=n;t++)c=En("path",{}),u=t*r,l=[[i-o*Math.sin(u),s-o*Math.cos(u)],[i-a*Math.sin(u),s-a*Math.cos(u)]],c.setAttribute("d","M "+p[0]+" A "+o+" "+o+", 0, 0, 1, "+l[0]+" L "+l[1]+" A "+a+" "+a+", 0, 0, 0, "+p[1]),c.setAttribute("opacity",d),p=l,d-=h,m.appendChild(c);return m}const Hn=document.createElement("template");Hn.innerHTML='<div class="buffer_wrap"></div>';class qn extends le{constructor(){super({stylesheet:".buffer_wrap{align-items:center;display:flex;height:100%;justify-content:center;width:100%;z-index:10}svg{animation:playPauseSpinner 1s linear infinite;transform-origin:50% 50%}@keyframes playPauseSpinner{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}",template:Hn,templateName:"bufferWrap"})}create(){super.create(),this.render()}static get observedAttributes(){return["thickness","external-radius"]}attributeChanged(){this.markDirty()}render(){super.render(),function(t){for(;t&&t.firstChild;)t.removeChild(t.firstChild)}(this.bufferWrap);const t=this.thickness||6,e=this.externalRadius||25,i=2*e,s=Mn(e,e-t,e,e),n=En("svg",{viewBox:`0 0 ${i} ${i}`});n.style.width=n.style.height=i+"px",n.appendChild(s),this.bufferWrap.appendChild(n)}get thickness(){return this.getAttribute("thickness")}set thickness(t){this.thickness!=t&&this.setAttribute("thickness",t)}get externalRadius(){return this.getAttribute("external-radius")}set externalRadius(t){t!=this.externalRadius&&this.setAttribute("external-radius",t)}}customElements.get("smp-buffer")||customElements.define("smp-buffer",qn);class zn extends le{alert(t){this.removeAttribute("role"),this.setAttribute("aria-hidden","false"),this.setAttribute("aria-label",t),this.setAttribute("role","alert")}}customElements.get("smp-aria-announcer")||customElements.define("smp-aria-announcer",zn);function Un(t,e,i){const s=En("svg",{class:t,viewBox:"0 0 32 32"}),n=En("path",{class:e,d:"M32,16c0,8.84-7.16,16-16,16S0,24.84,0,16S7.16,0,16,0S32,7.16,32,16z"}),o=En("path",{class:i,d:"M16.57,24.41c-1.31,0-2.48-0.19-3.52-0.57s-1.93-0.94-2.65-1.67c-0.73-0.73-1.28-1.61-1.67-2.64\n            c-0.38-1.04-0.57-2.21-0.57-3.51c0-1.27,0.2-2.43,0.61-3.45c0.4-1.03,0.98-1.91,1.73-2.64s1.65-1.3,2.71-1.69\n            c1.06-0.39,2.24-0.58,3.54-0.58c0.98,0,1.91,0.09,2.8,0.28s1.71,0.46,2.46,0.82v3.19c-0.69-0.42-1.44-0.74-2.26-0.96\n            c-0.82-0.22-1.7-0.33-2.64-0.33c-1.12,0-2.09,0.21-2.89,0.63c-0.8,0.42-1.41,1.03-1.83,1.82c-0.42,0.8-0.63,1.76-0.63,2.9\n            c0,1.74,0.44,3.08,1.31,4.02c0.87,0.94,2.12,1.41,3.73,1.41c0.41,0,0.81-0.03,1.22-0.09c0.4-0.06,0.8-0.15,1.19-0.27v-3.24h-2.88\n            v-2.72h6.12v8.01c-0.51,0.27-1.09,0.5-1.73,0.7c-0.65,0.19-1.32,0.34-2.02,0.44S17.27,24.41,16.57,24.41z"});return s.appendChild(n),s.appendChild(o),s}const Wn=document.createElement("template");Wn.innerHTML="<div class=\"continuous_guidance_container\">\n                                            <div class=guidance_inner_wrap>\n                                                <div class=guidance_icon_holder></div>\n                                                <div class='guidance_message_container'>\n                                                    <span class='guidance_message_span'></span>\n                                                </div>\n                                            </div>\n                                        </div>";class Vn extends le{constructor(){super({stylesheet:".continuous_guidance_container{color:#fff;display:none;font-size:.875rem;height:calc(100% - var(--smp-continuous-guidance-top, 24px));left:var(--smp-continuous-guidance-left,32px);position:relative;top:var(--smp-continuous-guidance-top,24px);width:calc(100% - var(--smp-continuous-guidance-left, 32px))}.guidance_inner_wrap{display:flex;width:100%}:host(.rightBottom) .guidance_inner_wrap{justify-content:right}:host(.rightBottom) .continuous_guidance_container{box-sizing:border-box;float:right;font-size:var(--smp-continuous-guidance-font-size,.875rem);justify-content:right;left:unset;padding-right:var(--smp-continuous-guidance-padding-right,32px);width:80%}:host(.rightBottom.smp_B2) .continuous_guidance_container,:host(.rightBottom.smp_B3) .continuous_guidance_container{padding-right:32px}.guidanceSVG{bottom:.125rem;margin-right:8px;position:relative;transform:scale(var(--smp-guidance-svg-scale,1));transition:var(--smp-guidance-icon-transition,none);width:1.25rem}.guidance_icon_holder{height:var(--smp-guidance-message-container-height,40px);position:relative;top:var(--smp-guidance-icon-guidance-icon-holder-top,0)}:host(smp-continuous-guidance[message]) .continuous_guidance_container{display:flex}.circle{fill:#e51854}.g,.warning .circle{fill:#fff}.warning .g{fill:#000}.guidance_message_container{height:var(--smp-guidance-message-container-height,40px);max-width:85%;overflow:hidden}:host(.rightBottom) .guidance_message_container{max-width:92%;padding-right:6px}.guidance_message_span{line-height:125%;overflow:hidden;position:relative;top:var(--smp-guidance-message-span-top,0);transition:var(--smp-guidance-message-span-transition,none)}@media screen and (prefers-reduced-motion:no-preference){:host(.continuous_guidance) .guidanceSVG{--smp-guidance-svg-scale:0.8}:host(.showingFirstStep) .guidanceSVG{--smp-guidance-icon-transition:transform 400ms ease-in-out;--smp-guidance-svg-scale:1}:host(.hidingFirstStep) .guidanceSVG{--smp-guidance-icon-transition:all 400ms ease-in-out 350ms;--smp-guidance-svg-scale:0.8}:host(.continuous_guidance) .guidance_message_span{--smp-guidance-message-span-transition:top 800ms cubic-bezier(0,.46,0,.97);--smp-guidance-message-span-top:1.5rem}:host(.showingSecondStep) .guidance_message_span{--smp-guidance-message-span-top:0}:host(.hidingFirstStep) .guidance_message_span{--smp-guidance-message-span-transition:top 600ms cubic-bezier(1,.01,.85,.1);--smp-guidance-message-span-top:-1.5rem}:host(.continuous_guidance) .guidance_message_span.twoLines{--smp-guidance-message-span-top:3rem}:host(.showingSecondStep) .guidance_message_span.twoLines{--smp-guidance-message-span-top:0}:host(.hidingFirstStep) .guidance_message_span.twoLines{--smp-guidance-message-span-top:-3rem}:host(.continuous_guidance) .guidance_message_span.threeLines{--smp-guidance-message-span-transition:top 700ms cubic-bezier(0,.46,0,.97);--smp-guidance-message-span-top:4.5rem}:host(.showingSecondStep) .guidance_message_span.threeLines{--smp-guidance-message-span-top:0.063rem}:host(.hidingFirstStep) .guidance_message_span.threeLines{--smp-guidance-message-span-top:-4.5rem}}",template:Wn,templateName:"continuousGuidance"})}create(){super.create(),this.guidanceMessageContainer=this.continuousGuidance.getElementsByClassName("guidance_message_container")[0],this.guidanceMessage=this.continuousGuidance.getElementsByClassName("guidance_message_span")[0],this.guidanceIconHolder=this.continuousGuidance.getElementsByClassName("guidance_icon_holder")[0],this.guidanceIconHolder.setAttribute("aria-hidden","true"),this.guidanceIconHolder.appendChild(Un("guidanceSVG","circle","g"))}static get observedAttributes(){return["type","message"]}attributeChangedCallback(t,e,i){if("message"==t){this.guidanceMessage.textContent=i;const t=this.guidanceMessage.offsetHeight,e=parseFloat(getComputedStyle(this.guidanceMessage).getPropertyValue("line-height")),s=t/e;this.guidanceMessage.classList.remove("twoLines"),this.guidanceMessage.classList.remove("threeLines"),s>2?this.guidanceMessage.classList.add("threeLines"):s>1&&this.guidanceMessage.classList.add("twoLines"),t>0?(this.guidanceMessageContainer.style.setProperty("--smp-guidance-message-container-height",.0625*Math.max(t,e)+"rem"),this.guidanceIconHolder.style.setProperty("--smp-guidance-message-container-height",.0625*Math.max(t,e)+"rem")):(this.guidanceMessageContainer.style.setProperty("--smp-guidance-message-container-height","5rem"),this.guidanceIconHolder.style.setProperty("--smp-guidance-message-container-height","5rem"))}"type"==t&&("guidance"===i&&this.continuousGuidance.classList.remove("warning"),"warning"===i&&this.continuousGuidance.classList.add("warning"))}get type(){return this.getAttribute("type")}set type(t){this.setAttribute("type",t)}get message(){return this.getAttribute("message")}set message(t){this.setAttribute("message",t)}getGuidanceMessageBottomMargin(){return this.guidanceMessageContainer.getBoundingClientRect().bottom+10}}customElements.get("smp-continuous-guidance")||customElements.define("smp-continuous-guidance",Vn);const jn=document.createElement("template");jn.innerHTML='<img class="holding_image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNk/gkAAQUA/qaI640AAAAASUVORK5CYII=" alt="">';class Gn extends le{static get observedAttributes(){return["src","alt","available-widths"]}constructor(){super({stylesheet:":host{display:block;object-fit:inherit}*{object-fit:inherit}.holding_image{height:100%;object-fit:var(--smp-holding-image-fit,cover);position:relative;width:100%}:host(.swipe) .holding_image{object-fit:contain}",template:jn,templateName:"holdingImage"}),this._displaying=!0}attributeChanged(){this.markDirty()}setSrcset(t,e,i,s){this.holdingImage.decoding="async",this.src=t,this.alt=e,this.availableWidths=i,this.holdingImageObject=s}render(){if(super.render(),this.src||this.holdingImageObject){const t=ki(this.src,!1,this.availableWidths,this.holdingImageObject);this.holdingImage.srcset!=t&&(this.holdingImage.srcset=t);const e=ki(this.src,!0,this.availableWidths,this.holdingImageObject);this.holdingImage.src!=e&&(this.holdingImage.src=e,this.holdingImage.style.visibility="hidden",this.holdingImage.onload=()=>{this.holdingImage.onload=null,this.holdingImage.style.visibility="visible"}),this.holdingImage.alt=this.alt||"",this.holdingImage.style.display=""}else this.holdingImage.style.display="none",this.holdingImage.srcset="",this.holdingImage.src="",this.holdingImage.alt=""}set src(t){t?t!=this.getAttribute("src")&&this.setAttribute("src",t):this.removeAttribute("src")}get src(){return this.getAttribute("src")}set alt(t){this.setAttribute("alt",t||"")}get displaying(){return this._displaying}set displaying(t){this._displaying=t}get opacity(){return this._opacity}set opacity(t){this._opacity=t,this.style.setProperty("--smp-holding-image-opacity",t)}get alt(){return this.getAttribute("alt")}set availableWidths(t){this.setAttribute("available-widths",t)}get availableWidths(){return this.getAttribute("available-widths")}set holdingImageObject(t){t&&t.url&&t.orientation?this._holdingImageObject=t:this._holdingImageObject=null,this.markDirty()}get holdingImageObject(){return this._holdingImageObject}}customElements.get("smp-holding-image")||customElements.define("smp-holding-image",Gn);const $n=document.createElement("template");$n.innerHTML='<div class="time_tip">\n                                <span class="time_tip_text"></span>\n                            </div>';class Kn extends le{static get observedAttributes(){return["live","format","data-live-indicator-only"]}constructor(){super({stylesheet:":host{display:block}.time_tip{align-items:center;color:var(--smp-time-tip-colour,#fff);cursor:default;display:flex;font-size:1rem;justify-content:center;user-select:none}.live_pulsing .time_tip_text{color:var(--smp-live-pulse-colour,#00ccca);font-weight:700}.live_icon{fill:#e6e8ea;bottom:var(--smp-time-tip-bottom,unset);height:var(--smp-live-icon-size,12px);margin-right:var(--smp-live-icon-right-margin,5px);overflow:visible;position:var(--smp-time-tip-position,unset);width:var(--smp-live-icon-size,12px)}:host([stopped]) .live_icon,:host([stopped]) .live_pulsing .live_icon{fill:var(--smp-seek-bar-unavailable-colour,#3a3c3e)}:host([stopped]) .live_pulsing .time_tip_text,:host([stopped]) .time_tip_text{color:var(--smp-seek-bar-unavailable-colour,#3a3c3e)}.live_pulsing .live_icon{fill:var(--smp-live-pulse-colour,#00ccca)}:host(:not([stopped])) .live_pulsing .live_icon_inner_circle{animation:pulsate 1.7s ease 3}@media (prefers-reduced-motion){.live_icon_inner_circle,.live_pulsing .live_icon_inner_circle{animation:none!important}}@keyframes pulsate{0%{opacity:1}50%{opacity:.3}to{opacity:1}}:host(.audio_ui) .time_tip{--smp-time-tip-colour:var(--smp-base-colour,#000)}",template:$n,templateName:"timeTip"}),this._liveEdge=!0}create(){super.create(),this.liveIcon||(this.text=this.timeTip.querySelector(".time_tip_text"),this.liveIcon=function(){const t=En("svg",{viewBox:"0 0 12 12",class:"live_icon"}),e=En("path",{class:"live_icon_outer_ring",d:"M5.96681502,10.3410568 C8.38342771,10.3410568 10.3424794,8.38388329 10.3424794,5.96958745\n         \tC10.3424794,3.5552916 8.38342771,1.59811812 5.96681502,1.59811812 C3.55020233,1.59811812\n          \t1.59115067,3.5552916 1.59115067,5.96958745 C1.59115067,8.38388329 3.55020233,10.3410568\n          \t5.96681502,10.3410568 Z M5.96681502,11.930682 C2.67143408,11.930682 0,9.26180906 \n           \t0,5.96958745 C0,2.67736584 2.67143408,0.00849290887 5.96681502,0.00849290887 C9.26219596,\n           \t0.00849290887 11.93363,2.67736584 11.93363,5.96958745 C11.93363,9.26180906 9.26219596,\n           \t11.930682 5.96681502,11.930682 Z"}),i=En("circle",{class:"live_icon_inner_circle",cx:6,cy:6,r:3});return t.appendChild(i),t.appendChild(e),t}(),this.liveIcon.style.display="none",this.timeTip.prepend(this.liveIcon),fi(this.timeTip,Qn.bind(this)),yi(this.timeTip,Yn.bind(this))),this.render()}set time(t){this._time=t,this.markDirty()}get time(){return this._time}set live(t){t?this.setAttribute("live",""):this.removeAttribute("live")}set end(t){this._end!==t&&(this._end=t,this.markDirty())}get end(){return this._end}get live(){return this.hasAttribute("live")}get format(){return this.getAttribute("format")}set format(t){this.setAttribute("format",t)}set liveIndicatorOnlyMode(t){t?this.setAttribute("data-live-indicator-only","true"):this.removeAttribute("data-live-indicator-only")}get liveIndicatorOnlyMode(){return this.hasAttribute("data-live-indicator-only")}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){if(super.render(),this.live&&this._liveEdge)this.text.textContent=E.live,this.liveIcon.style.display="block",this.timeTip.classList.add("live_pulsing");else if(this.live&&this.liveIndicatorOnlyMode)this.text.textContent=E.live,this.liveIcon.style.display="block",this.timeTip.classList.remove("live_pulsing");else{this.liveIcon.style.display="none",this.timeTip.classList.remove("live_pulsing");let t="";const e=this.time;switch(this.format){case"broadcast":t=R(e);break;case"remaining":t=F(e,this.end);break;case"remainingSynced":t=F(e,Math.ceil(this.end));break;case"progress":t=function(t,e){return isNaN(e)?R(t):D(Math.max(0,t-e))}(e,this.start);break;case"duration":t=N(this.end);break;default:t=N(e)}this.text.textContent=t}}setLiveEdge(t){this._liveEdge!=t&&(this._liveEdge=t,this.markDirty())}get stopped(){return this.hasAttribute("stopped")}set stopped(t){t?this.setAttribute("stopped",""):this.removeAttribute("stopped")}}function Qn(){this.setAttribute("interacting","interacting")}function Yn(){this.removeAttribute("interacting")}customElements.get("smp-time-tip")||customElements.define("smp-time-tip",Kn);const Jn=document.createElement("template");Jn.innerHTML='<div class="wrap">\n                                    <div class="live_info_container">\n                                        <smp-time-tip live="live" data-live-indicator-only="true"></smp-time-tip>\n                                        <div class="live_info_text"></div>\n                                    </div>\n                                    <div class="title_container"></div>\n                                    <div class="secondary_title_container"></div>                                 \n                                </div>';class Xn extends le{static get observedAttributes(){return["live-text","title","secondary-title"]}constructor(){super({stylesheet:":host(.rightBottom) .wrap{display:grid;justify-content:right;padding-right:var(--smp-title-header-padding-right,32px)}.show{user-select:none;visibility:visible}.hide{visibility:hidden}.title_container{-webkit-line-clamp:2;font-size:var(--smp-title-header-main-title-font-size,1rem);font-weight:700;line-height:var(--smp-title-header-main-title-line-height,1.125rem)}.secondary_title_container,.title_container{-webkit-box-orient:vertical;display:-webkit-box;margin-top:8px;overflow:hidden;text-overflow:ellipsis}.secondary_title_container{-webkit-line-clamp:1;font-size:var(--smp-title-header-secondary-title-font-size,.75rem)}.live_info_container{align-items:end;display:none;margin-bottom:2px;margin-top:6px}.live_info_text{color:#e6e8ea;font-size:var(--smp-title-header-live-info-text-font-size,.813rem);margin-inline-start:10px}smp-time-tip{--smp-time-tip-colour:#e6e8ea;direction:ltr}.live_info_container.show{display:flex}:host(.smp_title_dont_fit:not(.rightBottom)) .live_info_container,:host(.smp_title_dont_fit:not(.rightBottom)) .secondary_title_container,:host(.smp_title_dont_fit:not(.rightBottom)) .title_container{display:none}",template:Jn,templateName:"titleHeader"})}create(){super.create(),this.titleTextContainer=this.titleHeader.getElementsByClassName("title_container")[0],this.secondaryTitleTextContainer=this.titleHeader.getElementsByClassName("secondary_title_container")[0],this.liveIndicator=this.titleHeader.getElementsByTagName("smp-time-tip")[0],this.liveInfoText=this.titleHeader.getElementsByClassName("live_info_text")[0],this.liveInfoContainer=this.titleHeader.getElementsByClassName("live_info_container")[0]}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){super.render(),this.titleTextContainer.textContent=this.title,this.secondaryTitleTextContainer.textContent=this.secondaryTitle,this.liveInfoText.textContent=this.liveText}set liveText(t){let e=t||"";e!=this.getAttribute("live-text")&&(this.setAttribute("live-text",e),this.markDirty())}get liveText(){return this.getAttribute("live-text")}set title(t){let e=t||"";e!=this.getAttribute("title")&&(this.setAttribute("title",e),this.markDirty())}get title(){return this.getAttribute("title")}set secondaryTitle(t){let e=t||"";e!=this.getAttribute("secondary-title")&&(this.setAttribute("secondary-title",e),this.markDirty())}get secondaryTitle(){return this.getAttribute("secondary-title")}show(){this.markDirty(),this.liveText?this.liveInfoContainer.classList.add("show"):this.liveInfoContainer.classList.remove("show"),this.titleHeader.classList.add("show"),this.titleHeader.classList.remove("hide")}hide(){super.cancelRender(),this.titleHeader.classList.remove("show"),this.titleHeader.classList.add("hide"),this.liveInfoContainer.classList.remove("show")}updateLiveIndicator(t){this.liveIndicator.setLiveEdge(!t.canSeekForwards)}}customElements.get("smp-title-header")||customElements.define("smp-title-header",Xn);class Zn extends yn{constructor(t){super(t),this.svgON=t.svgOn,this.svgOFF=t.svgOff,this.labelON=t.labelOn,this.labelOFF=t.labelOff,this.alternativeSvgOff=t.alternativeSvgOff||void 0,this._useAlternateOff=!1}create(){super.create(),this.svgON&&this.svgOFF&&(this.buttonInner.appendChild(this.svgON),this.buttonInner.appendChild(this.svgOFF),this.alternativeSvgOff&&this.buttonInner.appendChild(this.alternativeSvgOff)),this.off()}get useAlternateOff(){return this._useAlternateOff}set useAlternateOff(t){this._useAlternateOff=t,this.alternativeSvgOff&&("on"==this.state?(this.svgOFF.style.display="none",this.alternativeSvgOff.style.display="none"):t?(this.svgOFF.style.display="none",this.alternativeSvgOff.style.display="block"):(this.svgOFF.style.display="block",this.alternativeSvgOff.style.display="none"))}on(){var t;"on"!=this.state&&((t=this).svgON&&t.svgOFF&&(t.svgON.style.display="block",t.alternativeSvgOff&&(t.alternativeSvgOff.style.display="none"),t.svgOFF.style.display="none"),this.state="on",this.setAttribute("on",""),this.accessibleTitle=this.accTitle)}off(){var t;"off"!=this.state&&((t=this).svgON&&t.svgOFF&&(t.useAlternateOff?(t.svgOFF.style.display="none",t.alternativeSvgOff&&(t.alternativeSvgOff.style.display="block")):(t.svgOFF.style.display="block",t.alternativeSvgOff&&(t.alternativeSvgOff.style.display="none")),t.svgON.style.display="none"),this.state="off",this.removeAttribute("on"),this.accessibleTitle=this.accTitle)}get accTitle(){return"on"==this.state?this.labelON:this.labelOFF}get isOn(){return"on"===this.state}}customElements.get("smp-two-state-button")||customElements.define("smp-two-state-button",Zn);function to(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M4.4,32V0l25.1,16L4.4,32z"});return t.appendChild(e),t}function eo(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M13,31H6V1h7ZM26,1H19V31h7Z"});return t.classList.add("pause"),t.appendChild(e),t}class io extends Zn{constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-play-pause-icon-dimension,42px);position:relative;right:-3px;width:var(--smp-play-pause-icon-dimension,42px)}svg.pause{right:0}.button:not([disabled]).hovering svg{transform:scale(1.18)}:host(.smp_B4) .button:not([disabled]).hovering svg{transform:scale(1.2)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg,:host(.smp_B4) .button:not([disabled]).hovering.pressed svg,:host(.smp_B4) .button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched_animation svg{transform:scale(.8);transition:transform .2s cubic-bezier(.2,0,0,1)}.button.hovering svg,:host(.show-focus) .button:focus-visible svg{transform:scale(1.18)}:host(.smp_B4.show-focus) .button:focus-visible svg{transform:scale(1.2)}.button.pressed:focus-visible svg{transform:scale(1)}",svgOn:to(),svgOff:eo(),labelOn:E.toolTipPlay,labelOff:E.toolTipPause}),this.play=this.on,this.pause=this.off,this.allowHide=!0}}customElements.get("smp-play-pause-button")||customElements.define("smp-play-pause-button",io);class so extends yn{constructor(){super({stylesheet:"button svg{fill:var(--smp-base-colour,#fff);stroke:var(--smp-base-colour,#fff);stroke-width:0;height:56px;transition:transform .1s linear;width:56px}:host(.audio_ui) .button:not([disabled]).hovering svg{fill:var(--smp-colour-on-highlight-colour,#fff);transform:scale(1.2)}:host(.audio_ui) .button:not([disabled]).hovering.pressed svg{transform:scale(1)}:host(.audio_ui) button:not([disabled]).touched svg{transform:scale(.9)}:host(.smp_tiny) button svg{height:48px;width:48px}:host(.show_slim_controls.slim_controls:not(.three_rows)) button svg,:host(.slim_controls.slim_height) button svg{height:44px;width:44px}#surroundingCircle{stroke-width:3;fill:none;opacity:1;transition:opacity .1s linear}:host([buffering]) #surroundingCircle{opacity:0}#highlightCircle{fill:var(--smp-colour,#ff4900);opacity:0;transition:opacity .1s linear}:host(.show-focus) button:not([disabled]):focus-visible #highlightCircle{fill:var(--smp-colour,#ff4900);opacity:1}#spinner{opacity:0;transition:opacity .1s linear}:host([buffering]) #spinner{animation-duration:1s;animation-iteration-count:infinite;animation-name:spin;animation-timing-function:linear;opacity:1;transform-origin:34px 34px}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(1turn)}}:host(.show-focus) button:focus-visible #surroundingCircle,button.hovering #surroundingCircle,button.pressed #surroundingCircle{opacity:0}:host(.show-focus) button:focus-visible #highlightCircle,button.hovering #highlightCircle,button.pressed #highlightCircle{opacity:1}:host(.show-focus) button:focus-visible #centralIcons,button.hovering #centralIcons,button.pressed #centralIcons{fill:var(--smp-colour-on-highlight-colour,#fff)}:host(.show-focus) button:focus-visible #spinner,button.hovering #spinner,button.pressed #spinner{fill:var(--smp-colour-on-highlight-colour,#fff)}#playIcon{opacity:1}#pauseIcon{opacity:0}:host([pause]) #pauseIcon{opacity:1}:host([loading]) #pauseIcon,:host([loading]) #playIcon,:host([pause]) #playIcon{opacity:0}:host([loading]){pointer-events:none}.duration_container{display:none;left:80px;position:relative;top:-50%;transform:translateY(-50%);width:var(--smp-cta-duration-available-width,110px)}.duration_container.duration_visible{display:block}:host(.smp_B1) .duration_container.duration_visible{display:none}.duration_container .duration_text{font-size:.938rem;user-select:none}"})}connectedCallback(){if(super.connectedCallback(),!this.surroundingCircle){let t=En("svg",{width:68,height:68,viewBox:"0 0 68 68"});this.surroundingCircle=En("circle",{id:"surroundingCircle",cx:34,cy:34,r:32.5}),this.highlightCircle=En("circle",{id:"highlightCircle",cx:34,cy:34,r:34}),this.spinner=Mn(34,31,34,34),this.spinner.id="spinner",this.centralIcons=En("g",{id:"centralIcons"}),this.playIcon=En("polygon",{id:"playIcon",points:"27 46 46 34 27 22"}),this.pauseIcon=En("g",{id:"pauseIcon"});let e=En("rect",{x:26,y:24,width:6,height:20}),i=En("rect",{x:36,y:24,width:6,height:20});this.pauseIcon.appendChild(e),this.pauseIcon.appendChild(i),this.centralIcons.appendChild(this.playIcon),this.centralIcons.appendChild(this.pauseIcon),t.appendChild(this.surroundingCircle),t.appendChild(this.highlightCircle),t.appendChild(this.spinner),t.appendChild(this.centralIcons),this.buttonInner.append(t),this.setAttribute("loading","loading")}!function(t){if(t.duration)return;const e=document.createElement("div");e.classList.add("duration_container"),t.shadowRoot.appendChild(e),t.durationContainer=e;const i=document.createElement("time");i.classList.add("duration_text"),e.appendChild(i),t.duration=i}(this),this.render()}static get observedAttributes(){return["buffering","pause"]}attributeChanged(){this.markDirty()}get buffering(){return this.hasAttribute("buffering")}set buffering(t){this.buffering!=t&&(t?this.setAttribute("buffering","buffering"):this.removeAttribute("buffering"))}get loading(){return this.hasAttribute("loading")}set loading(t){t?(this.setAttribute("tabIndex","-1"),this.setAttribute("loading","loading")):(this.removeAttribute("tabIndex"),this.removeAttribute("loading"))}pause(){this.setAttribute("pause","pause")}play(){this.removeAttribute("pause")}set ctaProgrammeDuration(t){this.duration.textContent=t}get ctaProgrammeDuration(){return this.duration.textContent}set ctaProgrammeIsoDuration(t){t?this.duration.setAttribute("datetime",t):this.duration.removeAttribute("datetime")}get ctaProgrammeIsoDuration(){return this.duration.getAttribute("datetime")}toggleCtaDuration(t){t?this.durationContainer.classList.add("duration_visible"):this.durationContainer.classList.remove("duration_visible")}render(){super.render();let t=this.hasAttribute("pause")?E.toolTipPause:E.toolTipPlay;this.ctaState&&this.title&&(t=E.toolTipCTAPlay.replace("{title}",this.title)),this.accessibleTitle=t}get ctaState(){return this._ctaState}set ctaState(t){this._ctaState!=t&&(t&&this.play(),this._ctaState=t,this.markDirty())}get title(){return this._title}set title(t){t!=this.title&&(this._title=t,this.markDirty())}}customElements.get("smp-audio-play-pause-button")||customElements.define("smp-audio-play-pause-button",so);function no(t){const e=Cn(16,18,11);let i=En("path",{class:t,d:"M30.2,17.9C30.1,25.7,23.8,32,16,32C8.2,32,1.8,25.7,1.8,17.9S8.2,3.7,16,3.7h1.2l0,0L14.7,0h2.6l3.9,4.9\n\t\t\tl-3.9,5h-2.6l2.6-3.6l0.1-0.2H16c-6.5,0-11.8,5.3-11.8,11.8S9.5,29.6,16,29.6c6.5,0,11.8-5.2,11.8-11.7H30.2z"});return e.insertBefore(i,e.firstChild),e}function oo(t){const e=Cn(16,18,11);let i=En("path",{class:t,d:"M30.2,17.8C30.2,17.8,30.2,17.8,30.2,17.8C30.2,25.7,23.8,32,16,32S1.8,25.7,1.8,17.8h0c0,0,0,0,0,0h2.3c0,0,0,0,0,0.1\n\t\t\tc0,4.1,2,7.6,5.2,9.7c1.9,1.3,4.1,2,6.6,2c6.5,0,11.8-5.3,11.8-11.8c0-3-1.1-5.7-2.9-7.8c0,0,0,0,0,0c-0.1-0.1-0.1-0.2-0.2-0.2\n\t\t\tc-0.1-0.1-0.1-0.2-0.2-0.2c0,0,0,0,0,0c-2.1-2.1-5.1-3.4-8.3-3.4c-0.4,0-0.8,0-1.1,0.1l2.6,3.7h-2.6l-3.9-4.9L14.7,0l2.6,0l-2.6,3.7\n\t\t\tl0.1,0c0.4,0,0.7,0,1.1,0C23.8,3.6,30.2,9.9,30.2,17.8C30.2,17.8,30.2,17.8,30.2,17.8z"});return e.insertBefore(i,e.firstChild),e}class ao extends yn{constructor(){super({stylesheet:":host{display:block}.button{overflow:visible}.button svg{bottom:1px;height:var(--smp-forward-interval-icon-dimension,32px);position:relative;width:var(--smp-forward-interval-icon-dimension,32px)}.button .iconNumber{transition:transform .1s linear}.iconNumber{color:var(--smp-interval-button-icon-number-color,#fff);font-size:var(--smp-forward-interval-icon-number-font-size,11px);left:0;line-height:14px;position:absolute;right:0;text-align:center;top:var(--smp-forward-interval-icon-number-top,42%);transform:scale(var(--smp-interval-iconNumber-scale,1))}.button:not([disabled]).hovering .iconNumber{color:var(--smp-fore-colour-hover,#fff)}:host(.show-focus) .button:focus-visible .iconNumber{color:var(--smp-fore-colour-tab,#fff)}.popNumber{color:var(--smp-base-colour,#fff);display:var(--smp-interval-button-pop-number-display,block);font-size:16px;left:0;line-height:16px;opacity:0;pointer-events:none;position:absolute;right:0;text-align:center;top:-20px}.popNumber.p_up{top:-27px}:host(.smp_B4) button{--smp-interval-button-pop-number-display:none}.button svg{transform:scale(var(--smp-interval-arrow-scale,1))}.button:not([disabled]).hovering .iconNumber,.button:not([disabled]).hovering svg{transform:scale(1.18)}:host(.smp_B4) .button:not([disabled]).hovering svg,:host(.smp_B4).button:not([disabled]).hovering .iconNumber{transform:scale(1.2)}.button:not([disabled]).touched .iconNumber,.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed .iconNumber,.button:not([disabled]).touched.pressed svg{transform:scale(.8)}.button:not([disabled]).hovering.pressed .iconNumber,.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed .iconNumber,.button:not([disabled]).pressed svg{transform:scale(1)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.18)}:host(.smp_B4.show-focus) .button:focus-visible svg{transform:scale(1.2)}@media (prefers-reduced-motion:reduce){.popNumber{display:none}}.rotated .popNumber.p_up{transition:top .4s linear}:not(.rotated) .popNumber.p_up{transition:top .4s linear,opacity .25s linear}:not(.rotated) .popNumber{transition:opacity .25s linear}.button .intervalArrow{transform-origin:16px 18px;transition:transform .25s linear}.button .forwardInterval_arrow{transform:rotate(var(--smp-forward-interval-arrow-rotate,0));transition:var(--smp-interval-button-transition,none)}@starting-style{.button .forwardInterval_arrow{transform:rotate(var(--smp-forward-interval-starting-rotate,0))}}.button .backwardInterval_arrow{transform:rotate(var(--smp-backward-interval-arrow-rotate,0));transition:var(--smp-interval-button-transition,none)}@starting-style{.button .backwardInterval_arrow{transform:rotate(var(--smp-backward-interval-starting-rotate,0))}}.button.rotated .intervalArrow{transition:transform var(--smp-interval-rotate-speed,.15s) linear}.button.rotated .backwardInterval_arrow{transform:rotate(-70deg)}.button.rotated .forwardInterval_arrow{transform:rotate(70deg)}:host(.smp_B4.audio_ui) button{--smp-interval-button-pop-number-display:block}:host(.audio_ui) .popNumber{top:-8px}:host(.audio_ui) .popNumber.p_up{top:-16px}"})}create(){let t,e;super.create(),this.popNumber=document.createElement("div"),this.popNumber.className="popNumber",this.popNumber.setAttribute("aria-hidden","true"),"right"===this.direction?(t="forwardInterval",e=no):(t="backwardInterval",e=oo),this.button.classList.add(t),this.buttonInner.appendChild(e(t+"_arrow intervalArrow")),this.buttonInner.appendChild(this.popNumber),this.iconNumber=this.buttonInner.querySelector("text"),this.attributeChanged();const i=this;super.setActionFunction(function(t){i.animateAndTriggerActionFunc(t)})}static get observedAttributes(){return["interval"]}animate(t){clearTimeout(this.animTimeout),clearTimeout(this.animTimeoutTwo),clearTimeout(this.animTimeoutThree);let e=150;t&&(e=550,this.style.setProperty("--smp-interval-rotate-speed",e+"ms")),this.button.classList.add("rotated"),this.animTimeout=setTimeout(()=>{this.button.classList.remove("rotated"),this.style.removeProperty("--smp-interval-rotate-speed")},e),t||(window.matchMedia("(prefers-reduced-motion: reduce)").matches||(this.iconNumber.style.opacity=0),this.popNumber.style.opacity=1,this.popNumber.classList.add("p_up"),this.animTimeoutTwo=setTimeout(()=>{this.iconNumber.style.opacity=1,this.popNumber.style.opacity=0},400),this.animTimeoutThree=setTimeout(()=>{this.popNumber.classList.remove("p_up")},650))}animateAndTriggerActionFunc(t){this.animate(),this.actionFunction(t,this.delta)}enableIfTimeOkay(t){"right"==this.direction?t.canSeekForwards?this.enable():this.disable():t.currentTime>t.earliestSeek+.2?this.enable():this.disable()}attributeChanged(){if(isNaN(this.interval)||this.interval<=0)return void(this.interval="10");let t;this.iconNumber.textContent=this.interval;let e="-";"right"===this.direction?(e="+",t=E.skipForward):t=E.skipBack,this.popNumber.textContent=e+this.interval,this.accessibleTitle=t.replace("{seconds}",this.interval),this.delta=parseFloat(e+this.interval)}get direction(){return this.getAttribute("direction")}get interval(){return this.getAttribute("interval")||"10"}set interval(t){isNaN(t)||0==t||this.setAttribute("interval",t)}setActionFunction(t){this.actionFunction=t||function(){}}}customElements.get("smp-interval-button")||customElements.define("smp-interval-button",ao);var ro=":host{display:block}.button,.button svg{overflow:visible}.button svg{height:var(--smp-forward-interval-icon-dimension,36px);position:relative;top:2px;width:var(--smp-forward-interval-icon-dimension,36px)}.button.previousIcon svg{height:24px;top:0;width:24px}.button text{transition:transform .1s linear}:host(.no_text) text{display:none}.button:not([disabled]).hovering text{color:var(--smp-fore-colour-hover,#fff)}:host(.show-focus) .button:focus-visible text{color:var(--smp-fore-colour-tab,#fff)}.button svg{transform:scale(var(--smp-interval-arrow-scale,1))}.button:not([disabled]) .button_inner{transition:transform .1s linear}.button:not([disabled]).hovering .button_inner{transform:scale(1.18)}:host(.smp_B4) .button:not([disabled]).hovering .button_inner{transform:scale(1.2)}.button:not([disabled]).touched .button_inner,.button:not([disabled]).touched.pressed .button_inner{transform:scale(.8)}.button:not([disabled]).hovering.pressed .button_inner,.button:not([disabled]).pressed .button_inner,:host(.smp_B4) .button:not([disabled]).hovering.pressed .button_inner{transform:scale(1)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.18)}:host(.smp_B4.show-focus) .button:focus-visible svg{transform:scale(1.2)}@media (prefers-reduced-motion:reduce){.button .live_edge_arrow{transform-origin:17px 17px;transition:transform .15s linear}.button .live_restart_arrow{transform-origin:15px 18px;transition:transform .15s linear}.button.rotated .live_edge_arrow{transform:rotate(70deg)}.button.rotated .live_restart_arrow{transform:rotate(-70deg)}}";function lo(){const t=Cn(8,16,9);t.firstChild.textContent="START";let e=En("g",{class:"live_restart_arrow"}),i=En("path",{d:"M8.7,23.51c1.86,1.86,4.42,3.01,7.34,3.01c5.75,0,10.44-4.69,10.44-10.44S21.79,5.64,16.04,5.64h-1.15\n        l0.09,0.18L17.28,9h-2.3l-3.45-4.42l3.36-4.33h2.3l-2.3,3.27h1.15c6.9,0,12.47,5.57,12.47,12.47s-5.57,12.56-12.47,12.56\n        c-3.27,0-6.28-1.24-8.58-3.36c-0.09-0.09-0.18-0.18-0.27-0.27 M6.4,4.58L9.85,9h2.3L9.15,4.58l3.01-4.33H9.77L6.4,4.58z"});return e.appendChild(i),t.appendChild(e),t}function uo(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M4.8 1v30H2V1h2.8zm9.1 13.3L30 31h-6.4L9 16 23.6 1H30L13.9 17.7v-3.4z"});return t.appendChild(e),t}class co extends yn{constructor(){super({stylesheet:ro}),this.angle=0,this.animationDuration=600,this._audio=!1}set audio(t){this._audio=t,this.accessibleTitle=this.audio?E.listenFromStart:E.liveRestart}get audio(){return this._audio}set previousIcon(t){this._previousIcon!=t&&(this.animationID&&cancelAnimationFrame(this.animationID),clearTimeout(self.animTimeout),this._previousIcon=t,this.buttonInner&&this.buttonInner.firstChild&&(t?(this.buttonInner.replaceChild(uo(),this.buttonInner.firstChild),this.button.classList.add("previousIcon")):(this.buttonInner.replaceChild(lo(),this.buttonInner.firstChild),this.button.classList.remove("previousIcon")),this.iconText=this.buttonInner.querySelector("text")))}get previousIcon(){return this._previousIcon}create(){super.create(),this.button.classList.add("live_restart"),this.previousIcon&&this.button.classList.add("previousIcon");let t=this.previousIcon?uo():lo();this.buttonInner.appendChild(t),this.iconText=this.buttonInner.querySelector("text"),this.accessibleTitle=this.audio?E.listenFromStart:E.liveRestart;let e=this;super.setActionFunction(function(t){e.animateAndTriggerActionFunc(t)})}animateAndTriggerActionFunc(t){let e;const i=this;this.animationID&&cancelAnimationFrame(this.animationID),this.previousIcon?delete this.animationID:this.animationID=requestAnimationFrame(function t(s){let n=i.button.getElementsByClassName("live_restart_arrow")[0];if(window.matchMedia("(prefers-reduced-motion: reduce)").matches||i.previoslyReducedMotion)clearTimeout(i.animTimeout),i.iconText.style.opacity=0,i.button.classList.add("rotated"),i.animTimeout=setTimeout(()=>{i.button.classList.remove("rotated"),i.iconText.style.opacity=1},150);else{void 0===e&&(e=s,i.iconText.style.opacity=0);const o=(s-e)/i.animationDuration*360;i.angle=i.angle-o,i.angle<-360&&(i.angle=-360),n.setAttribute("transform","rotate("+i.angle+",16,16)"),e=s,i.angle>-360?i.animationID=requestAnimationFrame(t):(i.angle=0,i.iconText.style.opacity=1,e=void 0)}}),this.actionFunction(t)}enableIfTimeOkay(t){t.canSeekToLiveReStart||this.previousIcon&&t.underFiveSecsElapsed?this.enable():this.disable()}setActionFunction(t){this.actionFunction=t||function(){}}}customElements.get("smp-live-restart-button")||customElements.define("smp-live-restart-button",co);class ho extends yn{constructor(){super({stylesheet:ro}),this.angle=0,this.animationDuration=600}create(){super.create(),this.button.classList.add("live_edge"),this.buttonInner.appendChild(function(){const t=Cn(22,16,9);t.firstChild.textContent="LIVE";let e=En("g",{class:"live_edge_arrow"}),i=En("path",{d:"M24.75,24.92c-0.09,0.09-0.18,0.18-0.27,0.27c-2.21,2.12-5.22,3.36-8.58,3.36c-6.81,0-12.38-5.57-12.38-12.47\n            S9.1,3.52,15.99,3.52h1.15l-2.3-3.27h2.3l3.45,4.33L17.14,9h-2.3l2.3-3.18l0.09-0.18h-1.15c-5.75,0-10.44,4.69-10.44,10.44\n            s4.69,10.44,10.44,10.44c2.83,0,5.39-1.15,7.34-3.01 M22.27,0.25h-2.39l3.01,4.33L19.89,9h2.3l3.45-4.42L22.27,0.25z"});return e.appendChild(i),t.appendChild(e),t}()),this.iconText=this.buttonInner.querySelector("text"),this.accessibleTitle=E.goToLivePoint;let t=this;super.setActionFunction(function(e){t.animateAndTriggerActionFunc(e)})}animateAndTriggerActionFunc(t){let e;const i=this;this.animationID&&cancelAnimationFrame(this.animationID),this.animationID=requestAnimationFrame(function t(s){let n=i.button.getElementsByClassName("live_edge_arrow")[0];if(window.matchMedia("(prefers-reduced-motion: reduce)").matches)clearTimeout(i.animTimeout),i.iconText.style.opacity=0,i.button.classList.add("rotated"),i.animTimeout=setTimeout(()=>{i.button.classList.remove("rotated"),i.iconText.style.opacity=1},150);else{void 0===e&&(e=s,i.iconText.style.opacity=0);const o=(s-e)/i.animationDuration*360;i.angle=i.angle+o,i.angle>360&&(i.angle=360),n.setAttribute("transform","rotate("+i.angle+",16,16)"),e=s,i.angle<360?i.animationID=requestAnimationFrame(t):(i.angle=0,i.iconText.style.opacity=1,e=void 0)}}),this.actionFunction(t)}enableIfTimeOkay(t){t.canSeekForwards&&!t.blockSeekToEnd?this.enable():this.disable()}setActionFunction(t){this.actionFunction=t||function(){}}}customElements.get("smp-live-edge-button")||customElements.define("smp-live-edge-button",ho);class po extends yn{constructor(){super({stylesheet:":host{display:block}.button,.button svg{overflow:visible}.button svg{height:24px;position:relative;width:24px}.button:not([disabled]).hovering svg{transform:scale(1.18)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}"})}create(){super.create(),"back"===this.direction?(this.buttonInner.appendChild(uo()),this.accessibleTitle=E.previousItem):(this.buttonInner.appendChild(function(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M27.2 1v30H30V1h-2.8zm-9.1 13.3L2 31h6.4L23 16 8.4 1H2l16.1 16.7v-3.4z"});return t.appendChild(e),t}()),this.accessibleTitle=E.nextItem)}get direction(){return this.getAttribute("direction")}enableIfTimeOkay(t,e){e?this.enable():"back"===this.direction?t._playlistModel.previousItemsOrPlaylistAvailable?this.enable():this.disable():t._playlistModel.moreRemainingOrAnotherPlaylist?this.enable():this.disable()}}customElements.get("smp-skip-button")||customElements.define("smp-skip-button",po);const mo=document.createElement("template");mo.innerHTML='<div class="core_controls_container">\n                                    <div class="core_controls_container_inner_wrap">\n                                        <smp-interval-button direction="left" smp-context class="layout_button backward_interval"></smp-interval-button>\n                                        <smp-interval-button direction="right" smp-context class="layout_button forward_interval"></smp-interval-button>\n                                        <smp-skip-button direction="back" smp-context class="layout_button skip_back"></smp-skip-button>\n                                        <smp-skip-button direction="forward" smp-context class="layout_button skip_forward"></smp-skip-button>\n                                        <smp-live-restart-button smp-context class="layout_button live_restart"></smp-live-restart-button>\n                                        <smp-live-edge-button smp-context class="layout_button live_edge"></smp-live-edge-button>\n                                    </div>\n                                 </div>';class go extends Ks{constructor(){super({stylesheet:":host([videoLayout]) .core_controls_container{display:flex;justify-content:center;width:100%}.core_controls_container_inner_wrap{align-items:center;display:flex;justify-content:center;width:100%}:host([videoLayout].smp_B2.fadingOut) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container{--smp-forward-interval-arrow-rotate:0;--smp-backward-interval-arrow-rotate:0}:host([videoLayout].smp_B2.fadingOut) .core_controls_container,:host([videoLayout].smp_B3.fadingOut) .core_controls_container{--smp-forward-interval-arrow-rotate:-15deg;--smp-backward-interval-arrow-rotate:15deg;--smp-interval-arrow-scale:0.9;--smp-interval-iconNumber-scale:0.9}:host([videoLayout]) .layout_button.hidden,:host([videoLayout]) .layout_button.removed{display:none}:host([videoLayout]) smp-play-pause-button{height:64px;width:64px}:host([videoLayout].smp_B2:not(.rightBottom)) smp-play-pause-button{--smp-play-pause-icon-dimension:34px}:host([videoLayout].smp_B2.portrait) smp-play-pause-button{margin-left:16px;margin-right:16px}:host([videoLayout].smp_B4:not(.rightBottom)) smp-play-pause-button{margin-left:26px;margin-right:26px}:host([videoLayout].smp_B4) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container smp-play-pause-button{margin-left:0;margin-right:0}:host([videoLayout].smp_B4.liveMedia) smp-play-pause-button{margin-left:0;margin-right:0}:host([videoLayout].smp_B1.fadedOut) smp-play-pause-button,:host([videoLayout].smp_B2.fadedOut) smp-play-pause-button,:host([videoLayout].smp_B3.fadedOut) smp-play-pause-button{transform:scale(.5);transition:transform .25s cubic-bezier(.79,.09,.48,.96)}:host([videoLayout].smp_B1.fadedIn) smp-play-pause-button,:host([videoLayout].smp_B2.fadedIn) smp-play-pause-button,:host([videoLayout].smp_B3.fadedIn) smp-play-pause-button{transform:scale(1);transition:transform .5s cubic-bezier(.2,0,0,1)}:host([videoLayout].smp_B1.fadingOut) smp-play-pause-button,:host([videoLayout].smp_B2.fadingOut) smp-play-pause-button,:host([videoLayout].smp_B3.fadingOut) smp-play-pause-button{transform:scale(.75);transition:transform .25s ease-in-out}:host([videoLayout]) smp-interval-button{height:64px;width:64px}:host([videoLayout].smp_B3) smp-interval-button,:host([videoLayout].smp_B4) smp-interval-button{--smp-forward-interval-icon-dimension:41px;--smp-forward-interval-icon-number-font-size:14px}:host([videoLayout].smp_B4) smp-interval-button{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0)}:host([videoLayout].smp_B2.fadedOut) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval,:host([videoLayout].smp_B3.fadedOut) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval{right:calc(13% - 32px)}:host([videoLayout].smp_B2.fadedOut) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval,:host([videoLayout].smp_B3.fadedOut) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval{left:calc(13% - 32px)}:host([videoLayout].smp_B2.fadingOut) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval,:host([videoLayout].smp_B3.fadingOut) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval{right:calc(14% - 32px);transition:right .25s cubic-bezier(.2,0,.3,1)}:host([videoLayout].smp_B2.fadingOut) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval,:host([videoLayout].smp_B3.fadingOut) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval{left:calc(14% - 32px);transition:left .25s cubic-bezier(.2,0,.3,1)}:host([videoLayout].smp_B2) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval,:host([videoLayout].smp_B3) :not(.hasNextOrPreviousButtons).core_controls_container .backward_interval{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);position:relative;right:calc(18% - 32px);transition:right .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B2) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval,:host([videoLayout].smp_B3) :not(.hasNextOrPreviousButtons).core_controls_container .forward_interval{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);left:calc(18% - 32px);position:relative;transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B3.fadedOut) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .backward_interval{position:relative;right:calc(11% - 32px)}:host([videoLayout].smp_B3.fadedOut) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .forward_interval{left:calc(11% - 32px);position:relative}:host([videoLayout].smp_B3) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .backward_interval{position:relative;right:calc(13% - 32px);transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B3) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .forward_interval{left:calc(13% - 32px);position:relative;transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B2.liveMedia) .backward_interval,:host([videoLayout].smp_B2.liveMedia) .forward_interval{display:none!important}:host([videoLayout].smp_B3.liveMedia) .hasIntervalButtons.core_controls_container .backward_interval{right:calc(13% - 32px)}:host([videoLayout].smp_B3.liveMedia) .hasIntervalButtons.core_controls_container .forward_interval{left:calc(13% - 32px)}:host(.noSeeking) smp-interval-button{display:none!important}:host([videoLayout]) smp-skip-button{height:64px;width:64px}:host([videoLayout].smp_B2.fadedOut) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_back,:host([videoLayout].smp_B3.fadedOut) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_back{right:calc(14% - 32px);transition:right .25s cubic-bezier(.2,0,.3,1)}:host([videoLayout].smp_B2.fadedOut) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_forward,:host([videoLayout].smp_B3.fadedOut) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_forward{left:calc(14% - 32px);transition:left .25s cubic-bezier(.2,0,.3,1)}:host([videoLayout].smp_B2) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_back,:host([videoLayout].smp_B3) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_back{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);position:relative;right:calc(18% - 32px);transition:right .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B2) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_forward,:host([videoLayout].smp_B3) :not(.hasIntervalButtons).hasNextOrPreviousButtons.core_controls_container .skip_forward{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);left:calc(18% - 32px);position:relative;transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B3.fadedOut) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .skip_back{position:relative;right:calc(18% - 32px)}:host([videoLayout].smp_B3.fadedOut) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .skip_forward{left:calc(18% - 32px);position:relative}:host([videoLayout].smp_B3) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .skip_back{position:relative;right:calc(18% - 16px);transition:right .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B3) .hasIntervalButtons.hasNextOrPreviousButtons.core_controls_container .skip_forward{left:calc(18% - 16px);position:relative;transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B2.swipableY) .skip_forward,:host([videoLayout].smp_B3.swipableY) .skip_forward{left:unset!important;position:absolute!important;right:4px!important;top:50%!important;transform:rotate(90deg)!important}:host([videoLayout].smp_B2.swipableY) .skip_back,:host([videoLayout].smp_B3.swipableY) .skip_back{left:unset!important;position:absolute!important;right:4px!important;top:calc(50% - 64px)!important;transform:rotate(90deg)!important}.skip_back{order:1}.live_restart{order:2}.backward_interval{order:3}smp-audio-play-pause-button,smp-play-pause-button{order:4}.forward_interval{order:5}.live_edge{order:6}.skip_forward{order:7}:host([videoLayout].smp_B1) .live_edge,:host([videoLayout].smp_B1) .live_restart,:host([videoLayout].smp_B1) smp-interval-button,:host([videoLayout].smp_B1) smp-skip-button{display:none}:host([videoLayout]) smp-live-edge-button,:host([videoLayout]) smp-live-restart-button{height:64px;width:64px}:host([videoLayout].smp_B2.fadedOut.liveMedia) .live_restart{right:calc(13% - 32px)}:host([videoLayout].smp_B2.fadedOut.liveMedia) .live_edge{left:calc(13% - 32px)}:host([videoLayout].smp_B2.liveMedia) .live_restart{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);position:relative;right:calc(18% - 32px);transition:right .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B2.liveMedia) .live_edge{--smp-interval-button-transition:transform 0.5s cubic-bezier(0.0,0.81,0.23,1.0);left:calc(18% - 32px);position:relative;transition:left .5s cubic-bezier(0,.81,.23,1)}:host([videoLayout].smp_B3.liveMedia) .live_restart{position:relative;right:calc(18% - 16px)}:host([videoLayout].smp_B3.liveMedia) .live_edge{left:calc(18% - 16px);position:relative}:host(.noSeeking) smp-live-edge-button,:host(.noSeeking) smp-live-restart-button{display:none!important}:host([audioLayout]) .core_controls_container{align-items:center;display:flex}:host([audioLayout]) .layout_button{display:block;opacity:1}:host([audioLayout]) .layout_button.hidden,:host([audioLayout]) .layout_button.removed{display:none;opacity:0}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) .layout_button,:host([audioLayout].slim_controls.slim_height) .layout_button{height:44px;width:44px}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows):not(.smp_B2)) smp-interval-button.backward_interval,:host([audioLayout].slim_controls.slim_height) smp-interval-button.backward_interval{margin-left:16px}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows):not(.smp_B2)) smp-interval-button.forward_interval,:host([audioLayout].slim_controls.slim_height) smp-interval-button.forward_interval{margin-right:16px}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-audio-play-pause-button.layout_button,:host([audioLayout].slim_controls.slim_height) smp-audio-play-pause-button.layout_button{height:52px;width:52px}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-interval-button,:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-live-edge-button,:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) smp-live-restart-button,:host([audioLayout].slim_controls.slim_height) smp-interval-button,:host([audioLayout].slim_controls.slim_height) smp-live-edge-button,:host([audioLayout].slim_controls.slim_height) smp-live-restart-button{--smp-forward-interval-icon-dimension:32px}@media (prefers-reduced-motion:no-preference){:host([audioLayout].state-transition) .layout_button:not(.removed){transition-behavior:allow-discrete;transition-duration:1.5s;transition-property:opacity,display}}@starting-style{:host([audioLayout]) .layout_button{opacity:0}}:host([audioLayout]) smp-audio-play-pause-button{height:64px;margin:0 16px;width:64px}:host([audioLayout]) smp-audio-play-pause-button.smp_B2,:host([audioLayout]:not(.B3_over_600)) smp-audio-play-pause-button.smp_B3{margin:0 8px}:host([audioLayout]) smp-interval-button{--smp-forward-interval-icon-dimension:42px;--smp-interval-button-transition:transform 1s;--smp-forward-interval-arrow-rotate:0;--smp-backward-interval-arrow-rotate:0;height:64px;width:64px}@media (prefers-reduced-motion:no-preference){:host([audioLayout].playback-state) :not(.hasNextOrPreviousButtons) smp-interval-button{--smp-forward-interval-starting-rotate:-45deg;--smp-backward-interval-starting-rotate:45deg}}@media (prefers-reduced-motion:no-preference){:host([audioLayout].playback-state) :not(.hasNextOrPreviousButtons) smp-interval-button.hidden,:host([audioLayout].playback-state) :not(.hasNextOrPreviousButtons) smp-interval-button.removed{--smp-forward-interval-arrow-rotate:-45deg;--smp-backward-interval-arrow-rotate:45deg}}:host([audioLayout]) smp-live-edge-button,:host([audioLayout]) smp-live-restart-button{height:64px;width:64px}:host([audioLayout].small_B2) smp-live-edge-button,:host([audioLayout].small_B2) smp-live-restart-button{height:48px;width:48px}:host([audioLayout]) smp-skip-button{height:64px;width:64px}:host([audioLayout].small_B2) smp-skip-button{height:48px;width:48px}",template:mo,templateName:"coreControls"}),this.idealWidth=0}create(){super.create();const t=this.shadowRoot.querySelector(".core_controls_container");this.outerContainer=t,this.isAudio?(this.playPauseButton=new so,this.playPauseButton.classList.add("layout_button")):(this.playPauseButton=new io,this.playPauseButton.classList.add("layout_button","play_pause")),this.playPauseButton.setAttribute("smp-context",""),this.subgroups.push(this.playPauseButton),this.forwardIntervalButton=t.getElementsByClassName("forward_interval")[0],this.backwardIntervalButton=t.getElementsByClassName("backward_interval")[0],this.liveRestartButton=t.getElementsByClassName("live_restart")[0],this.liveEdgeButton=t.getElementsByClassName("live_edge")[0],this.skipBackButton=t.getElementsByClassName("skip_back")[0],this.skipForwardButton=t.getElementsByClassName("skip_forward")[0],this.innerWrap=t.getElementsByClassName("core_controls_container_inner_wrap")[0],this.innerWrap.prepend(this.playPauseButton),this.isAudio&&(this.playPauseButton.classList.add("audio_ui"),this.forwardIntervalButton.classList.add("audio_ui"),this.backwardIntervalButton.classList.add("audio_ui"),this.liveRestartButton.classList.add("audio_ui"),this.liveEdgeButton.classList.add("audio_ui"),this.skipForwardButton.classList.add("audio_ui"),this.skipBackButton.classList.add("audio_ui"))}onRooted(){var t;this.updateSettings(this.settings),this.updateUiConfig(this.uiConfig),(t=this).playPauseButton.setActionFunction(function(e){const i=mi(e),s=t.toucanPlayer.paused?zi:Ui;t.echoReporter.trackAction(s,i),t.eventBus.trigger("play-toggle",e)}),t.forwardIntervalButton.setActionFunction(yo.bind(null,t)),t.backwardIntervalButton.setActionFunction(yo.bind(null,t)),t.liveRestartButton.setActionFunction(vo.bind(null,t)),t.liveEdgeButton.setActionFunction(_o.bind(null,t)),t.skipBackButton.setActionFunction(ko.bind(null,t)),t.skipForwardButton.setActionFunction(wo.bind(null,t)),function(t){const e=t.eventBus;e.bind(["playing","tryingToPlay"],()=>{t.pause()}),e.bind(["play","playbackBegin"],()=>{t.pause(),bo(t)}),e.bind(["notableTimechange","queueChanged","playing"],()=>{bo(t)}),e.bind("pause",e=>{e.target.ended||t.play()}),e.bind("playlistEnded",e=>{!t.toucanPlayer.settings.noAutomaticNextQueued&&e.detail.queuedPlaylist||t.play()}),e.bind("mediaItemChanged",()=>{t.toucanPlayer.isLive?t.classList.add("liveMedia"):t.classList.remove("liveMedia"),t.liveRestartButton.audio="audio"==t.toucanPlayer.contentType,t.determineButtonSetForPlayback()}),e.bind("waitingForPlugins",()=>{t.playPauseButton.loading=!0,t.playPauseButton.buffering=!0}),e.bind("playlistLoaded",()=>{t.playPauseButton.loading=!1}),e.bind("showBuffer",()=>{t.playPauseButton.buffering=!0}),e.bind("hideBuffer",()=>{t.playPauseButton.buffering=!1}),e.bind("webcastDataUpdated",()=>{t.determineButtonSetForPlayback()}),e.bind("playerSizeChange",()=>{t.determineButtonSetForPlayback()}),e.bind("focusButton",e=>{let i=!1;if(e.group)return"core"==e.group&&(i=!Oi(t.nameMap,0),i)?void t.dispatchEvent(new CustomEvent("focusGroup",{bubbles:!0,composed:!0,detail:{group:"secondary"}})):void 0;let s=t.nameMap[e.name];if(s)if(e.after){if(i=!Oi(t.nameMap,s.index+1),i)return void t.dispatchEvent(new CustomEvent("focusGroup",{bubbles:!0,composed:!0,detail:{group:"secondary"}}))}else{let e=s.button;e&&(i=!Ii(e)),i&&t.eventBus.trigger("focusOnPlayPause")}}),t.playPauseButton.addEventListener("pointerenter",fo.bind(t)),t.playPauseButton.addEventListener("focus",fo.bind(t))}(this),this.nameMap={"play-pause":{button:this.playPauseButton,index:0},"back-interval":{button:this.backwardIntervalButton,index:1},"forward-interval":{button:this.forwardIntervalButton,index:2},previous:{button:this.skipBackButton,index:3},next:{button:this.skipForwardButton,index:4},"live-restart":{button:this.liveRestartButton,index:5},"jump-to-live":{button:this.liveEdgeButton,index:6}},this.dispatchEvent(new CustomEvent("takeFocusNames",{bubbles:!0,composed:!0,detail:{names:Object.keys(this.nameMap)}}))}focusOnPlayPauseBtn(){this.playPauseButton.takeFocus()}updateSettings(t){super.updateSettings(t)}updateUiConfig(t){const e=t.controls;this.determineButtonSetForPlayback(),e.includeForwardIntervalButton||e.includeBackIntervalButton?(this.outerContainer.classList.add("hasIntervalButtons"),this.hasIntervalButtons=!0):(this.outerContainer.classList.remove("hasIntervalButtons"),this.hasIntervalButtons=!1),e.includePreviousButton||e.includeNextButton?this.outerContainer.classList.add("hasNextOrPreviousButtons"):this.outerContainer.classList.remove("hasNextOrPreviousButtons"),e.displayJumpButtonText?(this.liveRestartButton.classList.remove("no_text"),this.liveEdgeButton.classList.remove("no_text")):(this.liveRestartButton.classList.add("no_text"),this.liveEdgeButton.classList.add("no_text")),isNaN(t.skipInterval)||(this.forwardIntervalButton.interval=this.backwardIntervalButton.interval=t.skipInterval)}set mode(t){this._mode=t,"cta"==t?(this.playPauseButton.ctaState=!0,this.forwardIntervalButton.hide(),this.backwardIntervalButton.hide(),this.liveEdgeButton.hide(),this.liveRestartButton.hide(),this.skipBackButton.hide(),this.skipForwardButton.hide()):(this.playPauseButton.ctaState=!1,this.forwardIntervalButton.show(),this.backwardIntervalButton.show(),this.liveEdgeButton.show(),this.liveRestartButton.show(),this.skipBackButton.show(),this.skipForwardButton.show());let e=this.innerWrap.offsetWidth;this.idealWidth=e,e>this.widthAvailable&&this.reduceControls(e-this.widthAvailable)}get mode(){return this._mode}get isAudio(){return this.hasAttribute("audioLayout")}pause(){this.playPauseButton.pause()}play(){this.playPauseButton.play()}get playPauseLeftBoundary(){return this.playPauseButton.getBoundingClientRect().left}get leftBoundary(){let t;for(const e of this.outerContainer.children)if("none"!==window.getComputedStyle(e).getPropertyValue("display")){const i=e.getBoundingClientRect().left;(void 0===t||i<t)&&(t=i)}return t}set widthAvailable(t){this._widthAvailable!==t&&(this._widthAvailable=t,this.determineButtonSetForPlayback(),this.dispatchEvent(new CustomEvent("coreControlsWidthAvailableSet",{bubbles:!0,composed:!0,detail:"default"})))}get widthAvailable(){return this._widthAvailable}set playPauseOnly(t){this._playPauseOnly=t,this.determineButtonSetForPlayback()}get playPauseOnly(){return this._playPauseOnly}reduceControls(t){let e;const i=this.toucanPlayer.isLive;e=this.rollingBroadcastLiveAudio?[[this.forwardIntervalButton,this.backwardIntervalButton],[this.skipBackButton,this.liveEdgeButton]]:i?[[this.skipForwardButton,this.skipBackButton],[this.forwardIntervalButton,this.backwardIntervalButton],[this.liveEdgeButton,this.liveRestartButton]]:[[this.skipForwardButton,this.skipBackButton],[this.forwardIntervalButton,this.backwardIntervalButton]];let s=[];for(const i of e)if("none"!==window.getComputedStyle(i[0]).getPropertyValue("display")||"none"!==window.getComputedStyle(i[1]).getPropertyValue("display")){s.push(i[0],i[1]);if(s.reduce(function(t,e){return t+e.offsetWidth},0)>=t)break}for(const t of s)t.remove()}determineButtonSetForPlayback(){if(this.isAudio&&this.classList.contains("smp_B1"))return this.playPauseButton.show(),void[this.forwardIntervalButton,this.backwardIntervalButton,this.liveEdgeButton,this.liveRestartButton,this.skipBackButton,this.skipForwardButton].forEach(t=>{t.remove()});const t=this.uiConfig.controls,e=this.toucanPlayer.isLive;this.liveRestartButton.previousIcon=this.rollingBroadcastLiveAudio;const i=t.mode&&"rightBottom"===t.mode;this.playPauseButton.show(),this.forwardIntervalButton.restoreRemove(!this._playPauseOnly&&t.includeForwardIntervalButton&&!i),this.backwardIntervalButton.restoreRemove(!this._playPauseOnly&&t.includeBackIntervalButton&&!i),this.liveEdgeButton.restoreRemove(!this._playPauseOnly&&e&&t.includeJumpToLiveButton&&!i),this.liveRestartButton.restoreRemove(!this._playPauseOnly&&e&&t.includeLiveRestartButton&&!i),this.skipBackButton.restoreRemove(!this._playPauseOnly&&!e&&t.includePreviousButton&&!i),this.skipForwardButton.restoreRemove(!this._playPauseOnly&&!e&&t.includeNextButton&&!i);let s=this.innerWrap.offsetWidth;this.idealWidth=s,this.isAudio&&s>this.widthAvailable&&this.reduceControls(s-this.widthAvailable),bo(this);let n=0;this.outerContainer.querySelectorAll(".layout_button").forEach(function(t){t.removed||n++}),this.buttonCount=n}get rollingBroadcastLiveAudio(){const t=this.toucanPlayer.webcastData;return this.isAudio&&this.toucanPlayer.isLive&&!(t&&(t.accurateStartTime||t.scheduledStartTime))}}function bo(t){let e=t.toucanPlayer.playbackController,i=!1;if(e.canSeek){t.classList.contains("noSeeking")&&(t.classList.remove("noSeeking"),i=!0),t.forwardIntervalButton.enableIfTimeOkay(e),t.backwardIntervalButton.enableIfTimeOkay(e),t.liveEdgeButton.enableIfTimeOkay(e),t.liveRestartButton.enableIfTimeOkay(e);const s=e._playlistModel,n=s._playlist.previousPlaylist,o=t.toucanPlayer.uiSettings.controls.alwaysEnablePreviousButton,a=n||o;t.skipBackButton.enableIfTimeOkay(e,a);const r=s.moreRemainingOrAnotherPlaylistAvailable,l=t.toucanPlayer.uiSettings.controls.alwaysEnableNextButton,u=r||l;t.skipForwardButton.enableIfTimeOkay(e,u),t.noSeeking=!1}else t.classList.contains("noSeeking")||(t.classList.add("noSeeking"),i=!0,t.noSeeking=!0);if(i){let e=t.innerWrap.offsetWidth;t.idealWidth=e,t.isAudio&&e>t.widthAvailable&&t.reduceControls(e-t.widthAvailable)}}function fo(t){const e=this;let i;function s(){e.playPauseButton.removeEventListener("pointerleave",s),e.playPauseButton.removeEventListener("blur",s),e.dispatchEvent(new CustomEvent("bufferIconScale",{bubbles:!0,composed:!0,detail:"default"}))}("focus"==t.type&&e.playPauseButton.hasFocusVisible||"pointerenter"==t.type&&"mouse"==t.pointerType)&&(i="increase"),"pointerenter"!=t.type||"touch"!==t.pointerType&&"pen"!==t.pointerType||(i="shrink"),i&&(e.dispatchEvent(new CustomEvent("bufferIconScale",{bubbles:!0,composed:!0,detail:i})),e.playPauseButton.addEventListener("pointerleave",s),e.playPauseButton.addEventListener("blur",s))}function yo(t,e,i){t.eventBus.trigger("seek-requested",{interval:i});const s=mi(e),n=1===Math.sign(i)?Ki:$i;t.echoReporter.trackAction(n,s)}function vo(t,e){t.eventBus.trigger("live-restart-seek-requested");const i=mi(e),s=cs;t.echoReporter.trackAction(s,i)}function _o(t,e){t.eventBus.trigger("live-edge-seek-requested");const i=mi(e),s=ds;t.echoReporter.trackAction(s,i)}function ko(t,e){t.toucanPlayer.uiSettings.controls.previousNextJustEvents?t.eventBus.trigger("previousRequested"):t.eventBus.trigger("skip-back-requested",{isLive:t.toucanPlayer.isLive,method:"button"});const i=mi(e),s=hs;t.echoReporter.trackAction(s,i)}function wo(t,e){t.toucanPlayer.uiSettings.controls.previousNextJustEvents?t.eventBus.trigger("nextRequested"):t.eventBus.trigger("skip-forward-requested",{method:"button"});const i=mi(e),s=ps;t.echoReporter.trackAction(s,i)}customElements.get("smp-core-controls")||customElements.define("smp-core-controls",go);function To(t){const e=En("svg",{class:t,viewBox:"0 0 40 40"}),i=En("path",{d:"M3,3h10v3h-10v10H0v-10V3H3zM3,24H0v10v3h3h10v-3h-10V24zM37,34h-10v3h10H40v-3v-10h-3V34zM37,3h-10v3h10v10H40v-10V3H37z"});return e.appendChild(i),e}function Eo(t){const e=En("svg",{class:t,viewBox:"0 0 48 48"}),i=En("path",{d:"M12,3h3v12v3H12H0v-3h12V3zM0,29v3h12v12h3v-12v-3H12H0zM33,29v3v12H36v-12h12v-3h-12H33zM36,15v-12h-3v12v3H36h12v-3H36z"});return e.appendChild(i),e}function Co(t){const e=En("svg",{class:t,viewBox:"0 0 32 32"}),i=En("path",{d:"M18.11,16.5l8.74,8.74l-2.12,2.12L16,18.62l-8.74,8.74l-2.11-2.11l8.74-8.74L5.14,7.77l2.12-2.12L16,14.39l8.74-8.74l2.11,2.11L18.11,16.5z"});return e.appendChild(i),e}class So extends Zn{constructor(){super({stylesheet:":host{display:block}.enter_fullscreen_button,.exit_fullscreen_button{height:20px;width:20px}:host(.smp_B4) .enter_fullscreen_button,:host(.smp_B4) .exit_fullscreen_button{height:22px;width:22px}.exit_fullscreen_button.close{height:23px;width:23px}:host(.smp_B4) .exit_fullscreen_button.close{height:25px;width:25px}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}",svgOn:To("enter_fullscreen_button"),svgOff:Eo("exit_fullscreen_button"),alternativeSvgOff:Co("exit_fullscreen_button close"),labelOn:E.toolTipEnterFullScreen,labelOff:E.toolTipExitFullScreen}),this.setEnterState=this.on,this.setExitState=this.off}get useCloseIcon(){return this.useAlternateOff}set useCloseIcon(t){this.useAlternateOff=t}}customElements.get("smp-fullscreen-button")||customElements.define("smp-fullscreen-button",So);var Bo=":host{display:block}svg{height:var(--smp-secondary-controls-svg-dimension,20px);width:var(--smp-secondary-controls-svg-dimension,20px)}:host(.smp_B4) svg{height:var(--smp-secondary-controls-svg-dimension,22px);width:var(--smp-secondary-controls-svg-dimension,22px)}:host(.slim_controls.show_slim_controls:not(.three_rows)) svg,:host(.slim_controls.slim_height) svg{height:16px;width:16px}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}";function xo(t){const e=En("svg",{class:t,viewBox:"0 0 32 32"}),i=En("path",{d:"M29.7,2.4H2.3c-1.2,0-2.3,1-2.3,2.3v17.1c0,1.2,1,2.3,2.3,2.3h11.6l0,8l8.4-8h7.4c1.2,0,2.3-1,2.3-2.3V4.6\n\t\t\tC32,3.4,30.9,2.4,29.7,2.4z M20.6,21.7l-4.4,4.7l0-4.7l-13.9,0l0-17.1h27.4l0,17.1H20.6z M22.8,13.8H9.2v-2.3h13.7V13.8z M4.6,16.1\n\t\t\tH16v2.3H4.6V16.1z M18.3,16.1h9.1v2.3h-9.1V16.1z"});return e.appendChild(i),e}function Po(t){const e=En("svg",{class:t,viewBox:"0 0 32 32"}),i=En("path",{d:"M29.7,2.4H2.3c-1.2,0-2.3,1-2.3,2.3v17.1c0,1.3,1,2.3,2.3,2.3h11.6l0,8l8.4-8h7.4c1.2,0,2.3-1,2.3-2.3V4.6\n\t\t\tC32,3.4,30.9,2.4,29.7,2.4z M9.2,11.5h13.7v2.3H9.2V11.5z M16,18.4H4.6v-2.3H16V18.4z M27.4,18.4h-9.1v-2.3h9.1V18.4z"});return e.appendChild(i),e}class Lo extends Zn{constructor(){super({stylesheet:Bo,svgOff:xo("turn_subs_on"),svgOn:Po("turn_subs_off")}),this._opensPanel=!0,this._panelOpen=!1,this._showAD=!1,this.setEnterState=this.on,this.setExitState=this.off}connectedCallback(){super.connectedCallback(),this.off()}set opensPanel(t){this._opensPanel=t,this.accessibleTitle=this.accTitle}get opensPanel(){return this._opensPanel}set panelOpen(t){this._panelOpen=t,this.accessibleTitle=this.accTitle}get panelOpen(){return this._panelOpen}get showAD(){return this._showAD}set showAD(t){this._showAD!=t&&(this._showAD=t,this.accessibleTitle=this.accTitle)}get showSubs(){return this._showSubs}set showSubs(t){this._showSubs!=t&&(this._showSubs=t,this.accessibleTitle=this.accTitle)}get accTitle(){let t="";return t=this.opensPanel?this._showAD?this._showSubs?this.panelOpen?E.closeSubtitlesAndADmenu:E.openSubtitlesAndADmenu:this.panelOpen?E.closeADsMenu:E.openADMenu:this.panelOpen?E.closeSubtitlesMenu:E.openSubtitlesMenu:this.isOn?E.toolTipSubtitlesOff:E.toolTipSubtitlesOn,t}}customElements.get("smp-subtitles-button")||customElements.define("smp-subtitles-button",Lo);class Ao extends Zn{constructor(){super({stylesheet:Bo,svgOff:xo("turn_subs_on"),svgOn:Po("turn_subs_off")}),this.setEnterState=this.on,this.setExitState=this.off}connectedCallback(){super.connectedCallback(),this.off()}get accTitle(){let t="";return t=this.isOn?E.toolTipTranscriptionOff:E.toolTipTranscriptionOn,t}}customElements.get("smp-transcription-button")||customElements.define("smp-transcription-button",Ao);const Io=document.createElement("template");Io.innerHTML='<div class="toggle toggle_on" role="checkbox" aria-checked="true" aria-hidden="false" tabindex="0">\n                                    <div class="toggleSlot">\n                                        <div class="toggleSlider">\n                                            <div class="tick"></div>\n                                        </div>\n                                    </div>\n                                </div>';class Oo extends le{constructor(){super({stylesheet:".toggle{display:block;height:44px;outline:0;position:relative;user-select:none;width:64px}.toggle:focus-visible{outline:2px solid var(--smp-colour-toggle-focus-visible,#fff)}.toggle.forced_focus:focus-visible{outline:none}.toggleSlot{background-color:#a4a4a4;border:1px solid #a4a4a4;border-radius:12px;box-sizing:border-box;cursor:pointer;height:24px;margin:0;padding:0;position:absolute;right:12px;top:10px;width:40px}.toggle_on .toggleSlot{background-color:var(--smp-colour,#000);border-color:var(--smp-colour,#fff)}.toggleSlider{background-color:var(--smp-toggle-slider-button-background-color-off,#000);-webkit-border-radius:9px;-moz-border-radius:9px;border-radius:9px;display:block;height:18px;left:2px;position:absolute;top:2px;width:18px}:host(:not(.initialising)) .toggleSlider{transition:left .2s linear}.toggle_on .toggleSlider{background-color:var(--smp-toggle-slider-button-background-color,#fff)}.toggleSlider .tick{border:var(--smp-colour-toggle-border,solid #000);border-width:0 2px 2px 0;height:8px;left:7px;opacity:0;position:absolute;top:3px;transform:rotate(45deg);width:3px}.toggle_on .toggleSlider{left:18px}.toggle_on .toggleSlider .tick{opacity:1}",template:Io,templateName:"toggleButton"}),d.needsPreventDefaultToNotLosePanelFocus&&(this.preventDefaultOnPressed=!0)}create(){super.create(),fi(this,No.bind(this)),yi(this,Ro.bind(this));const t=this;bi(this.toggleButton,["pointerup","keyup"],function(e){const i=e.keyCode;"keyup"!=e.type||i!=ci&&i!=di?"pointerup"==e.type&&t.flip():(e.stopPropagation(),e.preventDefault(),t.keyIsDown&&t.flip(!0),t.keyIsDown=!1)},!0),this.toggleButton.addEventListener("blur",function(){t.keyIsDown=!1}),this.toggleButton.addEventListener("keydown",function(e){e.keyCode!=di&&e.keyCode!=ci||(t.keyIsDown=!0,e.stopPropagation(),e.preventDefault())}),this.toggleButton.addEventListener("pointerdown",function(e){t.preventDefaultOnPressed&&(e.preventDefault(),t.forcedBlur=!0,t.toggleButton.blur(),t.toggleButton.classList.add("forced_focus"),t.toggleButton.focus(),t.forcedBlur=!1),e.stopPropagation()}),this.toggleButton.addEventListener("keyup",function(){t.preventDefaultOnPressed&&t.toggleButton.classList.remove("forced_focus")}),this.addEventListener("dblclick",function(t){t.stopPropagation(),t.preventDefault()}),this.toggleButton.setAttribute("aria-label",this.toggleLabel),this.toggleButton.setAttribute("title",this.offTitle),this.toggleButton.setAttribute("aria-checked","false"),this.toggleButton.classList.remove("toggle_on"),this._on=!1}get toggleLabel(){return this.getAttribute("toggle-label")||""}set toggleLabel(t){this.toggleLabel!=t&&(this.setAttribute("toggle-label",t),this.toggleButton&&this.toggleButton.setAttribute("aria-label",t))}get offTitle(){return this.getAttribute("off-title")||""}set offTitle(t){this.offTitle!=t&&(this.setAttribute("off-title",t),this.toggleButton&&this.toggleButton.setAttribute("title",t))}get onTitle(){return this.getAttribute("on-title")||""}set onTitle(t){this.onTitle!=t&&(this.setAttribute("on-title",t),this.toggleButton&&this.toggleButton.setAttribute("title",t))}flip(t){"true"==this.toggleButton.getAttribute("aria-checked")?this.setOff(t):this.setOn(t)}removeTabindex(){this.toggleButton.tabIndex=-1}addTabindex(){this.toggleButton.tabIndex=0}initialise(t){this.classList.add("initialising"),t?this.setOn(!1,!0):this.setOff(!1,!0),this.classList.remove("initialising")}setState(t){t!=this._on&&(t?this.setOn(!1,!0):this.setOff(!1,!0))}setOn(t,e){if(!this._on&&(this.toggleButton.setAttribute("aria-checked","true"),this.toggleButton.classList.add("toggle_on"),this.toggleButton.setAttribute("title",this.onTitle),this._on=!0,!e)){const e=new CustomEvent("toggleOn",{detail:{fromKeyboard:t}});this.dispatchEvent(e)}}setOff(t,e){if(this._on&&(this.toggleButton.setAttribute("aria-checked","false"),this.toggleButton.classList.remove("toggle_on"),this.toggleButton.setAttribute("title",this.offTitle),this._on=!1,!e)){const e=new CustomEvent("toggleOff",{detail:{fromKeyboard:t}});this.dispatchEvent(e)}}focus(){this.toggleButton.focus()}}function No(){this.classList.add("hovering"),this.setAttribute("interacting","interacting")}function Ro(){this.classList.remove("hovering"),this.classList.contains("pressed")||this.removeAttribute("interacting")}customElements.get("smp-toggle")||customElements.define("smp-toggle",Oo);class Fo extends yn{static get observedAttributes(){return["size"]}constructor(){super({stylesheet:":host{display:block}.button{height:44px;width:44px}.button svg{height:32px;width:32px}.button:focus-visible{outline:2px solid var(--smp-colour,#fff);position:relative;z-index:1}.button.touched svg{transform:scale(.8)}.button:not([disabled]).hovering svg{fill:var(--smp-base-colour,#fff)}.button:not([disabled]).hovering{background-color:var(--smp-setting-overlay-outline-hover,#545658)}.lineIndicator{background-color:var(--smp-setting-overlay-line-indicator,#fff);bottom:4px;height:2px;opacity:0;position:absolute;transition:all .2s ease-in-out;width:40px}.lineIndicator.visible{opacity:1}"}),d.needsPreventDefaultToNotLosePanelFocus&&(this.preventDefaultOnPressed=!0,this.stopPropagationOnPressed=!0)}create(){super.create(),this.isOn=!1,this.button.setAttribute("aria-pressed","false"),this.buttonInner.appendChild(Cn(16,16,10)),this.buttonContent=this.buttonInner.querySelector("text"),this.buttonContent.textContent=E.aa,this.lineIndicator=document.createElement("div"),this.lineIndicator.className="lineIndicator",this.buttonInner.appendChild(this.lineIndicator),this.render()}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){switch(super.render(),this.size){case"xs":this.buttonContent.setAttribute("font-size",9),this.button.setAttribute("aria-label",E.useSmallestFontSize),this.button.title=E.useSmallestFontSize;break;case"s":this.buttonContent.setAttribute("font-size",11),this.button.setAttribute("aria-label",E.useSmallFontSize),this.button.title=E.useSmallFontSize;break;case"m":default:this.buttonContent.setAttribute("font-size",14),this.button.setAttribute("aria-label",E.useMediumFontSize),this.button.title=E.useMediumFontSize;break;case"l":this.buttonContent.setAttribute("font-size",17),this.button.setAttribute("aria-label",E.useLargeFontSize),this.button.title=E.useLargeFontSize;break;case"xl":this.buttonContent.setAttribute("font-size",20),this.button.setAttribute("aria-label",E.useLargestFontSize),this.button.title=E.useLargestFontSize}}set size(t){this.setAttribute("size",t)}get size(){return this.getAttribute("size")}on(){this.isOn||(this.isOn=!0,this.button.setAttribute("aria-pressed","true"),this.lineIndicator.classList.add("visible"))}off(){this.isOn&&(this.isOn=!1,this.button.setAttribute("aria-pressed","false"),this.lineIndicator.classList.remove("visible"))}}customElements.get("smp-subtitles-size-button")||customElements.define("smp-subtitles-size-button",Fo);const Do=document.createElement("template");Do.innerHTML='<div class="header"><div class="title title_header"></div></div>';class Mo extends le{static get observedAttributes(){return["titleText"]}constructor(){super({stylesheet:".header{align-items:center;border-bottom:1px solid var(--smp-setting-overlay-outline,#545658);display:flex;justify-content:flex-end;min-height:43px}.title.title_header{cursor:default;font-size:1rem;left:0;margin-left:0;padding:8px;pointer-events:none;text-align:center;width:100%}",template:Do,templateName:"panelHeader"})}create(){super.create(),this.textField=this.panelHeader.getElementsByClassName("title_header")[0]}set titleText(t){this.textField.textContent=t}get titleText(){return this.textField.textContent}get fontSize(){const t=this.panelHeader.getElementsByClassName("title_header")[0];return parseFloat(getComputedStyle(t).getPropertyValue("font-size"))}}customElements.get("smp-panel-header")||customElements.define("smp-panel-header",Mo);const Ho=document.createElement("template");Ho.innerHTML='<div class="wrap">\n                                                <div class="up_arrow"></div>\n                                                <smp-panel-header aria-hidden="true"></smp-panel-header>\n                                                <div class="header adThing">\n                                                    <div class="ad_title_header title_header" aria-hidden="true"></div>\n                                                    <smp-toggle class="ad_toggle" smp-tabbable></smp-toggle>\n                                                </div>\n                                                <div class="header subsThing">\n                                                    <div class="sub_title_header title_header"r aria-hidden="true"></div>\n                                                    <smp-toggle class="subs_toggle" smp-tabbable></smp-toggle>\n                                                </div>\n                                                <div class="sizeButtons buttons_wrap subsThing subsCustom">\n                                                    <smp-subtitles-size-button size="xs" class="smallest" smp-tabbable></smp-subtitles-size-button>\n                                                    <smp-subtitles-size-button size="s" class="small" smp-tabbable></smp-subtitles-size-button>\n                                                    <smp-subtitles-size-button size="m" class="medium" smp-tabbable></smp-subtitles-size-button>\n                                                    <smp-subtitles-size-button size="l" class="large" smp-tabbable></smp-subtitles-size-button>\n                                                    <smp-subtitles-size-button size="xl" class="largest" smp-tabbable></smp-subtitles-size-button>\n                                                </div>\n                                                <smp-quality-setting-button icon="externalLink" class="customise_button subsThing subsCustom" smp-context smp-tabbable></smp-quality-setting-button>\n                                                <div class="down_arrow"></div>\n                                            </div>';class qo extends Ks{static get observedAttributes(){return["selected"]}constructor(){super({stylesheet:":host{display:block}.wrap{fill:var(--smp-overlay-panels-controls-fill,#fff);background-color:var(--smp-setting-overlay,#3a3c3e);border:1px solid var(--smp-setting-overlay-outline,#545658);box-shadow:1px 1px 8px 4px var(--smp-setting-overlay-box-shadow,rgba(84,86,88,.25));box-sizing:border-box;display:flex;flex-direction:column;min-width:var(--smp-panels-min-width,0);opacity:0;pointer-events:none;transition:all .35s ease-in-out;visibility:hidden;width:277px}.visible{opacity:1;pointer-events:auto;visibility:visible}.header{align-items:center;border-bottom:1px solid var(--smp-setting-overlay-outline,#545658);display:flex;justify-content:flex-end;min-height:43px}.buttons_wrap{align-items:flex-start;display:flex;justify-content:space-between;width:100%}:host(.customise_enabled) .buttons_wrap{display:none}.title_header{cursor:default;font-size:.875rem;left:0;margin-left:16px;pointer-events:none;width:100%}.header.adThing{position:relative;top:1px}.down_arrow{bottom:-4.5px;display:var(--smp-subtitles-settings-panel-down-arrow-display,none);transform:rotate(225deg)}.down_arrow,.up_arrow{background:var(--smp-setting-overlay,#3a3c3e);border:1px solid var(--smp-setting-overlay-outline,#545658);clip-path:polygon(0 0,0 100%,100% 0);height:10px;position:absolute;right:var(--smp-subtitles-settings-panel-arrow-right,none);width:10px}.up_arrow{display:var(--smp-subtitles-settings-panel-up-arrow-display,none);top:-5px;transform:rotate(45deg)}.customise_button{display:none}:host(.customise_enabled) .customise_button{--smp-highlight-button-circle-radius:0;border-top:1px solid #404040;display:block}",template:Ho,templateName:"subtitlesSettingsPanel"})}create(){super.create(),this.titleHeader=this.subtitlesSettingsPanel.getElementsByTagName("smp-panel-header")[0],this.titleHeader.titleText=E.subsADTitle,this.subTitleHeader=this.subtitlesSettingsPanel.getElementsByClassName("sub_title_header")[0],this.subTitleHeader.textContent=E.subtitles,this.adTitleHeader=this.subtitlesSettingsPanel.getElementsByClassName("ad_title_header")[0],this.adTitleHeader.textContent=E.audioDescription,this.adToggle=this.subtitlesSettingsPanel.getElementsByClassName("ad_toggle")[0],this.adToggle.toggleLabel=E.audioDescription,this.adToggle.onTitle=E.toolTipADTurnedOn,this.adToggle.offTitle=E.toolTipADTurnedOff,this.subsToggle=this.subtitlesSettingsPanel.getElementsByClassName("subs_toggle")[0],this.subsToggle.toggleLabel=E.subtitles,this.subsToggle.onTitle=E.toolTipSubtitlesTurnedOn,this.subsToggle.offTitle=E.toolTipSubtitlesTurnedOff,this.sizeButtons=this.subtitlesSettingsPanel.getElementsByClassName("sizeButtons")[0],this.smallestButton=this.subtitlesSettingsPanel.getElementsByClassName("smallest")[0],this.smallButton=this.subtitlesSettingsPanel.getElementsByClassName("small")[0],this.mediumButton=this.subtitlesSettingsPanel.getElementsByClassName("medium")[0],this.largeButton=this.subtitlesSettingsPanel.getElementsByClassName("large")[0],this.largestButton=this.subtitlesSettingsPanel.getElementsByClassName("largest")[0],this.customiseButton=this.subtitlesSettingsPanel.getElementsByClassName("customise_button")[0],this.customiseButton.setAttribute("primary-text",E.customiseButtonPrimary),this.customiseButton.setAttribute("secondary-text",E.customiseButtonSecondary),this.subtitlesSettingsPanel.setAttribute("aria-hidden","true"),this.subsToggle.toggleButton.setAttribute("aria-hidden","true"),this.adToggle.toggleButton.setAttribute("aria-hidden","true"),fi(this,Wo.bind(this)),yi(this,Vo.bind(this));const t=jo.bind(this),e=Go.bind(this);this.addEventListener("pointerdown",t),this.addEventListener("pointerup",e,!0),this.addEventListener("pointerout",e,!0),function(t){function e(t){return"keydown"==t.type&&!(t.keyCode==ci||t.keyCode==di)}bi(t.smallestButton,["pointerup","keydown"],function(i){e(i)||(t.alreadySet=!0,t.setAttribute("selected","xs"))},!0),bi(t.smallButton,["pointerup","keydown"],function(i){e(i)||(t.alreadySet=!0,t.setAttribute("selected","s"))},!0),bi(t.mediumButton,["pointerup","keydown"],function(i){e(i)||(t.alreadySet=!0,t.setAttribute("selected","m"))},!0),bi(t.largeButton,["pointerup","keydown"],function(i){e(i)||(t.alreadySet=!0,t.setAttribute("selected","l"))},!0),bi(t.largestButton,["pointerup","keydown"],function(i){e(i)||(t.alreadySet=!0,t.setAttribute("selected","xl"))},!0)}(this),this.subsToggleCallback=()=>{},this.adToggleCallback=()=>{},this.subsToggle.addEventListener("toggleOff",t=>{this.subsToggleCallback(t)}),this.subsToggle.addEventListener("toggleOn",t=>{this.subsToggleCallback(t)}),this.adToggle.addEventListener("toggleOff",t=>{this.adToggleCallback(t)}),this.adToggle.addEventListener("toggleOn",t=>{this.adToggleCallback(t)}),this.addEventListener("focusout",$o.bind(this)),this.addEventListener("focusin",Ko.bind(this)),document.addEventListener("pointerup",this.closeIfOutside.bind(this)),this.shown=!1,this.alreadySet=!1,super.render()}onRooted(){super.onRooted(),this.eventBus.bind("subtitleCustomisationEnabled",t=>{this.customiseEnabled||(this.customiseEnabled=!0,this.classList.add("customise_enabled"),Qo(this.customiseButton,t),this.eventBus.bind("subtitleCustomisationConfigChange",t=>{Qo(this.customiseButton,t)}),this.customiseButton.setActionFunction(()=>{const t={};new Promise(e=>{t.close=e}).then(()=>{this.eventBus.trigger("closeSubtitleCustomisation")}),this.eventBus.trigger("openSubtitleCustomisationRequest",t)}))})}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){switch(super.render(),this.selected){case"xs":(t=this).smallestButton.on(),t.smallButton.off(),t.mediumButton.off(),t.largeButton.off(),t.largestButton.off();break;case"s":!function(t){t.smallButton.on(),t.smallestButton.off(),t.mediumButton.off(),t.largeButton.off(),t.largestButton.off()}(this);break;case"m":default:Uo(this);break;case"l":!function(t){t.largeButton.on(),t.smallestButton.off(),t.smallButton.off(),t.mediumButton.off(),t.largestButton.off()}(this);break;case"xl":!function(t){t.largestButton.on(),t.smallestButton.off(),t.smallButton.off(),t.mediumButton.off(),t.largeButton.off()}(this)}var t}set selected(t){this.setAttribute("selected",t)}get selected(){return this.getAttribute("selected")}get showCustom(){return this._showCustom}set showCustom(t){this._showCustom!=t&&(this._showCustom=t,this.checkVisible())}get showSubtitles(){return this._showSubtitles}set showSubtitles(t){this._showSubtitles!=t&&(this._showSubtitles=t,this.checkVisible(),!t&&this.shown&&this.hide())}get showAD(){return this._showAD}set showAD(t){this._showAD!=t&&(this._showAD=t,this.checkVisible(),!t&&this.shown&&this.hide())}get heightAvailable(){return this._heightAvailable||1e4}set heightAvailable(t){this._heightAvailable!=t&&(this._heightAvailable=t,this.checkVisible())}checkVisible(){this._showAD&&this._showSubtitles?this.titleHeader.style.display="":this.titleHeader.style.display="none",zo(this._showAD,this.subtitlesSettingsPanel.getElementsByClassName("adThing")),zo(this._showSubtitles,this.subtitlesSettingsPanel.getElementsByClassName("subsThing")),zo(this._showCustom&&this._showSubtitles,this.subtitlesSettingsPanel.getElementsByClassName("subsCustom")),this.offsetHeight>this._heightAvailable&&(this.titleHeader.style.display="none",this.offsetHeight>this._heightAvailable&&(this.sizeButtons.style.display="none",this.customiseButton.style.display="none"))}setActionFunctions(t,e,i,s,n){const o=function(){},a=t||o;this.smallestButton.setActionFunction(a);const r=e||o;this.smallButton.setActionFunction(r);const l=i||o;this.mediumButton.setActionFunction(l);const u=s||o;this.largeButton.setActionFunction(u);const c=n||o;this.largestButton.setActionFunction(c)}setSubsToggleCallback(t){this.subsToggleCallback=t}setADToggleCallback(t){this.adToggleCallback=t}show(){this.subtitlesSettingsPanel.classList.add("visible"),this.subtitlesSettingsPanel.setAttribute("aria-hidden","false"),this._showSubtitles&&this.subsToggle.toggleButton.setAttribute("aria-hidden","false"),this._showAD&&this.adToggle.toggleButton.setAttribute("aria-hidden","false"),this._linkedButton.panelOpen=!0,this._linkedButton.on(),this.addTabindex(),this.shown=!0,this.eventBus.trigger("subtitlesPanelOpened")}hide(t){if(this.removeAttribute("interacting","interacting"),this.shown){setTimeout(()=>{this.shadowRoot.activeElement&&this.dispatchEvent(new CustomEvent("hidingWithFocus",{bubbles:!0,composed:!0})),this.removeTabindex(),this.subtitlesSettingsPanel.classList.remove("visible"),this.subtitlesSettingsPanel.setAttribute("aria-hidden","true"),this.subsToggle.toggleButton.setAttribute("aria-hidden","true"),this.adToggle.toggleButton.setAttribute("aria-hidden","true"),this.shown=!1,this._linkedButton.panelOpen=!1,this._linkedButton.off()},t?300:0)}}setLinkedButton(t){this._linkedButton=t}closeIfOutside(t){let e=t.composedPath();e.includes(this)||e.includes(this._linkedButton)||this.hide()}}function zo(t,e){let i=t?"":"none";for(const t of e)t.style.display=i}function Uo(t){t.mediumButton.on(),t.smallestButton.off(),t.smallButton.off(),t.largeButton.off(),t.largestButton.off()}function Wo(){this.classList.add("hovering"),this.setAttribute("interacting","interacting")}function Vo(){this.classList.remove("hovering"),this.removeAttribute("interacting")}function jo(){this.classList.add("pressed"),clearTimeout(this.interactingTimeout),this.setAttribute("interacting","interacting")}function Go(){this.classList.remove("pressed"),this.classList.contains("hovering")||(clearTimeout(this.interactingTimeout),this.interactingTimeout=setTimeout(()=>{this.removeAttribute("interacting")},250))}function $o(t){this==t.relatedTarget||this.contains(t.relatedTarget)||t.relatedTarget==this._linkedButton||this.subsToggle.forcedBlur||this.adToggle.forcedBlur||this.hide(!0)}function Ko(){this.setAttribute("interacting","interacting")}function Qo(t,e){const i=Object.keys(e.detail).length>0;t.accessibleTitle=i?E.customiseTooltipWithChanges:E.customiseTooltip}customElements.get("smp-subtitles-settings-panel")||customElements.define("smp-subtitles-settings-panel",qo);function Yo(t){const e=En("svg",{class:t,viewBox:"0 0 40 40"}),i=En("path",{d:"M26,21H40v14H26V21zM37,4H3H0v3v26v3h3h19v-3H3V7h34v10H40v-10V4H37z"});return e.appendChild(i),e}class Jo extends Zn{constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-secondary-controls-svg-dimension,20px);width:var(--smp-secondary-controls-svg-dimension,20px)}:host(.smp_B4) svg{height:var(--smp-secondary-controls-svg-dimension,22px);width:var(--smp-secondary-controls-svg-dimension,22px)}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}",svgOn:Yo("enter_pip_button"),svgOff:Yo("exit_pip_button"),labelOff:E.toolTipPicInPic,labelOn:E.toolTipStopPicInPic}),this.setEnterState=this.off,this.setExitState=this.on}}function Xo(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M30,19V13l-3.6-0.5c-0.1-0.4-0.3-0.9-0.5-1.4l2.2-2.8L23.7,4l-2.9,2.2C20.5,6,20,5.8,19.5,5.6L19,2h-6l-0.5,3.6c-0.5,0.2-1,0.4-1.4,0.6L8.3,4L3.9,8.3l2.2,2.8c-0.2,0.5-0.4,1-0.5,1.4L2,13V19l3.6,0.5c0.1,0.5,0.3,0.9,0.5,1.4l-2.2,2.8L8.3,28l2.8-2.2c0.4,0.2,0.9,0.4,1.4,0.6L13,30h6l0.5-3.6c0.5-0.1,1-0.4,1.4-0.6l2.8,2.2l4.3-4.3l-2.2-2.8c0.2-0.5,0.4-0.9,0.5-1.4L30,19zM25.3,23.5l-1.8,1.8l-2.5-1.9c-0.9,0.6-2.3,1.2-3.5,1.4L17.2,28h-2.4l-0.4-3.1c-1.2-0.2-2.5-0.8-3.5-1.4l-2.4,1.9l-1.8-1.8l2-2.4c-0.7-0.8-1.2-2-1.5-3.4L4,17.3v-2.5l3.3-0.4c0.2-1,0.6-2.1,1.3-3.4L6.7,8.5l1.8-1.8l2.6,2c0.8-0.6,1.6-1,3.4-1.5L14.8,4h2.4l0.4,3.2C19.4,7.7,20.2,8,21,8.6l2.6-2l1.8,1.8l-1.9,2.4c0.8,1.3,1.2,2.4,1.3,3.4l3.3,0.4v2.5l-3.2,0.4c-0.3,1.4-0.8,2.6-1.5,3.4L25.3,23.5z M16,10.2c-3.3,0-5.8,2.5-5.8,5.8c0,3.4,2.6,5.9,5.8,5.9c3.3,0,5.8-2.5,5.8-5.9C21.8,12.7,19.3,10.2,16,10.2z M16,20c-2.3,0-4-1.7-4-4c0-2.3,1.7-4,4-4s4,1.7,4,4C20,18.3,18.3,20,16,20z"});return t.appendChild(e),t}function Zo(){const t=En("svg",{viewBox:"0 0 32 32"}),e=En("path",{d:"M30,19V13l-3.6-0.5c-0.1-0.4-0.3-0.9-0.5-1.4l2.2-2.8L23.7,4l-2.9,2.2C20.5,6,20,5.8,19.5,5.6L19,2h-6l-0.5,3.6c-0.5,0.2-1,0.4-1.4,0.6L8.3,4L3.9,8.3l2.2,2.8c-0.2,0.5-0.4,1-0.5,1.4L2,13V19l3.6,0.5c0.1,0.5,0.3,0.9,0.5,1.4l-2.2,2.8L8.3,28l2.8-2.2c0.4,0.2,0.9,0.4,1.4,0.6L13,30h6l0.5-3.6c0.5-0.1,1-0.4,1.4-0.6l2.8,2.2l4.3-4.3l-2.2-2.8c0.2-0.5,0.4-0.9,0.5-1.4L30,19z M16,20c-2.3,0-4-1.7-4-4c0-2.3,1.7-4,4-4s4,1.7,4,4C20,18.3,18.3,20,16,20z"});return t.appendChild(e),t}customElements.get("smp-pip-button")||customElements.define("smp-pip-button",Jo);class ta extends Zn{constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-secondary-controls-svg-dimension,20px);width:var(--smp-secondary-controls-svg-dimension,20px)}:host(.smp_B4) svg{height:var(--smp-secondary-controls-svg-dimension,22px);width:var(--smp-secondary-controls-svg-dimension,22px)}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}",svgOn:Zo(),svgOff:Xo(),labelOn:E.closePlaybackSettingsMenu,labelOff:E.openPlaybackSettingsMenu})}}customElements.get("smp-playback-settings-button")||customElements.define("smp-playback-settings-button",ta);function ea(t){const e=En("svg",{class:t,viewBox:"0 0 23 23"}),i=En("path",{d:"M1,18 L1,21 L4,21 C4,19.34 2.66,18 1,18 L1,18 Z M1,14 L1,16 C3.76,16 6,18.24 6,21 L8,21 C8,17.13 4.87,14 1,14 L1,14 Z M1,10 L1,12 C5.97,12 10,16.03 10,21 L12,21 C12,14.92 7.07,10 1,10 L1,10 Z M21,3 L3,3 C1.9,3 1,3.9 1,5 L1,8 L3,8 L3,5 L21,5 L21,19 L14,19 L14,21 L21,21 C22.1,21 23,20.1 23,19 L23,5 C23,3.9 22.1,3 21,3 L21,3 Z"});return e.appendChild(i),e}function ia(t){const e=En("svg",{class:t,viewBox:"0 0 123 101"}),i=En("path",{d:"M22.88,22.47h77.56v55.46H68.7c-7.08-21.73-24.17-38.94-45.82-46.2V22.47L22.88,22.47z M0.32,83.38 c9.2,0,16.67,7.41,16.75,16.59H0V83.39L0.32,83.38L0.32,83.38z M0.32,38.58c17,0,32.39,6.89,43.52,18.03 c11.1,11.1,17.99,26.43,18.03,43.36H49.56c-0.04-13.53-5.55-25.78-14.42-34.66C26.23,56.4,13.92,50.89,0.32,50.89L0,50.9V38.58 L0.32,38.58L0.32,38.58z M0.32,60.68c10.9,0,20.76,4.42,27.9,11.56c7.11,7.11,11.51,16.91,11.56,27.74H27.47 c-0.04-7.43-3.07-14.16-7.95-19.04c-4.91-4.91-11.7-7.95-19.2-7.95l-0.32,0V60.68L0.32,60.68L0.32,60.68z M12.39,0h97.11 c3.69,0,7.03,1.51,9.45,3.92c2.48,2.48,3.93,5.95,3.93,9.45v73.78c0,3.66-1.51,7-3.93,9.42l-0.03,0.03 c-2.42,2.42-5.76,3.93-9.42,3.93H72.24c0-0.22,0.01,0.07,0.01,0.1c0,0.03-0.06-0.19,0.01-1.45l0.52-10.47h38.28v-76.9H12.01v16.34 C8.84,27.53,1.74,27.99,0.2,28.01V13.38c0-3.65,1.5-6.99,3.92-9.42C6.68,1.43,8.78,0,12.39,0L12.39,0z"});return e.appendChild(i),e}class sa extends Zn{constructor(){super({stylesheet:":host{display:block}.enter_chromecast_button,.exit_chromecast_button{height:20px;width:20px}:host(.smp_B4) .enter_chromecast_button,:host(.smp_B4) .exit_chromecast_button{height:22px;width:22px}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}:host(.show-focus) .button:focus-visible svg{transform:scale(1.25)}",svgOn:ea("enter_chromecast_button"),svgOff:ia("exit_chromecast_button"),labelOn:E.toolTipChromecast,labelOff:E.toolTipStopChromecast}),this.setEnterState=this.on,this.setExitState=this.off}}customElements.get("smp-chromecast-button")||customElements.define("smp-chromecast-button",sa);class na extends yn{static get observedAttributes(){return["primary-text","secondary-text","icon"]}constructor(){super({stylesheet:":host(.show-focus) .button:focus-visible .highlight_button_circle{background:unset;box-shadow:unset;outline:2px solid var(--smp-colour,#fff);transition:none}:host(.show-focus) .button:focus-visible:not(.hovering) .highlight_button_circle{background:unset;box-shadow:unset}:host(.show-focus) .button:focus-visible.pressed .highlight_button_circle{transform:unset}#buttonInnerCustomSlot{color:var(--smp-controls-text-colour,#fff);height:100%;line-height:2px;position:relative;top:-100%}.wrap{line-height:.875rem;padding:3px 16px;text-align:left}:host(.quality_page_high_button) .wrap{padding:3px 16px 0}.primaryTextContainer{font-size:.875rem;max-width:calc(100% - 36px)}.secondaryTextContainer{color:#e6e8ea;font-size:.8125rem;height:5px;max-width:calc(100% - 36px);position:relative;top:-10px}:host(.quality_page_high_button) .secondaryTextContainer{height:fit-content;top:-8px}svg.chevron,svg.externalLink{height:14px;right:14px;top:1.125rem;width:14px}svg.chevron,svg.externalLink,svg.tick{fill:var(--smp-overlay-panels-controls-fill,#fff);position:absolute}svg.tick{height:22px;right:16px;top:.813rem;width:22px}.button:not([disabled]).hovering{background-color:var(--smp-setting-overlay-outline,#545658)}"})}create(){super.create(),this.slottedDiv=document.createElement("div"),this.slottedDiv.id="buttonInnerCustomSlot",this.button.firstElementChild.appendChild(this.slottedDiv),this.render()}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){for(super.render();this.slottedDiv.firstChild;)this.slottedDiv.removeChild(this.slottedDiv.firstChild);let t=document.createElement("p"),e=document.createElement("p");t.textContent=this.primaryText,t.classList.add("primaryTextContainer"),t.setAttribute("aria-hidden",!0),e.textContent=this.secondaryText,e.classList.add("secondaryTextContainer"),e.setAttribute("aria-hidden",!0);let i=document.createElement("div");switch(i.classList.add("wrap"),i.appendChild(t),i.appendChild(e),this.icon){case"tick":i.appendChild(function(t){const e=En("svg",{class:t,viewBox:"0 0 48 48"}),i=En("path",{d:"M21.8,36.99L7.89,23l2.82-2.89L23,32.44h-2.33L42.1,11.01l2.86,2.82L21.8,36.99z"});return e.appendChild(i),e}("tick"));break;case"externalLink":i.appendChild(function(t){const e=En("svg",{class:t,viewBox:"0 0 16 16"}),i=En("path",{d:"M10.95 8.45V14.2H1.85V5.1H7.4V3.8H0.5V15.5H12.3V8.45H10.95V8.45ZM9 0.5V1.8H14.1L13.85 1.25L5.5 9.5L6.45 10.45L14.8 2.15L14.2 1.9V7H15.5V0.5H9Z"});return e.appendChild(i),e}("externalLink"));break;case"chevron":i.appendChild(function(t){const e=En("svg",{class:t,viewBox:"0 0 32 32"}),i=En("path",{d:"M6.25,30l14-14.08L6.25,2h7l14,14l-14,14H6.25z"});return e.appendChild(i),e}("chevron"))}this.slottedDiv.appendChild(i)}set primaryText(t){this.setAttribute("primary-text",t)}get primaryText(){return this.getAttribute("primary-text")}set secondaryText(t){this.setAttribute("secondary-text",t)}get secondaryText(){return this.getAttribute("secondary-text")}set icon(t){this.setAttribute("icon",t)}get icon(){return this.getAttribute("icon")}}customElements.get("smp-quality-setting-button")||customElements.define("smp-quality-setting-button",na);class oa extends yn{constructor(t){super(t),this.svg=t.svg,this.label=t.label}create(){super.create(),this.buttonInner.appendChild(this.svg),this.accessibleTitle=this.label}}customElements.get("smp-one-state-button")||customElements.define("smp-one-state-button",oa);function aa(t){const e=En("svg",{class:t,viewBox:"0 0 32 32"}),i=En("path",{d:"M26.5,2l-14,14.08L26.5,30h-7l-14-14l14-14H26.5z"});return e.appendChild(i),e}class ra extends oa{constructor(){super({stylesheet:":host{display:block}svg{fill:var(--smp-overlay-panels-controls-fill,#fff);height:18px;width:18px}.button:focus-visible .highlight_button_circle,:host(.show-focus) .button:focus-visible .highlight_button_circle{background:unset;box-shadow:unset}.button:not([disabled]).hovering svg{transform:scale(1.25)}.button:not([disabled]).hovering.pressed svg,.button:not([disabled]).pressed svg{transform:scale(1)}.button:not([disabled]).touched svg,.button:not([disabled]).touched.pressed svg{transform:scale(.85)}.button:focus-visible{outline:2px solid var(--smp-colour,#fff);position:relative;z-index:1}",svg:aa("left_chevron")})}}customElements.get("smp-go-back-button")||customElements.define("smp-go-back-button",ra);const la=document.createElement("template");la.innerHTML='<div class="pages">\n                            <div class="up_arrow"></div>\n                            <div class="page main_page">\n                                <smp-panel-header aria-hidden="true"></smp-panel-header>\n                                <smp-autoplay-setting id="initalFocusItem" smp-context smp-tabbable></smp-autoplay-setting>\n                                <smp-quality-setting-button icon="chevron" class="quality_setting_page_button" smp-context smp-tabbable></smp-quality-setting-button>\n                                <smp-quality-setting-button class="quality_setting_not_available_button" smp-context smp-tabbable></smp-quality-setting-button>\n                            </div>\n\n                            <div class="page quality_page">\n                                <smp-panel-header class="quality_page_header"></smp-panel-header>\n                                <smp-quality-setting-button icon="tick" class="quality_page_low_button" smp-context smp-tabbable></smp-quality-setting-button>\n                                <smp-quality-setting-button icon="" class="quality_page_medium_button" smp-context smp-tabbable></smp-quality-setting-button>\n                                <smp-quality-setting-button icon="" class="quality_page_high_button" smp-context smp-tabbable></smp-quality-setting-button>\n                                <smp-go-back-button smp-tabbable></smp-go-back-button>\n                            </div>\n                            <div class="down_arrow"></div>\n                        </div>';class ua extends Ks{constructor(){super({stylesheet:".quality_setting_page_button.show{display:block}.quality_setting_page_button{display:none;height:var(--smp-playback-settings-panel-quality-setting-page-height,unset)}.page .quality_setting_not_available_button{display:none}.quality_change_not_available.page .quality_setting_not_available_button{display:grid}.no_quality_row .page .quality_setting_not_available_button,.no_quality_row .quality_change_not_available.page .quality_setting_not_available_button,.quality_change_not_available.page .quality_setting_page_button,.quality_change_not_available.page .quality_setting_page_button.show{display:none}.main_page,.quality_page{border:1px solid var(--smp-setting-overlay-outline,#545658);box-shadow:1px 1px 8px 4px var(--smp-setting-overlay-box-shadow,rgba(84,86,88,.25));box-sizing:border-box;transition:all .35s ease-in-out}.main_page.hide,.quality_page{display:none}.quality_page.show{display:grid;pointer-events:auto}.main_page{opacity:0;pointer-events:none;visibility:hidden}.main_page.visible{opacity:1;pointer-events:auto;visibility:visible}.quality_page .quality_page_low_button,.quality_page .quality_page_medium_button{height:var(--smp-playback-settings-panel-quality-button-height,46px)}smp-go-back-button{height:44px;position:absolute;width:44px}.up_arrow{display:var(--smp-subtitles-settings-panel-up-arrow-display,none);top:-5px;transform:rotate(45deg)}.down_arrow,.up_arrow{background:var(--smp-setting-overlay,#3a3c3e);border:1px solid var(--smp-setting-overlay-outline,#545658);clip-path:polygon(0 0,0 100%,100% 0);height:10px;opacity:0;position:absolute;right:var(--smp-playback-settings-panel-arrow-right);transition:all .1s ease-in-out;visibility:hidden;width:10px}.down_arrow{bottom:-4.5px;display:var(--smp-subtitles-settings-panel-down-arrow-display,none);transform:rotate(225deg)}.down_arrow.visible,.up_arrow.visible{opacity:1;transition:all .1s ease-in-out;visibility:visible}.pages{--smp-highlight-button-circle-radius:0;min-width:var(--smp-panels-min-width,0);width:var(--smp-playback-setting-panel-width,276px)}.page{background-color:var(--smp-setting-overlay,#3a3c3e);width:100%}",template:la,templateName:"playbackSettingsPanel"}),this.setInteracting=this.setInteracting.bind(this),this.finishedInteracting=this.finishedInteracting.bind(this)}create(){super.create();let t=this;var e;function i(e){clearTimeout(t.pageSwitcherTimeout),t.switchingBetweenPages=!0,t.pageSwitcherTimeout=setTimeout(function(){t.switchingBetweenPages=!1},150),e?(t.mainPage.classList.add("hide"),t.qualityPage.classList.add("show"),setTimeout(function(){t.lowRow.button.focus()},100)):(t.mainPage.classList.remove("hide"),t.qualityPage.classList.remove("show"))}this.wrap=this.playbackSettingsPanel,this.mainPage=this.playbackSettingsPanel.getElementsByClassName("main_page")[0],this.qualityPage=this.playbackSettingsPanel.getElementsByClassName("quality_page")[0],this.upArrow=this.playbackSettingsPanel.getElementsByClassName("up_arrow")[0],this.downArrow=this.playbackSettingsPanel.getElementsByClassName("down_arrow")[0],this.playbackSettingHeader=this.playbackSettingsPanel.getElementsByTagName("smp-panel-header")[0],this.playbackSettingHeader.titleText=E.playbackSettingsHeading,this.autoplayRow=this.playbackSettingsPanel.getElementsByTagName("smp-autoplay-setting")[0],this.autoplayToggle=this.autoplayRow.toggleElement,this.autoplayToggle.toggleButton.setAttribute("aria-hidden","true"),this.qualityRow=this.playbackSettingsPanel.getElementsByClassName("quality_setting_page_button")[0],this.qualityRow.setAttribute("primary-text",E.qualitySettingHeading),this.qualityRow.setAttribute("secondary-text",E.qualityPanelHighRowHeading),this.qualityNotAvailableRow=this.playbackSettingsPanel.getElementsByClassName("quality_setting_not_available_button")[0],this.qualityNotAvailableRow.accessibleTitle=E.qualitySettingOpenUnavailableAccessible,this.qualityNotAvailableRow.setAttribute("primary-text",E.qualitySettingHeading),this.qualityNotAvailableRow.setAttribute("secondary-text",E.qualitySettingOpenUnavailable),this.qualityPageHeader=this.playbackSettingsPanel.getElementsByClassName("quality_page_header")[0],this.qualityPageHeader.titleText=E.qualitySettingHeading,this.goBackButton=this.playbackSettingsPanel.getElementsByTagName("smp-go-back-button")[0],this.goBackButton.accessibleTitle=E.backToPlaybackSettingsMenu,this.lowRow=this.playbackSettingsPanel.getElementsByClassName("quality_page_low_button")[0],this.mediumRow=this.playbackSettingsPanel.getElementsByClassName("quality_page_medium_button")[0],this.highRow=this.playbackSettingsPanel.getElementsByClassName("quality_page_high_button")[0],this.lowRow.setAttribute("primary-text",E.qualityPanelLowRowHeading),this.mediumRow.setAttribute("primary-text",E.qualityPanelMediumRowHeading),this.highRow.setAttribute("primary-text",E.qualityPanelHighRowHeading),this.highRow.setAttribute("secondary-text",E.qualityPanelHighRowSubtitle),this.lowRow.accessibleTitle=E.qualitySettingLowSelect,this.mediumRow.accessibleTitle=E.qualitySettingMediumSelect,this.highRow.accessibleTitle=E.qualitySettingHighSelect,(e=this).lowRow.setActionFunction(function(t){ca(e,!0,t)}),e.mediumRow.setActionFunction(function(t){da(e,!0,t)}),e.highRow.setActionFunction(function(t){ha(e,!0,t)}),this.qualityRow.setActionFunction(function(){i(!0)}),this.goBackButton.setActionFunction(function(){i(),function(t,e,i){let s=i||0,n=t.querySelector(e);n=n.button?n.button:n,setTimeout(function(){n.focus()},s)}(t.playbackSettingsPanel,"#initalFocusItem",100)}),fi(this.playbackSettingsPanel,this.setInteracting,!0),yi(this.playbackSettingsPanel,this.finishedInteracting,!0),this.addEventListener("focusout",ma.bind(this)),this.closeIfOutside=ga.bind(this),document.addEventListener("pointerup",this.closeIfOutside,!0);let s=this.playbackSettingHeader.fontSize;s>=24&&s<34?this.wrap.style.setProperty("--smp-playback-settings-panel-quality-button-height","80px"):s>=34&&s<40?(this.wrap.style.setProperty("--smp-playback-settings-panel-quality-button-height","80px"),this.wrap.style.setProperty("--smp-playback-settings-panel-quality-setting-page-height","160px")):s>=40&&s<48?(this.wrap.style.setProperty("--smp-playback-settings-panel-quality-button-height","95px"),this.wrap.style.setProperty("--smp-playback-settings-panel-quality-setting-page-height","250px")):s>=48&&s<57?(this.wrap.style.setProperty("--smp-playback-settings-panel-quality-button-height","110px"),this.wrap.style.setProperty("--smp-playback-settings-panel-quality-setting-page-height","300px")):s>=57&&(this.wrap.style.setProperty("--smp-playback-settings-panel-quality-button-height","125px"),this.wrap.style.setProperty("--smp-playback-setting-panel-width","max-content"))}onRooted(){super.onRooted();const t=this;this.initialPanelSettings=this.toucanPlayer._uiConfig.playbackSettingsPanel,this.setMode(this.initialPanelSettings),this.eventBus.bind("canplay",()=>{!function(t){let e=t.toucanPlayer.playbackController.canChangeQuality;e?t.mainPage.classList.remove("quality_change_not_available"):t.mainPage.classList.add("quality_change_not_available");let i=t.toucanPlayer.playbackController.quality;"hd"==i||"high"==i?ha(t):"medium"==i?da(t):ca(t)}(t)}),this.eventBus.bind("uiConfigUpdated",e=>{t.setMode(e.playbackSettingsPanel)})}show(){this.mainPage.classList.add("visible"),this.upArrow.classList.add("visible"),this.downArrow.classList.add("visible"),this.playbackSettingsPanel.setAttribute("aria-hidden","false"),this.hasAutoplayRow&&this.autoplayToggle.toggleButton.setAttribute("aria-hidden","false"),this.addTabindex(),this._linkedButton.on(),this.shown=!0,this.eventBus.trigger("playbackSettingsPanelOpened")}hide(t){this.removeAttribute("interacting");setTimeout(()=>{this.shadowRoot.activeElement&&this.dispatchEvent(new CustomEvent("hidingWithFocus",{bubbles:!0,composed:!0})),this.mainPage.classList.remove("visible"),this.upArrow.classList.remove("visible"),this.downArrow.classList.remove("visible"),this.qualityPage.classList.remove("show"),this.mainPage.classList.remove("hide"),this.qualityPage.classList.remove("show"),this.playbackSettingsPanel.setAttribute("aria-hidden","true"),this.autoplayToggle.toggleButton.setAttribute("aria-hidden","true"),this.removeTabindex(),this._linkedButton&&this._linkedButton.off(),this.shown=!1},t?300:0)}setMode(t){var e;t.continuousPlaySetting?(this.playbackSettingsPanel.classList.remove("no_autoplay_row"),this.autoplayRow.style.display="block",this.hasAutoplayRow=!0):(this.playbackSettingsPanel.classList.add("no_autoplay_row"),this.autoplayRow.style.display="none",this.hasAutoplayRow=!1),t.qualitySetting?(this.playbackSettingsPanel.classList.remove("no_quality_row"),this.qualityRow.classList.add("show"),this.hasQualityRow=!0):(this.playbackSettingsPanel.classList.add("no_quality_row"),this.qualityRow.classList.remove("show"),this.hasQualityRow=!1),(e=this).hasAutoplayRow?(e.autoplayRow.setAttribute("id","initalFocusItem"),e.qualityRow.removeAttribute("id")):e.hasQualityRow&&(e.qualityRow.setAttribute("id","initalFocusItem"),e.autoplayRow.removeAttribute("id"))}setLinkedButton(t){this._linkedButton=t}setInteracting(){this.setAttribute("interacting","interacting")}finishedInteracting(){this.switchingBetweenPages||this.removeAttribute("interacting")}}function ca(t,e,i){t.lowRow.setAttribute("icon","tick"),t.mediumRow.removeAttribute("icon"),t.highRow.removeAttribute("icon"),pa(t,"low",e,i),t.qualityRow.setAttribute("secondary-text",E.qualityPanelLowRowHeading),t.qualityRow.accessibleTitle=E.qualitySettingOpenLowSelected,t.lowRow.accessibleTitle=E.qualitySettingLowSelected,t.mediumRow.accessibleTitle=E.qualitySettingMediumSelect,t.highRow.accessibleTitle=E.qualitySettingHighSelect}function da(t,e,i){t.mediumRow.setAttribute("icon","tick"),t.lowRow.removeAttribute("icon"),t.highRow.removeAttribute("icon"),pa(t,"medium",e,i),t.qualityRow.setAttribute("secondary-text",E.qualityPanelMediumRowHeading),t.qualityRow.accessibleTitle=E.qualitySettingOpenMediumSelected,t.lowRow.accessibleTitle=E.qualitySettingLowSelect,t.mediumRow.accessibleTitle=E.qualitySettingMediumSelected,t.highRow.accessibleTitle=E.qualitySettingHighSelect}function ha(t,e,i){t.highRow.setAttribute("icon","tick"),t.mediumRow.removeAttribute("icon"),t.lowRow.removeAttribute("icon"),pa(t,"hd",e,i),t.qualityRow.setAttribute("secondary-text",E.qualityPanelHighRowHeading),t.qualityRow.accessibleTitle=E.qualitySettingOpenHighSelected,t.lowRow.accessibleTitle=E.qualitySettingLowSelect,t.mediumRow.accessibleTitle=E.qualitySettingMediumSelect,t.highRow.accessibleTitle=E.qualitySettingHighSelected}function pa(t,e,i,s){if(!i)return;t.toucanPlayer.playbackController.quality={quality:e};if(xi({quality:e}),s){const i=mi(s);let n=ys;"medium"==e&&(n=fs),"low"==e&&(n=bs),t.echoReporter.trackAction(n,i)}}function ma(t){this==t.relatedTarget||this.contains(t.relatedTarget)||t.relatedTarget==this._linkedButton||this.hasAttribute("interacting")||this.switchingBetweenPages||this.autoplayToggle.forcedBlur||this.hide(!0)}function ga(t){let e=t.composedPath();e.includes(this)||e.includes(this._linkedButton)||this.hide()}customElements.get("smp-playback-settings-panel")||customElements.define("smp-playback-settings-panel",ua);class ba extends yn{static get observedAttributes(){return["speed"]}constructor(){super({stylesheet:":host{display:block}.button{height:44px;width:44px}.button svg{height:32px;width:32px}.button.disabled svg{opacity:.4}.button:focus-visible{outline:2px solid var(--smp-colour,#fff);position:relative;z-index:1}.button.touched svg{transform:scale(.8)}.button:not([disabled]).hovering svg{fill:var(--smp-base-colour,#fff)}.button:not([disabled]).hovering{background-color:var(--smp-setting-overlay-outline-hover,#545658)}.lineIndicator{background-color:var(--smp-setting-overlay-line-indicator,#fff);bottom:4px;height:2px;opacity:0;position:absolute;transition:all .2s ease-in-out;width:40px}.lineIndicator.visible{opacity:1}"})}create(){super.create(),this.isOn=!1,this.button.setAttribute("aria-pressed","false"),this.buttonInner.appendChild(Cn(16,16,14)),this.buttonContent=this.buttonInner.querySelector("text"),this.lineIndicator=document.createElement("div"),this.lineIndicator.className="lineIndicator",this.buttonInner.appendChild(this.lineIndicator),this.render()}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){switch(super.render(),this.buttonContent.textContent=this.speed,this.speed){case"0.5":this.button.setAttribute("aria-label",E.speedButton0),this.button.setAttribute("stats-label",Ss);break;case"0.8":this.button.setAttribute("aria-label",E.speedButton1),this.button.setAttribute("stats-label",Bs);break;case"1":default:this.button.setAttribute("aria-label",E.speedButton2),this.button.setAttribute("stats-label",xs);break;case"1.2":this.button.setAttribute("aria-label",E.speedButton3),this.button.setAttribute("stats-label",Ps);break;case"1.5":this.button.setAttribute("aria-label",E.speedButton4),this.button.setAttribute("stats-label",Ls);break;case"2":this.button.setAttribute("aria-label",E.speedButton5),this.button.setAttribute("stats-label",As)}}set speed(t){this.setAttribute("speed",t)}get speed(){return this.getAttribute("speed")}on(t){this.isOn||(this.isOn=!0,this.button.setAttribute("aria-pressed","true")),t?this.lineIndicator.classList.remove("visible"):this.lineIndicator.classList.add("visible")}off(){this.isOn&&(this.isOn=!1,this.button.setAttribute("aria-pressed","false"),this.lineIndicator.classList.remove("visible"))}}customElements.get("smp-playback-speed-settings-button")||customElements.define("smp-playback-speed-settings-button",ba);const fa=document.createElement("template");fa.innerHTML='<div class="wrap">\n                                                    <div class="up_arrow"></div>\n                                                    <smp-panel-header aria-hidden="true"></smp-panel-header>\n                                                    <div class="buttons_wrap">\n                                                        <smp-playback-speed-settings-button speed="0.5" class="slowest" smp-tabbable></smp-playback-speed-settings-button>\n                                                        <smp-playback-speed-settings-button speed="0.8" class="slow" smp-tabbable></smp-playback-speed-settings-button>\n                                                        <smp-playback-speed-settings-button speed="1" class="normal" smp-tabbable></smp-playback-speed-settings-button>\n                                                        <smp-playback-speed-settings-button speed="1.2" class="fast" smp-tabbable></smp-playback-speed-settings-button>\n                                                        <smp-playback-speed-settings-button speed="1.5" class="faster" smp-tabbable></smp-playback-speed-settings-button>\n                                                        <smp-playback-speed-settings-button speed="2" class="fastest" smp-tabbable></smp-playback-speed-settings-button>\n                                                    </div>\n                                                    <div class="selectedSpeedIndicator"></div>\n                                                    <div class="down_arrow"></div>\n                                                </div>';class ya extends Ks{static get observedAttributes(){return["selected"]}constructor(){super({stylesheet:":host{display:block}.wrap{fill:var(--smp-overlay-panels-controls-fill,#fff);background-color:var(--smp-setting-overlay,#3a3c3e);border:1px solid var(--smp-setting-overlay-outline,#545658);box-shadow:1px 1px 8px 4px var(--smp-setting-overlay-box-shadow,rgba(84,86,88,.25));box-sizing:border-box;min-width:var(--smp-panels-min-width,0);opacity:0;pointer-events:none;position:relative;transition:all .35s ease-in-out;visibility:hidden;width:var(--smp-playback-speed-setting-panel-wrap-width,277px)}.visible{opacity:1;pointer-events:auto;visibility:visible}.buttons_wrap{bottom:0;display:flex;justify-content:space-between;position:relative;width:100%}.down_arrow{bottom:-5.5px;display:var(--smp-subtitles-settings-panel-down-arrow-display,none);transform:rotate(225deg)}.down_arrow,.up_arrow{background:var(--smp-setting-overlay,#3a3c3e);border:1px solid var(--smp-setting-overlay-outline,#545658);clip-path:polygon(0 0,0 100%,100% 0);height:10px;position:absolute;right:var(--smp-playback-speed-settings-panel-arrow-right);width:10px}.up_arrow{display:var(--smp-subtitles-settings-panel-up-arrow-display,none);top:-5.5px;transform:rotate(45deg)}",template:fa,templateName:"playbackSpeedSettingsPanel"})}create(){super.create(),this.wrap=this.playbackSpeedSettingsPanel,this.titleHeader=this.playbackSpeedSettingsPanel.getElementsByTagName("smp-panel-header")[0],this.titleHeader.titleText=E.speedTitle,this.slowestButton=this.playbackSpeedSettingsPanel.getElementsByClassName("slowest")[0],this.slowButton=this.playbackSpeedSettingsPanel.getElementsByClassName("slow")[0],this.normalButton=this.playbackSpeedSettingsPanel.getElementsByClassName("normal")[0],this.fastButton=this.playbackSpeedSettingsPanel.getElementsByClassName("fast")[0],this.fasterButton=this.playbackSpeedSettingsPanel.getElementsByClassName("faster")[0],this.fastestButton=this.playbackSpeedSettingsPanel.getElementsByClassName("fastest")[0],fi(this,_a.bind(this)),yi(this,ka.bind(this));const t=wa.bind(this),e=Ta.bind(this);this.addEventListener("pointerdown",t),this.addEventListener("pointerup",e,!0),this.addEventListener("pointerout",e,!0),function(t){function e(t){return"keydown"==t.type&&!(t.keyCode==ci||t.keyCode==di)}bi(t.slowestButton,["pointerup","keydown"],function(i){e(i)||t.slowestButton.isDisabled||t.setAttribute("selected","0.5")},!0),bi(t.slowButton,["pointerup","keydown"],function(i){e(i)||t.slowButton.isDisabled||t.setAttribute("selected","0.8")},!0),bi(t.normalButton,["pointerup","keydown"],function(i){e(i)||t.normalButton.isDisabled||t.setAttribute("selected","1")},!0),bi(t.fastButton,["pointerup","keydown"],function(i){e(i)||t.fastButton.isDisabled||t.setAttribute("selected","1.2")},!0),bi(t.fasterButton,["pointerup","keydown"],function(i){e(i)||t.fasterButton.isDisabled||t.setAttribute("selected","1.5")},!0),bi(t.fastestButton,["pointerup","keydown"],function(i){e(i)||t.fastestButton.isDisabled||t.setAttribute("selected","2")},!0)}(this),this.addEventListener("focusout",Ea.bind(this)),this.addEventListener("focusin",Ca.bind(this)),this.closeIfOutside=this.closeIfOutside.bind(this),document.addEventListener("pointerup",this.closeIfOutside,!0),this.shown=!1,super.render(),this.setAttribute("selected","1"),va(this),this.titleHeader.fontSize>=40&&this.wrap.style.setProperty("--smp-playback-speed-setting-panel-wrap-width","fit-content")}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){switch(super.render(),this.selected){case"0.5":(t=this).slowestButton.on(),t.slowButton.off(),t.normalButton.off(),t.fastButton.off(),t.fasterButton.off(),t.fastestButton.off();break;case"0.8":!function(t){t.slowButton.on(),t.slowestButton.off(),t.normalButton.off(),t.fastButton.off(),t.fasterButton.off(),t.fastestButton.off()}(this);break;case"1":va(this);break;case"1.2":!function(t){let e=t.fastButton.button.disabled;t.fastButton.on(e),t.slowestButton.off(),t.slowButton.off(),t.normalButton.off(),t.fasterButton.off(),t.fastestButton.off()}(this);break;case"1.5":!function(t){let e=t.fasterButton.button.disabled;t.fasterButton.on(e),t.slowestButton.off(),t.slowButton.off(),t.normalButton.off(),t.fastButton.off(),t.fastestButton.off()}(this);break;case"2":!function(t){let e=t.fastestButton.button.disabled;t.fastestButton.on(e),t.slowestButton.off(),t.slowButton.off(),t.normalButton.off(),t.fastButton.off(),t.fasterButton.off()}(this);break;default:va(this,!0)}var t}set selected(t){this.setAttribute("selected",t)}get selected(){return this.getAttribute("selected")}setActionFunctions(t,e,i,s,n,o){const a=function(){},r=t||a;this.slowestButton.setActionFunction(r);const l=e||a;this.slowButton.setActionFunction(l);const u=i||a;this.normalButton.setActionFunction(u);const c=s||a;this.fastButton.setActionFunction(c);const d=n||a;this.fasterButton.setActionFunction(d);const h=o||a;this.fastestButton.setActionFunction(h)}show(){this.playbackSpeedSettingsPanel.classList.add("visible"),this.playbackSpeedSettingsPanel.setAttribute("aria-hidden","false"),this.shown=!0,this.addTabindex(),this._linkedButton&&(this._linkedButton.on(),this._linkedButton.setLineIndicator(!0)),this.eventBus.trigger("playbackSpeedSettingsPanelOpened")}hide(t){setTimeout(()=>{this.shadowRoot.activeElement&&this.dispatchEvent(new CustomEvent("hidingWithFocus",{bubbles:!0,composed:!0})),this.playbackSpeedSettingsPanel.classList.remove("visible"),this.playbackSpeedSettingsPanel.setAttribute("aria-hidden","true"),this.removeTabindex(),this.shown=!1,this._linkedButton&&(this._linkedButton.off(),this._linkedButton.setLineIndicator(!1))},t?300:0)}setLinkedButton(t){this._linkedButton=t}closeIfOutside(t){let e=t.composedPath();e.includes(this)||e.includes(this._linkedButton)||this.hide()}setLiveEgde(t){t?(this.fasterDisabled=!0,this.fastButton.disable(),this.fasterButton.disable(),this.fastestButton.disable()):(this.fasterDisabled=!1,this.fastButton.enable(),this.fasterButton.enable(),this.fastestButton.enable())}}function va(t,e){t.normalButton.on(e),t.slowestButton.off(),t.slowButton.off(),t.fastButton.off(),t.fasterButton.off(),t.fastestButton.off()}function _a(){this.classList.add("hovering"),this.setAttribute("interacting","interacting")}function ka(){this.classList.remove("hovering"),this.removeAttribute("interacting")}function wa(){this.classList.add("pressed"),clearTimeout(this.interactingTimeout),this.setAttribute("interacting","interacting")}function Ta(){if(this.classList.remove("pressed"),!this.classList.contains("hovering")){let t=this;clearTimeout(this.interactingTimeout),this.interactingTimeout=setTimeout(function(){t.removeAttribute("interacting")},250)}}function Ea(t){this==t.relatedTarget||this.contains(t.relatedTarget)||t.relatedTarget==this._linkedButton||(this.removeAttribute("interacting","interacting"),this.hide())}function Ca(){this.setAttribute("interacting","interacting")}customElements.get("smp-playback-speed-settings-panel")||customElements.define("smp-playback-speed-settings-panel",ya);class Sa extends Zn{static get observedAttributes(){return["button-text"]}constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-secondary-controls-svg-dimension,20px);overflow-x:unset;overflow-y:visible;width:var(--smp-secondary-controls-svg-dimension,20px)}:host(.smp_B4) svg{height:var(--smp-secondary-controls-svg-dimension,22px);width:var(--smp-secondary-controls-svg-dimension,22px)}.button_inner{color:var(--smp-interval-button-icon-number-color,#fff);font-size:18px}:host(.show-focus) .button:focus-visible .button_inner{color:var(--smp-fore-colour-tab,#fff)}.indicator_line{background-color:var(--smp-base-colour,#fff);bottom:6px;height:2px;margin:auto;position:relative;width:40px}:host(.show-focus) .button:focus-visible .indicator_line{background-color:var(--smp-fore-colour-tab,#fff)}.button:not([disabled]).hovering .button_inner{transform:scale(1.25)}.button:not([disabled]).hovering.pressed .button_inner,.button:not([disabled]).pressed .button_inner{transform:scale(1)}.button:not([disabled]).touched .button_inner,.button:not([disabled]).touched.pressed .button_inner{transform:scale(.85)}:host(.show-focus) .button:focus-visible .button_inner{transform:scale(1.25)}.button .button_inner{transition:transform .1s linear}:host(.audio_ui) .button:not([disabled]):not(:focus-visible).hovering .indicator_line{background-color:var(--smp-colour,#0071f1)}",svgOn:null,svgOff:null,labelOff:E.openSpeedMenu,labelOn:E.closeSpeedMenu})}create(){super.create(),this.buttonInner.appendChild(Cn(16,16,30)),this.buttonContent=this.buttonInner.querySelector("text"),this.indicatorLine=document.createElement("div"),this.indicatorLine.classList.add("indicator_line"),this.button.appendChild(this.indicatorLine),this.indicatorLine.style.display="none",this.render()}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){this.buttonContent.textContent=this.getAttribute("button-text")}setLineIndicator(t){this.indicatorLine.style.display=t?"block":"none"}set buttonText(t){this.setAttribute("button-text",t)}get buttonText(){return this.getAttribute("button-text")}}customElements.get("smp-playback-speed-button")||customElements.define("smp-playback-speed-button",Sa);function Ba(){const t=En("svg",{viewBox:"0 0 29 32"}),e=En("path",{d:"M28.4004 8.48H10.4934V2.56H28.2376V8.48H28.4004ZM28.4004 14.24H4.30737V20.16H28.2376V14.24H28.4004ZM28.4004 26.08H4.30737V32H28.2376V26.08H28.4004ZM0.400391 0V10.88H3.00504L7.56318 5.44L3.00504 0H0.400391Z"});return t.appendChild(e),t}class xa extends Zn{constructor(){super({stylesheet:":host{display:block}svg{height:var(--smp-secondary-controls-svg-dimension,20px);width:var(--smp-secondary-controls-svg-dimension,20px)}:host(.smp_B4) svg{height:var(--smp-secondary-controls-svg-dimension,22px);width:var(--smp-secondary-controls-svg-dimension,22px)}.button_inner{color:var(--smp-interval-button-icon-number-color,#fff);font-size:18px}:host(.show-focus) .button:focus-visible .button_inner{color:var(--smp-fore-colour-tab,#fff)}.indicator_line{background-color:var(--smp-base-colour,#fff);bottom:6px;height:2px;margin:auto;position:relative;width:40px}:host(.show-focus) .button:focus-visible .indicator_line{background-color:var(--smp-fore-colour-tab,#fff)}.button:not([disabled]).hovering .button_inner{transform:scale(1.25)}.button:not([disabled]).hovering.pressed .button_inner,.button:not([disabled]).pressed .button_inner{transform:scale(1)}.button:not([disabled]).touched .button_inner,.button:not([disabled]).touched.pressed .button_inner{transform:scale(.85)}:host(.show-focus) .button:focus-visible .button_inner{transform:scale(1.25)}.button .button_inner{transition:transform .1s linear}:host(.audio_ui) .button:not([disabled]):not(:focus-visible).hovering .indicator_line{background-color:var(--smp-colour,#0071f1)}",svgOn:Ba(),svgOff:Ba(),labelOff:E.playQueueOff,labelOn:E.playQueueOn})}create(){super.create(),this.indicatorLine=document.createElement("div"),this.indicatorLine.classList.add("indicator_line"),this.button.appendChild(this.indicatorLine),this.indicatorLine.style.display="none",this.render()}setState(t){t?(this.on(),this.indicatorLine.style.display="block"):(this.off(),this.indicatorLine.style.display="none")}}customElements.get("smp-play-queue-button")||customElements.define("smp-play-queue-button",xa);const Pa=document.createElement("template");Pa.innerHTML='<div class="button_container">\n                                    <smp-fullscreen-button smp-context class="layout_button"></smp-fullscreen-button>\n                                    <smp-chromecast-button smp-context class="layout_button"></smp-chromecast-button>\n                                    <smp-pip-button smp-context class="layout_button"></smp-pip-button>\n                                    <div class="playback_settings_button_and_panel_wrap">\n                                        <smp-playback-settings-button smp-context class="layout_button"></smp-playback-settings-button>\n                                        <smp-playback-settings-panel class="overlay_panel" smp-context></smp-playback-speed-settings-panel>\n                                    </div>\n                                    <div class="playback_speed_button_and_panel_wrap">\n                                        <smp-playback-speed-button button-text="1" smp-context class="layout_button"></smp-playback-speed-button>\n                                        <smp-playback-speed-settings-panel  smp-context></smp-playback-speed-settings-panel>\n                                    </div>\n                                    <smp-play-queue-button smp-context class="layout_button"></smp-play-queue-button>\n                                    <smp-transcription-button smp-context class="layout_button"></smp-transcription-button>\n                                    <div class="subtitles_button_and_panel_wrap">\n                                         <smp-subtitles-button smp-context class="layout_button"></smp-subtitles-button>\n                                         <smp-subtitles-settings-panel class="overlay_panel" smp-context></smp-subtitles-settings-panel>\n                                    </div>\n                                 </div>';class La extends Ks{constructor(t){super({stylesheet:'.button_container{align-items:flex-start;display:flex;justify-content:flex-end}:host(.three_rows) .button_container{display:grid;grid-template-areas:". . . .";grid-template-columns:auto;justify-items:center}:host(.three_rows.small_B2.buttonCount_3) .button_container{grid-template-columns:80px 64px 48px}:host(.three_rows.buttonCount_2) .button_container{grid-template-columns:64px 64px}:host(.three_rows.buttonCount_2.small_B2) .button_container{grid-template-columns:64px 48px}:host(.three_rows.buttonCount_1) .button_container{grid-template-columns:64px}:host(.three_rows.buttonCount_1.small_B2) .button_container{grid-template-columns:48px}:host(.three_rows.buttonCount_3) .button_container{grid-template-columns:80px 64px 64px}:host(.three_rows.buttonCount_4) .button_container{grid-template-columns:64px 80px 64px 64px}:host(.three_rows.small_B2.buttonCount_4) .button_container{grid-template-columns:64px 80px 64px 48px}:host(.three_rows.B3_over_600.buttonCount_2) .button_container{grid-template-columns:64px 64px}:host(.three_rows.B3_over_600.buttonCount_3) .button_container{grid-template-columns:96px 64px 64px}:host(.three_rows.B3_over_600.buttonCount_4) .button_container{grid-template-columns:64px 96px 64px 64px}:host(.three_rows.coreControlsOneButton) .button_container,:host(.three_rows.coreControlsThreeButtons) .button_container{grid-template-columns:64px 80px 64px}:host(.three_rows.coreControlsOneButton.buttonCount_2) .button_container,:host(.three_rows.coreControlsThreeButtons.buttonCount_2) .button_container{grid-template-columns:80px 64px}:host(.three_rows.coreControlsOneButton.buttonCount_1) .button_container,:host(.three_rows.coreControlsThreeButtons.buttonCount_1) .button_container{grid-template-columns:64px}:host(.three_rows.coreControlsOneButton.buttonCount_4) .button_container,:host(.three_rows.coreControlsThreeButtons.buttonCount_4) .button_container{grid-template-columns:64px 80px 64px 64px}:host(.three_rows.coreControlsOneButton.buttonCount_3) .button_container,:host(.three_rows.coreControlsThreeButtons.buttonCount_3) .button_container{grid-template-columns:80px 64px 64px}:host(.three_rows.coreControlsThreeButtons.buttonCount_4.small_B2) .button_container{grid-template-columns:48px 80px 48px 48px}:host(.three_rows.coreControlsThreeButtons.buttonCount_3.small_B2) .button_container{grid-template-columns:80px 48px 48px}:host(.three_rows.coreControlsThreeButtons.buttonCount_2.small_B2) .button_container{grid-template-columns:80px 48px}:host(.three_rows.coreControlsThreeButtons.buttonCount_4.small_B2.coreControlsHasIntervalButtons) .button_container{grid-template-columns:64px 80px 64px 64px}:host(.three_rows.coreControlsThreeButtons.buttonCount_3.small_B2.coreControlsHasIntervalButtons) .button_container{grid-template-columns:80px 64px 64px}:host(.three_rows.coreControlsThreeButtons.buttonCount_2.small_B2.coreControlsHasIntervalButtons) .button_container{grid-template-columns:80px 64px}:host(.three_rows.coreControlsOneButton.B3_over_600.buttonCount_4) .button_container,:host(.three_rows.coreControlsThreeButtons.B3_over_600.buttonCount_4) .button_container{grid-template-columns:64px 96px 64px 64px}:host(.three_rows.coreControlsOneButton.B3_over_600.buttonCount_3) .button_container,:host(.three_rows.coreControlsThreeButtons.B3_over_600.buttonCount_3) .button_container{grid-template-columns:96px 64px 64px}.layout_button.hidden{display:none}smp-chromecast-button,smp-fullscreen-button,smp-pip-button,smp-play-queue-button,smp-playback-settings-button,smp-playback-speed-button,smp-subtitles-button,smp-transcription-button{height:48px;width:48px}smp-transcription-button{order:1}.subtitles_button_and_panel_wrap{order:2}smp-play-queue-button{order:3}.playback_speed_button_and_panel_wrap{order:4}.playback_settings_button_and_panel_wrap{order:6}smp-pip-button{order:8}smp-chromecast-button{order:10}smp-fullscreen-button{order:12}:host(.smp_B1) smp-subtitles-settings-panel{display:none}:host(.smp_B1) smp-playback-speed-settings-panel{display:none}smp-chromecast-button.shown{display:block}.removed,smp-chromecast-button.hidden{display:none}smp-subtitles-settings-panel{--smp-subtitles-settings-panel-up-arrow-display:block;--smp-subtitles-settings-panel-down-arrow-display:none;margin-top:7px;pointer-events:none;position:absolute;right:13px;right:0;z-index:140}:host(.audio_ui) smp-subtitles-settings-panel,:host(.rightBottom) smp-subtitles-settings-panel,:host(.smp_B4) smp-subtitles-settings-panel{--smp-subtitles-settings-panel-up-arrow-display:none;--smp-subtitles-settings-panel-down-arrow-display:block;bottom:54px;margin-top:0}smp-playback-settings-panel,smp-playback-speed-settings-panel{--smp-subtitles-settings-panel-up-arrow-display:block;--smp-subtitles-settings-panel-down-arrow-display:none;margin-top:7px;pointer-events:none;position:absolute;right:0;z-index:140}:host(.audio_ui) smp-playback-settings-panel,:host(.rightBottom) smp-playback-settings-panel,:host(.smp_B4) smp-playback-settings-panel{--smp-subtitles-settings-panel-up-arrow-display:none;--smp-subtitles-settings-panel-down-arrow-display:block;bottom:54px;margin-top:0;top:unset}:host(.audio_ui) smp-playback-speed-settings-panel,:host(.rightBottom) smp-playback-speed-settings-panel,:host(.smp_B4) smp-playback-speed-settings-panel{--smp-subtitles-settings-panel-up-arrow-display:none;--smp-subtitles-settings-panel-down-arrow-display:block;bottom:54px;margin-top:0;top:unset}:host(.audio_ui) smp-playback-speed-settings-panel{right:-3px}:host(:not(.smp_B4)) smp-fullscreen-button,:host(:not(.smp_B4)) smp-pip-button,:host(:not(.smp_B4)) smp-subtitles-button{transform:scale(.85)}:host(:not(.smp_B4)) smp-fullscreen-button.fadedIn,:host(:not(.smp_B4)) smp-pip-button.fadedIn,:host(:not(.smp_B4)) smp-subtitles-button.fadedIn{transform:scale(1);transition:transform .5s cubic-bezier(.2,0,0,1)}:host(:not(.smp_B4)) smp-fullscreen-button.fadedOut,:host(:not(.smp_B4)) smp-pip-button.fadedOut,:host(:not(.smp_B4)) smp-subtitles-button.fadedOut{transition:transform .25s cubic-bezier(.79,.09,.48,.96)}:host(.audio_ui) smp-chromecast-button{display:none!important}:host([audioLayout].slim_controls.show_slim_controls:not(.three_rows)) .layout_button,:host([audioLayout].slim_controls.slim_height) .layout_button{--smp-secondary-controls-svg-dimension:16px;height:40px;width:40px}',template:Pa,templateName:"buttonGroup",toucanPlayer:t}),this.THREE_ROWS_HEIGHT=220,this.buttonWidth=48}create(){super.create();const t=this.outerContainer=this.shadowRoot.querySelector(".button_container");this.fullscreenButton=t.getElementsByTagName("smp-fullscreen-button")[0],this.subtitlesButton=t.getElementsByTagName("smp-subtitles-button")[0],this.transcriptionButton=t.getElementsByTagName("smp-transcription-button")[0],this.pictureInPictureButton=t.getElementsByTagName("smp-pip-button")[0],this.chromecastButton=t.getElementsByTagName("smp-chromecast-button")[0],this.subtitlesSettingPanel=t.getElementsByTagName("smp-subtitles-settings-panel")[0],this.subtitlesSettingButton=t.getElementsByTagName("smp-subtitles-button")[0],this.playbackSpeedSettingsButton=t.getElementsByTagName("smp-playback-speed-button")[0],this.playbackSpeedSettingsPanel=t.getElementsByTagName("smp-playback-speed-settings-panel")[0],this.playbackSpeedButtonAndPanelWrap=t.getElementsByClassName("playback_speed_button_and_panel_wrap")[0],this.playbackSettingsButtonAndPanelWrap=t.getElementsByClassName("playback_settings_button_and_panel_wrap")[0],this.subtitlesButtonAndPanelWrap=t.getElementsByClassName("subtitles_button_and_panel_wrap")[0],this.playQueueButton=t.getElementsByTagName("smp-play-queue-button")[0],this.playbackSettingsButton=t.getElementsByTagName("smp-playback-settings-button")[0],this.playbackSettingsPanel=t.getElementsByTagName("smp-playback-settings-panel")[0],this.isAudio&&(this.classList.add("audio_ui"),this.playbackSpeedSettingsButton.classList.add("audio_ui"),this.playQueueButton.classList.add("audio_ui"),this.chromecastButton.classList.add("audio_ui"),this.playbackSettingsButton.classList.add("audio_ui"),this.transcriptionButton.classList.add("audio_ui"));let e=this;this.subtitlesButton.addEventListener("focusout",t=>{e.subtitlesSettingPanel==t.relatedTarget||e.subtitlesSettingPanel.contains(t.relatedTarget)||e.subtitlesSettingPanel.hide(!0)}),this.playbackSpeedSettingsButton.addEventListener("focusout",t=>{e.playbackSpeedSettingsPanel==t.relatedTarget||e.playbackSpeedSettingsPanel.contains(t.relatedTarget)||e.playbackSpeedSettingsPanel.hide(!0)}),this.playbackSettingsButton.addEventListener("focusout",t=>{e.playbackSettingsPanel==t.relatedTarget||e.playbackSettingsPanel.contains(t.relatedTarget)||e.playbackSettingsPanel.hide(!0)});const i=this;this.playbackSpeedSettingsButton.parentElement.addEventListener("hidingWithFocus",t=>{document.activeElement==i.toucanPlayer&&i.playbackSpeedSettingsButton.takeFocus(),t.stopPropagation()}),this.playbackSettingsButton.parentElement.addEventListener("hidingWithFocus",t=>{document.activeElement==i.toucanPlayer&&i.playbackSettingsButton.takeFocus(),t.stopPropagation()}),this.subtitlesButton.parentElement.addEventListener("hidingWithFocus",t=>{document.activeElement==i.toucanPlayer&&i.subtitlesButton.takeFocus(),t.stopPropagation()})}onRooted(){if(super.onRooted(),isNaN(this.uiConfig.subtitles.sizeAdjustment)){const t=Si("ckps_smpSettings");if(t)try{const e=JSON.parse(t);e&&e.subtitles&&!isNaN(e.subtitles.sizeAdjustment)&&(this.uiConfig.subtitles.sizeAdjustment=e.subtitles.sizeAdjustment)}catch(t){}}var t;this.updateUiConfig(this.uiConfig),(t=this).subtitlesButton.setActionFunction(function(){t.subtitlesSettingPanel.shown?Ia(t):(Oa(t),t.subtitlesSettingPanel.show())}),t.transcriptionButton.setActionFunction(function(e){t.eventBus.trigger("transcriptionPressed");const i=e.detail.fromKeyboard?"key_press":"click",s=Os;t.echoReporter.trackAction(s,i)}),t.subtitlesSettingPanel.setSubsToggleCallback(function(e){const i=t.toucanPlayer;t.eventBus.trigger("subtitles-toggle");const s=e.detail.fromKeyboard?"key_press":"click",n=i.subtitlesOn?ji:Gi;t.echoReporter.trackAction(n,s)}),t.subtitlesSettingPanel.setADToggleCallback(function(e){const i=t.toucanPlayer;t.eventBus.trigger("ad-toggle");const s=e.detail.fromKeyboard?"key_press":"click",n=i.audioDescriptionOn?Ns:Rs;t.echoReporter.trackAction(n,s)}),t.fullscreenButton.setActionFunction(function(e){t.toucanPlayer.toggleFullscreen(),t.eventBus.trigger("focusOnPlayPause");const i=mi(e),s=t.toucanPlayer.isFullscreen?Vi:Wi;t.echoReporter.trackAction(s,i)}),t.pictureInPictureButton.setActionFunction(function(e){t.eventBus.trigger("togglePictureInPictureRequested");const i=mi(e),s=t.toucanPlayer.pictureInPicture.pipActive?as:rs;t.echoReporter.trackAction(s,i)}),t.chromecastButton.setActionFunction(function(e){t.toggleChromecastDeviceSelection();const i=mi(e);t.echoReporter.trackAction(Ts,i)}),t.playQueueButton.setActionFunction(e=>{const i=mi(e);t.echoReporter.trackAction(Is,i),t.eventBus.trigger("playQueuePressed")}),t.playbackSpeedSettingsButton.setActionFunction(function(e){let i;t.playbackSpeedSettingsPanel.shown?(t.playbackSpeedSettingsPanel.hide(),i=Cs):(t.playbackSpeedSettingsPanel.show(),i=Es);const s=mi(e);t.echoReporter.trackAction(i,s)}),t.playbackSettingsButton.setActionFunction(function(e){let i;t.playbackSettingsPanel.shown?(t.playbackSettingsPanel.hide(),i=gs):(t.playbackSettingsPanel.show(),i=ms);const s=mi(e);t.echoReporter.trackAction(i,s)}),t.playbackSpeedSettingsPanel.setActionFunctions(Ra.bind(t),Ra.bind(t),Ra.bind(t),Ra.bind(t),Ra.bind(t),Ra.bind(t)),t.subtitlesSettingPanel.setActionFunctions(Na.bind(t),Na.bind(t),Na.bind(t),Na.bind(t),Na.bind(t)),this.toucanPlayer.isFullscreen?this.fullscreenButton.setExitState():this.fullscreenButton.setEnterState(),this.nameMap={fullscreen:{button:this.fullscreenButton,index:0},chromecast:{button:this.chromecastButton,index:1},"picture-in-picture":{button:this.pictureInPictureButton,index:2},"settings-cog":{button:this.playbackSettingsButton,index:3},speed:{button:this.playbackSpeedSettingsButton,index:4},"play-queue":{button:this.playQueueButton,index:5},transcript:{button:this.transcriptionButton,index:6},subtitles:{button:this.subtitlesButton,index:7}},this.dispatchEvent(new CustomEvent("takeFocusNames",{bubbles:!0,composed:!0,detail:{names:Object.keys(this.nameMap)}})),function(t){const e=t.eventBus,i=t.toucanPlayer;e.bind(["audioDescriptionChange","trackchanged"],()=>{t.subtitlesSettingPanel.adToggle.setState(i.audioDescriptionOn)}),e.bind("focusButton",e=>{let i=!1;if(e.group)return"secondary"==e.group&&(i=!Oi(t.nameMap,0),i)?void t.dispatchEvent(new CustomEvent("focusGroup",{bubbles:!0,composed:!0,detail:{group:"volume"}})):void 0;let s=t.nameMap[e.name];if(s)if(e.after){if(i=!Oi(t.nameMap,s.index+1),i)return void t.dispatchEvent(new CustomEvent("focusGroup",{bubbles:!0,composed:!0,detail:{group:"volume"}}))}else{let e=s.button;e&&(i=!Ii(e)),i&&t.eventBus.trigger("focusOnPlayPause")}}),e.bind("fullscreenchange",()=>{i.isFullscreen?(t.subtitlesSettingPanel.heightAvailable=i.offsetHeight-54,t.fullscreenButton.setExitState(),t.eventBus.trigger("exitPictureInPictureRequested")):(t.fullscreenButton.setEnterState(),t.subtitlesSettingPanel.heightAvailable=void 0)}),e.bind("picInPicStopped",()=>{t.pictureInPictureButton.setEnterState()}),e.bind("picInPicStarted",()=>{t.pictureInPictureButton.setExitState()}),e.bind("fullToucanPiPtoggled",()=>{t.subtitlesSettingPanel.heightAvailable=i.picInPicActive?i.offsetHeight-54:void 0}),e.bind("playerSizeChange",()=>{(i.isFullscreen||i.pictureInPicture.fullPipActive)&&(t.subtitlesSettingPanel.heightAvailable=i.offsetHeight-54)}),e.bind("notableTimechange",()=>{t.determineButtonsToShow()}),e.bind("currentPlaybackChange",()=>{t.determineButtonsToShow()}),e.bind("subtitlesAvailability",()=>{t.determineButtonsToShow(),t.subtitlesSettingPanel.showSubtitles=i.subtitlesAvailable}),e.bind(["mediaItemChanged","durationchange"],()=>{t.determineButtonsToShow()}),e.bind("chromecastStateChange",e=>{[Zs.STATE.NOT_CONNECTED,Zs.STATE.NO_DEVICES_AVAILABLE,Zs.STATE.SELECT_DEVICE].includes(e.detail.newState)?t.chromecastButton.setEnterState():t.chromecastButton.setExitState(),t.determineButtonsToShow()}),e.bind("ratechange",()=>{let e=i.playbackController.playbackRate;e=(Math.floor(e)==e?e:e.toFixed(1))+"",t.playbackSpeedSettingsButton.setAttribute("button-text",e),t.playbackSpeedSettingsPanel.setAttribute("selected",e)}),e.bind("externalSubtitleSizeChange",e=>{t.subtitlesSettingPanel.setAttribute("selected",e.newSize),t.setSizeInSettings(e.newSize)}),e.bind("fullToucanPiPtoggled",()=>{t.determineButtonsToShow()}),e.bind("subtitlesPanelOpened",()=>{t.playbackSettingsPanel.hide(),t.playbackSpeedSettingsPanel.hide()}),e.bind("playbackSettingsPanelOpened",()=>{t.subtitlesSettingPanel.hide(),t.playbackSpeedSettingsPanel.hide()}),e.bind("playbackSpeedSettingsPanelOpened",()=>{t.subtitlesSettingPanel.hide(),t.playbackSettingsPanel.hide()})}(this)}get isAudio(){return this.hasAttribute("audioLayout")}get maxWidth(){return this.getAttribute("max-width")||0}set maxWidth(t){this.maxWidth!=t&&(this.setAttribute("max-width",t),this.determineButtonsToShow(!0))}determineButtonsToShow(t){let e=this.uiConfig,i=this.toucanPlayer;this.playbackSpeedSettingsButton.showHide(e.controls.speed&&!i.isCasting&&i.playbackController.canSeek&&"B1"!==this.breakpoint),this.subtitlesButton.showHide(!this.isAudio&&(e.subtitles.enabled&&i.subtitlesAvailable||e.language.audioDescription&&i.audioDescriptionAvailable)&&"B1"!==this.breakpoint),this.transcriptionButton.showHide(e.transcription.enabled&&!e.subtitles.enabled&&"B1"!==this.breakpoint),this.fullscreenButton.showHide(!this.isAudio&&e.fullscreen.enabled&&i.fullscreenSupported&&!this.toucanPlayer.pictureInPicture.fullPipActive),this.pictureInPictureButton.showHide((!this.isAudio&&"video"==i.contentType||e.pictureInPicture.full&&"documentPictureInPicture"in window)&&e.pictureInPicture.enabled&&document.pictureInPictureEnabled&&!i.isCasting&&"B1"!==this.breakpoint),this.playbackSettingsButton.showHide(Aa(this)),this.chromecastButton.showHide(i.chromecastAvailable&&e.chromecast.enabled&&(i._config.supportLiveChromecast||!i.isLive)&&!this.toucanPlayer.pictureInPicture.fullPipActive&&"B1"!==this.breakpoint),this.playQueueButton.showHide(e.playQueue.enabled&&"B1"!==this.breakpoint);let s=0;const n=this.outerContainer.querySelectorAll(".layout_button");n.forEach(function(t){t.showing&&s++}),this.buttonCount=s;var o=!1;if(isNaN(this.previousButtonCount)||this.previousButtonCount==s||(o=!0),t&&(this.previousButtonCount=this.buttonCount),this.isAudio){const t=["buttonCount_1","buttonCount_2","buttonCount_3","buttonCount_4"];for(let e=0;e<t.length;e++)this.classList.remove(t[e]);let e="buttonCount_"+s;this.classList.add(e)}let a=[this.pictureInPictureButton,this.chromecastButton,this.playbackSettingsButton,this.playbackSpeedSettingsButton,this.playQueueButton,this.subtitlesButton,this.transcriptionButton,this.fullscreenButton];if(this.isAudio){let e=this.getRootNode().host;if(this.backToThreeWidth<=0||this.backToThreeWidth-20<s*this.buttonWidth){e.offsetHeight>=this.THREE_ROWS_HEIGHT?e.threeRows=!0:this.eventBus.triggerEvent(new Q({height:220}))}else this.backToThreeWidth-20>s*this.buttonWidth&&(!t&&o||(e.threeRows=!1))}if(this.maxWidth<=0)n.forEach(function(t){t.showHide(!1)});else if(this.maxWidth<s*this.buttonWidth){let t=Math.ceil((s*this.buttonWidth-this.maxWidth)/this.buttonWidth);for(this.buttonCount=this.buttonCount-t;t>0;){let e=a.shift();e.showing&&(e.showHide(!1),t--)}}this.subtitlesButton.showAD=e.language.audioDescription&&i.audioDescriptionAvailable,this.subtitlesButton.showSubs=e.subtitles.enabled&&this.toucanPlayer.subtitlesAvailable,this.subtitlesSettingPanel.adToggle.setState(i.audioDescriptionOn),this.subtitlesSettingPanel.subsToggle.setState(i.subtitlesOn),Fa(this),Da(this),3===this.coreControlsButtoncount?this.classList.add("coreControlsThreeButtons"):this.classList.remove("coreControlsThreeButtons"),1===this.coreControlsButtoncount||this.coreControlsNoSeeking?this.classList.add("coreControlsOneButton"):this.classList.remove("coreControlsOneButton"),this.coreControlsHasIntervalButtons?this.classList.add("coreControlsHasIntervalButtons"):this.classList.remove("coreControlsHasIntervalButtons"),this.isAudio&&(this.coreControlsNoSeeking?this.playbackSpeedButtonAndPanelWrap.style.display="none":e.controls.speed&&(this.playbackSpeedButtonAndPanelWrap.style.display="block"))}updateUiConfig(t){super.updateUiConfig(t),Oa(this);const e=this;window.requestAnimationFrame(function(){e.determineButtonsToShow()}),this.fullscreenButton.useCloseIcon=t.fullscreen.useCloseIconForExitFullscreen,Da(this),Fa(this),t.playQueue.enabled&&this.playQueueButton.setState(t.playQueue.on),t.transcription.enabled&&(t.transcription.on?this.transcriptionButton.on():this.transcriptionButton.off()),this.isAudio&&(t.controls.speed?this.playbackSpeedButtonAndPanelWrap.style.display="block":this.playbackSpeedButtonAndPanelWrap.style.display="none",Aa(this,!0)?this.playbackSettingsButtonAndPanelWrap.style.display="block":this.playbackSettingsButtonAndPanelWrap.style.display="none",t.subtitles.enabled&&this.subtitlesAvailable?this.subtitlesButtonAndPanelWrap.style.display="block":this.subtitlesButtonAndPanelWrap.style.display="none")}fadeChange(t,e){super.fadeChange(t,e),t||(Ia(this),this.playbackSpeedSettingsPanel.hide(),this.playbackSettingsPanel.hide())}toggleChromecastDeviceSelection(){this.eventBus.trigger("chromecastDeviceSelection")}breakpointchange(t){super.breakpointchange(t),this.breakpoint=t.breakpoint,this.determineButtonsToShow(),Fa(this),Da(this)}setSizeInSettings(t){const e=Ce.get(t),i={subtitles:{sizeAdjustment:e&&e.value}};return this.toucanPlayer.uiSettings=i,xi(i),e&&e.value}}function Aa(t,e){const i=t.uiConfig.playbackSettingsPanel,s=t.toucanPlayer.playbackController.quality;return i.enabled&&(i.continuousPlaySetting||i.qualitySetting&&s)&&("B1"!==t.breakpoint||e)}function Ia(t,e){t.subtitlesSettingPanel.hide(e)}function Oa(t){let e=t.subtitlesSettingPanel,i=t.uiConfig,s=i.subtitles.sizeAdjustment;isNaN(s)&&(s=Be(t.toucanPlayer._uiinfo));const n=Se.find(t=>t.value===s);let o=n&&n.shortName;o||(o="m"),e.selected=o;let a=t.toucanPlayer.isStandardPlayback;e.showAD=i.language.audioDescription&&t.toucanPlayer.audioDescriptionAvailable,e.showSubtitles=i.subtitles.enabled&&t.toucanPlayer.subtitlesAvailable,e.showCustom=a}const Na=function(t,e,i){const s=this.setSizeInSettings(i.getAttribute("size"));clearTimeout(this.recordSizeTimeout);let n=this.toucanPlayer.offsetWidth,o=this.toucanPlayer.offsetHeight,a=this;this.recordSizeTimeout=setTimeout(function(){a.echoReporter.trackAction("user_selected_sub_size",s,{player_width:n,player_height:o})},1e4)},Ra=function(t,e,i){let s=i.getAttribute("speed").replace(/[^\d.-]/g,"");s=Number(s),this.eventBus.trigger("playbackRateChangeRequested",{value:s});let n=i.button.getAttribute("stats-label");this.echoReporter.trackAction(n,e)},Fa=function(t){let e=t.buttonCount;e="B4"===t.breakpoint?e:e+1;let i=48*e;i+="px",e>=6?t.style.setProperty("--smp-panels-min-width",i):t.style.removeProperty("--smp-panels-min-width")},Da=function(t){const e=t.subtitlesButton.getBoundingClientRect().right,i=t.subtitlesSettingPanel.getBoundingClientRect().right-e+18+"px";t.style.setProperty("--smp-subtitles-settings-panel-arrow-right",i);const s=t.playbackSpeedSettingsButton.getBoundingClientRect().right,n=t.playbackSpeedSettingsPanel.getBoundingClientRect().right-s+18+"px";t.style.setProperty("--smp-playback-speed-settings-panel-arrow-right",n);const o=t.playbackSettingsButton.getBoundingClientRect().right,a=t.playbackSettingsPanel.getBoundingClientRect().right-o+18+"px";t.style.setProperty("--smp-playback-settings-panel-arrow-right",a)};customElements.get("smp-secondary-controls")||customElements.define("smp-secondary-controls",La);const Ma=["highlight","key"],Ha=function(t,e){return t.start-e.start},qa=document.createElement("template");qa.innerHTML='<div class="seek_bar_holder">\n                                    <div>\n                                        <div class="seek_bar_holder_inner"></div>\n                                    </div>\n                                </div>';class za extends le{constructor(){super({stylesheet:en+".seek_bar_holder{-webkit-tap-highlight-color:transparent;box-sizing:border-box;padding:var(--smp-seek-bar-base-padding-three-times,24px) var(--smp-seek-bar-base-padding,8px);touch-action:none;width:100%}.seek_bar_holder_inner{position:relative}button{background-color:transparent;border:none;bottom:1px;box-sizing:border-box;cursor:pointer;display:flex;justify-content:center;margin:0;outline:none;padding:0;pointer-events:auto;position:absolute}button:focus-visible{border:none;outline:none}.default{background:#000;border:1px solid #202224;height:22px;opacity:50%;width:22px}:host(.smallMarkers) .p_keyMoment{display:none}.p_keyMoment{cursor:pointer;margin-left:-50%}.arrow{background-color:var(--smp-fore-colour-tab);bottom:-21px;height:4px;margin-left:-50%;pointer-events:none;position:absolute;width:4px}.default span{background-color:transparent;border:2px solid #fff;border-radius:4px;display:block;height:3px;margin-left:7px;margin-top:7px;width:3px}.marker .default:hover,button:focus-visible .default{border-width:0;border-top:2px solid #fff;opacity:100%;outline:none;z-index:1000}.marker .default:hover span,button:focus-visible .default span{outline:none}.marker .default:hover .arrow,button:focus-visible .default .arrow{border-top:5px solid #fff;outline:none}.marker .extra{background-color:#fff;bottom:calc(100% + 10px);color:#000;padding:4px;width:fit-content;z-index:1000}.extraarrow,.marker .extra{display:none;margin-left:-50%;position:absolute}.extraarrow{border-left:5px solid transparent;border-right:5px solid transparent;border-top:5px solid #fff;bottom:100%;height:5px;width:0}button:focus-visible .extra,button:focus-visible .extraarrow,button:hover .extra,button:hover .extraarrow{display:block}button:focus-visible .extra:empty,button:focus-visible .extraarrow:empty,button:hover .extra:empty,button:hover .extraarrow:empty{display:none}",template:qa,templateName:"progressBar"}),this.storedMarkers={},this.activeMarkers=[],this.outOfBoundsMarkers=[]}create(){super.create(),this.bar=this.shadowRoot.querySelector(".seek_bar_holder_inner")}breakpointchange(t){t.smallMarkers?this.classList.add("smallMarkers"):this.classList.remove("smallMarkers")}setRewindWindow(t,e,i){this.streamStart=t||0,this.streamEnd=e||0,this.latestAllowableSeek=function(t,e){return t&&t<=e?t:e}(i,this.streamEnd);let s=[];this.outOfBoundsMarkers.forEach(t=>{let e=t.marker;e.start>=this.streamStart&&e.start<=this.streamEnd?(this.activeMarkers.push(t),t.style.display="flex"):s.push(t)}),this.outOfBoundsMarkers=s,this.activeMarkers.forEach(t=>{let e=Ka(t.marker.start,this.streamEnd,this.streamStart);t.style.left=e+"%"})}setActionFunctions(t){this.seekedFunction=t}get disabled(){return this.getAttribute("disabled")}set disabled(t){this.getAttribute("disabled")!==t&&this.setAttribute("disabled",t)}loadCSS(t){Array.isArray(t)?t.forEach(t=>{$a(this,t)}):$a(this,t)}updateMarkers(t){t.sort(Ha);for(let e=0;e<t.length;e++){let i=t[e];if(Ma.includes(i.type)){let t=this.storedMarkers[i.id];t?Ga(i,t):(t=ja(i),t.marker=i,this.storedMarkers[i.id]=t,t.addEventListener("click",Ua.bind(this,i)),t.addEventListener("pointerup",Wa.bind(this,i)),this.bar.appendChild(t));let e=Ka(i.start,this.streamEnd,this.streamStart);t.style.left=e+"%",t.style.display="flex"}}this.activeMarkers=[],this.outOfBoundsMarkers=[],Object.keys(this.storedMarkers).forEach(e=>{let i=this.storedMarkers[e];if(t.find(t=>t.id==e)){let t=i.marker;t.start>=this.streamStart&&t.start<=this.streamEnd?this.activeMarkers.push(i):(i.style.display="none",this.outOfBoundsMarkers.push(i))}else i.style.display="none"})}reset(){this.streamStart=0,this.streamEnd=0,this.currentTime=0,this.latestAllowableSeek=0,this.progressPercent=0,this.disabled=!1,Object.keys(this.storedMarkers).forEach(t=>{this.storedMarkers[t].parentElement.removeChild(this.storedMarkers[t])}),this.storedMarkers={},this.activeMarkers=[]}get showingMarkers(){return this.activeMarkers.length>0}get marginAdjustment(){let t=this.activeMarkers.reduce((t,e)=>Math.min(t,e.offsetTop),0);return t=t<0?t-5:0,t}setTime(t,e){}}function Ua(t,e){this.dispatchEvent(new CustomEvent("markerinteract",{detail:{marker:t,event:e}})),this.seekedFunction(t.start)}function Wa(t,e){e.currentTarget==this.shadowRoot.activeElement?(this.dispatchEvent(new CustomEvent("markerinteract",{detail:{marker:t,event:e}})),this.seekedFunction(t.start)):(e.currentTarget.focus(),e.stopPropagation(),e.preventDefault())}const Va=document.createElement("button");function ja(t){let e=Va.cloneNode(!0);return e.id=t.id,e.className="marker",Ga(t,e),e}function Ga(t,e){e.firstChild.className="p_keyMoment "+(t.className?t.className:"default"),t.ariaLabel&&e.setAttribute("aria-label",t.ariaLabel);let i=e.querySelector(".extra");t.richDescription?i.innerHTML=t.richDescription:i.textContent=t.description||t.text}function $a(t,e){let i=t.shadowRoot.querySelectorAll("link"),s=!1;for(let t=0;t<i.length;t++)if(i[t].href==e){s=!0;break}if(!s){var n=document.createElement("link");n.type="text/css",n.rel="stylesheet",n.href=e,t.shadowRoot.appendChild(n)}}function Ka(t,e,i){let s=(t-i)/(e-i)*100;return s=Math.max(0,Math.min(s,100)),s}Va.innerHTML="<div><span></span></div><div class='arrow'></div><div class='extra'></div><div class='extraarrow'></div>",customElements.get("smp-markers-bar")||customElements.define("smp-markers-bar",za);const Qa=document.createElement("template");Qa.innerHTML='<div class="wrap" style="display:none">\n                                    <smp-time-tip class="time"></smp-time-tip>\n                                    <div class="triangle"></div>\n                                </div>';class Ya extends le{constructor(){super({stylesheet:":host{--smp-time-tip-colour:#000;display:flex;pointer-events:none}.wrap{align-items:center;background:#fff;bottom:var(--smp-time-tipe-seek-wrap-bottom,43px);height:1rem;justify-content:center;line-height:2;min-width:3rem}.triangle,.wrap{position:absolute}.triangle{border-left:6px solid transparent;border-right:6px solid transparent;border-top:5px solid #fff;top:1rem}:host(.audio_ui) .wrap{--smp-time-tip-colour:var(--smp-colour-on-base-colour);background:var(--smp-base-colour,#fff);font-weight:700}:host(.audio_ui) .triangle{border-top:5px solid var(--smp-base-colour,#fff)}:host(.audio_ui) .wrap{bottom:var(--smp-time-tip-seek-bottom,calc(100% - 10px))}",template:Qa,templateName:"timeTipSeek"})}create(){super.create(),this.timeTip=this.timeTipSeek.getElementsByTagName("smp-time-tip")[0],this.triangle=this.timeTipSeek.getElementsByClassName("triangle")[0]}show(t,e){this.timeTip.time=e,this.timeTipSeek.style.display="flex";let i=Math.max(t,8)-Math.round(this.timeTipSeek.getBoundingClientRect().width/2),s=0;i<0&&(s=2*-Math.abs(i,0),i=0),this.triangle.style.marginLeft=s+"px",this.timeTipSeek.style.left=i+"px"}hide(){this.timeTipSeek.style.display="none"}}customElements.get("smp-time-tip-seek")||customElements.define("smp-time-tip-seek",Ya);const Ja=document.createElement("template");Ja.innerHTML='<div class="wrap"></div>';class Xa extends le{static get observedAttributes(){return["size","time","left"]}constructor(){super({stylesheet:":host{pointer-events:none}.wrap{background:#767676;border:1px solid #fff;bottom:var(--smp-thumbnail-scrubbing-wrap-bottom,43px);position:absolute;visibility:hidden;z-index:1}.show{transition:visibility 0s linear .3s;visibility:visible}.hide{visibility:hidden}",template:Ja,templateName:"thumbnailScrubbing"}),this.manifestJSON=null,this._manifestHref=null,this.mediaItem=null,this.connectionIndex=0,this.thumbData={},this._hasData=!1,this._enabled=!0,this.holderContainer=null,this._manifestDownloader=Za,this._getThumbnailData=er}attributeChangedCallback(t,e,i){this.shadowRoot&&e!=i&&this.markDirty()}render(){let t,e;switch(super.render(),this.size){case"s":default:t=128,e=72;break;case"m":t=192,e=108;break;case"l":t=224,e=126}const i=this.time;if(isNaN(i))return;const s=this._getThumbnailData(this,i,t,e);if(!s)return;const n=t+"x"+e+s.storyBoardUrl;n!=this.thumbnailData&&(this.thumbnailData=n,this.thumbnailScrubbing.style.width=t+"px",this.thumbnailScrubbing.style.height=e+"px",this.thumbnailScrubbing.style.backgroundImage="url("+s.storyBoardUrl+")"),this.thumbnailScrubbing.style.backgroundPosition=s.x+"px "+s.y+"px";const o=function(t,e){const i=t.left-e/2;if(t.holderContainer&&t.parentContainer){const s=t.holderContainer.clientWidth;let n;return n=s<t.parentContainer.clientWidth+e/2?xe(i,0,s-e-2):i,n}return i}(this,t);this.thumbnailScrubbing.style.left=o+"px",this.thumbnailScrubbing.classList.remove("hide"),this.thumbnailScrubbing.classList.add("show")}initialise(t,e){this.holderContainer=t,this.parentContainer=e}newMediaItem(t){this.reset(),this.mediaItem=t,this._manifestDownloader(this)}reset(){this.manifestJSON=null,this._manifestHref=null,this.mediaItem=null,this.connectionIndex=0,this.thumbData={},this._hasData=!1}get initialised(){return null!==this.holderContainer}set size(t){this.setAttribute("size",t)}get size(){return this.getAttribute("size")}set time(t){this.setAttribute("time",t)}get time(){return this.getAttribute("time")}set left(t){this.setAttribute("left",t)}get left(){return this.getAttribute("left")}get manifestURL(){return this._manifestHref}set manifestURL(t){t!=this._manifestHref&&t&&(this.reset(),Za(this,t),this._initialised=!0)}get hasData(){return this._hasData}set hasData(t){this._hasData=t}show(t,e,i,s){Number.isFinite(s)&&(t+=s),this._enabled&&(this.size=e,this.time=t,this.left=i)}hide(){super.cancelRender(),this.thumbnailScrubbing.classList.remove("show"),this.thumbnailScrubbing.classList.add("hide")}get enabled(){return this._enabled}enable(){this._enabled=!0}disable(){this._enabled=!1,this.hide()}}function Za(e,i){if(i)e._manifestHref=i;else if(e.mediaItem&&e.mediaItem.connections){const t=e.mediaItem.connections.thumbnails;if(!t||!t[e.connectionIndex])return void 0;e._manifestHref=t[e.connectionIndex].href}e._manifestHref&&async function(t){let e;try{e=await fetch(t)}catch(t){}if(!e)throw{};if(!e.ok)throw{status:e.status};let i=await e.text();return{url:t,text:i}}(e._manifestHref).then(i=>{if(e._manifestHref==i.url)try{const s=function(e,i){const s={},n=(new window.DOMParser).parseFromString(e,"text/xml"),o=n.querySelectorAll("AdaptationSet"),a=n.querySelector("Period").getAttribute("duration");s.duration=function(t){const e=or.exec(t);if(e){const t=parseInt("0"+e[2],10),i=parseInt("0"+e[3],10),s=parseInt("0"+e[4],10),n=parseInt("0"+e[5],10),o=parseInt("0"+e[6],10);return parseFloat("0"+e[7])+60*o+60*n*60+24*s*60*60+30*i*24*60*60+365*t*24*60*60}return null}(a),s.thumbData=function(t,e,i){let s,n,o,a,r,l,u,c,d,h={},p={},m=function(t){let e="";-1!==t.indexOf("/")&&(-1!==t.indexOf("?")&&(t=t.substring(0,t.indexOf("?"))),e=t.substring(0,t.lastIndexOf("/")+1));return e}(i);for(c=0,d=e.length;c<d;c++)p={},s=e[c],n=s.querySelector("Representation").getAttribute("width"),o=s.querySelector("Representation").getAttribute("height"),u=n+"x"+o,a=s.querySelector("SegmentTemplate").getAttribute("media"),r=s.querySelector("Representation").getAttribute("id"),l=m+a.replace("$RepresentationID$",r),p.storyboardUrlTemplate=l,p.numberRows=s.querySelector("Representation").querySelectorAll("EssentialProperty")[0].getAttribute("value"),p.numberColumns=s.querySelector("Representation").querySelectorAll("EssentialProperty")[1].getAttribute("value"),p.thumbsPerBoard=p.numberRows*p.numberColumns,p.maxNumBoards=40,p.thumbInterval=s.querySelector("SegmentTemplate").getAttribute("timescale")/1e3,p.totalNumberThumbs=Math.floor(t/p.thumbInterval),p.lastBoard=Math.ceil(p.totalNumberThumbs/p.thumbsPerBoard)-1,h[u]=p;return h}(s.duration,o,i),t;return s}(i.text,e._manifestHref);e.duration=s.duration,e.thumbData=s.thumbData}catch(t){tr(e,!1)}},t=>tr(e,!0,t.status))}function tr(t,e,i){const s=e?"manifestFetchingError":"parsingError";const n=new CustomEvent(s,{detail:{extra:t._manifestHref+"_"+s+(void 0!==i?"_"+i:"")}});t.dispatchEvent(n);const o=t.mediaItem.connections.thumbnails;t.connectionIndex<o.length&&(t.connectionIndex++,Za(t))}function er(t,e,i,s){let n,o,a,r,l,u,c,d,h;if(h=i+"x"+s,n=t.thumbData[h],n)return t._hasData=!0,o=Math.min(n.totalNumberThumbs-2,Math.max(0,Math.ceil(e/n.thumbInterval)-1)),a=Math.floor(o/n.thumbsPerBoard),sr(n,a),a>0&&sr(n,a-1),a<n.lastBoard&&sr(n,a+1),r=o%n.thumbsPerBoard,u=r%n.numberColumns,l=Math.floor(r/n.numberColumns),c=nr(n.storyboardUrlTemplate,a),d={storyBoardUrl:c,x:-1*u*i,y:-1*l*s},d;t._hasData=!1}const ir={};function sr(t,e){const i=nr(t.storyboardUrlTemplate,e);if(!ir[i]){ir[i]=!0;(new Image).src=i}}function nr(t,e){return t.replace("$Number%04d$",("0000"+e).slice(-4))}const or=new RegExp("([+-]?)P(?:(\\d+)Y)?(?:(\\d+)M)?(?:(\\d+)D)?(?:T(?:(\\d+)H)?(?:(\\d+)M)?(?:(\\d+(?:\\.\\d+)?)S)?)?","i");customElements.get("smp-thumbnail-scrubbing")||customElements.define("smp-thumbnail-scrubbing",Xa);const ar=document.createElement("template");ar.innerHTML='<div class="seek_time_group">\n    <smp-thumbnail-scrubbing aria-hidden="true"></smp-thumbnail-scrubbing>\n    <smp-time-tip aria-hidden="true" class="time_tip_current"></smp-time-tip>\n    <smp-time-tip-seek class="time_tip_seek"></smp-time-tip-seek>\n    <div class="progress_bar">\n      <smp-progress-bar></smp-progress-bar>\n      <smp-markers-bar smp-context style="display:none"></smp-markers-bar>\n    </div>\n    <smp-time-tip aria-hidden="true" class="time_tip_duration"></smp-time-tip>\n</div>';class rr extends Ks{constructor(t){super({stylesheet:":host([disabled]) smp-thumbnail-scrubbing,:host([disabled].smp_B1) smp-time-tip-seek,:host([disabled]:not(.liveMedia)) smp-time-tip-seek{display:none!important}.seek_time_group{align-items:center;box-sizing:border-box;width:100%}.progress_bar,.seek_time_group{display:flex;justify-content:center}.progress_bar{flex-grow:1;position:relative}:host([videoLayout].smp_B1) .progress_bar{right:-8px}:host([videoLayout].smp_B1) .progress_bar,:host([videoLayout].smp_B2) .slimline_b2 .progress_bar{--smp-seek-bar-slider-clip-path:polygon(0px 0px,0px 0px,0px 0px,0px 0px);bottom:-21px;pointer-events:none;position:absolute;top:20px;width:calc(100% + 16px)}:host([videoLayout].smp_B2) .progress_bar,:host([videoLayout].smp_B3) .progress_bar,:host([videoLayout].smp_B4) .progress_bar{margin-left:8px;margin-right:8px}:host([videoLayout].liveMedia.smp_B2) .progress_bar,:host([videoLayout].liveMedia.smp_B3) .progress_bar,:host([videoLayout].liveMedia.smp_B4) .progress_bar{margin-left:24px}:host([videoLayout].liveMedia.smp_B2.slimline_b2) .progress_bar{margin-left:0;margin-right:0}:host([audioLayout].liveMedia.smp_B3) .progress_bar,:host([audioLayout].liveMedia.smp_B4) .progress_bar{margin-left:8px}smp-progress-bar{display:block;width:100%}:host([videoLayout]) .time_tip_current{margin-left:16px;opacity:1;transition:opacity .25s cubic-bezier(.2,0,.3,1)}:host(.liveMedia) .time_tip_current{display:none}:host([videoLayout].smp_B1) .time_tip_current,:host([videoLayout].smp_B2) .slimline_b2 .time_tip_current{display:none}:host([videoLayout].smp_B3) .time_tip_current{margin-left:32px}:host([videoLayout][disabled]) .time_tip_current{visibility:hidden!important}:host([audioLayout].smp_B1) .time_tip_current{margin-left:8px}:host([audioLayout].smp_B2) .time_tip_current{margin-left:8px;margin-right:8px}:host([audioLayout].smp_B3) .time_tip_current{margin-left:16px;margin-right:8px}:host([audioLayout].smp_B4) .time_tip_current{margin-left:16px;margin-right:8px}:host([audioLayout]) .time_tip_current{max-width:4.7rem;opacity:1}@media (prefers-reduced-motion:no-preference){:host([audioLayout]) .time_tip_current{transition:max-width .6s ease-in,margin .3s ease-in,opacity 1s ease-in-out}}:host([audioLayout][disabled]) .time_tip_current{margin:0;max-width:0;opacity:0}:host([videoLayout]) .time_tip_duration{margin-right:16px}:host([videoLayout].smp_B1) .time_tip_duration,:host([videoLayout].smp_B2) .slimline_b2 .time_tip_duration{display:none}:host([videoLayout].smp_B3) .time_tip_duration{margin-right:32px}:host([videoLayout][disabled]:not(.liveMedia)) .time_tip_duration{visibility:hidden!important}:host([audioLayout].smp_B1) .time_tip_duration{margin-right:8px}:host([audioLayout].smp_B2) .time_tip_duration{margin-left:8px;margin-right:8px}:host([audioLayout].smp_B3) .time_tip_duration{margin-left:8px;margin-right:16px}:host([audioLayout].smp_B4) .time_tip_duration{margin-left:8px;margin-right:16px}:host([audioLayout]) .time_tip_duration{border-radius:16px;max-width:4.7rem;opacity:1}@media (prefers-reduced-motion:no-preference){:host([audioLayout]) .time_tip_duration{transition:max-width .6s ease-in,margin .3s ease-in,opacity 1s ease-in-out,background-color .16s linear,overflow .65s}}:host([audioLayout][disabled]:not(.liveMedia)) .time_tip_duration,:host([audioLayout][mode=cta]) .time_tip_duration{margin:0;max-width:0;opacity:0;overflow:hidden}:host([audioLayout].smp_B1.liveMedia) .time_tip_duration{margin-left:4px}:host([audioLayout]) .time_tip_duration.toggle-highlight{background:var(--smp-time-tip-toggle-highlight,hsla(0,0%,55%,.347))}smp-time-tip-seek{z-index:3}.hide_seek_timetip smp-thumbnail-scrubbing,.hide_seek_timetip smp-time-tip-seek{display:none}smp-markers-bar{display:block;height:0;left:0;pointer-events:none;position:absolute;top:-16px;width:100%;z-index:0}:host(.show_slim_controls:not(.three_rows)) .slim_controls,:host(.slim_height) .slim_controls{--smp-seek-bar-base-padding-three-times:14px;--smp-time-tip-seek-bottom:100%}",template:ar,templateName:"seekGroup",toucanPlayer:t})}create(){super.create();const t=this.shadowRoot.querySelector(".seek_time_group");this.containerDiv=t,this.seekbar=t.getElementsByTagName("smp-progress-bar")[0],this.markersbar=t.getElementsByTagName("smp-markers-bar")[0],this.timeTipCurrent=t.getElementsByClassName("time_tip_current")[0],this.timeTipDuration=t.getElementsByClassName("time_tip_duration")[0],this.timeTipSeek=t.getElementsByClassName("time_tip_seek")[0],this.thumbnailScrubbing=t.getElementsByTagName("smp-thumbnail-scrubbing")[0],this.isAudio?(this.timeTipSeek.classList.add("audio_ui"),this.timeTipCurrent.classList.add("audio_ui"),this.timeTipDuration.classList.add("audio_ui")):(this.timeTipSeek.classList.remove("audio_ui"),this.timeTipCurrent.classList.remove("audio_ui"),this.timeTipDuration.classList.remove("audio_ui"));new ResizeObserver(this.checkMarkerBar.bind(this)).observe(this)}onRooted(){var t;!function(t){const e=t.eventBus,i=function(t){e.trigger("seek-requested",{time:t})};t.seekbar.setActionFunctions(i,!0),t.markersbar.setActionFunctions(i)}(this),function(t){const e=t.eventBus;e.bind("timeupdate",()=>{const e=t.toucanPlayer.playbackController,i=e.currentTime,s=t.toucanPlayer.isLive,n=e.webcastData&&e.webcastData.availableTime&&e.webcastData.availableTime.end;if(t.seekbar.isLive=s,t.seekbar.setTime(i),t.markersbar.isLive=s,t.markersbar.setTime(i),s||n){const s=!e.canSeekForwards;t.seekbar.atLiveEdge=s,t.timeTipDuration.setLiveEdge(s),s?t.classList.add("liveEdge"):(t.timeTipCurrent.time=i,t.classList.remove("liveEdge")),t.timeTipDuration.end=i,t.updateRewindWindow()}else t.timeTipCurrent.time=i;t.readonly&&t._onNoRewindOverShowing&&t._onNoRewindOver()}),e.bind("seeking",()=>{const e=t.toucanPlayer.playbackController.currentTime;t.seekbar.setTime(e),t.toucanPlayer.isLive?t.timeTipDuration.end=e:t.timeTipCurrent.time=e}),e.bind("pause",()=>{t.seekbar.stopAnimation(),t.toucanPlayer.stoppedStateOnPause&&(t.seekbar.disabled=!0,t.timeTipDuration.stopped=!0)}),e.bind("playing",()=>{t.toucanPlayer.stoppedStateOnPause&&(t.seekbar.disabled=!1,t.timeTipDuration.stopped=!1)}),e.bind("ended",()=>{t.seekbar.resetAnimation(),t.toucanPlayer.stoppedStateOnPause&&(t.seekbar.disabled=!1,t.timeTipDuration.stopped=!1)}),e.bind("playlistEnded",()=>{t.seekbar.resetAnimation(),t.toucanPlayer.stoppedStateOnPause&&(t.seekbar.disabled=!1,t.timeTipDuration.stopped=!1)}),e.bind("loadedmetadata",()=>{t.updateRewindWindow(),t.awaitingData=!1}),e.bind("durationchange",()=>{t.updateRewindWindow()}),e.bind("playlistLoading",()=>{t.resetForNewPlaylist(),t.awaitingData=!0}),e.bind("playing",()=>{t.awaitingData||t.updateRewindWindow()}),e.bind("waiting",()=>{t.seekbar.stopAnimation()}),e.bind("mediaItemChanged",()=>{lr(t);t.toucanPlayer.isLive?(t.classList.add("liveMedia"),t.timeTipDuration.setAttribute("live","")):(t.classList.remove("liveMedia"),t.timeTipDuration.removeAttribute("live")),ur(t)}),e.bind("mediated",lr.bind(this,t)),e.bind("playerSizeChange",e=>{(t.shadowRoot.activeElement&&"B1"==e.breakpoint||"B2"==e.breakpoint&&t.uiConfig.controls.slimlineB2Scrubbar)&&t.dispatchEvent(new CustomEvent("disablingWithFocus",{bubbles:!0,composed:!0}))}),e.bind("setData",e=>{let i=e.data||{};"SMP.thumbManifestUrl"==i.name&&i.url&&(t.thumbnailScrubbing.manifestURL=i.url),"SMP.markers.css"==i.name&&i.data&&t.markersbar.loadCSS(i.data),"SMP.markers"==i.name&&(t.markers=i.data)}),e.bind("focusButton",e=>{"seek"==e.group||"seekbar"==e.name&&!e.after?t.seekbar.disabled||"none"===t.style.display||-1==t.seekbar.accessibleSlider.tabIndex?t.eventBus.trigger("focusOnPlayPause"):t.seekbar.accessibleSlider.focus():"seekbar"==e.name&&e.after&&t.eventBus.trigger("focusOnPlayPause")})}(this),function(t){function e(t){return t.detail}function i(t){let e=t.marker;return{marker_type:e.type,start:Math.floor(e.start),id:e.identifier}}t.markersbar.addEventListener("markerinteract",function(e){t.echoReporter.trackAction(Zi+"~"+e.detail.marker.identifier,"click",i(e.detail))}),t.seekbar.addEventListener("sliderpointerup",function(i){t.echoReporter.trackAction(Xi,"click",e(i))}),t.seekbar.addEventListener("sliderpointerdragging",function(i){t.echoReporter.trackAction(Xi,"drag",e(i))}),t.seekbar.addEventListener("sliderassistivetech",function(i){t.echoReporter.trackAction(Xi,"fromATorKeyboard",e(i))}),t.seekbar.addEventListener("showInfo",function(e){if(!t.isAudio&&(!t.classList.contains("fadedIn")||t._parent.uiFadingIn))return;let i,s=e.detail.xCoordinate,n=e.detail.time;const o=t.getBoundingClientRect().left;i=isNaN(s)?t.seekbar.progress.getBoundingClientRect().right-t.seekbar.seekBarPadding:s-o+t.seekbar.seekBarPadding,t.timeTipSeek.show(i,n),t.thumbnailScrubbing.initialised&&t.uiConfig.thumbnail.enabled&&(t.thumbnailScrubbing.show(n,t.thumbSize,i,t.toucanPlayer.playbackController.webcastData?.accurateStartTime),clearTimeout(t.thumbnailHidingTimeout),t.thumbnailScrubbing.hasData&&(t.thumbShown=!0,t.dispatchEvent(new CustomEvent("thumbnail_show"))))}),t.seekbar.addEventListener("hideInfo",function(){t.timeTipSeek.hide(),t.uiConfig.thumbnail.enabled&&(t.thumbnailScrubbing.hide(),t.dispatchEvent(new CustomEvent("thumbnail_hide")),clearTimeout(t.thumbnailHidingTimeout),t.thumbnailHidingTimeout=setTimeout(function(){t.thumbShown=!1},500))})}(t=this),bi(t.thumbnailScrubbing,["manifestFetchingError","parsingError"],function(e){const i=P.THUMBNAIL_FAILOVER;i.description=e.type,i.extra=e.detail.extra,t.eventBus.trigger("error",i)}),this.dispatchEvent(new CustomEvent("takeFocusNames",{bubbles:!0,composed:!0,detail:{names:["seekbar"]}}))}resetForNewPlaylist(){this.seekbar.reset(),this.markersbar.reset(),this.timeTipCurrent.time=NaN,this.timeTipDuration.time=NaN,this.timeTipDuration.end=NaN,this.readonly=!0,this.disabled=!0}updateRewindWindow(){const t=this.toucanPlayer.playbackController,e=t.webcastData;this.seekbar.setRewindWindow(t.earliestSeek,t.streamEnd,t.latestSeek,e&&(e.accurateStartTime||e.scheduledStartTime),t.canSeek),this.markersbar.setRewindWindow(t.earliestSeek,t.streamEnd,t.latestSeek),this.timeTipDuration.time=t.currentTime,this.timeTipDuration.end=t.streamEnd,this.timeTipDuration.setLiveEdge(!t.canSeekForwards),this.timeTipCurrent.start=t.earliestSeek,this.timeTipCurrent.end=t.latestSeek,this.timeTipSeek.timeTip.start=t.earliestSeek,this.timeTipSeek.timeTip.end=t.latestSeek,this.readonly=!t.canSeek,this.disabled=!1}get thumbShown(){return this.seekbar.thumbShown}set thumbShown(t){this.seekbar.thumbShown=t}get readonly(){return this.hasAttribute("readonly")}set readonly(t){t!=this.readonly&&(!0===t?(this.setAttribute("readonly",""),this.seekbar.readonly=!0):(this.removeAttribute("readonly"),this.seekbar.readonly=!1))}get disabled(){return this.hasAttribute("disabled")}set disabled(t){t!=this.disabled&&(!0===t?(this.setAttribute("disabled",""),this.seekbar.disabled=!0):(this.removeAttribute("disabled"),this.seekbar.disabled=!1))}get isAudio(){return this.hasAttribute("audioLayout")}fadeChange(t,e){var i;super.fadeChange(t,e),t?this.eventBus.trigger("uiControlBarShown"):(i=this,clearTimeout(i.thumbnailHidingTimeout),i.thumbnailScrubbing.hide(),i.dispatchEvent(new CustomEvent("thumbnail_hide")),i.thumbShown=!1,this.eventBus.trigger("uiControlBarHidden"),this.thumbShown=!1,this.timeTipSeek.hide())}updateUiConfig(t){var e;super.updateUiConfig(t),!this.thumbnailScrubbing.enabled&&this.uiConfig.thumbnail.enabled&&lr(this),(e=this).thumbnailScrubbing&&(e.uiConfig.thumbnail.enabled?e.thumbnailScrubbing.enable():e.thumbnailScrubbing.disable()),ur(this),!0===t.controls.slimlineB2Scrubbar?this.containerDiv.classList.add("slimline_b2"):!1===t.controls.slimlineB2Scrubbar&&this.containerDiv.classList.remove("slimline_b2"),!0===t.controls.hideSeekTimetip?this.containerDiv.classList.add("hide_seek_timetip"):!1===t.controls.hideSeekTimetip&&this.containerDiv.classList.remove("hide_seek_timetip"),t.controls.slim?this.containerDiv.classList.add("slim_controls"):this.containerDiv.classList.remove("slim_controls"),this.checkMarkerBar()}get marginAdjustment(){return"none"!=this.markersbar.style.display?this.markersbar.marginAdjustment:0}get markers(){return this._markers||[]}set markers(t){Array.isArray(t)?(this._markers=t,t.forEach(t=>{t.id=t.id||Math.random().toString(36).substr(2,10),t.identifier=t.id})):delete this._markers,this.markersbar.updateMarkers(this.markers),this.eventBus.trigger("markersUpdated",{markersBarVisible:"none"!=this.markersbar.style.display&&this.markersbar.showingMarkers})}checkMarkerBar(){let t=Number(this.uiConfig.markers.hideBelowWidth),e="none"!=this.markersbar.style.display&&this.markersbar.showingMarkers;this.markersbar.style.display=!this.uiConfig.markers.enabled||t>this.containerDiv.offsetWidth?"none":"block",e!=("none"!=this.markersbar.style.display&&this.markersbar.showingMarkers)&&this.eventBus.trigger("markersUpdated",{markersBarVisible:!e})}}function lr(t){(!t.isAudio||t.uiConfig.thumbnail.audio)&&t.thumbnailScrubbing&&t.uiConfig.thumbnail.enabled&&t.toucanPlayer.mediaItem&&(t.thumbnailScrubbing.initialised||t.thumbnailScrubbing.initialise(t.containerDiv,t._parent),t.thumbnailScrubbing.newMediaItem(t.toucanPlayer.mediaItem))}function ur(t){const e=t.toucanPlayer.isLive,i=t.uiConfig.controls.timetipFormat||"";t.timeTipCurrent.format=i,e?(t.timeTipDuration.format="broadcast",t.timeTipSeek.timeTip.format=i||"broadcast"):(t.timeTipSeek.timeTip.format="",t.timeTipDuration.format="duration")}customElements.get("smp-seek-group")||customElements.define("smp-seek-group",rr);const cr=document.createElement("template");cr.innerHTML='<div id="container">\n                                            <p id="settingHeading" aria-hidden="true"></p>\n                                            <p id="settingSubheading" aria-hidden="true"></p>\n                                            <smp-toggle smp-tabbable></smp-toggle>\n                                        </div>';class dr extends Ks{constructor(t){(t=t||{}).template=cr,t.stylesheet=":host{display:block}#container{box-sizing:border-box;color:var(--smp-controls-text-colour,#fff);font-family:var(--smp-font-family);min-height:49px;padding:9px 0 10px;position:relative;width:100%}p{cursor:default;margin:0}#settingHeading{font-size:.875rem}#settingHeading,#settingSubheading{line-height:1.2;margin-right:64px;padding-left:16px}#settingSubheading{color:var(--smp-base-colour);font-size:.8125rem;opacity:.8}smp-toggle{position:absolute;right:0;top:0}",super(t)}create(){super.create(),this.settingHeadingHolder=this.shadowRoot.querySelector("#settingHeading"),this.settingSubheadingHolder=this.shadowRoot.querySelector("#settingSubheading"),this.toggleElement=this.shadowRoot.querySelector("smp-toggle"),this.render(),this.addEventListener("pointerup",hr.bind(this)),this.addEventListener("pointerdown",pr.bind(this))}focus(){this.toggleElement.focus()}initialise(t){this.toggleElement.initialise(t)}setOn(t){t?this.toggleElement.setOn(!1,!0):this.toggleElement.setOff(!1,!0)}render(){super.render(),this.settingHeadingHolder.textContent=this.settingHeading,this.settingSubheadingHolder.textContent=this.settingSubheading,this.toggleElement.toggleLabel=this.settingHeading,this.toggleElement.onTitle=this.toggleElement.offTitle=this.settingSubheading}get settingHeading(){return this.getAttribute("setting-heading")}set settingHeading(t){this.settingHeading!=t&&(this.setAttribute("setting-heading",t),this.markDirty())}get settingSubheading(){return this.getAttribute("setting-subheading")}set settingSubheading(t){this.settingSubheading!=t&&(this.setAttribute("setting-subheading",t),this.markDirty())}static get observedAttributes(){return["setting-subheading","setting-heading"]}}function hr(t){t.stopPropagation(),this.removeAttribute("interacting","interacting")}function pr(){this.setAttribute("interacting","interacting")}customElements.get("smp-toggle-setting")||customElements.define("smp-toggle-setting",dr);class mr extends dr{constructor(t){super(t),this.settingHeading=E.autoplaySettingHeading,this.settingSubheading=E.autoplaySettingSubheading}onRooted(){super.onRooted(),this.initialise(!!this.toucanPlayer._config.continuousPlay),this.toggleElement.addEventListener("toggleOn",t=>{this.toucanPlayer.settings={continuousPlay:!0},this.eventBus.trigger("continuousPlayToggleSwitched",{status:!0}),this.echoReporter.trackAction(us,t.detail.fromKeyboard?"key_press":"click")}),this.toggleElement.addEventListener("toggleOff",t=>{this.toucanPlayer.settings={continuousPlay:!1},this.eventBus.trigger("continuousPlayToggleSwitched",{status:!1}),this.echoReporter.trackAction(ls,t.detail.fromKeyboard?"key_press":"click")}),this.eventBus.bind("continuousPlayChange",t=>{this.setOn(!!t.status)})}}customElements.get("smp-autoplay-setting")||customElements.define("smp-autoplay-setting",mr);const gr=document.createElement("template");gr.innerHTML='<div class="video_layout_outer_container">\n\n                                    <smp-holding-image class="holdingImage"></smp-holding-image>\n                                    <div smp-context class="video_layout_container fadedOut">\n                                        <smp-title-header></smp-title-header>\n                                        <smp-core-controls videolayout smp-context></smp-core-controls>\n                                        <smp-secondary-controls smp-context></smp-secondary-controls>\n                                        <smp-volume-controller smp-context class="volume_controller"></smp-volume-controller>\n\n                                        <smp-seek-group videoLayout smp-context></smp-seek-group>                                        \n                                    </div>\n\n                                    <smp-aria-announcer aria-hidden="true" aria-live="assertive" style="display:none"></smp-aria-announcer>\n                                    <div smp-context class="opacity_layer"></div>\n                                    <smp-continuous-guidance aria-hidden="true" class="continuous_guidance"></smp-continuous-guidance>\n                                    <smp-buffer aria-hidden="true" aria-live="assertive" role="alert" thickness="6" external-radius="24" style="display:none"></smp-buffer>\n\n                                </div>';class br extends Xs{constructor(t){super({stylesheet:"smp-playback-settings-panel{--panel-width:256px}.video_layout_outer_container{fill:var(--smp-controls-fill,#fff);--smp-highlight-button-border-radius:100%;color:var(--smp-controls-text-colour,#fff);font-family:var(--smp-font-family)}.video_layout_container{align-items:center;display:flex;height:100%;justify-content:center;pointer-events:none;position:absolute;width:100%;z-index:160}.video_layout_container smp-volume-controller{pointer-events:auto}.layout.layoutOnNotCompleted *,.video_layout_container.stopTouch *{pointer-events:none}.removed{display:none}.opacity_layer{background-color:rgba(0,0,0,.6);bottom:-.1px;left:0;opacity:0;pointer-events:none;position:absolute;right:0;top:0;z-index:140}@media (max-resolution:90dpi){.opacity_layer{bottom:-.45px;right:-.45px}}:host(.audio) .opacity_layer.fadedIn,:host(.smp_title_dont_fit.no_opacity) .opacity_layer.fadedIn,:host(:not(.fullscreen).fullscreenOnlyTitleHeader.no_opacity) .opacity_layer.fadedIn,:host(:not(.title_header_visible).no_opacity) .opacity_layer.fadedIn{background-color:transparent;opacity:0}.fadedOut.opacity_layer{opacity:0;transition:opacity .25s cubic-bezier(.2,0,.3,1)}.fadedIn.opacity_layer{opacity:1;transition:opacity .5s cubic-bezier(0,.81,.23,1)}.video_layout_outer_container{height:100%;width:100%}.hide_cursor{cursor:none}smp-secondary-controls{display:flex;pointer-events:auto;position:absolute;right:6px;top:0}smp-volume-controller{display:none;position:absolute;right:var(--smp-secondary-controls-group-width,0);top:0}smp-volume-controller.show{display:block}@media screen and (prefers-reduced-motion:no-preference){:host(.smp_B2) .volume_expanded .castingTextDiv,:host(.smp_B2) .volume_expanded .fadedIn smp-core-controls,:host(.smp_B2) .volume_expanded .fadedIn smp-secondary-controls,:host(.smp_B2) .volume_expanded .fadedIn smp-seek-group,:host(.smp_B2) .volume_expanded .fadedIn smp-title-header,:host(.smp_B2) .volume_expanded smp-playback-settings-panel,:host(.smp_B3) .volume_expanded .castingTextDiv,:host(.smp_B3) .volume_expanded .fadedIn smp-core-controls,:host(.smp_B3) .volume_expanded .fadedIn smp-secondary-controls,:host(.smp_B3) .volume_expanded .fadedIn smp-seek-group,:host(.smp_B3) .volume_expanded .fadedIn smp-title-header,:host(.smp_B3) .volume_expanded smp-playback-settings-panel{opacity:0;pointer-events:none;transition:opacity .6s ease-in-out}:host(.rightBottom) .volume_expanded .fadedIn smp-core-controls,:host(.rightBottom) .volume_expanded .fadedIn smp-secondary-controls{opacity:0;pointer-events:none;transition:opacity .25s ease-in-out}:host(.smp_B2) .volume_just_closed .castingTextDiv,:host(.smp_B2) .volume_just_closed .fadedIn smp-core-controls,:host(.smp_B2) .volume_just_closed .fadedIn smp-secondary-controls,:host(.smp_B2) .volume_just_closed .fadedIn smp-seek-group,:host(.smp_B2) .volume_just_closed .fadedIn smp-title-header,:host(.smp_B3) .volume_just_closed .castingTextDiv,:host(.smp_B3) .volume_just_closed .fadedIn smp-core-controls,:host(.smp_B3) .volume_just_closed .fadedIn smp-secondary-controls,:host(.smp_B3) .volume_just_closed .fadedIn smp-seek-group,:host(.smp_B3) .volume_just_closed .fadedIn smp-title-header\n\t:host(.smp_B2) .volume_just_closed smp-playback-settings-panel,:host(.smp_B3) .volume_just_closed smp-playback-settings-panel{opacity:1;transition:opacity .45s ease-in-out}:host(.rightBottom) .volume_just_closed .fadedIn smp-core-controls,:host(.rightBottom) .volume_just_closed .fadedIn smp-secondary-controls{opacity:1;transition:opacity .75s ease-in}}@media screen and (prefers-reduced-motion:reduce){:host(.smp_B2) .volume_expanded .castingTextDiv,:host(.smp_B2) .volume_expanded .fadedIn smp-title-header,:host(.smp_B3) .volume_expanded .castingTextDiv,:host(.smp_B3) .volume_expanded .fadedIn smp-title-header{clip-path:inset(0 141px 0 0)}:host(.rightBottom) .volume_expanded smp-core-controls{opacity:0}}smp-core-controls{display:flex;height:64px;justify-content:center;pointer-events:auto;width:100%}:host(.smp_B2) .video_layout_container,:host(.smp_B3) .video_layout_container{--smp-forward-interval-arrow-rotate:-45deg;--smp-backward-interval-arrow-rotate:45deg;--smp-interval-arrow-scale:0.8;--smp-interval-iconNumber-scale:0.8}:host(.smp_B2) .video_layout_container.fadedIn,:host(.smp_B3) .video_layout_container.fadedIn{--smp-forward-interval-arrow-rotate:0;--smp-backward-interval-arrow-rotate:0;--smp-interval-arrow-scale:1;--smp-interval-iconNumber-scale:1}smp-seek-group{bottom:0;display:flex;height:48px;pointer-events:auto;position:absolute;width:100%}@media screen and (prefers-reduced-motion:no-preference){:host(.smp_B2) .thumbnail_visible smp-core-controls,:host(.smp_B2) .thumbnail_visible smp-secondary-controls,:host(.smp_B2) .thumbnail_visible smp-title-header,:host(.smp_B2) .thumbnail_visible smp-volume-controller,:host(.smp_B3) .thumbnail_visible smp-core-controls,:host(.smp_B3) .thumbnail_visible smp-secondary-controls,:host(.smp_B3) .thumbnail_visible smp-title-header,:host(.smp_B3) .thumbnail_visible smp-volume-controller{opacity:0;transition:opacity .6s ease-in-out}:host(.smp_B2) smp-core-controls,:host(.smp_B2) smp-secondary-controls,:host(.smp_B2) smp-title-header,:host(.smp_B2) smp-volume-controller,:host(.smp_B3) smp-core-controls,:host(.smp_B3) smp-secondary-controls,:host(.smp_B3) smp-title-header,:host(.smp_B3) smp-volume-controller{transition:opacity .45s ease-in-out}}:host(.smp_B2) smp-seek-group,:host(.smp_B3) smp-seek-group{transform:scale(.95)}:host(.smp_B1) .fadedIn,:host(.smp_B2) .fadedIn,:host(.smp_B3) .fadedIn{--smp-seek-bar-slider-transform-transition:transform 0.5s cubic-bezier(0.2,0.0,0.0,1.0);--smp-seek-bar-slider-scale:1}:host(.smp_B2) .fadedIn smp-seek-group,:host(.smp_B3) .fadedIn smp-seek-group{transition:transform .5s cubic-bezier(.2,0,0,1)}:host(.smp_B2) .fadedIn smp-seek-group,:host(.smp_B3) .fadedIn smp-seek-group{transform:scale(1)}:host(.smp_B2) .fadedOut,:host(.smp_B3) .fadedOut{--smp-seek-bar-slider-transform-transition:transform 0.25s cubic-bezier(0.79,0.09,0.48,0.96);--smp-seek-bar-slider-scale:0.5}:host(.smp_B1) .fadedOut smp-seek-group,:host(.smp_B2) .fadedOut smp-seek-group,:host(.smp_B3) .fadedOut smp-seek-group{transition:transform .25s cubic-bezier(.79,.09,.48,.96)}.holdingImage{background-color:#000;height:100%;position:absolute;top:0;width:100%;z-index:0}:host(.audio) .holdingImage,:host(.audio) smp-title-header{display:none}smp-buffer{fill:var(--smp-colour,#0071f1);color:transparent;height:100%;left:0;margin-left:auto;margin-right:auto;pointer-events:none;position:absolute;right:0;z-index:145}:host(.smp_B1) smp-buffer{bottom:calc(50% - 32px);height:64px;width:64px}:host(.smp_B1) smp-buffer.scaleBig{width:64.5px}:host(.smp_B2) smp-buffer{bottom:calc(50% - 36px);height:72px;width:72px}:host(.smp_B2) smp-buffer.scaleBig{width:72.5px}:host(.smp_B3) smp-buffer{bottom:calc(50% - 52px);height:104px;width:104px}:host(.smp_B3) smp-buffer.scaleBig{width:104.5px}:host(.smp_B4) smp-buffer{bottom:calc(50% - 48px);height:96px;width:96px}:host(.smp_B4) smp-buffer.scaleBig{width:96.5px}:host(:not(.smp_B4)) smp-buffer.scaleBig{transform:scale(1.1)}:host(:not(.smp_B4)) smp-buffer.scaleSmall{transform:scale(.9)}smp-continuous-guidance{height:100%;opacity:0;pointer-events:none;position:absolute;transition-duration:.6s;transition-property:opacity;transition-timing-function:ease-in-out;width:100%}smp-continuous-guidance:not(.hidden).shown{opacity:1}smp-continuous-guidance.finished{opacity:0;transition-delay:.5s}smp-subtitles{--smp-subtitle-margin-bottom:0px;clip-path:inset(0 0 0 0);forced-color-adjust:none;height:100%;left:0;pointer-events:none;position:absolute;top:0;transition-duration:.1s;transition-property:opacity;width:100%;z-index:155}smp-subtitles.hidden{display:none}smp-subtitles.swiping{opacity:0}:host(.controlsShown) smp-subtitles{--smp-subtitle-margin-bottom:30px}.video_layout_container{--smp-highlight-button-circle-radius:100%;--smp-highlight-button-circle-background:visible}smp-title-header{pointer-events:none;position:absolute;width:100%}:host(.add_extra_top_space) smp-title-header,:host(.add_extra_top_space:not(.smp_B4)) smp-secondary-controls,:host(.add_extra_top_space:not(.smp_B4)) smp-volume-controller{margin-top:var(--smp-extra-top-space,20px)}:host(.add_extra_top_space) smp-continuous-guidance{padding-top:var(--smp-extra-top-space,20px)}:not(.fullscreen).video_layout_container.fullscreenOnlyTitleHeader smp-title-header{display:none}.castingInfoContainer.shown{box-sizing:border-box;-webkit-box-sizing:border-box;display:flex;height:100%;position:absolute;top:0;width:100%;z-index:150}.castingInfoContainer.hidden{display:none}.castingTextDiv{color:#fff;flex-basis:100%;font-weight:500;letter-spacing:.03rem;user-select:none}smp-subtitles.casting{display:none}:host(.rightBottom) smp-title-header{max-width:80%;right:0;top:27px}:host(.rightBottom.smp_B1) smp-core-controls,:host(.rightBottom.smp_B2) smp-core-controls,:host(.rightBottom.smp_B3) smp-core-controls,:host(.rightBottom.smp_B4) smp-core-controls{--smp-play-pause-icon-dimension:24px;bottom:8px;position:absolute;right:calc(var(--smp-secondary-controls-group-width, 0px) + 59px);scale:75%;width:unset}:host(.rightBottom.smp_B3) smp-core-controls{right:calc(var(--smp-secondary-controls-group-width, 0px) + 62px)}:host(.rightBottom.smp_B1) smp-core-controls,:host(.rightBottom.smp_B2) smp-core-controls{right:calc(var(--smp-secondary-controls-group-width, 0px) + 46px)}:host(.rightBottom.smp_B1) smp-secondary-controls,:host(.rightBottom.smp_B2) smp-secondary-controls,:host(.rightBottom.smp_B3) smp-secondary-controls,:host(.rightBottom.smp_B4) smp-secondary-controls{bottom:16px;top:unset;width:unset}:host(.rightBottom.smp_B1) smp-volume-controller,:host(.rightBottom.smp_B2) smp-volume-controller,:host(.rightBottom.smp_B3) smp-volume-controller,:host(.rightBottom.smp_B4) smp-volume-controller{bottom:16px;left:unset;margin-left:unset;top:unset}:host(.rightBottom.smp_B4) smp-volume-controller{right:calc(var(--smp-secondary-controls-group-width, 0px) + 19px)}:host(.rightBottom.smp_B1) smp-volume-controller{right:calc(var(--smp-secondary-controls-group-width, 0px) + 6px)}:host(.rightBottom:not(.title_header_visible)) .opacity_layer{background-color:transparent;background-image:linear-gradient(180deg,hsla(0,0%,5%,0),hsla(0,0%,5%,.2) 70%,hsla(0,0%,5%,.9) 99%)}:host(.rightBottom.smp_B1) .opacity_layer{background-color:transparent;background-image:linear-gradient(180deg,hsla(0,0%,5%,0),hsla(0,0%,5%,.2) 50%,hsla(0,0%,5%,.9) 99%)}:host(.smp_B1) smp-seek-group{overflow:hidden;pointer-events:none}:host(.portrait.smp_B1) smp-title-header{left:0;max-width:calc(100% - 32px);padding-inline-start:16px;top:64px}:host(.portrait.smp_B1) smp-title-header.rtl{left:16px}:host(.smp_B1.smp_title_dont_fit:not(.rightBottom)) smp-title-header{left:21px;top:12px}:host(.smp_B1) .castingInfoContainer{display:none}smp-volume-controller.shift_left{left:6px;right:auto}:host(.smp_B1) smp-continuous-guidance{background-image:linear-gradient(180deg,#0e0e0e,hsla(0,0%,5%,.3) 50%,hsla(0,0%,5%,0) 75%,hsla(0,0%,5%,0))}:host(.smp_B1.rightBottom) smp-continuous-guidance{--smp-continuous-guidance-font-size:0.675rem;--smp-continuous-guidance-padding-right:20px}:host(.smp_B1.rightBottom) smp-title-header{display:none}:host(.smp_B2) smp-continuous-guidance{--smp-continuous-guidance-top:16px;--smp-continuous-guidance-left:16px;background-image:linear-gradient(180deg,#0e0e0e,hsla(0,0%,5%,.3) 50%,hsla(0,0%,5%,0) 75%,hsla(0,0%,5%,0))}:host(.smp_B2) smp-seek-group.slimline_b2{overflow:hidden;pointer-events:none}:host(.smp_B2.portrait) smp-seek-group{bottom:16px}:host(.smp_B2) smp-volume-controller{right:calc(var(--smp-secondary-controls-group-width, 0px) + 6px)}:host(.smp_B2:not(.rightBottom)) smp-title-header{--smp-title-header-main-title-font-size:1.125rem;--smp-title-header-secondary-title-font-size:0.875rem;--smp-title-header-main-title-line-height:1.5rem;left:16px;max-width:calc(100% - 32px - var(--smp-secondary-controls-group-width,0px) - var(--smp-volume-controls-group-width,48px));top:11px}:host(.smp_B2.smp_title_dont_fit:not(.rightBottom)) smp-title-header{left:24px;top:13px}:host(.smp_B2.no_controls) smp-title-header{max-width:calc(100% - 32px)}:host(.portrait.smp_B2) smp-title-header{left:0;max-width:calc(100% - 16px);padding-inline-start:16px;top:64px}:host(.smp_B2) .castingTextDiv{font-size:1.05rem;line-height:1.5rem;padding-top:clamp(45px,14%,75px);text-align:center}:host(.smp_B2) .hidePopNumber{--smp-interval-button-pop-number-display:none}:host(.smp_B2.rightBottom) smp-continuous-guidance{--smp-continuous-guidance-padding-right:20px}:host(.smp_B2.rightBottom) smp-title-header{--smp-title-header-padding-right:20px;top:16px}:host(.smp_B3) smp-seek-group{bottom:16px}:host(.smp_B3) smp-secondary-controls{right:22px;top:16px}:host(.smp_B3) smp-volume-controller{right:calc(var(--smp-secondary-controls-group-width, 0px) + 22px);top:16px}:host(.smp_B3) smp-continuous-guidance{background-image:linear-gradient(180deg,#0e0e0e,hsla(0,0%,5%,.3) 50%,hsla(0,0%,5%,0) 67%,hsla(0,0%,5%,0))}:host(.smp_B3) .video_layout_container{--smp-forward-interval-icon-number-top:43%}:host(.smp_B3:not(.rightBottom)) smp-title-header{--smp-title-header-main-title-font-size:1.25rem;--smp-title-header-secondary-title-font-size:1rem;--smp-title-header-main-title-line-height:1.5rem;--smp-time-tip-position:relative;--smp-time-tip-bottom:1px;left:32px;max-width:calc(100% - 64px - var(--smp-secondary-controls-group-width,0px) - var(--smp-volume-controls-group-width,48px));top:27px}:host(.smp_B3.no_controls) smp-title-header{max-width:calc(100% - 64px)}:host(.smp_B3) .castingInfoContainer{max-width:calc(100% - 64px - var(--smp-secondary-controls-group-width,0px) - var(--smp-volume-controls-group-width,48px))}:host(.smp_B3) .castingTextDiv{font-size:1.25rem;line-height:1.5rem;padding-left:32px;padding-top:27px}:host(.smp_B3) .castingInfoContainer.centred_B3{max-width:100%;text-align:center}:host(.smp_B3) .centred_B3 .castingTextDiv{padding-left:0;padding-top:clamp(45px,15%,38%)}.smp_B4.opacity_layer,:host(:not(.fullscreen).title_header_visible.fullscreenOnlyTitleHeader) .smp_B4.opacity_layer{background-color:transparent;background-image:linear-gradient(180deg,hsla(0,0%,5%,0),hsla(0,0%,5%,.2) 70%,hsla(0,0%,5%,.9) 99%)}@media (forced-colors:active){.smp_B4.opacity_layer{background-color:rgba(0,0,0,.6)!important}}:host(.title_header_visible) .smp_B4.opacity_layer{background-color:transparent;background-image:linear-gradient(180deg,hsla(0,0%,5%,.85),hsla(0,0%,5%,.3) 30%,hsla(0,0%,5%,.25) 70%,hsla(0,0%,5%,.85) 99%)}:host(.smp_B4) smp-seek-group{bottom:80px;max-width:1280px}:host(.smp_B4.minimode) smp-seek-group{bottom:64px}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-seek-group{bottom:88px}:host(.smp_B4) smp-core-controls{bottom:16px;position:absolute;width:auto}:host(.smp_B4.minimode) smp-core-controls{bottom:0}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-core-controls{bottom:24px}:host(.smp_B4) smp-secondary-controls,:host(.smp_B4) smp-volume-controller{top:calc(100% - 72px)}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-secondary-controls,:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-volume-controller{top:calc(100% - 80px)}:host(.smp_B4.minimode) smp-secondary-controls,:host(.smp_B4.minimode) smp-volume-controller{top:calc(100% - 56px)}:host(.smp_B4) smp-secondary-controls{margin-right:16px;right:3px}:host(.smp_B4) smp-volume-controller{left:2px;margin-left:16px;position:absolute;right:auto}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-secondary-controls{padding-right:3px;right:calc(50% - 640px)}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-volume-controller{left:calc(50% - 640px);padding-left:2px;right:auto}:host(.smp_B4) smp-continuous-guidance{background-image:linear-gradient(180deg,#0e0e0e,hsla(0,0%,5%,.3) 25%,hsla(0,0%,5%,0) 50%,hsla(0,0%,5%,0))}:host(.smp_B4) smp-continuous-guidance{--smp-continuous-guidance-top:32px;--smp-continuous-guidance-left:96px}:host(.controlsShown.smp_B4) smp-subtitles{--smp-subtitle-margin-bottom:120px}:host(.smp_B4) smp-title-header{--smp-title-header-main-title-font-size:1.625rem;--smp-title-header-secondary-title-font-size:1.125rem;--smp-title-header-main-title-line-height:1.875rem;--smp-title-header-live-info-text-font-size:0.875rem;--smp-live-icon-size:13px;top:24px}:host(.smp_B4:not(.rightBottom)) smp-title-header{max-width:calc(100% - 64px)}:host(.smp_seek_bar_stopped_growing:not(.rightBottom)) smp-title-header{left:calc(50% - 608px);max-width:1248px}:host(.smp_B4.minimode) smp-title-header{display:none}:host(.smp_B4) .castingInfoContainer{background-color:transparent;background-image:linear-gradient(180deg,hsla(0,0%,5%,.65),hsla(0,0%,5%,.3) 25%,hsla(0,0%,5%,.2) 70%,hsla(0,0%,5%,.9) 99%);max-width:100%}:host(.smp_B4) .castingInfoContainer.centred_B4{background-color:hsla(0,0%,5%,.6);background-image:none;max-width:100%;text-align:center}:host(.smp_B4) .castingTextDiv{font-size:1.625rem;line-height:1.875rem;padding-left:32px;padding-top:35px}:host(.smp_B4) .centred_B4 .castingTextDiv{padding-left:0;padding-top:clamp(20%,25%,30%)}"+Je,template:gr,templateName:"outerContainer",toucanPlayer:t}),this.setAttribute("part","controls"),this.subtitles=t.subtitles,this.subtitles.addMargin(this),this.fixedElementFunction=this.getFixedElement.bind(this),this.subtitles.addFixedElement(this.fixedElementFunction),this.playbackController=t.playbackController,this.titleHeaderMinHeightRequired=450,this.titleHeaderMinWidthRequired=600,this._noControls=!1}create(){super.create();const t=this.outerContainer;this.containerDiv=t.getElementsByClassName("video_layout_container")[0];const e=this.containerDiv;var i,s;this.holdingImage=t.getElementsByTagName("smp-holding-image")[0],this.coreControls=e.getElementsByTagName("smp-core-controls")[0],this.secondaryControls=e.getElementsByTagName("smp-secondary-controls")[0],function(t,e){if("ResizeObserver"in self){new ResizeObserver(t=>{for(let i of t){let t=i.contentRect.width;e.style.setProperty("--smp-secondary-controls-group-width",t+"px")}}).observe(t)}else e.style.setProperty("--smp-secondary-controls-group-width","1px")}(this.secondaryControls,this),this.seekGroup=e.getElementsByTagName("smp-seek-group")[0],this.seekGroup.addEventListener("thumbnail_show",()=>{t.classList.add("thumbnail_visible"),Li(this.toucanPlayer._registeredControls,"thumbnail_visible")}),this.seekGroup.addEventListener("thumbnail_hide",()=>{t.classList.remove("thumbnail_visible"),Li(this.toucanPlayer._registeredControls,"thumbnail_visible",!0)}),this.buffer=t.getElementsByTagName("smp-buffer")[0],this.continuousGuidance=t.getElementsByTagName("smp-continuous-guidance")[0],this.keyboardShortcutAnnouncer=t.getElementsByTagName("smp-aria-announcer")[0],this.volumeControl=t.getElementsByTagName("smp-volume-controller")[0],this.titleHeader=t.getElementsByTagName("smp-title-header")[0],this.bufferThickness=6,this.buffer.setAttribute("aria-label",E.audioToolTipBuffering),this.buffer.textContent=E.audioToolTipBuffering,this.keyboardShortcutAnnouncer.setAttribute("aria-label",""),customElements.upgrade(this.outerContainer),i=this,s=this.toucanPlayer,function(t,e){t.addEventListener("click",function(){e.shadowRoot.activeElement||t.coreControls.focusOnPlayPauseBtn()})}(i,s),function(t){const e=t.eventBus;e.bind("notableTimechange",()=>{t.titleHeader.updateLiveIndicator(t.toucanPlayer.playbackController),function(t){t.toucanPlayer.isLive?(!t.toucanPlayer.playbackController.canSeekForwards&&t.toucanPlayer.playbackController.playbackRate>1&&t.eventBus.trigger("playbackRateChangeRequested",{value:1}),t.toucanPlayer.playbackController.canSeekForwards||t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled?t.toucanPlayer.playbackController.canSeekForwards&&t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled&&t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!1):t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!0)):t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled&&t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!1)}(t)}),e.bind("playing",()=>{t.playingSeen=!0,t.checkHoldingImageState()}),e.bind("playbackBegin",()=>{t.playingSeen=!1,t.firstPlay&&(t.firstPlay=!1,t.fadeOut()),yr(t)&&t.fadeIn(),t.checkHoldingImageState()}),e.bind("durationchange",()=>{yr(t)&&t.fadeIn(),t.checkHoldingImageState()}),e.bind("pause",()=>{t.checkHoldingImageState()}),e.bind("playlistLoading",()=>{t.resetForNewPlaylist()}),e.bind("autoplayingPlaylist",e=>{e.detail&&e.detail.then(()=>{t.autoplay=!0;let e=t.toucanPlayer.playlist.fromQueue,i=t.uiConfig.guidance;(e&&i.displayContinuousGuidanceInQueuePlaylist||!e&&i.displayGuidanceInAutoplay)&&function(t){if(t.autoplay&&(t.guidance||t.warning)){t.continuousGuidaceStarted=!0;const e=t.guidance||t.warning;t.continuousGuidance.setAttribute("role","alert"),t.continuousGuidance.setAttribute("aria-label",e),t.continuousGuidance.setAttribute("aria-hidden","false"),t.continuousGuidance.setAttribute("aria-live","assertive"),Cr(t)}}(t)}).catch(()=>{})}),e.bind("fullscreenchange",()=>{t.toucanPlayer.isFullscreen?(t.containerDiv.classList.add("fullscreen"),t.classList.add("fullscreen")):(t.containerDiv.classList.remove("fullscreen"),t.classList.remove("fullscreen"),t.showCursor())}),e.bind("setData",e=>{"SMP.overrideTitleHeader"==e.data.name&&e.data&&(t.overrideDisplayTitle=e.data.displayTitle,t.overrideDisplaySecondaryTitle=e.data.displaySecondaryTitle,t.overrideLiveTimeInfo=e.data.liveTimeInfo,Pr(t))}),e.bind("seekRequested",()=>{this.checkHoldingImageState()}),e.bind("playerSizeChange",e=>{vr(t),e.width<280?t.volumeControl.classList.add("shift_left"):t.volumeControl.classList.remove("shift_left")}),e.bind("chromecastStateChange",e=>{e.detail.newState===Zs.STATE.NO_DEVICES_AVAILABLE||e.detail.newState===Zs.STATE.NOT_CONNECTED?(t.hideCastingOverlay(),t.subtitles.classList.remove("casting")):e.detail.newState===Zs.STATE.SELECT_DEVICE?(t.showCastingOverlay("SELECT_DEVICE"),t.toucanPlayer.subtitlesOn&&t.subtitles.classList.add("casting")):e.detail.newState===Zs.STATE.CONNECTING?Ar(t,E.ccConnecting):e.detail.newState===Zs.STATE.DISCONNECTING?Ar(t,E.ccDisconnecting):e.detail.newState===Zs.STATE.CONNECTED&&t.showCastingOverlay("CASTING",e.detail.deviceName)}),e.bind("chromecastDisconnected",()=>{t.hideCastingOverlay()}),e.bind("fullscreenchange",()=>{t.exitPictureInPicture()}),e.bind("waitingForPlugins",()=>{t.noControls=!0,t.showBuffer(),t.toucanPlayer._waitingPlaylist&&(t.toucanPlayer._fallbackHoldingImage=t.toucanPlayer._waitingPlaylist.holdingImageURL,t.updatePoster(),t.showHoldingImage(!0)),e.trigger("forceShowPlayback")}),e.bind("pluginsLoadedAfterWaiting",()=>{t.noControls=!1}),e.bind("showBuffer",()=>{t.showBuffer()}),e.bind("hideBuffer",()=>{t.hideBuffer()}),e.bind("swipeNext",e=>{t.swipeControl.moveNext(e.method)}),e.bind("swipePrevious",e=>{t.swipeControl.movePrevious(e.method)}),e.bind("closeSubtitleCustomisation",()=>{t.moveFocusOnAppearance()})}(i),function(t){function e(){clearTimeout(t.volumeExpandedTimeout),Li(t.toucanPlayer._registeredControls,"volume_expanded"),t.outerContainer.classList.add("volume_expanded"),t.volumeExpanded=!0}function i(){Li(t.toucanPlayer._registeredControls,"volume_just_closed"),t.outerContainer.classList.add("volume_just_closed"),clearTimeout(t.volumeExpandedTimeout),t.volumeExpandedTimeout=setTimeout(function(){t.volumeExpanded=!1,t.outerContainer.classList.remove("volume_expanded"),Li(t.toucanPlayer._registeredControls,"volume_expanded",!0)},150),setTimeout(function(){t.outerContainer.classList.remove("volume_just_closed"),Li(t.toucanPlayer._registeredControls,"volume_just_closed",!0)},460)}t.volumeControl.setExpandedAndClosedCallbacks(e,i)}(i),function(t){bi(t,["pointerdown","pointermove","pointerup","focusin","buttonFocusin"],Tr(t)),bi(t,["pointerout","focusout"],function(t){return function(e){if(!("focusout"===e.type&&t.toucanPlayer.isFullscreen||"focusout"===e.type&&d.isApple||wr(t)||"touch"===e.pointerType||t.hasInteractingControls()&&(null==e.relatedTarget||t.toucanPlayer.contains(e.relatedTarget)))){if(-1!=t.toucanPlayer.plugins.indexOf(e.relatedTarget))return;clearTimeout(t.idleTimeoutInterval);const i="pointerout"===e.type&&(t.volumeExpanded||t.seekGroup.thumbShown);clearTimeout(t.clickRequestedFadeOut),t.containerDiv.classList.contains("fadedIn")&&(t.clickRequestedFadeOut=!0,t.clickRequestedFadeOutTimeout=setTimeout(function(){t.clickRequestedFadeOut=!1},150)),t.fadeOut(i)}}}(t)),document.addEventListener("keyup",Tr(t),!0),window.addEventListener("touchstart",()=>{t.touchDetected=!0,t.classList.contains("fadedIn")||"block"!=t.style.display||t.containerDiv.classList.add("stopTouch")},{passive:!0,once:!0}),t.addEventListener("dblclick",function(e){if(t.uiConfig.fullscreen.enabled&&t.uiConfig.fullscreen.dblclick){t.toggleFullscreen();const i=mi(e),s=t.toucanPlayer.isFullscreen?Vi:Wi;t.echoReporter.trackAction(s,i)}})}(this),this.guidance="",this.warning="",this.guidanceShown=!1,this.guidanceTimer=10,this.outerContainer.appendChild(this.subtitles),this.secondaryControls.playbackSettingsPanel.setLinkedButton(this.secondaryControls.playbackSettingsButton,t),this.secondaryControls.subtitlesSettingPanel.setLinkedButton(this.secondaryControls.subtitlesSettingButton,t),this.secondaryControls.playbackSpeedSettingsPanel.setLinkedButton(this.secondaryControls.playbackSpeedSettingsButton,t),this.checkHoldingImageState(),this.addEventListener("bufferIconScale",t=>{this.onBufferScale(t.detail)}),this.uiConfig.swipable.enabled&&(this.swipeControl=new js(this),this.coreControls.classList.add("swipable"+this.uiConfig.swipable.direction),this.swipeStart=()=>{this.subtitles.classList.add("swiping"),this.toucanPlayer.plugins.forEach(t=>{t.classList.add("swiping")})},this.swipeEnd=()=>{this.subtitles.classList.remove("swiping"),this.toucanPlayer.plugins.forEach(t=>{t.classList.remove("swiping")})})}getControlsPositioning(){let t={},e=1/0,i=1/0,s=0,n=0,o=this.seekGroup;if("none"!=o.style.display){t.seekBarTop=o.offsetTop;("B1"==this.breakpoint||"B2"===this.breakpoint&&this.uiConfig.controls.slimlineB2Scrubbar)&&(t.seekBarTop=t.seekBarTop+44),t.seekBarBottom=t.seekBarTop+o.offsetHeight,t.seekBarLeft=o.offsetLeft,t.seekBarRight=t.seekBarLeft+o.offsetWidth,t.seekBarRight-=parseFloat(window.getComputedStyle(o.timeTipDuration).marginRight),t.seekBarLeft+=parseFloat(window.getComputedStyle(o.timeTipCurrent).marginLeft),e=Math.min(e,t.seekBarTop),s=Math.max(s,t.seekBarBottom),i=Math.min(i,t.seekBarLeft),n=Math.max(n,t.seekBarRight)}else t.seekBarLeft=0,t.seekBarRight=0,t.seekBarTop=0,t.seekBarBottom=0;const a=this.secondaryControls;if("none"!=a.style.display){let t=a.getBoundingClientRect();e=Math.min(e,t.top),s=Math.max(s,t.bottom),i=Math.min(i,t.left),n=Math.max(n,t.right)}const r=this.coreControls;if("none"!=r.style.display){let t=r.getBoundingClientRect();e=Math.min(e,t.top),s=Math.max(s,t.bottom)}return t.controlsTop=e,t.controlsLeft=i,t.controlsHeight=s-e,t.controlsWidth=n-i,t}layoutOn(t){super.layoutOn(t),this.touchDetected&&!this.classList.contains("fadedIn")&&(this.clearStopTouchTimeout(),this.containerDiv.classList.add("stopTouch")),this.eventBus.trigger("playbackStateEntered")}layoutOnCompleted(){super.layoutOnCompleted(),vr(this)}get shouldStopTouchOnLayoutOn(){return!0}hideBuffer(){this.buffer.style.display="none",this.classList.remove("buffering"),this.buffer.setAttribute("aria-hidden","true")}showBuffer(){this.buffer.style.display="block",this.classList.add("buffering"),this.buffer.setAttribute("aria-hidden","false")}showHoldingImage(t){this.holdingImage&&(this.holdingImage.displaying=t,this.holdingImage.style.display=t?"block":"none")}checkHoldingImageState(){let t=!1;("audio"==this.toucanPlayer.contentType||this.castingOverlayVisible)&&(t=!0,this.exitPictureInPicture()),this.toucanPlayer.stoppedStateOnPause&&this.playbackController.paused&&(t=!0),this.uiConfig.poster.availableWhenSettingUp&&!this.playingSeen&&(t=!0),this.showHoldingImage(t)}get noControls(){return this._noControls}set noControls(t){this._noControls!=t&&(this._noControls=t,Br(this),vr(this))}fadeIn(t){this.classList.contains("fadedIn")||this.clickRequestedFadeOut&&!t||(this.classList.add("controlsShown"),this.fadeChange(!0,!1),this.showCursor(),Cr(this),this.touchDetected&&(this.clearStopTouchTimeout(),this.stopTouchTimeout=setTimeout(()=>{this.containerDiv.classList.remove("stopTouch")},150)),this.uiFadingIn=!0,setTimeout(()=>{this.uiFadingIn=!1},510))}fadeOut(t){var e;yr(this)||(this.containerDiv.classList.contains("fadedOut")||(this.classList.remove("controlsShown"),this.fadeChange(!1,t),(e=this).volumeControl.close(),clearTimeout(e.volumeExpandedTimeout),e.outerContainer.classList.remove("volume_expanded","volume_just_closed"),Li(e.toucanPlayer._registeredControls,"volume_just_closed",!0),Li(e.toucanPlayer._registeredControls,"volume_expanded",!0),e.volumeExpanded=!1,this.toucanPlayer.isFullscreen&&this.hideCursor(),Cr(this),this.touchDetected&&(this.clearStopTouchTimeout(),this.containerDiv.classList.add("stopTouch"))))}clearStopTouchTimeout(){this.stopTouchTimeout&&(clearTimeout(this.stopTouchTimeout),this.stopTouchTimeout=null)}isFadedIn(){return this.containerDiv.classList.contains("fadedIn")}breakpointchange(t){super.breakpointchange(t);const e=t.breakpoint,i=t.width,s=t.height;switch(i>=1280?this.classList.add("smp_seek_bar_stopped_growing"):this.classList.remove("smp_seek_bar_stopped_growing"),i>=this.titleHeaderMinWidthRequired||t.isPortrait&&s>=this.titleHeaderMinHeightRequired?(this.classList.remove("smp_title_dont_fit"),this.titleHeader.classList.remove("smp_title_dont_fit")):(this.classList.add("smp_title_dont_fit"),this.titleHeader.classList.add("smp_title_dont_fit")),e){case"B4":Er(this,"48","6"),this.bufferThickness=6,this.seekGroup.thumbSize="l";break;case"B3":Er(this,"52","5"),this.bufferThickness=5,this.seekGroup.thumbSize="m";break;case"B2":Er(this,"36","5"),this.bufferThickness=5,this.seekGroup.thumbSize="s";break;default:Er(this,"34","4"),this.bufferThickness=4}"B1"==e?(this.seekGroup.setAttribute("tabIndex","-1"),this.coreControls.forwardIntervalButton.setAttribute("tabIndex","-1"),this.coreControls.backwardIntervalButton.setAttribute("tabIndex","-1")):("B2"===e&&this.uiConfig.controls.slimlineB2Scrubbar?this.seekGroup.setAttribute("tabIndex","-1"):this.seekGroup.removeAttribute("tabIndex"),this.coreControls.forwardIntervalButton.removeAttribute("tabIndex"),this.coreControls.backwardIntervalButton.removeAttribute("tabIndex")),"B4"==e&&"rightBottom"!==this.uiConfig.controls.mode?this.volumeControl.slideDirection="right":this.volumeControl.slideDirection="left",this.volumeControl.muteOnly="B1"==e||this.uiConfig.controls.muteButtonOnly}resetForNewPlaylist(){this.firstPlay=!0,this.autoplay=!1,this.guidanceTimer=10,this.guidanceShown=!1,this.continuousGuidaceStarted=!1,this.continuousGuidance.classList.remove("shown"),this.continuousGuidance.classList.remove("finished")}playlistLoaded(t){super.playlistLoaded(t),this.autoplay=t.autoplay,function(t,e){e.guidance=t.guidance||"",e.warning=t.warning||"",t.guidance?(e.continuousGuidance.setAttribute("type","guidance"),e.continuousGuidance.setAttribute("message",t.guidance)):(e.continuousGuidance.removeAttribute("message"),t.warning?(e.continuousGuidance.setAttribute("type","warning"),e.continuousGuidance.setAttribute("message",t.warning)):e.continuousGuidance.removeAttribute("warning"))}(t,this),Pr(this)}toggleFullscreen(){this.toucanPlayer.toggleFullscreen()}updateUiConfig(t){super.updateUiConfig(t),this.needToCreate||(Br(this),Pr(this),function(t){let e=t.uiConfig.addExtraTopSpace;Number.isInteger(e)&&e>=12&&e<=24?(t.classList.add("add_extra_top_space"),t.style.setProperty("--smp-extra-top-space",e+"px")):t.classList.remove("add_extra_top_space")}(this),this.uiConfig.controls.always||!this.hasInteractingControls()&&this.isFadedIn()&&kr(null,this),!0===t.controls.slimlineB2Scrubbar?this.seekGroup.classList.add("slimline_b2"):!1===t.controls.slimlineB2Scrubbar&&this.seekGroup.classList.remove("slimline_b2"),vr(this)),this.subtitles&&(this.uiConfig.subtitles&&this.uiConfig.subtitles.hidden?this.subtitles.classList.add("hidden"):this.subtitles.classList.remove("hidden"))}exitPictureInPicture(){this.eventBus.trigger("exitPictureInPictureRequested")}showCastingOverlay(t,e){let i,s;this.castingOverlayVisible=!0,Pr(this),this.checkHoldingImageState(),this.exitPictureInPicture(),this.secondaryControls.determineButtonsToShow(),this.fadeIn(),this.coreControls.classList.add("hidePopNumber"),"SELECT_DEVICE"===t?i=E.ccSelectDevice:"CASTING"===t&&(i=E.ccCastingTo,s=e.replaceAll("&amp;","&").replaceAll("&lt;","<").replaceAll("&gt;",">").replaceAll("&quot;",'"').replaceAll("&#39;","'")),this.castingInfoContainer?(this.castingInfoContainer.classList.add("shown"),this.castingInfoContainer.classList.remove("hidden"),Ar(this,i,s)):Lr(this,i,s),"SELECT_DEVICE"===t?this.castingInfoContainer.classList.add("centred_B3","centred_B4"):this.castingInfoContainer.classList.remove("centred_B3","centred_B4")}hideCastingOverlay(){this.castingInfoContainer&&(this.castingOverlayVisible=!1,this.secondaryControls.determineButtonsToShow(),this.checkHoldingImageState(),this.castingInfoContainer.classList.add("hidden"),this.castingInfoContainer.classList.remove("shown"),Pr(this),this.coreControls.classList.remove("hidePopNumber"),kr(null,this))}hasInteractingControls(){return!!super.hasInteractingControls()||this._toucanPlayer._registeredControls.some(t=>{let e=!1;return t&&t.shadowRoot&&(e=null!==t.shadowRoot.querySelector("[interacting]")),e||t.hasAttribute("interacting")})}showCursor(){this.outerContainer.classList.remove("hide_cursor")}hideCursor(){this.outerContainer.classList.add("hide_cursor")}moveFocusOnAppearance(){this.coreControls.focusOnPlayPauseBtn()}onBufferScale(t){if("default"==t)return this.buffer.classList.remove("scaleBig"),void this.buffer.classList.remove("scaleSmall");!this.classList.contains("smp_B4")&&("shrink"==t?this.buffer.classList.add("scaleSmall"):this.buffer.classList.add("scaleBig"))}getMargin(){if(this.isFadedIn()){const t=this.containerDiv.getBoundingClientRect();let e=0,i=this.seekGroup.getBoundingClientRect();if(0!=i.top){let s="B1"==this.breakpoint||"B2"===this.breakpoint&&this.uiConfig.controls.slimlineB2Scrubbar?44:0;e=t.bottom-(i.top+s)-this.seekGroup.marginAdjustment}const s=this.classList.contains("smp_B4");let n={height:0,bottom:0},o={height:0,bottom:0};if(this.titleHeader.visible&&t.width>this.titleHeaderMinWidthRequired&&(n=this.titleHeader.getBoundingClientRect()),"rightBottom"==this.uiConfig.controls.mode){let i=this.secondaryControls.getBoundingClientRect();e=t.bottom-i.top}else s||(o=this.secondaryControls.getBoundingClientRect());return{bottom:e,top:0!=n.height||0!=o.height?Math.max(n.bottom,o.bottom)-t.top:0}}if(this.continuousGuidance.visible){const t=this.containerDiv.getBoundingClientRect();return{bottom:0,top:this.continuousGuidance.getGuidanceMessageBottomMargin()-t.top}}return null}getFixedElement(){return this.isFadedIn()&&!this.classList.contains("smp_B4")?this.coreControls.getBoundingClientRect():null}}const fr=500;function yr(t){let e=t.toucanPlayer;if(t.uiConfig.controls.always||"audio"==e.contentType&&!t.uiConfig.allowAudioControlsToHide)return!0;let i=e.playbackController.playbacks.chromecast;return i&&i._shouldShowPlayerControls}function vr(t){let e;if("none"==window.getComputedStyle(t.outerContainer).getPropertyValue("display"))return;let i=t.outerContainer.offsetWidth;switch(t.breakpoint){case"B1":e=i-parseFloat(window.getComputedStyle(t.secondaryControls).right);break;case"B2":case"B3":e=i-parseFloat(window.getComputedStyle(t.secondaryControls).right)-(t.uiConfig.controls&&!t.uiConfig.controls.volumeSlider?0:t.uiConfig.controls&&t.uiConfig.controls.muteButtonOnly?48:189);break;case"B4":e=t.secondaryControls.getBoundingClientRect().right-t.coreControls.getBoundingClientRect().right;break;default:e=i}"rightBottom"===t.uiConfig.controls.mode&&(e=i-(t.uiConfig.controls&&!t.uiConfig.controls.volumeSlider?0:t.uiConfig.controls&&t.uiConfig.controls.muteButtonOnly?110:190)),t.secondaryControls.maxWidth=e}function _r(t){for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;){if(t.allowHide)return{visible:!1,element:t.button};let e=t.shadowRoot.querySelector(":focus-visible");if(e&&("button"==e.localName||"input"==e.localName)){if("rgba(0, 0, 0, 0)"!=window.getComputedStyle(e).getPropertyValue("background-color"))return{visible:!0};if(e.firstElementChild){if("rgba(0, 0, 0, 0)"!=window.getComputedStyle(e.firstElementChild).getPropertyValue("background-color"))return{visible:!0}}}t=t.shadowRoot.activeElement}return{visible:!1}}function kr(t,e){let i=e.uiConfig.controls;const s=t&&"touch"===t.pointerType?i.timeoutTouch:i.timeout,n=!t||"pointerup"==t.type||"pointermove"==t.type||"keyup"==t.type||"focusin"===t.type||"buttonFocusin"===t.type;clearTimeout(e.idleTimeoutInterval),n&&(e.idleTimeoutInterval=setTimeout(function(){let i=_r(e);if(i.visible)kr(null,e);else if(function(t){for(let e=0;e<t.length;e++){let i=_r(t[e]);if(i.visible)return i}return{visible:!1}}(e._toucanPlayer._registeredControls).visible)kr(null,e);else if(!e.hasInteractingControls()&&!wr(e)){const s=e.volumeExpanded;e.fadeOut(s),i.element&&(e.forcedFocus=!0,i.element.blur(),t&&"buttonFocusin"!==t.type&&setTimeout(function(){e.forcedFocus=!0,i.element.noFocusInEvent=!0,i.element.focus()},1))}},s))}function wr(t){return t.toucanPlayer.paused&&t.toucanPlayer.stoppedStateOnPause}function Tr(t){function e(){t.fading=!1}function i(i){t.fading||(t.fadeIn(),kr(i,t),t.fading=!0,setTimeout(e,fr))}return t.fading=!1,function(s){if("keyup"==s.type)return document.activeElement!==t.toucanPlayer?void kr(s,t):("Tab"==s.code&&t.focusChange(!0),void i(s));if("focusin"!=s.type&&"buttonFocusin"!=s.type||t.focusFromButtonArrivedAlready){if("pointermove"==s.type&&"touch"!==s.pointerType&&0==s.buttons&&!t.volumeExpanded)return t.focusChange(!1),void i(s);"pointerup"==s.type&&(!t.hasInteractingControls()&&t.isFadedIn()?function(){if(!t.fading){const i=t.volumeExpanded;t.fadeOut(i),t.fading=!0,setTimeout(e,fr)}}():(t.focusChange(!1),t.volumeExpanded||i(s)))}else if(t.forcedFocus&&"focusin"==s.type)t.forcedFocus=!1;else{if(this.toucanPlayer.isFullscreen)return;t.focusFromButtonArrivedAlready=!0,setTimeout(function(){t.focusFromButtonArrivedAlready=!1},fr),i(s)}}}function Er(t,e,i){t.buffer.setAttribute("external-radius",e),t.buffer.setAttribute("thickness",i)}function Cr(t){(t.guidanceShown||t.autoplay)&&t.continuousGuidaceStarted&&t.guidanceTimer>0&&(clearInterval(t.contGuidanceTimerId),t.isFadedIn()?Sr(t):(!function(t){clearTimeout(t.guidanceClassHelperTimeout),t.continuousGuidance.visible||(t.continuousGuidance.classList.remove("hidingFirstStep"),t.continuousGuidance.visible=!0,t.eventBus.trigger("continuousGuidanceToggle"),t.showContinuousGuidanceTimeout=setTimeout(function(){t.continuousGuidance.classList.add("shown","showingFirstStep"),t.guidanceClassHelperTimeout=setTimeout(function(){t.continuousGuidance.classList.add("showingSecondStep")},300)},500))}(t),t.contGuidanceTimerId=setInterval(function(){if(t.guidanceTimer<=0)return Sr(t,!0),t.guidanceShown=!0,t.continuousGuidance.setAttribute("aria-hidden","true"),void t.continuousGuidance.classList.add("finished");t.guidanceTimer--},1e3)))}function Sr(t,e){clearTimeout(t.guidanceClassHelperTimeout),clearTimeout(t.showContinuousGuidanceTimeout),t.continuousGuidance.visible&&(t.continuousGuidance.visible=!1,t.eventBus.trigger("continuousGuidanceToggle"),e?(t.continuousGuidance.classList.remove("shown","showingFirstStep","showingSecondStep"),t.continuousGuidance.classList.add("hidingFirstStep")):(t.continuousGuidance.classList.remove("shown"),t.guidanceClassHelperTimeout=setTimeout(function(){t.continuousGuidance.classList.remove("showingFirstStep","showingSecondStep")},500)))}function Br(t){const e=t.uiConfig.controls;if(t.noControls)return t.volumeControl.hide(),t.coreControls.style.display="none",t.secondaryControls.style.display="none",t.seekGroup.style.display="none",void t.classList.add("no_controls");let i=-1==["seekbar","controls","rightBottom"].indexOf(e.mode)?"default":e.mode;e.always&&t.fadeIn(!0),"default"===i&&(t.coreControls.style.display="flex",t.secondaryControls.style.display="flex",t.seekGroup.style.display="flex"),"seekbar"===i&&(t.coreControls.style.display="none",t.secondaryControls.style.display="none",t.seekGroup.style.display="flex"),"controls"===i&&(t.seekGroup.style.display="none",t.coreControls.style.display="flex",t.secondaryControls.style.display="flex"),!e.enabled||e.onlyOpacityLayer?(t.coreControls.style.display="none",t.secondaryControls.style.display="none",t.seekGroup.style.display="none",t.classList.add("no_controls"),e.enabled||t.classList.add("no_opacity")):(t.classList.remove("no_controls"),t.classList.remove("no_opacity")),"rightBottom"===i?(t.seekGroup.style.display="none",t.classList.add("rightBottom"),t.titleHeader.classList.add("rightBottom"),t.coreControls.classList.add("rightBottom"),t.secondaryControls.classList.add("rightBottom"),t.continuousGuidance.classList.add("rightBottom")):(t.classList.remove("rightBottom"),t.titleHeader.classList.remove("rightBottom"),t.coreControls.classList.remove("rightBottom"),t.secondaryControls.classList.remove("rightBottom"),t.continuousGuidance.classList.remove("rightBottom"));let s=e.muteButtonOnly;"B1"==t.breakpoint&&(s=!0);let n=0;e.volumeSlider&&e.enabled&&!e.onlyOpacityLayer?(t.volumeControl.show(),n=48):t.volumeControl.hide(),t.style.setProperty("--smp-volume-controls-group-width",n+"px"),t.volumeControl.muteOnly=s,t.eventBus.trigger("controlsUpdated",{controlBarVisible:"none"!=t.coreControls.style.display,seekBarVisible:"none"!=t.seekGroup.style.display})}function xr(...t){for(;t.length;){let e=t.shift();if(e||""===e)return e}return""}function Pr(t){if(t.toucanPlayer.playlist){const e=xr(t.overrideDisplayTitle,t.toucanPlayer.playlist.displayTitle,t.toucanPlayer.playlist.title),i=xr(t.overrideDisplaySecondaryTitle,t.toucanPlayer.playlist.displaySecondaryTitle),s=xr(t.overrideLiveTimeInfo,t.toucanPlayer.playlist.liveTimeInfo),n=t.titleHeader;if(n.title=e,n.secondaryTitle=i,n.liveText=s,t.castingOverlayVisible)return n.hide(),t.classList.remove("title_header_visible"),void(t.titleHeader.visible=!1);n&&t.uiConfig.titleHeader&&t.uiConfig.titleHeader.enabled?(t.uiConfig.titleHeader.fullscreenOnly?(t.containerDiv.classList.add("fullscreenOnlyTitleHeader"),t.classList.add("fullscreenOnlyTitleHeader")):(t.containerDiv.classList.remove("fullscreenOnlyTitleHeader"),t.classList.remove("fullscreenOnlyTitleHeader")),n.show(),t.classList.add("title_header_visible"),n.visible=!0):(n.hide(),t.classList.remove("title_header_visible"),n.visible=!1),["ar","ur","fa","ps"].includes(t.uiConfig.locale.lang)&&(n.style.direction="rtl",n.classList.add("rtl"))}}function Lr(t,e,i){const s=document.createElement("div");s.classList.add("castingInfoContainer","shown");const n=document.createElement("div");n.classList.add("castingTextDiv"),s.appendChild(n),t.castingTextDiv=n,Ar(t,e,i),t.shadowRoot.appendChild(s),t.castingInfoContainer=s,t.toucanPlayer.registerControl(s)}function Ar(t,e,i){t.castingTextDiv?(t.castingTextDiv.textContent=e,i&&(t.castingTextDiv.textContent=e+" - "+i)):Lr(t,e,i)}customElements.get("smp-video-layout")||customElements.define("smp-video-layout",br);class Ir extends oa{constructor(){super({stylesheet:":host{--smp-button-box-shadow:0;display:block;z-index:150}svg{left:3px;position:relative;width:30px}.button{cursor:pointer;transition:background-color .4s ease-out}.button:not([disabled]).hovering svg{fill:var(--smp-cta-fore-colour-hover)}.button:focus-visible .button_inner svg{fill:var(--smp-cta-fore-colour-tab)}.button.hovering,.button:focus{background-color:var(--smp-colour,#0071f1)}.button:focus{fill:var(--smp-cta-fore-colour-hover)}.cta_duration{bottom:8px;color:#fff;display:none;font-size:.75rem;pointer-events:none;position:absolute;text-align:center;width:80px}.button:not([disabled]).hovering~time{color:var(--smp-cta-fore-colour-hover)}.button:focus-visible~time{color:var(--smp-cta-fore-colour-tab)}.button:focus~time{color:var(--smp-cta-fore-colour-hover)}.button.has_duration svg{top:-5px}",svg:to()})}create(){super.create();const t=document.createElement("time");this.shadowRoot.appendChild(t),this.duration=t,t.className="cta_duration",this.programmeDuration="",this.programmeTitle="",this.attributeChanged()}static get observedAttributes(){return["programme-title"]}attributeChanged(){const t=E.toolTipCTAPlay.replace("{title}",this.programmeTitle);this.button.setAttribute("aria-label",t),this.title=t}get programmeTitle(){return this.getAttribute("programme-title")}set programmeTitle(t){t!=this.programmeTitle&&(null==t&&(t=""),this.setAttribute("programme-title",t))}get programmeDuration(){return this.duration.textContent}set programmeDuration(t){this.duration.textContent=t}get programmeIsoDuration(){return this.duration.getAttribute("datetime")}set programmeIsoDuration(t){t?this.duration.setAttribute("datetime",t):this.duration.removeAttribute("datetime")}durationShow(){this.duration.style.display="block",this.button.classList.add("has_duration")}durationHide(){this.duration.style.display="none",this.button.classList.remove("has_duration")}}customElements.get("smp-cta")||customElements.define("smp-cta",Ir);const Or=document.createElement("template");Or.innerHTML="<div class=\"pre_play_layout_container\">\n\n                                            <smp-holding-image></smp-holding-image>\n                                            <smp-cta></smp-cta>\n\n                                            <div class='guidance_container'>\n                                                <div class=guidance_icon_holder></div>\n                                                <div class='guidance_message_container'>\n                                                    <span class='guidance_message_container'></span>\n                                                </div>\n                                            <div/>\n\n                                        </div>";class Nr extends Xs{constructor(t){super({stylesheet:":host(.ctaDisabled) smp-cta{display:none}:host(.ctaDisabled) .guidance_container{opacity:0}:host(.visiblyHidden) smp-cta{opacity:0}:host(.visiblyHidden) .guidance_container{opacity:0}:host{object-fit:inherit}.pre_play_layout_container{fill:var(--smp-controls-fill,#fff);color:var(--smp-controls-text-colour,#fff);height:100%;position:absolute;width:100%}.layout.layoutOnNotCompleted *{pointer-events:none}smp-holding-image{background-color:#000;height:100%;opacity:var(--smp-holding-image-opacity,1);position:absolute;top:0;width:100%}smp-cta{background-color:rgba(0,0,0,.8);height:80px;left:0;width:80px}.guidance_container,smp-cta{bottom:0;position:absolute;z-index:2}.guidance_container{align-items:center;background-color:rgba(0,0,0,.7);color:#fff;display:none;font-size:.75rem;font-weight:700;justify-content:center;left:80px;max-width:70%;min-height:80px;padding:0 10px}.guidanceSVG{bottom:-1px;margin-right:8px;position:relative;width:15px}.circle{fill:#e51854}.g,.warning .circle{fill:#fff}.warning .g{fill:#000}",template:Or,templateName:"prePlayLayout",toucanPlayer:t}),this.setAttribute("part","preplay")}create(){super.create();const t=this.prePlayLayout;t.style.display="none",this.holdingImage=t.getElementsByTagName("smp-holding-image")[0],this.cta=t.getElementsByTagName("smp-cta")[0],this.guidanceContainer=t.getElementsByClassName("guidance_container")[0],this.guidanceMessage=t.getElementsByClassName("guidance_message_container")[0];const e=t.getElementsByClassName("guidance_icon_holder")[0];e.setAttribute("aria-hidden","true"),e.appendChild(Un("guidanceSVG","circle","g")),customElements.upgrade(this.holdingImage),customElements.upgrade(this.cta);const i=(t,e)=>{this.eventBus.trigger("play-requested",t),this.echoReporter.trackAction(qi,e)};bi(this.holdingImage,["pointerup","click"],gi((t,e)=>{this.focusOnCta(),i(t,e)})),this.holdingImage.style.cursor="pointer",this.cta.setActionFunction(i)}updateUiConfig(t){super.updateUiConfig(t),this.needToCreate||function(t){const e=t.uiConfig.cta;e.enabled?t.classList.remove("ctaDisabled"):t.classList.add("ctaDisabled");e.visiblyHidden?t.classList.add("visiblyHidden"):t.classList.remove("visiblyHidden");"duration"===e.mode?t.cta.durationShow():t.cta.durationHide()}(this)}playlistLoaded(t){super.playlistLoaded(t);let e=t.title||"";t.guidance&&(e.length>0&&(e+=", "),e+=t.guidance),this.cta.programmeTitle=e||"",this.cta.programmeDuration=t.programmeDuration,this.cta.programmeIsoDuration=t.programmeIsoDuration,function(t,e){if(e.guidance||e.warning){t.guidanceContainer.style.display="flex";const i=e.guidance||e.warning;t.guidanceMessage.textContent=i,t.guidanceMessage.setAttribute("aria-label",i),e.warning&&!e.guidance?t.guidanceContainer.classList.add("warning"):t.guidanceContainer.classList.remove("warning")}else t.guidanceContainer.style.display="none"}(this,t)}layoutOn(t){super.layoutOn(t),this.prePlayLayout.style.display="",this.eventBus.trigger("showCta")}layoutOff(){this.cancelOn=!0;const t=this;window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){t.style.display="none",t.setAttribute("tabIndex","-1"),t.setAttribute("aria-hidden","true")})}),this.shouldStopTouchOnLayoutOn&&this.___config&&this[this.___config.templateName]&&(clearTimeout(this.layoutOnNotCompletedTimeout),this[this.___config.templateName].classList.add("layoutOnNotCompleted"))}get shouldStopTouchOnLayoutOn(){return!0}focusOnCta(){this.cta.shadowRoot.querySelector("button").focus()}moveFocusOnAppearance(){this.focusOnCta()}transparentHoldingImage(t){this.holdingImage.opacity=t?0:1}}customElements.get("smp-preplay-layout")||customElements.define("smp-preplay-layout",Nr);function Rr(){const t=En("svg",{viewBox:"0 0 32 32"});let e=En("path",{d:"M3.1 30.2h25.8c1.6 0 2.3-.8 2.3-1.9 0-.8-.3-1.4-1-2.9L18.6 3.8c-.8-1.5-1.5-2-2.6-2s-1.8.5-2.6 2L1.8 25.4C1 26.9.7 27.5.7 28.3c.1 1.1.8 1.9 2.4 1.9zM16 26.9c-1.6 0-2.4-1-2.4-2.1 0-1.2.8-2.1 2.4-2.1s2.4 1 2.4 2.1-.8 2.1-2.4 2.1zm-1.7-6.7-.8-10.6h5l-.8 10.6h-3.4z"});return t.appendChild(e),t}class Fr{constructor(){this._onFuncs={},this._offFuncs={},this._stateChangeListeners=[],this.hadFocus=!1}addType(t,e,i){e&&(this._onFuncs[t]=e),i&&(this._offFuncs[t]=i)}addStateChangeListener(t){this._stateChangeListeners.push(t)}removeStateChangeListener(t){for(let e=0;e<this._stateChangeListeners.length;)this._stateChangeListeners[e]===t?this._stateChangeListeners.splice(e,1):e++}get state(){return this._state}set state(t){if(this._state!=t){this._offFuncs[this._state]&&this._offFuncs[this._state]();for(let e=0;e<this._stateChangeListeners.length;e++)this._stateChangeListeners[e](this._state,t);this._state=t,this._onFuncs[this._state]&&this._onFuncs[this._state](this.hadFocus),this.hadFocus=!1}}}class Dr extends yn{constructor(){super({stylesheet:".button .button_inner{box-sizing:border-box;color:var(--smp-text-button-font-colour,#fff);display:inline-block;font-size:var(--smp-text-button-font-size,1.2rem);line-height:220%;padding:0 12px;transition:background .4s ease-out}smp-text-button.button{padding:5px}.hovering .button_inner{background:var(--smp-text-button-hover,#0071f1);color:var(--smp-text-button-hover-font-colour,#fff)}"})}static get observedAttributes(){return["button-text"]}attributeChanged(){this.buttonInner.textContent=this.getAttribute("button-text"),this.accessibleTitle=this.getAttribute("button-text")}}customElements.get("smp-text-button")||customElements.define("smp-text-button",Dr);const Mr=document.createElement("template");Mr.innerHTML='<div>\n                                        <div class="errorDiv">\n                                            <div class="errorContainer">\n                                                <div class="iconAndTextContainer">\n                                                    <div class="alertIconContainer"></div>\n                                                    <div class="textContainer">\n                                                        <div class="primaryErrorText"></div>\n                                                        <div class="secondaryErrorText hidden"></div>\n                                                    </div>\n                                                </div>\n                                                <smp-text-button class="tryAgainButton show-focus"></smp-text-button>\n                                            </div>\n                                        </div>\n                                        <smp-holding-image class="holdingImage"></smp-holding-image>\n                                        <smp-aria-announcer aria-label=""></smp-aria-announcer>\n                                    </div>';class Hr extends Xs{constructor(t){super({stylesheet:"*{object-fit:inherit}.errorDiv{align-items:center;background-color:rgba(51,51,51,.85);display:flex;height:100%;justify-content:center;position:absolute;width:100%;z-index:1}.errorContainer{font-size:1.2rem;padding:16px;text-align:center;width:100%;z-index:1}:host(.minimode) .errorContainer,:host(.slim_controls.slim_height) .errorContainer,:host(.slim_height) .errorContainer{align-items:center;display:flex;justify-content:center}.alertIcon{fill:#fff;height:1em;width:1em}.alertIconContainer{height:1em;margin-bottom:16px;width:100%}:host(.minimode) .alertIconContainer,:host(.slim_height) .alertIconContainer{margin-bottom:8px}:host(.smp_B1) .alertIcon,:host(.smp_B1) .alertIconContainer{display:none}:host(.smp_tiny.smp_B1) .alertIcon{display:block;height:26px;width:26px}:host(.smp_tiny.smp_B1) .alertIconContainer{align-items:center;display:flex;height:26px;margin:auto;padding-bottom:4px;width:26px}.textContainer{color:#fff}.secondaryErrorText{margin-top:16px}.secondaryErrorText.hidden{display:none}.holdingImage{height:100%;position:absolute;top:0;width:100%;z-index:0}.tryAgainButton{--smp-button-background-colour:#191919;--smp-text-button-hover:var(--smp-colour,#0071f1);--smp-text-button-hover-font-colour:var(--smp-colour-on-highlight-colour,#fff);display:block;height:fit-content;margin:16px auto 0;text-align:center;width:fit-content;z-index:2}:host(.minimode) .tryAgainButton,:host(.slim_controls.slim_height) .tryAgainButton,:host(.slim_height) .tryAgainButton{margin:0 0 0 30px}.tryAgainButton.hidden{display:none}:host(.smp_tiny.smp_B1) .textContainer,:host(.smp_tiny.smp_B1) .tryAgainButton{display:none}:host([audiolayout]) .errorDiv{background-color:rgba(var(--smp-colour-on-base-colour-rgb),.93)}:host([audiolayout]) .tryAgainButton{--smp-button-background-colour:var(--smp-error-layout-button-bg)}:host([audiolayout]) .textContainer{color:var(--smp-text-button-font-colour);max-height:var(--smp-error-text-max-height);overflow:auto;overflow-wrap:break-word}:host([audiolayout].slim_controls.slim_height) .textContainer{max-height:unset;overflow:visible}:host([audiolayout]) .alertIcon{fill:var(--smp-text-button-font-colour)}:host([audiolayout]) .inlineAlertIconContainer{display:none;padding-right:7px}:host([audiolayout].B3_over_600) .inlineAlertIconContainer,:host([audiolayout].B3_over_600) .primaryErrorText{display:inline}:host([audiolayout].B3_over_600) .alertIconContainer{display:none}:host([audiolayout].B3_over_600) svg.alertIcon{position:relative;top:.125em}:host([audiolayout].smp_B1) .secondaryErrorText{display:none}:host([audiolayout].smp_B1) .errorContainer,:host([audiolayout].smp_B2) .errorContainer,:host([audiolayout].smp_tiny.minimode.smp_B4) .errorContainer,:host([audiolayout].smp_tiny.smp_B4.slim_height) .errorContainer{font-size:1rem;padding:8px}:host([audiolayout].minimode) .errorContainer,:host([audiolayout].slim_height) .errorContainer{font-size:1.1rem;padding:8px}:host([audiolayout].smp_B3) .errorContainer,:host([audiolayout].smp_B4) .errorContainer{font-size:1.25rem}:host([audiolayout]) .tryAgainButton{--smp-text-button-font-size:1rem}:host([audiolayout].smp_B3) .tryAgainButton,:host([audiolayout].smp_B4) .tryAgainButton{--smp-text-button-font-size:1.125rem}",template:Mr,templateName:"errorLayoutOuterContainer",toucanPlayer:t})}create(){super.create();const t=this.errorLayoutOuterContainer;this.errorDiv=t.getElementsByClassName("errorDiv")[0],this.setAttribute("part","error"),this.holdingImage=t.getElementsByTagName("smp-holding-image")[0],this.errorContainer=t.getElementsByClassName("errorContainer")[0],this.iconAndTextContainer=t.getElementsByClassName("iconAndTextContainer")[0],this.alertIconContainer=t.getElementsByClassName("alertIconContainer")[0],this.primaryErrorText=t.getElementsByClassName("primaryErrorText")[0],this.secondaryText=t.getElementsByClassName("secondaryErrorText")[0],this.textContainer=t.getElementsByClassName("textContainer")[0],this.tryAgainButton=t.getElementsByTagName("smp-text-button")[0],this.errorAnnouncer=t.getElementsByTagName("smp-aria-announcer")[0],function(t){const e=t.tryAgainButton,i=t.secondaryText;e.setActionFunction(qr.bind(null,t)),e.setAttribute("button-text",E.tryAgain),t.buttonState=new Fr,t.buttonState.addType("refresh",()=>{e.setAttribute("button-text",E.refreshButton),e.show()},()=>{e.setAttribute("button-text",E.tryAgain),e.hide()}),t.buttonState.addType("recoverable",()=>{e.show()},()=>{e.hide()}),t.buttonState.addType("deprecation",()=>{e.setAttribute("button-text",E.deprecationMessageLongLink),e.show()},()=>{e.setAttribute("button-text",E.tryAgain),e.hide()}),t.buttonState.addType("recoverableNoConnection",null,null),t.buttonState.addType("notRecoverable",()=>{i.classList.remove("hidden")},()=>{i.classList.add("hidden")}),t.tryAgainButton.hide()}(this);const e=Rr();if(e.classList.add("alertIcon"),this.alertIconContainer.append(e),this._toucanPlayer.isAudioSkin){this.inlineAlertIconContainer=document.createElement("div"),this.inlineAlertIconContainer.classList.add("inlineAlertIconContainer"),this.textContainer.prepend(this.inlineAlertIconContainer);const t=Rr();t.classList.add("alertIcon"),this.inlineAlertIconContainer.append(t)}}layoutOnCompleted(){this._toucanPlayer.isAudioSkin&&this.setErrorTextMaxHeight()}playlistLoaded(t){this.updatePoster(t)}moveFocusOnAppearance(){this.tryAgainButton&&this.tryAgainButton.takeFocus()}breakpointchange(t){super.breakpointchange(t),this.setErrorTextMaxHeight()}setError(t){this.primaryErrorText.textContent=t.description,this.secondaryText.textContent=t.secondaryText,this.inlineAlertIconContainer&&(this.inlineAlertIconContainer.title=t.description),this.alertIconContainer.title=t.description;let e=t.secondaryText?[t.description,t.secondaryText].join(" "):t.description;this.errorAnnouncer.alert(e),t.deprecation?this.buttonState.state="deprecation":t.recoverable?(this.onlineFunction=zr.bind(null,this),this.offlineFunction=Ur.bind(null,this),window.addEventListener("online",this.onlineFunction),window.addEventListener("offline",this.offlineFunction),navigator.onLine?this.buttonState.state="recoverable":this.buttonState.state="recoverableNoConnection"):t.refresh?this.buttonState.state="refresh":this.buttonState.state="notRecoverable",this.setErrorTextMaxHeight()}setErrorTextMaxHeight(){if(!this.offsetHeight)return;let t=this.tryAgainButton.offsetHeight?this.tryAgainButton.offsetHeight+16:0,e=this.alertIconContainer.offsetHeight?this.alertIconContainer.offsetHeight+16:0,i=this.offsetHeight-e-t-16;this.textContainer.style.setProperty("--smp-error-text-max-height",i+"px")}}function qr(t){"deprecation"==t.buttonState.state?location.href="https://www.bbc.co.uk/iplayer/help/questions/computer-issues/flash":"refresh"==t.buttonState.state?location.reload():(window.removeEventListener("online",t.onlineFunction),window.removeEventListener("offline",t.offlineFunction),t.toucanPlayer._eventBus.trigger("tryAgainClicked"))}function zr(t){"notRecoverable"!=t.buttonState.state&&(t.buttonState.state="recoverable")}function Ur(t){"notRecoverable"!=t.buttonState.state&&(t.buttonState.state="recoverableNoConnection")}customElements.get("smp-error-layout")||customElements.define("smp-error-layout",Hr);class Wr{constructor(t){this._toucanPlayer=t,this.layouts={preplay:null,playback:null,error:null},this._eventBus=t._eventBus,this._layoutState=new Fr,this.bindEvents()}set currentState(t){t!=this._layoutState.state&&(this._layoutState.hadFocus=!!this._toucanPlayer.shadowRoot.activeElement,this._layoutState.state=t)}get currentState(){return this._layoutState.state}defaultLayouts(t){const e=this._layoutState,i=this._toucanPlayer,s=new br(i);s.config=t,this.layouts.playback=s;const n=new Nr(i);this.layouts.preplay=n;const o=new Hr(i);this.layouts.error=o,i.shadowRoot.appendChild(s),i.shadowRoot.appendChild(n),i.shadowRoot.appendChild(o),e.addType("playback",s.layoutOn.bind(s),s.layoutOff.bind(s)),e.addType("preplay",n.layoutOn.bind(n),n.layoutOff.bind(n)),e.addType("error",o.layoutOn.bind(o),o.layoutOff.bind(o)),e.state=""}bindEvents(){const t=this._eventBus,e=this,i=this._toucanPlayer;let s=function(){e.currentState="preplay"},n=function(){t.unbind("fullscreenExit",s),e._layoutState.removeStateChangeListener(n)};t.bind("playlistLoaded",t=>{t.autoplay||(e.currentState="preplay")}),t.bind("playerDisconnected",()=>{e.currentState="preplay"}),t.bind("playbackBegin",()=>{e.currentState="playback",window.requestAnimationFrame(function(){window.requestAnimationFrame(t.trigger.bind(t,"fixSize"))}),n()}),t.bind("playing",()=>{0==i.videoElement.readyState&&2==i.videoElement.networkState&&i.videoElement.paused||(e.currentState="playback",n())}),t.bind("seekRequested",()=>{n()}),t.bind("playbackEnd",o=>{const a=i.uiSettings;if(!o.detail.error&&"error"!==e.currentState){const o=a.video.displayOnEnded;a.controls.availableOnMediaEnded||i.isFullscreen?(o||e.layouts.playback.showHoldingImage(!0),e.layouts.playback.keepControlsVisible=!0,e.layouts.playback.fadeIn(),a.controls.availableOnMediaEnded||(e.layouts.preplay.transparentHoldingImage(o),t.bind("fullscreenExit",s),e._layoutState.addStateChangeListener(n))):(e.currentState="preplay",e.layouts.preplay.transparentHoldingImage(o))}}),t.bind("error",t=>{"critical"!==t.severity||t.handled?P.shouldReturnToPreplay(t)&&(i.isFullscreen||(e.currentState="preplay")):(e.currentState="error",e._eventBus.trigger("showError"),e.layouts.error.setError(t),i.exitFullscreen(),e.layouts.playback.exitPictureInPicture())}),t.bind(["loadedmetadata","fullscreenExit","resize","uiConfigUpdated"],()=>{Vr(i,i.offsetWidth/i.offsetHeight)}),t.bind("fullscreenEnter",()=>{if(Vr(i,i.offsetWidth/i.offsetHeight),d.needsRepaintOnFullscreen){const t=i.shadowRoot.querySelector("smp-playback");if(t){const e=t.style.display;t.style.display="none",t.offsetHeight,t.style.display=e}}}),t.bind("breakpointchange",t=>{Vr(i,t.width/t.height)}),t.bind("settingsUpdated",()=>{e.applySettings(i._config)}),t.bind("uiConfigUpdated",()=>{e.applyUISettings(i._uiConfig)}),t.bind("focusOnPlayPause",()=>{e.focusOnPlayPause()}),t.bind("updatePoster",()=>{e.updatePoster()}),t.bind("forceShowPlayback",()=>{e.currentState="playback"}),t.bind("reset",()=>{e.currentState=""})}applySettings(t){this.layouts.playback.updateSettings(t)}applyUISettings(t){this.layouts.playback.updateUiConfig(t),this.layouts.preplay.updateUiConfig(t)}updatePoster(){const t=this._toucanPlayer.playlist;t&&(this.layouts.playback.updatePoster(t),this.layouts.error.updatePoster(t),this.layouts.preplay.updatePoster(t))}getControlsPositioning(){return this.layouts.playback.getControlsPositioning()}focusOnPlayPause(){const t=this._toucanPlayer.playbackController;t.interrupted&&t.playbackInterruptionPlugin&&t.playbackInterruptionPlugin.focusOnPlayPause?t.playbackInterruptionPlugin.focusOnPlayPause():("preplay"==this.currentState&&this.layouts.preplay.moveFocusOnAppearance(),"playback"==this.currentState&&this.layouts.playback.moveFocusOnAppearance(),"error"==this.currentState&&this.layouts.error.moveFocusOnAppearance())}get shouldSendUIInfoEvents(){return this.layouts.playback&&this.layouts.playback.clientWidth>0&&this.layouts.playback.clientHeight>0}}function Vr(t,e){!t.isFullscreen&&Math.abs(t.contentAspectRatio-e)/e<.05||t.uiSettings.displayCover?(t.classList.add("displayCover"),t.classList.remove("videoPositionTop","videoPositionBottom")):(t.classList.remove("displayCover","videoPositionBottom","videoPositionTop"),"top"==t.uiSettings.videoPosition?t.classList.add("videoPositionTop"):"bottom"==t.uiSettings.videoPosition&&t.classList.add("videoPositionBottom"))}const jr=document.createElement("template");jr.innerHTML='<div smp-context class="audio_layout_container">\n                                        <smp-core-controls audioLayout smp-context></smp-core-controls>\n                                        <smp-secondary-controls audioLayout smp-context></smp-secondary-controls>\n                                        <smp-volume-controller audioLayout smp-context slidedirection="right"></smp-volume-controller>\n                                        <smp-seek-group audioLayout smp-context></smp-seek-group>\n                                        <smp-aria-announcer aria-hidden="true" aria-live="assertive" style="display:none"></smp-aria-announcer>\n                                </div>';class Gr extends Xs{constructor(t){super({stylesheet:"smp-button.hidden,smp-button.removed{cursor:default;opacity:0;pointer-events:none}.layout.layoutOnNotCompleted *{pointer-events:none}.audio_layout_container{--smp-highlight-button-circle-radius:100%;fill:var(--smp-controls-fill,#422454);color:var(--smp-controls-text-colour,#fff)}smp-error-layout{--smp-highlight-button-circle-radius:0;position:absolute;top:0}smp-core-controls{display:block;display:flex;justify-content:center;opacity:1;position:absolute;top:62px;width:100%}:host(.show_slim_controls.slim_controls:not(.three_rows)) smp-core-controls,:host(.slim_height.slim_controls:not(.smp_tiny)) smp-core-controls{top:34px}:host(.show_slim_controls.slim_controls:not(.three_rows)) smp-secondary-controls,:host(.slim_height.slim_controls) smp-secondary-controls{top:40px}:host(.show_slim_controls.slim_controls:not(.three_rows)) smp-volume-controller,:host(.slim_height.slim_controls) smp-volume-controller{--smp-volume-slider-bottom:6px;--smp-volume-controller-number-wrap-size:40px;--smp-volume-button-svg-dimension:22px;top:40px}smp-core-controls.hidden,smp-volume-controller{display:none;opacity:0}smp-volume-controller{left:8px;position:absolute;top:70px}@media (prefers-reduced-motion:no-preference){smp-volume-controller{transition-behavior:allow-discrete;transition-duration:1.5s;transition-property:opacity,display}}smp-volume-controller.show{display:block;opacity:1}@starting-style{smp-volume-controller.show{opacity:0}}smp-volume-controller.smp_B1{top:62px}smp-secondary-controls{display:block;opacity:1;position:absolute;right:8px;top:70px}:host(.three_rows) smp-volume-controller.smp_B1{left:0;top:62px}:host(.three_rows.small_B2) smp-volume-controller{left:var(--smp-core-right,0)}:host(.three_rows) smp-volume-controller,:host(.three_rows.small_B2) smp-secondary-controls.coreControlsThreeButtons.buttonCount_2.coreControlsHasIntervalButtons~smp-volume-controller{left:calc(var(--smp-core-right, 0px) + 8px);top:134px}:host(.three_rows) smp-secondary-controls{right:var(--smp-core-right,0);top:134px}smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_3,smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_4{right:calc(var(--smp-core-right, 0px) - 64px)}smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_3.small_B2,smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_4.small_B2{right:calc(var(--smp-core-right, 0px) - 48px)}smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_3.small_B2.coreControlsHasIntervalButtons,smp-secondary-controls.three_rows.coreControlsThreeButtons.buttonCount_4.small_B2.coreControlsHasIntervalButtons{right:calc(var(--smp-core-right, 0px) - 64px)}:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_3.small_B2~smp-volume-controller,:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_4.small_B2~smp-volume-controller{left:calc(var(--smp-core-right, 0px) - 48px)}:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_3.small_B2.coreControlsHasIntervalButtons~smp-volume-controller,:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_4.small_B2.coreControlsHasIntervalButtons~smp-volume-controller{left:calc(var(--smp-core-right, 0px) - 56px)}smp-secondary-controls.three_rows.coreControlsOneButton.buttonCount_3,smp-secondary-controls.three_rows.coreControlsOneButton.buttonCount_4{right:calc(var(--smp-core-right, 0px) - 128px)}:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_3~smp-volume-controller,:host(.three_rows) smp-secondary-controls.coreControlsThreeButtons.buttonCount_4~smp-volume-controller{left:calc(var(--smp-core-right, 0px) - 56px)}:host(.three_rows) smp-secondary-controls.coreControlsOneButton.buttonCount_3~smp-volume-controller,:host(.three_rows) smp-secondary-controls.coreControlsOneButton.buttonCount_4~smp-volume-controller{left:calc(var(--smp-core-right, 0px) - 120px)}:host(.smp_tiny) smp-secondary-controls,:host(.smp_tiny) smp-seek-group,:host(.smp_tiny) smp-volume-controller{display:none;transition-duration:0s}:host(.smp_tiny) smp-core-controls{height:48px;top:calc(50% - 24px)}@media (prefers-reduced-motion:no-preference){smp-secondary-controls{transition-behavior:allow-discrete;transition-duration:1.5s;transition-property:opacity,display}}smp-secondary-controls.hidden{display:none;opacity:0}smp-secondary-controls.visuallyhidden{opacity:0}@starting-style{smp-secondary-controls{opacity:0}}",template:jr,templateName:"container",toucanPlayer:t}),this.firstPlaying=!0}create(){super.create();const t=this.outerContainer;var e,i;this.coreControls=this.container.getElementsByTagName("smp-core-controls")[0],this.coreControls.mode="cta",this.secondaryControls=this.container.getElementsByTagName("smp-secondary-controls")[0],this.secondaryControls.classList.add("hidden"),this.seekGroup=this.container.getElementsByTagName("smp-seek-group")[0],this.seekGroup.mode="cta",this.seekGroup.disabled=!0,this.volume=this.container.getElementsByTagName("smp-volume-controller")[0],this.volume.hide(),this.errorOverlay=new Hr(this._toucanPlayer),this.container.appendChild(this.errorOverlay),this.errorOverlay.setAttribute("audioLayout",""),this.keyboardShortcutAnnouncer=this.container.getElementsByTagName("smp-aria-announcer")[0],this.keyboardShortcutAnnouncer.setAttribute("aria-label",""),this.secondaryControls.playbackSettingsPanel.setLinkedButton(this.secondaryControls.playbackSettingsButton,t),this.secondaryControls.playbackSpeedSettingsPanel.setLinkedButton(this.secondaryControls.playbackSpeedSettingsButton,t),e=this,i=this._toucanPlayer,e.addEventListener("click",function(){i.shadowRoot.activeElement||e.coreControls.focusOnPlayPauseBtn()}),function(t){const e=t.eventBus;t.coreControls.addEventListener("coreControlsWidthAvailableSet",()=>{setTimeout(function(){$r(t)},50)}),e.bind("playlistLoaded",e=>{let i=e.title||"";e.guidance&&(i.length>0&&(i+=", "),i+=e.guidance),t.coreControls.playPauseButton.title=i;const s=t.coreControls.playPauseButton;s.ctaProgrammeDuration=e.programmeDuration,s.ctaProgrammeIsoDuration=e.programmeIsoDuration,e.autoplay||(t.state="cta")}),e.bind("playerDisconnected",()=>{t.state="cta"}),e.bind("canplay",()=>{$r(t)}),e.bind("playbackBegin",()=>{t.state="playback",window.requestAnimationFrame(function(){window.requestAnimationFrame(e.trigger.bind(e,"fixSize"))})}),e.bind("playing",()=>{0==t.toucanPlayer.videoElement.readyState&&2==t.toucanPlayer.videoElement.networkState&&t.toucanPlayer.videoElement.paused||(t.state="playback"),t.firstPlaying&&(t.firstPlaying=!1,$r(t))}),e.bind("playbackEnd",e=>{const i=t.uiConfig;!e.detail.error&&"error"!==t.state&&(i.controls.availableOnMediaEnded||(t.state="cta"))}),e.bind("error",e=>{"critical"!==e.severity||e.handled?P.shouldReturnToPreplay(e)&&(t.state="cta"):(t.state="error",t.errorOverlay.setError(e))}),e.bind("uiConfigUpdated",()=>{t.updateUiConfig(t._toucanPlayer._uiConfig)}),e.bind("playerSizeChange",e=>{t.lastRecordedWidth=e.width,"B2"===e.breakpoint&&e.width<375?(t.coreControls.classList.add("small_B2"),t.secondaryControls.classList.add("small_B2"),t.classList.add("small_B2")):(t.coreControls.classList.remove("small_B2"),t.secondaryControls.classList.remove("small_B2"),t.classList.remove("small_B2")),e.width>=600?(t.classList.add("B3_over_600"),t.coreControls.classList.add("B3_over_600"),t.secondaryControls.classList.add("B3_over_600"),t.errorOverlay.classList.add("B3_over_600")):(t.classList.remove("B3_over_600"),t.coreControls.classList.remove("B3_over_600"),t.secondaryControls.classList.remove("B3_over_600"),t.errorOverlay.classList.remove("B3_over_600")),e.slimHeight?(t.errorOverlay.classList.add("slim_height"),t.classList.add("slim_height"),t.coreControls.classList.add("slim_height"),t.coreControls.playPauseButton.classList.add("slim_height"),t.secondaryControls.classList.add("slim_height"),t.seekGroup.classList.add("slim_height"),t.volumeControl.classList.add("slim_height"),t.errorOverlay.classList.add("slim_height")):(t.errorOverlay.classList.remove("slim_height"),t.classList.remove("slim_height"),t.coreControls.classList.remove("slim_height"),t.coreControls.playPauseButton.classList.remove("slim_height"),t.secondaryControls.classList.remove("slim_height"),t.seekGroup.classList.remove("slim_height"),t.volumeControl.classList.remove("slim_height"),t.errorOverlay.classList.remove("slim_height")),Kr(t,e.width),t.errorOverlay.setErrorTextMaxHeight(),$r(t);let i=e.width/2-48+"px";t.container.style.setProperty("--smp-cta-duration-available-width",i),"B1"===e.breakpoint?t.volumeControl.muteOnly=!0:t.volumeControl.muteOnly=t.uiConfig.controls.muteButtonOnly}),e.bind("breakpointchange",e=>{!e.tiny||t.uiConfig.controls.slim&&"B4"==e.breakpoint?t.classList.remove("smp_tiny"):t.classList.add("smp_tiny")}),e.bind("notableTimechange",()=>{!function(t){t.toucanPlayer.isLive?(!t.toucanPlayer.playbackController.canSeekForwards&&t.toucanPlayer.playbackController.playbackRate>1&&t.eventBus.trigger("playbackRateChangeRequested",{value:1}),t.toucanPlayer.playbackController.canSeekForwards||t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled?t.toucanPlayer.playbackController.canSeekForwards&&t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled&&t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!1):t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!0)):t.secondaryControls.playbackSpeedSettingsPanel.fasterDisabled&&t.secondaryControls.playbackSpeedSettingsPanel.setLiveEgde(!1)}(t),t.secondaryControls.determineButtonsToShow()}),e.bind("volumeControlExpanded",()=>{const e=t.volume.getBoundingClientRect().left+189,i=t.coreControls.playPauseLeftBoundary,s=t.coreControls.leftBoundary;t.threeRows?t.secondaryControls.classList.add("visuallyhidden"):e>i?t.coreControls.classList.add("hidden"):e>s&&(t.coreControls.playPauseOnly=!0)}),e.bind("volumeControlClosed",()=>{t.coreControls.classList.remove("hidden"),t.secondaryControls.classList.remove("visuallyhidden"),t.coreControls.playPauseOnly=!1})}(this),bi(this,["keyup","focusout","pointermove","pointerup"],function(t){return function(e){if("keyup"==e.type)return document.activeElement!==t.toucanPlayer?void 0:void t.focusChange(!0);"focusout"!=e.type||t.focusChange(!1)}}(this)),this._toucanPlayer.playbackController.currentPlayback.classList.add("audio")}showCta(){const t=!!this._toucanPlayer.shadowRoot.activeElement;this.coreControls.mode="cta",this.seekGroup.disabled=!0,this.seekGroup.setAttribute("mode","cta"),this.seekGroup.setAttribute("aria-hidden","true"),this.toggleCtaDuration(!0),this.volume.hide(),this.secondaryControls.classList.add("hidden"),this.eventBus.trigger("showCta"),t&&this.coreControls.focusOnPlayPauseBtn(),this.uiConfig.cta.enabled||(this.container.style.display="none")}showPlayback(){this.coreControls.mode="playback",this.seekGroup.disabled=!1,this.seekGroup.setAttribute("mode","playback"),this.seekGroup.removeAttribute("aria-hidden"),this.toggleCtaDuration(!1),this.uiConfig.controls&&this.uiConfig.controls.volumeSlider&&"cta"!=this.state&&this.volume.show(),this.secondaryControls.classList.remove("hidden"),$r(this)}showError(){this.coreControls.mode="error",this.secondaryControls.mode="error",this.seekGroup.disabled=!1,this.disablePlayerControls(!0),this.toggleCtaDuration(!1),this.coreControls.toucanPlayer.pause(),this.eventBus.trigger("showError");const t=!!this._toucanPlayer.shadowRoot.activeElement;this.errorOverlay.layoutOn(t)}moveFocusOnAppearance(){"error"==this.coreControls.mode?this.errorOverlay.moveFocusOnAppearance():this.coreControls.focusOnPlayPauseBtn()}get shouldStopTouchOnLayoutOn(){return!0}hideError(){this.errorOverlay.layoutOff(),this.disablePlayerControls(!1)}get threeRows(){return this.classList.contains("three_rows")}set threeRows(t){this.classList.contains("three_rows")!=t&&(t?(this.classList.add("three_rows"),this.secondaryControls.classList.add("three_rows"),this.coreControls.classList.add("three_rows"),this.secondaryControls.playbackSettingsPanel.classList.add("three_rows"),this.secondaryControls.playbackSpeedSettingsPanel.classList.add("three_rows"),this.coreControls.playPauseButton.classList.add("three_rows"),this.seekGroup.classList.add("three_rows"),this.volumeControl.classList.add("three_rows"),this.coreControls.widthAvailable=this.offsetWidth):(this.classList.remove("three_rows"),this.secondaryControls.classList.remove("three_rows"),this.coreControls.classList.remove("three_rows"),this.secondaryControls.playbackSettingsPanel.classList.remove("three_rows"),this.secondaryControls.playbackSpeedSettingsPanel.classList.remove("three_rows"),this.coreControls.playPauseButton.classList.remove("three_rows"),this.seekGroup.classList.remove("three_rows"),this.volumeControl.classList.remove("three_rows"),this.eventBus.triggerEvent(new Q({height:165}))))}set state(t){if(this._state==t)return;this._state=t;const e=this._toucanPlayer._uiConfig;switch("error"==t||e.controls.enabled&&"playback"==t||e.cta.enabled&&"cta"==t?this.container.style.display="":this.container.style.display="none",this.classList.remove("cta-state","playback-state","error-state"),this.coreControls.classList.remove("cta-state","playback-state","error-state"),this.coreControls.classList.add("state-transition"),setTimeout(()=>{this.coreControls.classList.remove("state-transition")},1500),t){case"error":this.classList.add("error-state"),this.coreControls.classList.add("error-state"),this.showError();break;case"playback":this.classList.add("playback-state"),this.coreControls.classList.add("playback-state"),this.showPlayback(),this.hideError();break;default:this.classList.add("cta-state"),this.coreControls.classList.add("cta-state"),this.showCta(),this.hideError()}}get state(){return this._state}get volumeControl(){return this.volume}getControlsPositioning(){const t={};let e=1/0,i=1/0,s=0,n=0,o=this.seekGroup;"none"!=o.style.display?(t.seekBarTop=o.offsetTop,t.seekBarBottom=t.seekBarTop+o.offsetHeight,t.seekBarLeft=o.offsetLeft,t.seekBarRight=t.seekBarLeft+o.offsetWidth):(t.seekBarLeft=0,t.seekBarRight=0,t.seekBarTop=0,t.seekBarBottom=0);const a=this.secondaryControls;if("none"!=a.style.display){let t=a.getBoundingClientRect();e=Math.min(e,t.top),s=Math.max(s,t.bottom),n=Math.max(n,t.right)}const r=this.coreControls;if("none"!=r.style.display){let t=r.getBoundingClientRect();e=Math.min(e,t.top),s=Math.max(s,t.bottom),i=Math.min(i,t.left),n=Math.max(n,t.right)}const l=this.volume;if("none"!=l.style.display){let t=l.getBoundingClientRect();i=Math.min(i,t.left)}return t.controlsTop=e,t.controlsLeft=i,t.controlsHeight=s-e,t.controlsWidth=n-i,t}updateUiConfig(t){super.updateUiConfig(t);const e=this._toucanPlayer._uiConfig;let i=this._toucanPlayer._uiConfig.skinMode;if(void 0===i){i=Ci(e.baseColour||"#FFFFFF")?"dark":"light"}"error"==this.state||e.controls.enabled&&"playback"==this.state||e.cta.enabled&&"cta"==this.state?this.container.style.display="":this.container.style.display="none","light"===i?(this.container.classList.add("lightMode"),this.container.classList.remove("darkMode")):(this.container.classList.remove("lightMode"),this.container.classList.add("darkMode"));this._toucanPlayer._uiConfig.controls.slim?(this.classList.add("slim_controls"),this.coreControls.classList.add("slim_controls"),this.coreControls.playPauseButton.classList.add("slim_controls"),this.secondaryControls.classList.add("slim_controls"),this.seekGroup.classList.add("slim_controls"),this.volumeControl.classList.add("slim_controls"),this.errorOverlay.classList.add("slim_controls"),Kr(this,this.lastRecordedWidth)):(this.classList.remove("slim_controls"),this.coreControls.classList.remove("slim_controls"),this.secondaryControls.classList.remove("slim_controls"),this.coreControls.playPauseButton.classList.remove("slim_controls"),this.seekGroup.classList.remove("slim_controls"),this.volumeControl.classList.remove("slim_controls"),this.errorOverlay.classList.remove("slim_controls"));const s="light"===i?"#F6F6F6":"#3A3C3E";this.container.style.setProperty("--smp-setting-overlay",s);const n="light"===i?"rgba(230, 232, 234, 0.25)":"rgba(84, 86, 88, 0.25)";this.container.style.setProperty("--smp-setting-overlay-box-shadow",n);const o="light"===i?"#1414141c":"#f6f6f64d";this.container.style.setProperty("--smp-time-tip-toggle-highlight",o);const a="light"===i?"255, 255, 255":"20, 20, 20";this.errorOverlay.errorDiv.style.setProperty("--smp-colour-on-base-colour-rgb",a);const r="light"===i?"#F6F6F6":"#000000";this.errorOverlay.errorDiv.style.setProperty("--smp-error-layout-button-bg",r);const l="light"===i?"#141414":"#ffffff";this.errorOverlay.errorDiv.style.setProperty("--smp-text-button-font-colour",l),void 0!==this.state&&(e.controls&&e.controls.volumeSlider&&"cta"!=this.state?this.volume.show():this.volume.hide()),this.volume.muteOnly="B1"===this.volume.breakpoint||e.controls&&e.controls.muteButtonOnly,this.eventBus.trigger("controlsUpdated",{controlBarVisible:"none"!=this.coreControls.style.display,seekBarVisible:"none"!=this.seekGroup.style.display})}disablePlayerControls(t){t?(this.coreControls.setAttribute("inert","true"),this.secondaryControls.setAttribute("inert","true"),this.seekGroup.setAttribute("inert","true"),this.volume.setAttribute("inert","true")):(this.coreControls.removeAttribute("inert"),this.secondaryControls.removeAttribute("inert"),this.seekGroup.removeAttribute("inert"),this.volume.removeAttribute("inert"))}toggleCtaDuration(t){this.coreControls.playPauseButton.toggleCtaDuration(t)}layoutOnCompleted(){super.layoutOnCompleted(),$r(this)}}function $r(t){if("cta"!==t.state){let e=t.secondaryControls,i=t.coreControls,s=t.threeRows;s&&t.offsetHeight<e.THREE_ROWS_HEIGHT&&(s=t.threeRows=!1);let n="none"!==window.getComputedStyle(t.volume).getPropertyValue("display"),o=t.offsetWidth/2;!s&&n&&(o-=t.volume.getBoundingClientRect().right-t.getBoundingClientRect().left);let a=t.offsetWidth/2;const r=2*Math.min(o,a);i.widthAvailable=r;let l=i.innerWrap.getBoundingClientRect(),u=e.getBoundingClientRect().right-l.right;s&&(u=t.offsetWidth-(n?t.volume.offsetWidth:0));const c=(t.offsetWidth-i.innerWrap.offsetWidth)/2;t.style.setProperty("--smp-core-right",c+"px"),t.style.setProperty("--smp-core-left",c+"px"),e.backToThreeWidth=t.offsetWidth/2-i.idealWidth/2,e.maxWidth!=u?e.maxWidth=u:e.determineButtonsToShow(),t.secondaryControls.coreControlsButtoncount=t.coreControls.buttonCount,t.secondaryControls.coreControlsNoSeeking=t.coreControls.noSeeking,t.secondaryControls.coreControlsHasIntervalButtons=t.coreControls.hasIntervalButtons}}function Kr(t,e){if(!e)return;const i=t.uiConfig.controls.slimStart&&t.uiConfig.controls.slimStart>=500?t.uiConfig.controls.slimStart:900;t.uiConfig.controls.slim&&i<=e?(t.classList.add("show_slim_controls"),t.coreControls.classList.add("show_slim_controls"),t.coreControls.playPauseButton.classList.add("show_slim_controls"),t.secondaryControls.classList.add("show_slim_controls"),t.seekGroup.classList.add("show_slim_controls"),t.volumeControl.classList.add("show_slim_controls"),t.errorOverlay.classList.add("show_slim_controls")):(t.classList.remove("show_slim_controls"),t.coreControls.classList.remove("show_slim_controls"),t.secondaryControls.classList.remove("show_slim_controls"),t.coreControls.playPauseButton.classList.remove("show_slim_controls"),t.seekGroup.classList.remove("show_slim_controls"),t.volumeControl.classList.remove("show_slim_controls"),t.errorOverlay.classList.remove("show_slim_controls"))}customElements.get("smp-audio-layout")||customElements.define("smp-audio-layout",Gr);class Qr{constructor(t){this._toucanPlayer=t,this.layouts={preplay:null,playback:null,error:null},this.bindEvents(t._eventBus)}get currentState(){return this.layouts.playback.state}set currentState(t){"preplay"==t&&(t="cta"),this.layouts.playback.state=t}get shouldSendUIInfoEvents(){return!0}defaultLayouts(){const t=new Gr(this._toucanPlayer);this.layouts.playback=t,this._toucanPlayer.shadowRoot.appendChild(t),t.layoutOn()}getControlsPositioning(){return this.layouts.playback.getControlsPositioning()}bindEvents(t){const e=this;t.bind("focusOnPlayPause",()=>{e.focusOnPlayPause()})}focusOnPlayPause(){const t=this._toucanPlayer.playbackController;t.interrupted&&t.playbackInterruptionPlugin&&t.playbackInterruptionPlugin.focusOnPlayPause?t.playbackInterruptionPlugin.focusOnPlayPause():this.layouts.playback.moveFocusOnAppearance()}}function Yr(t,e,i){t.addEventListener(e,t=>{if(t.target.notInterestedInEvents&&"volumechange"!=t.type)return;const s=new Event(e,t);if(s._original=t,t.target.preloadingMediaItem)return t.target.delayedEvents||(t.target.delayedEvents=[]),void t.target.delayedEvents.push(s);i.dispatchEvent(s)})}function Jr(t,e,i){t.addEventListener(e,t=>{if(t.target.ignoreTimeUpdatesUntilDVRInfo)return;if(3==t.target.networkState)return;if(t.target.notInterestedInEvents||t.target.preloadingMediaItem)return;const s=new Event(e,t);s._original=t,i.dispatchEvent(s)})}const Xr=["playing","play","pause","seeking","seeked","ended","timeupdate","loadedmetadata","waiting","canplay","volumechange","durationchange","resize","statsBuffering","ratechange"];class Zr{static canPlay(){return!0}constructor(t){this.tryingToPlay=!1,this.element=t,this.storedErrors=[],this._joinTime=void 0,this._segmentedSubs=!1,this.preferAD=!1,this._config={}}setElementAndTarget(t,e){this.element=t,this.domEventTarget=e}onWaiting(){this.element.notInterestedInEvents||(clearTimeout(this.waitingTimer),this._failOnWaitingError&&(this._actuallyFailover(this._failOnWaitingError),this._failOnWaitingError=null))}onCanPlay(){this.element.notInterestedInEvents||(this.tryingToPlay||this.pause(),this.firstCanPlay&&(this.firstCanPlay=!1,this.afterStarting()))}connect(){this.element&&(this._onCanPlay=tl.bind(null,this),this.element.addEventListener("canplay",this._onCanPlay),this._onError=il.bind(null,this),this.element.addEventListener("error",this._onError),this._onWaiting=el.bind(null,this),this.element.addEventListener("waiting",this._onWaiting),this._onPlaying=()=>{this.failoverTime=null},this.element.addEventListener("playing",this._onPlaying),d.needsFakeEnded&&(this._safariFakeEnded={check:al.bind(null,this),cancel:ll.bind(null,this)},this.element.addEventListener("seeking",this._safariFakeEnded.check),this.element.addEventListener("ended",this._safariFakeEnded.cancel)),this.connected=!0)}disconnect(){this.element&&(this.element.removeEventListener("canplay",this._onCanPlay),this._onCanPlay=null,this.element.removeEventListener("error",this._onError),this._onError=null,this.element.removeEventListener("waiting",this._onWaiting),this._onWaiting=null,this.element.removeEventListener("playing",this._onPlaying),this._safariFakeEnded&&(this.element.removeEventListener("seeking",this._safariFakeEnded.check),this.element.removeEventListener("ended",this._safariFakeEnded.cancel),this._safariFakeEnded.timeout&&clearTimeout(this._safariFakeEnded.timeout),this._safariFakeEnded=null),this._onPlaying=null,clearTimeout(this.waitingTimer),this.connected=!1),this._statsProvider&&"function"==typeof this._statsProvider.disconnect&&this._statsProvider.disconnect()}async makeReady(){if(this.connected)for(;this.element.delayedEvents&&this.element.delayedEvents.length>0;){let t=this.element.delayedEvents.shift();this.domEventTarget.dispatchEvent(t)}else this.connect()}get live(){return!1}get segmentedSubs(){return this._segmentedSubs}set segmentedSubs(t){this._segmentedSubs=t}get element(){return this._element}set element(t){this._element=t,this.statsProvider.element=t,this.pairElementAndEventTarget()}get domEventTarget(){return this._domEventTarget}set domEventTarget(t){this._domEventTarget=t,this.pairElementAndEventTarget()}pairElementAndEventTarget(){var t,e;this.element&&this.domEventTarget&&(this.element.repeatedEvents||(!function(t,e,i){if("string"==typeof e)Yr(t,e,i);else for(const s of e)"timeupdate"==s?Jr(t,s,i):Yr(t,s,i)}(this.element,Xr,this.domEventTarget),this.element.repeatedEvents=!0),d.synthesisePlayingAfterSeeked&&(t=this.element,e=this.domEventTarget,t.addEventListener("seeked",t=>{if(!t.target.paused&&!t.target.ended){const i=new Event("playing",t);i._original=t,e.dispatchEvent(i)}})))}get onPlaybackError(){return this._errorCallback}set onPlaybackError(t){this._errorCallback=t}get inBandEnd(){return NaN}get startTime(){return this._startTime}set startTime(t){(isNaN(t)||t<0)&&(t=void 0),this._startTime=t}get canPreload(){return!1}get canPreloadWithElement(){return!0}play(){return this.tryingToPlay=!0,this.element&&(this.element.ignorePlay=!1),this.setup()}setupPaused(){return this.tryingToPlay=!1,this.element&&(this.element.ignorePlay=!0),this.setup()}setup(){if((this._aetEnded||this.live&&this.element.ended)&&(this._aetEnded=!1,this.startEnd&&this.startEnd.start>=0?this.currentTime=this.startEnd.start:this._joinTime&&(this.currentTime=this._joinTime)),!this.element)return;this.element.notInterestedInEvents=!1,!this.element.src&&this._connection&&this._onSrcChange(this._connection,this.startTime);return this.element.play().then(t=>(this.element.ignorePlay=!1,t),t=>{this.element.ignorePlay=!1,"NotAllowedError"===t.name?(this.sendError(P.PLAY_PROMISE_REJECTED),this.live&&!this.startTime&&this.reset()):"NotSupportedError"==t.name&&(this.element.notInterestedInEvents=!0,this.interestedInNextError=!0)})}pause(){this.tryingToPlay=!1,this.element.paused?this.domEventTarget.dispatchEvent(new j("pause")):this.element.pause()}get paused(){return this.element.paused}get ended(){return!!this._aetEnded||this.element.ended}get seeking(){return this.element.seeking}get played(){return this.element.played}get currentTime(){return this.element&&0!=this.element.currentTime?this.mediaToUtc(this.element.currentTime):this.failoverTime||this.startTime||0}set currentTime(t){if(this.element){if(this.startEnd&&this.startEnd.end>0&&t>=this.startEnd.end)this.accurateEndTimeHit();else if(this.element.currentTime!=t){let e=this.utcToMedia(t);Number.isFinite(e)&&(this.element.currentTime=e)}}else this.startTime=t}get duration(){return this.element.duration}get streamStart(){return 0}get earliestSeek(){return 0}get latestSeek(){return this.streamEnd}get streamEnd(){return this.duration}get blockSeekToEnd(){return!1}get canSeek(){return!0}get neverCanSeek(){return!this.canSeek}get canSeekForwards(){return this.currentTime<this.latestSeek}get canSeekToLiveReStart(){return!1}get joinTime(){const t=this._joinTime;return isNaN(t)?this.live?this.currentTime:0:t}get buffered(){const t=this.element.currentTime,e=this.element.buffered;if(!isNaN(t))for(let i=0;i<e.length;i++)if(t>=e.start(i)&&t<=e.end(i))return e.end(i)-t;return 0}reset(){rl(this),this.element&&(this.element.notInterestedInEvents=!0,delete this.element.delayedEvents,delete this.element.preloadingMediaItem,this.element.pause(),this.element.currentTime=0,this.element.src&&this.element.removeAttribute("src")),this.failoverTime=null,this._startTime=void 0,this.formatErrorHappened=!1,delete this._failOnWaitingError,this._aetEnded=!1}get connection(){return this._connection}get connectionSet(){return this._connectionSet}set connectionSet(t){t=t||[],this._statsProvider&&"function"==typeof this._statsProvider.onConnectionSetChange&&this._statsProvider.onConnectionSetChange(),this._connectionSet=t,this._connection=t[0],this._onSrcChange(this._connection,this.startTime)}sendError(t,e){e&&(t.extra?t.extra+="~"+e:t.extra=e),this._errorCallback&&this._errorCallback(t)}set config(t){this._config=t}get config(){return this._config}get statsProvider(){return this._statsProvider||{}}get canFailover(){return!!nl(this)}get currentBitrates(){return{}}get kind(){return this._connection?this._connection.kind:""}get isAudio(){return"audio"==this.kind}get audioTrack(){return 1}set audioTrack(e){t}get audioTracks(){}_actuallyFailover(e){this.failoverTime||(this.failoverTime=this.currentTime);let i=!0;e&&e.code==P.FORMAT_NOT_SUITABLE.code&&(!d.failoverOnFormatError&&"plain"!=this._connection.transferFormat||this.element.preloadingMediaItem)&&(this.formatErrorHappened=!0,i=!1);const s=i&&nl(this);if(s)this.element&&this.domEventTarget.dispatchEvent(new CustomEvent("supplierchange",{old:this._connection.supplier,new:s.supplier})),this._connection=s,this._onSrcChange(s,this.failoverTime),this.tryingToPlay&&this.play();else{t;let i=P.NO_ALTERNATIVE_CONNECTIONS;e&&(e.code==P.DOWNLOADS_OFTEN_SLOW.code&&(i=P.DOWNLOADS_OFTEN_SLOW_FATAL),i.parent=e,i.extra=e.code),setTimeout(this.sendError.bind(this,i),0)}}possiblyDelayFailoverTilOnline(t){navigator.onLine?this.failover(t):(rl(this),this.failoverHappenedAt=(new Date).valueOf(),this._onlineFunction=()=>{rl(this),(new Date).valueOf()-this.failoverHappenedAt>1e3*(this._config.hibernateTime||360)?this.sendError(P.ONLINE_AFTER_LONG):this.failover(t)},window.addEventListener("online",this._onlineFunction),this._cancelTimer=setTimeout(()=>{rl(this),this.sendError(P.NETWORK_UNAVAILABLE)},this._config.offlineAllowanceDelay||6e4))}failover(t){this._connection.blacklisted=!0;let e=12e4;t&&t.code==P.DOWNLOADS_OFTEN_SLOW.code&&(e=36e4),setTimeout(sl.bind(null,this._connection),e);const i=this.element;if(i){const e=this.buffered;i.readyState>2&&e>.5&&i.playbackRate>0&&!i.notInterestedInEvents&&!i.paused?(this._failOnWaitingError=t,clearTimeout(this.waitingTimer),this.waitingTimer=setTimeout(this.onWaiting.bind(this),1e3*e)):this._actuallyFailover(t)}else this._actuallyFailover(t)}recordJoinTime(){let t=this.currentTime;isNaN(this._joinTime)&&Number.isFinite(t)&&t>1e6&&(this._joinTime=t)}setStartEndTime(t){this.startEnd=t,this.makeEndCue()}makeEndCue(){if(this.startEnd&&this.element&&this.element.readyState>0){const t=this.utcToMedia(this.startEnd.end);if(Number.isFinite(t)&&t>=0){this.domEventTarget.timeCallbacks.addCue("AET",t,this.accurateEndTimeHit.bind(this))}}}afterStarting(){if(this.checkEndTime()){let t=this.earliestSeek;this.startEnd.start>=0&&(t=Math.max(t,this.startEnd.start)),this.currentTime=t}this.startEnd&&this.makeEndCue()}checkEndTime(){if(this.element&&this.startEnd&&this.startEnd.end>0){const t=this.currentTime;return t<=this.startEnd.start||t>=this.startEnd.end}return!1}accurateEndTimeHit(){this.pause(),this.element&&(ol(this.element),this._aetEnded=!0)}_onStreamEndAvailable(){!this.startTime&&this.liveEdgeEnded&&(this.currentTime=this.earliestSeek)}get liveEdgeEnded(){let t;return this.startEnd&&(t=this.startEnd.end),t<=this.streamEnd||this.inBandEnd<=this.streamEnd}get snappedToLiveEdge(){return!1}_onSrcChange(t,e){this.firstCanPlay=!0}mediaToUtc(t){return t}utcToMedia(t){return t}sendFakeTimeupdate(){this.domEventTarget&&!this.tryingToPlay&&(!this._lastDispatch||performance.now()-this._lastDispatch>1e3)&&(this._lastDispatch=performance.now(),this.domEventTarget.dispatchEvent(new j("timeupdate",{fake:!0})))}}function tl(t){t.onCanPlay()}function el(t){t.onWaiting()}function il(t,e){if(e.target.notInterestedInEvents&&!t.interestedInNextError)return void 0;t.interestedInNextError=!1;let i=null;switch(e.target.error&&e.target.error.code){case MediaError.MEDIA_ERR_ABORTED:i=P.MEDIA_ERR_ABORTED;break;case MediaError.MEDIA_ERR_NETWORK:i=P.MEDIA_ERR_NETWORK;break;case MediaError.MEDIA_ERR_DECODE:i=P.FORMAT_NOT_DECODED;break;case MediaError.MEDIA_ERR_SRC_NOT_SUPPORTED:""!==t.element.src&&(i=P.FORMAT_NOT_SUITABLE)}i&&(i.extra=e.message,"error"===i.severity||"critical"===i.severity?(i.handled=!0,t.sendError(i),t.handleOnlineDelays?t.possiblyDelayFailoverTilOnline(i):t.failover(i)):t.sendError(i))}function sl(t){t.blacklisted=!1}function nl(t){const e=t.connectionSet,i=t.connection;for(const s of e)if(!s.blacklisted&&s!==i&&t.constructor.canPlay(s))return s;return null}function ol(t){const e=new Event("ended");t.dispatchEvent(e)}function al(t){t.ended&&!t._safariFakeEnded.timeout&&(t._safariFakeEnded.timeout=setTimeout(()=>{ol(t.element),t._safariFakeEnded.timeout=null},200))}function rl(t){clearTimeout(t._cancelTimer),window.removeEventListener("online",t._onlineFunction),delete t._onlineFunction}function ll(t){t._safariFakeEnded.timeout&&(clearTimeout(t._safariFakeEnded.timeout),t._safariFakeEnded.timeout=null)}class ul{constructor(t){this._strategy=t,this.element=t.element,pl(this)}get element(){return this._element}set element(t){t&&this._element!=t&&(this._element&&(this._element.removeEventListener("playing",this._onPlaying),this._element.removeEventListener("waiting",this._onWaiting),this._element.removeEventListener("ended",this._onEnded)),this._element=t,this._onPlaying=hl.bind(null,this),this._element.addEventListener("playing",this._onPlaying),this._onWaiting=cl.bind(null,this),this._element.addEventListener("waiting",this._onWaiting),this._onEnded=dl.bind(null,this),this._element.addEventListener("ended",this._onEnded))}get bitrates(){}get transferFormat(){return this._strategy.connection.transferFormat}get supplier(){return this._strategy.connection.supplier}get currentTime(){return this._strategy.currentTime}get paused(){return this._strategy.paused}get liveEdgeTimestamp(){return this._strategy.latestSeek}get bufferTime(){let t=0;return this.buffering.last&&(t=performance.now()/1e3-this.buffering.last),this.buffering.time+t}get bufferEvents(){return this.buffering.events}get bufferLength(){return this._strategy.buffered}get videoWidth(){return this._element.videoWidth}get videoHeight(){return this._element.videoHeight}onConnectionSetChange(){pl(this)}disconnect(){this._element&&(this._element.removeEventListener("playing",this._onPlaying),this._element.removeEventListener("waiting",this._onWaiting),this._element.removeEventListener("ended",this._onEnded),delete this._onPlaying,delete this._onWaiting,delete this._onEnded)}}function cl(t){!t.buffering.started||t._element.seeking||t._element.ended||(t.buffering.events++,t.buffering.last=performance.now()/1e3,t._element.dispatchEvent(new CustomEvent("statsBuffering")))}function dl(t){t.buffering.started=!1}function hl(t){if(t.buffering.started=!0,t.buffering.last){const e=performance.now()/1e3-t.buffering.last;t.buffering.time+=e,t.buffering.last=null}}function pl(t){t.buffering={time:0,events:0,last:null}}class ml extends ul{constructor(t){super(t)}get downloadBitrate(){return this._strategy.connection.bitrate}get playbackBitrate(){return this._strategy.connection.bitrate}get bitrates(){let t={video:[],audio:[]},e=this._strategy.connection;return t[e.kind]=[{bitrate:e.bitrate,width:e.width}],t}}class gl extends Zr{static canPlay(t){return"plain"===t.transferFormat}constructor(t,e){super(t),this._statsProvider=new ml(this),this._playback=e,this.handleOnlineDelays=!0}_onSrcChange(t,e){super._onSrcChange(t,e),this.element.notInterestedInEvents=!1,this.element.src=this._connection.href,e>0&&(this.currentTime=e)}onCanPlay(){super.onCanPlay(),this.element.dispatchEvent(new j("bitrateChanged",{streamType:this.connection.kind,newBitrate:this.connection.bitrate,newIndex:0}))}}const bl={mf_:{192:86,256:156,384:281,512:437,704:827,960:1604,1280:5070},_live:{192:86,256:156,384:281,512:437,704:827,960:1604,1280:5070}},fl={pc:384,"mobile-cellular-main":192,"mobile-phone-main":256,"mobile-tablet-main":256};class yl extends ul{constructor(t){super(t),window.PerformanceObserver&&(this.observer=new PerformanceObserver(t=>{if(!this.element||!this.element.src)return;let e,i,s=new URL(this.element.src).pathname;-1!=s.indexOf(".ism/")?(e=s.substring(0,s.indexOf(".ism/")),i="od"):-1!=s.indexOf("/x=4/i=urn:bbc:pips:service:")&&(e=s.split("/").slice(0,3).join("/"),i="push"),e&&t.getEntriesByType("resource").forEach(t=>{-1!=t.name.indexOf(".ts")&&-1!=t.name.indexOf(e)&&(this._downloadBitrate=Math.floor(function(t,e){let i;if("od"==e){i=Tl(t,_l);let e=Tl(t,kl);return Number.isFinite(e)&&(i+=e),i}if("push"==e)return i=Tl(t,wl)+48e3,i/1e3>384&&(i+=48e3),i;return NaN}(t.name,i)/1e3))})})),this.observer.observe({entryTypes:["resource"]})}get downloadBitrate(){return this._downloadBitrate}get playbackBitrate(){const t=vl(this._strategy.connection.supplier+""),e=this._strategy.mediaset||"pc",i=fl[e],s=this._strategy.element.videoWidth;return s>0&&t&&t[s]+(!i||s>i?96:48)||NaN}get bitrates(){const t={audio:[{bitrate:48},{bitrate:96}]},e=vl(this._strategy.connection.supplier+"");if(e){t.video=[];for(const[i,s]of Object.entries(e))t.video.push({width:i,bitrate:s});t.video=t.video.sort((t,e)=>t.bitrate-e.bitrate)}return t}get videoBitrate(){const t=vl(this._strategy.connection.supplier+""),e=this._strategy.element.videoWidth;return e>0&&t&&t[e]||NaN}get audioBitrate(){const t=this._strategy.mediaset||"pc",e=fl[t],i=this._strategy.element.videoWidth;return i&&(!e||i>e?96:48)||NaN}}function vl(t){for(let e in bl)if(e&&t.indexOf(e)>=0)return bl[e];return null}const _l=/audio_eng=(\d+)/,kl=/video=(\d+)/,wl=/\/b=(\d+)/;function Tl(t,e){return t.match(e)?parseInt(RegExp.$1,10):NaN}const El=["timeupdate","playing","seeking"];class Cl extends Zr{static canPlay(t){return!t.live&&"hls"===t.transferFormat}constructor(t,e){super(t),this._statsProvider=new yl(this),this._playback=e,this._startDates=new Map,this.handleOnlineDelays=!0,this._syntheticSegmentCallbacks={},this.segmentLoadedEvents=!0}connect(){super.connect(),this.element&&(this._onTimeupdate=this.onTimeupdate.bind(this),this.element.addEventListener("timeupdate",this._onTimeupdate),El.forEach(t=>{this._syntheticSegmentCallbacks[t]=()=>{if(this.segmentLoadedEvents&&this.currentTime>0){let e=this.currentTime+("timeupdate"===t?3:0),i=0,s=0;const n=this.getStartDate();this.currentTime>this.element.currentTime&&(s=n);let o=function(t,e,i,s,n){const o=t-t%3.84;for(let a=0;a<s.length;a++)if(s.start(a)+n<=o&&s.end(a)+n>=o){let r=o;e&&e>r&&s.start(a)+n<=e&&s.end(a)+n>=e&&(r=e);const l=[];for(;r<s.end(a)+n&&r<t+i;)l.push(r),r+=3.84;return l}return[]}(e,this._lastFragmentTime,60,this.element.buffered,s);o.length>0&&(this._lastFragmentTime=o[o.length-1]),o[0]<n&&(o=o.map(t=>t+n),i=n),o.forEach(t=>{!function(t,e,i){if(t.domEventTarget&&!isNaN(e)){const s=t.connection&&t.connection.kind,n="video"===s?3.84:6.4,o={mediaType:"video"===s?"both":"audio",chunk:{index:Math.floor(e/n)+1,start:e-e%n,offset:isNaN(i)?0:i}};o.chunk.startMedia=t.utcToMedia(o.chunk.start),t._lastSegmentIndex!==o.chunk.index&&(t._lastSegmentIndex=o.chunk.index,t.domEventTarget.dispatchEvent(new CustomEvent("segmentLoaded",{detail:o})))}}(this,t,i)})}},this.element.addEventListener(t,this._syntheticSegmentCallbacks[t])}))}disconnect(){super.disconnect(),this.element&&(this.element.removeEventListener("timeupdate",this._onTimeupdate),this._onTimeupdate=null,El.forEach(t=>{this._syntheticSegmentCallbacks[t]&&(this.element.removeEventListener(t,this._syntheticSegmentCallbacks[t]),this._syntheticSegmentCallbacks[t]=null)}))}_onSrcChange(t,e){super._onSrcChange(t,e),this.element.notInterestedInEvents=!1,this.element.src=this._connection.href,e>0&&Number.isFinite(e)&&(this._srcStartFunc&&this.element.removeEventListener("canplay",this._srcStartFunc),this._srcStartFunc=()=>{this.currentTime=e,this.element.removeEventListener("canplay",this._srcStartFunc),this._srcStartFunc=null},this.element.addEventListener("canplay",this._srcStartFunc)),this._startDates=new Map,this._cachedStartDate=null}reset(){super.reset(),this.clearWaitingTooLong(),this.lastBitrate=NaN}onCanPlay(){super.onCanPlay(),this.clearWaitingTooLong()}onWaiting(){super.onWaiting(),this._lastBuffered=this.element.buffered;const t=function(t,e){for(let i=0;i<e.length;i++)if(e.start(i)<=t&&e.end(i)>=t)return!0;return!1}(this.element.currentTime,this._lastBuffered);this._waitTimeout&&clearTimeout(this._waitTimeout),this._waitTimeout=setTimeout(()=>{this.checkWaitingTooLong()},t?12e3:2e4)}checkWaitingTooLong(){if(!this._lastBuffered||function(t,e){if(t.length==e.length){for(let i=0;i<t.length;i++){if(t.start(i)!==e.start(i))return!1;if(t.end(i)!==e.end(i))return!1}return!0}return!1}(this._lastBuffered,this.element.buffered)){const t=P.HLS_WAITING_TOO_LONG;this.possiblyDelayFailoverTilOnline(t),t.handled=!0,this.sendError(t)}}failover(t){this.clearWaitingTooLong(),super.failover(t)}clearWaitingTooLong(){this._waitTimeout&&(clearTimeout(this._waitTimeout),this._waitTimeout=null),this._lastBuffered=null}checkBitrateChange(){const t=this._statsProvider.videoBitrate;if(this._lastBitrate!==t){const e=this._lastBitrate;this._lastBitrate=t;const i=this.statsProvider.bitrates;let s=0;for(;s<i.length&&t!==i[s].bitrate;s++);this.element.dispatchEvent(new j("bitrateChanged",{streamType:"video",newBitrate:t,previousBitrate:e,newIndex:s}))}}onTimeupdate(){this.checkBitrateChange()}getStartDate(){if(this._cachedStartDate)return this._cachedStartDate;if(this.element&&this.element.getStartDate){const t=this.element.getStartDate().getTime()/1e3;let e;this.element.seeking||(this._startDates.has(t)?this._startDates.set(t,this._startDates.get(t)+1):this._startDates.set(t,1));for(let t of this._startDates.entries())(!e||t[1]>e[1])&&(e=t);return e&&e.length>0&&Number.isFinite(e[0])&&e[1]>100&&(this._cachedStartDate=e[0]),e&&e[0]||t}}}class Sl extends Cl{static canPlay(t){return t.live&&"hls"===t.transferFormat}constructor(t,e){super(t,e),this.segmentLoadedEvents=!0}connect(){super.connect(),this.element&&(this._onFirstTimeupdate=()=>{this._onStreamEndAvailable(),this.element.removeEventListener("timeupdate",this._onFirstTimeupdate),this._onFirstTimeupdate=null},this.element.addEventListener("timeupdate",this._onFirstTimeupdate),clearInterval(this._dvrTimeupdateInterval),this._dvrTimeupdateInterval=setInterval(()=>{this.sendFakeTimeupdate(),this.onTimeupdate()},400))}onCanPlay(){this.recordJoinTime()}_onSrcChange(t,e){super._onSrcChange(t,e),this._endStoppedMoving=!1}disconnect(){super.disconnect(),this.element&&this._onFirstTimeupdate&&(this.element.removeEventListener("timeupdate",this._onFirstTimeupdate),this._onFirstTimeupdate=null),clearInterval(this._dvrTimeupdateInterval)}reset(){super.reset(),this._endStoppedMoving=!1,this._lastSeekableEnd=null}get live(){return!0}get canSeek(){return!(this.latestSeek-this.earliestSeek<90)}get streamStart(){return this.getStartDate()}get earliestSeek(){const t=this.element.seekable.length>0?this.element.seekable.start(0):NaN,e=this.mediaToUtc(t);return this.currentTime<e+3?this.currentTime:e}get latestSeek(){const t=this.element.seekable.length>0?this.element.seekable.end(0):NaN,e=this.mediaToUtc(t),i=e-this.currentTime;return!this._snappedToLiveEdge&&i<4?this._snappedToLiveEdge=!0:this._snappedToLiveEdge&&i>12&&(this._snappedToLiveEdge=!1),this._snappedToLiveEdge?this.currentTime:e}get streamEnd(){return this.latestSeek}get duration(){return this.latestSeek-this.earliestSeek}mediaToUtc(t){return t+this.streamStart+(this.isAudio?-37:0)}utcToMedia(t){return t-this.streamStart-(this.isAudio?-37:0)}onWaiting(){super.onWaiting(),this.element&&this.element.defaultPlaybackRate>1&&this.snappedToLiveEdge&&(this.element.defaultPlaybackRate=1,this.element.playbackRate=1)}get liveEdgeEnded(){return!!this._endStoppedMoving||super.liveEdgeEnded}onTimeupdate(){if(super.onTimeupdate(),this.element&&this.element.seekable.length>=1){const t=this.element.seekable.end(this.element.seekable.length-1);this._lastSeekableEnd&&t===this._lastSeekableEnd.end?performance.now()-this._lastSeekableEnd.timestamp>45e3&&(this._endStoppedMoving=!0):(this._lastSeekableEnd={end:t,timestamp:performance.now()},this._endStoppedMoving=!1)}}}class Bl extends ul{constructor(t){super(t),xl(this)}addDashPlayer(t,e){this._dash=t,xl(this),function(t,e,i,s){t.on(e.QUALITY_CHANGE_RENDERED,function(t){if(Ll.includes(t.mediaType)){const e=s.indexToInfo(t.mediaType,t.newQuality);let n=i[t.mediaType],o=n.lastRenderedBitrate;n.lastRenderedBitrate=e.bitrate/1e3,"video"===t.mediaType&&(n.lastRenderedWidth=e.width,n.lastRenderedHeight=e.height),s.element.dispatchEvent(new j("bitrateChanged",{streamType:t.mediaType,newBitrate:n.lastRenderedBitrate,previousBitrate:o,newIndex:t.newQuality}))}}),t.on(e.QUALITY_CHANGE_REQUESTED,function(t){if(Ll.includes(t.mediaType)){const e=s.indexToInfo(t.mediaType,t.newQuality);e&&(i[t.mediaType].lastStreamedBitrate=e.bitrate/1e3,"video"===t.mediaType&&(i[t.mediaType].lastStreamedWidth=e.width,i[t.mediaType].lastStreamedHeight=e.height))}})}(t,e,this.stats,this._strategy)}get bitrates(){const t=this._dash;if(t&&t.isReady()){let e,i,s=t.getSource(),n=s.Period.AdaptationSet_asArray;n||(n=s.AdaptationSet_asArray);let o=t.getCurrentTrackFor("audio");if(o){let t=Al(n,o.id,o.index);e=[],t.forEach(t=>{e.push({codec:t.codecs,bitrate:t.bandwidth/1e3,id:t.id})})}let a=t.getCurrentTrackFor("video");if(a){let t=Al(n,a.id,a.index);i=[],t.forEach(t=>{i.push({codec:t.codecs,bitrate:t.bandwidth/1e3,resolution:t.width+"x"+t.height,width:t.width,framerate:t.frameRate,id:t.id})})}return{audio:e,video:i}}}get downloadBitrate(){let t=Pl(this._dash,"audio",this._strategy,"getHasAudioTrack");return Pl(this._dash,"video",this._strategy,"getHasVideoTrack")+t}get playbackBitrate(){return this.stats.audio.lastRenderedBitrate+(this.stats.video.lastRenderedBitrate||0)}get bufferLength(){return this._dash&&this._dash.isReady()?this._dash.getBufferLength():NaN}}function xl(t){t.stats={audio:{},video:{}}}function Pl(t,e,i,s){let n=NaN;if(t&&t.isReady()){let o=t.getActiveStream();if(!o||!o[s]())return 0;const a=t.getQualityFor(e);if(a>=0){const t=i.indexToInfo(e,a);t&&(n=t.bitrate/1e3)}}return n}const Ll=["audio","video"];function Al(t,e,i){let s;return t&&(s=void 0!==e?t.find(t=>t.id==e):t[i]),s?s.Representation_asArray:[]}class Il{constructor(t){this._quality="hd",this.qualityChanged=t}set config(t){let e=t.quality||"";t.saveData&&!t.hasQualityCookie&&(e="medium"),t.lowBandwidth&&!t.hasQualityCookie&&(e="low"),this._quality!=e&&(this._quality=e,this.qualityChanged&&this.qualityChanged())}get config(){return this._quality}get ratios(){return{audio:this.audioRatio,video:this.videoRatio}}get videoRatio(){let t=1;return"medium"==this._quality&&(t=.65),"low"==this._quality&&(t=.2),t}get audioRatio(){return 1}}class Ol extends Zr{static canPlay(t){return"dash"===t.transferFormat&&!t.live}static getPresentationTimeOffset(t){let e=t.Period_asArray;if(e)for(let t=0;t<e.length;t++){let i=e[t].AdaptationSet_asArray;if(i)for(let t=0;t<i.length;t++){const e=Gl(i[t]);if(Number.isFinite(e))return e;const s=i[t].Representation_asArray;if(s)for(let t=0;t<s.length;t++){const e=Gl(s[t]);if(Number.isFinite(e))return e}}}return 0}constructor(t){super(t),this._statsProvider=new Bl(this),this._quality=new Il(Ul.bind(this)),this._loaded=!1,this._connectionLoaded=!1,this._inFailover=!1,this._presentationTimeOffset=0,this._loader=he,this._haveSentFragmentWarning=!1,this._slowDownloadCount={video:0,audio:0},this._timersClearedOnReset={},this._portalResizer=new ResizeObserver(this.updatePortalSize.bind(this)),t&&this._portalResizer.observe(t)}disconnect(){super.disconnect(),this.reset()}setElementAndTarget(e,i){if(this.element&&this._portalResizer.unobserve(e),super.setElementAndTarget(e,i),this.element&&(this._portalResizer.observe(e),this._dash)){this.element.notInterestedInEvents=!1,this._dash.attachView(this.element),void 0!==this._startTime&&this.element.currentTime!=this._startTime&&(this.element.currentTime=this.startTime,this.startTime=void 0),this._dash.updatePortalSize();const e=30;this._dash.updateSettings({streaming:{stableBufferTime:e,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60}}),setTimeout(()=>{try{this._dash.setBlacklistExpiryTime(12e4)}catch(e){t}},50)}}updatePortalSize(){this._dash&&(clearTimeout(this._updatePortalSize),this._updatePortalSize=setTimeout(this._dash.updatePortalSize.bind(this._dash),300))}set config(t){this._config=t,this._quality.config=t}get config(){return this._config}get quality(){return this._quality}get isWebcastStream(){return!1}preload(t){if(this._dash){let e;e=t&&t.initial||{};const i={initialBitrate:{video:e.video||0,audio:e.audio||0},maxBitrate:{audio:-1,video:2e3}};this._dash.updateSettings({streaming:{bufferTimeAtTopQuality:6,bufferTimeAtTopQualityLongForm:6,abr:i}}),this._dash.preload()}}makeReady(){super.makeReady();const e=/dashJsDebug=true/.test(document.cookie)||this._config.dashjsDebug,i="https://emp.bbci.co.uk/emp/dashjs/3.2.0-14/"+(e?"dash.all.debug.js":"dash.all.min.js");return this.libraryPromise=this._loader.load(i,"dashjs").then(i=>{if(this.dashjs=i,this.libraryPromise=null,!this._loaded){this._loaded=!0;try{this._dash=i.MediaPlayer().create(),this._dash.initialize(null,null,!1),this.debug=e,function(e,i,s){const n=e._dash;n.on(s.METRIC_ADDED,t=>{e.onMetricAdded(t)},e),n.on(s.GAP_CAUSED_SEEK_TO_PERIOD_END,t=>{e.onGapToEnd(t)},e),n.on(s.PLAYBACK_ENDED,t=>{e.onPlaybackEnded(t)},e),n.on("error",Fl.bind(null,e,i)),n.on(s.TRACK_CHANGE_RENDERED,t=>{t.newMediaInfo&&t.oldMediaInfo&&"audio"==t.newMediaInfo.type&&e.domEventTarget.dispatchEvent(new CustomEvent("trackchanged",{detail:{track:e.audioTrack}}))}),n.on(s.QUALITY_CHANGE_REQUESTED,i=>{const s=e.indexToInfo(i.mediaType,i.newQuality);if(s)try{window.localStorage&&("video"===s.mediaType?localStorage.setItem("smphtml5_vbr",s.bitrate/1e3):localStorage.setItem("smphtml5_abr",s.bitrate/1e3))}catch(e){t}}),n.on("serviceLocationUnblacklisted",Ml.bind(null,e))}(this,i.MediaPlayer.errors,i.MediaPlayer.events),this._statsProvider.addDashPlayer(this._dash,i.MediaPlayer.events)}catch(t){const e=P.DASH_LIBRARY_LOAD_FAIL;throw e.extra=t,this.sendError(e),this._loaded=!1,e}if(this._connection)return Rl(this,this._connection)}},t=>{this.libraryPromise=null;const e=P.DASH_LIBRARY_LOAD_FAIL;throw e.extra=t,this.sendError(e),e}),this.libraryPromise}onPlaybackEnded(){if(this.element&&this.element.seeking&&this.element.paused&&!this.element.ended){t,this.reset(),this.element.notInterestedInEvents=!1;const e=new Event("ended");this.element.dispatchEvent(e)}}onGapToEnd(){if(this.element){t;const e=new Event("ended");this.element.dispatchEvent(e)}this.reset()}onMetricAdded(t){if("HttpList"===t.metric){let e=t.value,i=t.mediaType,s=3;if("video"==this.connection.kind&&"video"!=t.mediaType&&(s=5),"MediaSegment"===e.type&&0===e.quality&&e._mediaduration>2&&e.interval/1e3/e._mediaduration>1.05){this._haveSentFragmentWarning||(this.sendError(P.DOWNLOAD_WAS_SLOW,e.url),this._haveSentFragmentWarning=!0),this._slowDownloadCount[i]++;const t=P.DOWNLOADS_OFTEN_SLOW;(this._slowDownloadCount[i]>s&&0===this.element.playbackRate||this._statsProvider.bufferLength<2)&&(this.failover(t),t.handled=!0,this.sendError(t,e.url)),clearTimeout(this._timersClearedOnReset[i]),this._timersClearedOnReset[i]=setTimeout(()=>{this._slowDownloadCount[i]=0},18e4)}}}set debug(t){this._debug=t,this._dash.updateSettings({debug:{logLevel:this._debug?this.dashjs.Debug.LOG_LEVEL_DEBUG:this.dashjs.Debug.LOG_LEVEL_NONE}})}get debug(){return this._debug}get canPreload(){return!0}get canPreloadWithElement(){return!1}play(){const t=this.libraryPromise||this.loadingPromise;return t?t.then(()=>super.play()):!this._connectionLoaded&&this._connection?(this._currentStartTime=this.startTime,Rl(this,this._connection),this.loadingPromise.then(()=>super.play())):super.play()}get connection(){return this._baseUrlConnection||this._connection}startTimeToFragment(t){return t>0?`#t=${t}`:""}_onSrcChange(t,e){this._dashconnection!==t&&(this._dashconnection=t,super._onSrcChange(t,e),this._currentStartTime=e,this._codecFailed=!1,this._loaded&&Rl(this,this._connection))}dashSettings(){const t={streaming:{stableBufferTime:30,bufferTimeAtTopQuality:30,bufferTimeAtTopQualityLongForm:60,calcSegmentAvailabilityRangeFromTimeline:!0,abr:{initialBitrate:Wl(),limitBitrateByPortal:!0,portalScale:1,maxBitrate:{audio:-1,video:-1},portalMinimum:2e3,maxRepresentationRatio:this.quality.ratios,bufferToKeep:70,scheduleWhilePaused:!0}}};return this.config.fragmentTimeout&&(t.streaming.fragmentRequestTimeout=this.config.fragmentRequestTimeout),t}manifestCallback(e,i){if(e){if(this._presentationTimeOffset=Ol.getPresentationTimeOffset(e),!this._novalidate&&!function(e){let i=!1;var s=e.Period_asArray;if(s)for(var n=0;n<s.length;n++){s[n].AdaptationSet_asArray&&(i=!0)}t;return i}(e)){t;return{success:!1,error:{code:this.dashjs.MediaPlayer.errors.MANIFEST_ERROR_ID_NOSTREAMS_CODE}}}const i=this._dash;if(this.baseUrlFailoverAllowed&&this.addAlternateBaseUrls(e),this.segmentedSubs&&!this.fragmentLoadedBinding&&(this.startNumber=function(t){let e=t.Period_asArray;if(e)for(let t=0;t<e.length;t++){let i=e[t].AdaptationSet_asArray;if(i)for(let t=0;t<i.length;t++){let e=i[t].Representation;if(e&&e.SegmentTemplate)return e.SegmentTemplate.startNumber}}}(e),this.fragmentLoadedBinding=jl.bind(null,this),i.on(this.dashjs.MediaPlayer.events.MEDIA_FRAGMENT_LOADED,this.fragmentLoadedBinding)),i.attachSource(e),this.element)this.element.notInterestedInEvents=!1,i.attachView(this.element),i.updatePortalSize(),setTimeout(()=>{try{i.setBlacklistExpiryTime(12e4)}catch(e){t}},50);else if(!i.isReady()&&!this._onlyPreloadManifest){let t=i.getDashAdapter().getIsDynamic(),s=e.mediaPresentationDuration;!t&&s>0&&i.attachView(null)}return{success:!0}}return{success:!1}}errorHandler(t,e){const i=this,s=t;let n=null,o=!0;const a=e.error.code;switch(a){case s.MANIFEST_ERROR_ID_PARSE_CODE:case s.MANIFEST_ERROR_ID_MULTIPLEXED_CODE:case s.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE:n=P.MPD_PARSE_ERROR,n.extra=e.error.message;break;case s.MANIFEST_ERROR_ID_NOSTREAMS_CODE:n=this._codecFailed?null:P.MPD_NO_STREAMS;break;case s.MANIFEST_ERROR_ID_CODEC_CODE:this._codecFailed=!0,n=P.NO_SUPPORTED_CODECS,o=!1;break;case s.DOWNLOAD_ERROR_ID_MANIFEST_CODE:n=P.MPD_LOAD_FAIL,Hl(e,n,this);break;case s.DOWNLOAD_ERROR_ID_INITIALIZATION_CODE:n=function(t,e){let i;const s=e.error.data.request;Dl(t,s)?(i=P.INIT_FRAGMENT_DOWNLOAD_INFORMATION,i.handled=!0,i.supplier=s.serviceLocation):i=P.INIT_FRAGMENT_LOAD_FAIL;return i}(i,e),Hl(e,n,this),n.code===P.INIT_FRAGMENT_DOWNLOAD_INFORMATION.code&&(o=!1);break;case s.DOWNLOAD_ERROR_ID_CONTENT_CODE:n=function(t,e){let i;const s=e.error.data.request;if(t.isWebcastStream){const e=t._inBandEnd,n=s.mediaStartTime;if(Number.isFinite(e)&&e-n<10)return i=P.END_FRAGMENT_MISSING,ql(t),i}const n=s.mediaInfo.streamInfo.duration,o=s.startTime;if(n-o<1&&!t.live)return i=P.END_FRAGMENT_MISSING,ql(t),i;Dl(t,s)?(i=P.FRAGMENT_DOWNLOAD_INFORMATION,i.handled=!0,i.supplier=s.serviceLocation):i=P.STREAM_FRAGMENT_LOAD_FAIL;return i}(i,e),Hl(e,n,this),n.code!==P.END_FRAGMENT_MISSING.code&&n.code!==P.FRAGMENT_DOWNLOAD_INFORMATION.code||(o=!1);break;case s.MEDIASOURCE_TYPE_UNSUPPORTED_CODE:n=P.DASH_MEDIASOURCE_ERROR;break;case s.DOWNLOAD_CONTENT_LENGTH_MISMATCH:n=P.STREAM_FRAGMENT_CONTENT_LENGTH_MISMATCH,Hl(e,n,this);break;default:n=P.DASH_EXCEPTION,n.extra=a,o=!1}n&&(o&&(setTimeout(()=>{i.possiblyDelayFailoverTilOnline(n)},0),n.handled=!0),i.sendError(n))}get baseUrlFailoverAllowed(){return!0!==this._config.disableDashBaseUrlFailover}generateBaseUrlFailovers(){return this.connectionSet.slice(1).filter(Vl)}reset(){super.reset(),this._presentationTimeOffset=0,this._dash&&this._dash.reset(),this._connectionLoaded=!1,this._baseUrlConnection=null,this.appliedBaseUrls=null,this._onStreamInit&&(this._onStreamInit.unloadFn&&this._onStreamInit.unloadFn(),this._onStreamInit=null),zl(this),this.fragmentLoadedBinding&&(this._dash.off(this.dashjs.MediaPlayer.events.MEDIA_FRAGMENT_LOADED,this.fragmentLoadedBinding),this.fragmentLoadedBinding=null),this.loadingPromise=null,this._inFailover=!1}indexToInfo(t,e){const i=this._dash.getBitrateInfoListFor(t);return i.length>e?i[e]:null}get currentBitrates(){return{audio:Nl(this._dash,"audio",this),video:Nl(this._dash,"video",this)}}addAlternateBaseUrls(t){const e=this.connection,i=this.generateBaseUrlFailovers();if(i&&i.length>0){const s=[];s.push({__text:t.baseUri,"dvb:priority":1,serviceLocation:e.supplier});let n=2;for(let t=0;t<i.length;t++)s.push(this.mapConnectionToBaseUrl(i[t],n++));s.length>1&&(t.BaseURL_asArray=s,delete t.baseUri,this.appliedBaseUrls=[e].concat(i))}}get audioTrack(){let t=this.audioTracks;try{let e=this._dash.getCurrentTrackFor("audio");return t.find(t=>$l(t,e))}catch(t){}}set audioTrack(e){let i=this.audioTracks;if(!i)return;let s=-1;if(s="number"==typeof e&&i[e]?e:i.findIndex(t=>$l(t,e)),i[s]){let e=i[s];t,this.preferAD=e.audioDescription,this._dash.setCurrentTrack(this.audioTracks[s])}}get audioTracks(){let t;try{t=this._dash.getTracksFor("audio")}catch(t){}if(t&&t.length>1){for(let e=0;e<t.length;e++){let i=t[e];i.audioDescription=i.accessibility.length>0&&i.roles.length>0&&"alternate"==i.roles[0]}return t}}multipleTracks(){let t=this.audioTracks;t&&t.length>1&&this.domEventTarget&&this.connected&&this.domEventTarget.dispatchEvent(new CustomEvent("multipleaudiotracks",{detail:{tracks:t}}))}mapConnectionToBaseUrl(t,e){const i=t.href,s=i.split(".ism/");if(!s||-1==i.indexOf(".ism/"))return;const n=s[0]+".ism/";return{__text:n,"dvb:priority":e,serviceLocation:t.supplier||n}}failover(t){this._inFailover=!0,super.failover(t)}}function Nl(t,e,i){let s=NaN;if(t&&t.isReady()){const n=t.getQualityFor(e);if(n>=0){const t=i.indexToInfo(e,n);t&&(s=t.bitrate/1e3)}}return s}function Rl(e,i){const s=i.href+e.startTimeToFragment(e._currentStartTime);let n=!1;if(e.loadingPromise||(e.loadingPromise=new Promise((t,i)=>{e._onStreamInit||(e._onStreamInit={callback:()=>{e.element&&e.element.notInterestedInEvents||(e.loadingPromise=null,e._onStreamInit&&e._onStreamInit.unloadFn&&e._onStreamInit.unloadFn(),e._onStreamInit=null,e.multipleTracks(),t())}},e.element?(e.element.addEventListener("loadedmetadata",e._onStreamInit.callback),e._onStreamInit.unloadFn=()=>{e.element.removeEventListener("loadedmetadata",e._onStreamInit.callback)}):(e._dash.on("streamInitialized",e._onStreamInit.callback),e._onStreamInit.unloadFn=()=>{e._dash.off("streamInitialized",e._onStreamInit.callback)})),e.onRetrieveManifest=(t,n)=>{if(s!=e.firstHref)return void 0;const o=e.manifestCallback(t,n);if(o.success)e._connectionLoaded=!0,e._inFailover=!1;else{n||(n=o.error),e._inFailover=!0;let t=e.dashjs.MediaPlayer.errors;n&&n.code!=t.MANIFEST_LOADER_LOADING_FAILURE_ERROR_CODE&&Fl(e,t,{error:n}),e.canFailover||(i("Couldn't load - all dash manifests failed"),e.loadingPromise=null,e._inFailover=!1)}}}),e.firstHref=s,n=!0),n||!0===e._inFailover){t,e._dash.reset(),e._dash.updateSettings(e.dashSettings());let i={};e.preferAD&&(i.role="alternate",i.accessibility="1"),e._dash.setInitialMediaSettingsFor("audio",i),e._dash.retrieveManifest(s,e.onRetrieveManifest)}else t;return e.loadingPromise}function Fl(t,e,i){t.errorHandler(e,i)}function Dl(e,i){let s=!1;if(e.appliedBaseUrls){let n=e.connection.supplier;e._baseUrlConnection=null;const o=e.appliedBaseUrls.filter(t=>t.supplier===i.serviceLocation);if(!(o.length>0))return!1;try{e._dash.setBlacklistExpiryTime(12e4)}catch(e){t}o.forEach(t=>{t.blacklisted=!0});const a=e.appliedBaseUrls.filter(t=>!t.blacklisted);a.length>0&&(setTimeout(()=>{e.domEventTarget.dispatchEvent(new CustomEvent("supplierchange",{old:n,new:a[0].supplier})),e._baseUrlConnection=a[0]},0),s=!0)}return s}function Ml(t,e){const i=e.entry;if(t.appliedBaseUrls){const e=t.appliedBaseUrls.filter(t=>t.supplier===i);e.length>0&&e.forEach(t=>{t.blacklisted=!1})}}function Hl(t,e,i){const s=t.error.data;s.request&&(e.extra=s.request.url,!e.supplier&&i.connection&&(e.supplier=i.connection.supplier),s.response&&(e.extra+="_"+s.response.status))}function ql(t){if(!t._endFunction){const e=t.element;t._endFunction=()=>{if(t.element){const t=new Event("ended");e.dispatchEvent(t)}t.reset(),zl(t)},e.addEventListener("waiting",t._endFunction)}}function zl(t){t._endFunction&&(t.element.removeEventListener("waiting",t._endFunction),t._endFunction=null)}function Ul(){if(this._dash){let t={streaming:{abr:{maxRepresentationRatio:this.quality.ratios}}};this._dash.updateSettings(t)}}function Wl(){let e=-1,i=-1;try{e=parseInt(localStorage.getItem("smphtml5_abr"),10)||-1,i=parseInt(localStorage.getItem("smphtml5_vbr"),10)||-1}catch(e){t}return{audio:e,video:i}}function Vl(t){if(t){if(t.blacklisted)return!1;if(t.href){const e=""+t.href,i=""+t.supplier;return e.indexOf(".ism/")>-1&&i.indexOf("_bidi")<0}}return!1}function jl(t,e){if(t.domEventTarget){const i=Number.isFinite(t.startNumber)?t.startNumber:1,s={mediaType:e.mediaType,chunk:{index:e.chunk.index+i,start:e.chunk.start,offset:t._presentationTimeOffset}};s.chunk.startMedia=t.utcToMedia(s.chunk.start),t.domEventTarget.dispatchEvent(new CustomEvent("segmentLoaded",{detail:s}))}}function Gl(t){if(t&&t.SegmentTemplate){const e=t.SegmentTemplate;if(e&&e.presentationTimeOffset>0){let t=e.timescale||1;return e.presentationTimeOffset/t}}}function $l(t,e){return t.id===e.id&&t.viewpoint===e.viewpoint&&t.lang===e.lang&&t.roles.toString()===e.roles.toString()&&!t.accessibility&&!e.accessibility||t.accessibility&&e.accessibility&&t.accessibility.toString()===e.accessibility.toString()&&(!t.audioChannelConfiguration&&!e.audioChannelConfiguration||t.audioChannelConfiguration&&e.audioChannelConfiguration&&t.audioChannelConfiguration.toString()===e.audioChannelConfiguration.toString())}const Kl=6e4;class Ql extends Ol{constructor(t){super(t),this.manifestRefresh=-1,this._inBandEnd=NaN,this.recentDeltas=[],this._snappedToLiveEdge=!0,this._presentationTimeOffset=0,this._defaultDashJitter=Math.round(3840*Math.random())}connect(){super.connect(),this.element&&(this.addFirstPlayingEvent(),this._onEnded=()=>{this.addFirstPlayingEvent()},this.element.addEventListener("ended",this._onEnded))}disconnect(){super.disconnect(),this.element&&(this.removeFirstPlayingEvent(),this.element.removeEventListener("ended",this._onEnded),this._onEnded=null)}addFirstPlayingEvent(){this._onFirstPlaying||(this._onFirstPlaying=Zl.bind(null,this),this.element.addEventListener("playing",this._onFirstPlaying))}removeFirstPlayingEvent(){this._onFirstPlaying&&(this.element.removeEventListener("playing",this._onFirstPlaying),this._onFirstPlaying=null)}setElementAndTarget(t,e){super.setElementAndTarget(t,e),this.tryingToPlay?this.play():this.pause()}static canPlay(t){return"dash"===t.transferFormat&&t.live}get live(){return!0}get canSeek(){return!(isNaN(this.inBandEnd)&&this.latestSeek-this.earliestSeek<90)}get isWebcastStream(){return!!this._isWebcastStream}get inBandEnd(){return this._inBandEnd}reset(){super.reset(),this._forceCurrentTime=null,this._streamEnd=void 0,this._streamStart=void 0,this._inBandEnd=NaN,this.recentDeltas=[],this._DVRWindowSize=1/0,this.refreshingManifest=!1,this.manifestRefresh&&(clearInterval(this.manifestRefresh),this.manifestRefresh=-1),this.afterRefreshFn=null,this.manifestLoadBinding&&(this._dash.off(this.dashjs.MediaPlayer.events.MANIFEST_LOADED,this.manifestLoadBinding),this.manifestLoadBinding=null),this.validityChangedBinding&&(this._dash.off(this.dashjs.MediaPlayer.events.MANIFEST_VALIDITY_CHANGED,this.validityChangedBinding),this.validityChangedBinding=null)}errorHandler(e,i){const s=e;if(this.refreshingManifest){this._forceCurrentTime=null;switch(i.error.code){case s.MANIFEST_ERROR_ID_PARSE_CODE:case s.MANIFEST_ERROR_ID_MULTIPLEXED_CODE:case s.MANIFEST_LOADER_PARSING_FAILURE_ERROR_CODE:case s.MANIFEST_ERROR_ID_NOSTREAMS_CODE:case s.MANIFEST_ERROR_ID_CODEC_CODE:case s.DOWNLOAD_ERROR_ID_MANIFEST_CODE:t;const e=P.DASH_MPD_REFRESH_FAILED;e.extra=i.error.code;const n=i.error.data;return n.request&&(e.extra+="_"+n.request.url,n.response&&(e.extra+="_"+n.response.status)),void this.sendError(e)}}super.errorHandler(e,i)}manifestCallback(e,i){if(e){if(this._isWebcastStream=function(t){let e=t.Period_asArray;if(e&&e[0]){let t=e[0].AdaptationSet_asArray;if(t)for(let e=0;e<t.length;e++)if(t[e].InbandEventStream)return!0}return!1}(e),this._isDynamic=function(t){return!(!t||"dynamic"!==t.type)}(e),this._manifestDuration=function(t){return t&&t.mediaPresentationDuration}(e),this._presentationTimeOffset=Ol.getPresentationTimeOffset(e),this._isDynamic){!!isNaN(this._manifestDuration)&&this.isWebcastStream?function(e){t;e.manifestLoadBinding||(e.manifestLoadBinding=Xl.bind(null,e),setTimeout(()=>{e.manifestLoadBinding&&e._dash.on(e.dashjs.MediaPlayer.events.MANIFEST_LOADED,e.manifestLoadBinding)},10));e.validityChangedBinding||(e.validityChangedBinding=Yl.bind(null,e),e._dash.on(e.dashjs.MediaPlayer.events.MANIFEST_VALIDITY_CHANGED,e.validityChangedBinding));e.manifestRefresh&&(clearInterval(e.manifestRefresh),e.manifestRefresh=-1);e.manifestRefresh=setInterval(Jl.bind(null,e),Kl)}(this):this._inBandEnd=this.mediaToUtc(e.mediaPresentationDuration)}this.isWebcastStream||(this.segmentedSubs=!0)}return super.manifestCallback(e,i)}onWaiting(){super.onWaiting(),this.element&&this.element.defaultPlaybackRate>1&&this.snappedToLiveEdge&&(this.element.defaultPlaybackRate=1,this.element.playbackRate=1)}onCanPlay(){super.onCanPlay(),this.tryingToPlay?this.play():this.pause(),this.recordJoinTime()}onMetricAdded(t){if(super.onMetricAdded(t),"DVRInfo"==t.metric){const e=void 0===this._streamEnd;if(this._streamStart=Math.min(t.value.range.end,t.value.range.start+30),this._streamEnd=t.value.range.end,this._DVRWindowSize=t.value.manifestInfo&&t.value.manifestInfo.DVRWindowSize||1/0,e&&this._onStreamEndAvailable(),this.currentTime>0){let t=this.mediaToUtc(this._streamEnd)-this.currentTime;if(t<17)this._snappedToLiveEdge=!0,this.recentDeltas=[];else if(t>23)this._snappedToLiveEdge=!1,this.recentDeltas=[];else{this.recentDeltas.push(t)>40&&this.recentDeltas.shift();let e=this.recentDeltas.reduce((t,e)=>t+e,0)/this.recentDeltas.length;this._snappedToLiveEdge=e<20}this.element.ignoreTimeUpdatesUntilDVRInfo=!1}0===t.value.time&&0!==t.value.range.start||this.sendFakeTimeupdate()}}startTimeToFragment(t){return t>0?`#t=pto_posix:${t}`:""}dashSettings(){let t=super.dashSettings();if(this.config.lowLatency)t.streaming.useSuggestedPresentationDelay=!0,t.streaming.lowLatencyEnabled=!0;else if(t.streaming.liveDelay=10,t.streaming.useSuggestedPresentationDelay=!1,t.streaming.lowLatencyEnabled=!1,!1!==this.config.dashFragmentJitter){let e=isNaN(this.config.dashFragmentJitterRange)?this._defaultDashJitter:Math.round(Math.random()*this.config.dashFragmentJitterRange);t.streaming.utcTimeOffset=-e}return t}get duration(){return this.streamEnd-this.earliestSeek}get streamStart(){return this._streamStart+this._presentationTimeOffset}get streamEnd(){return this.snappedToLiveEdge?this.currentTime:this._streamEnd+this._presentationTimeOffset-8}get earliestSeek(){let t=this._streamStart+10+this._presentationTimeOffset;return Math.min(t,this._streamEnd+this._presentationTimeOffset)}get latestSeek(){let t=this._streamEnd+this._presentationTimeOffset-8;return this.snappedToLiveEdge?Math.max(this.currentTime,this._streamStart+this._presentationTimeOffset):t}get snappedToLiveEdge(){return(this.rawCurrentTime>1e5||this._presentationTimeOffset>1e5)&&this._snappedToLiveEdge}get neverCanSeek(){return this._DVRWindowSize<90&&!this.canSeek}mediaToUtc(t){return t+this._presentationTimeOffset+(this.isAudio?-37:0)}utcToMedia(t){return t-this._presentationTimeOffset-(this.isAudio?-37:0)}get rawCurrentTime(){return this.element?this.element.currentTime:this.startTime||0}get currentTime(){return this._forceCurrentTime?this._forceCurrentTime:super.currentTime}set currentTime(t){if(this._forceCurrentTime&&(this._forceCurrentTime=null),Number.isFinite(t)){if(this.isWebcastStream&&this.element){if(!this.inBandEnd&&this.latestSeek-t<90&&t>this.currentTime)return this.manifestRefresh&&(clearInterval(this.manifestRefresh),this.manifestRefresh=-1),this.afterRefreshFn=()=>{this._forceCurrentTime=null,(!isFinite(this.inBandEnd)||t<this.inBandEnd)&&(super.currentTime=t),this.afterRefreshFn=null},this.refreshingManifest=!0,this._forceCurrentTime=t,void this._dash.refreshManifest();this.afterRefreshFn=null}this.element.ignoreTimeUpdatesUntilDVRInfo=!0,super.currentTime=t}}get baseUrlFailoverAllowed(){let t;return t=!1===this._config.attemptDashLiveBaseUrlFailover||!0===this._config.attemptDashLiveBaseUrlFailover?this._config.attemptDashLiveBaseUrlFailover:!!this._config._inExperiment,!this.isAudio&&!0!==this._config.disableDashBaseUrlFailover&&t}generateBaseUrlFailovers(){return this.connectionSet.slice(1).filter(tu)}mapConnectionToBaseUrl(t,e){const i=""+t.href,s=i.lastIndexOf("/");if(s<0)return;const n=i.slice(0,s+1);return{__text:n,"dvb:priority":e,"dvb:weight":t.dpw,serviceLocation:t.supplier||n}}}function Yl(t,e){const i=t.mediaToUtc(e.newDuration);t._inBandEnd=i}function Jl(t){t.latestSeek-t.currentTime>60&&(t.manifestRefresh&&(clearInterval(t.manifestRefresh),t.manifestRefresh=-1),t.refreshingManifest=!0,t._dash.refreshManifest())}function Xl(t,e){t.refreshingManifest=!1;const i=e.data,s=!isNaN(i.mediaPresentationDuration);t.manifestRefresh&&(clearInterval(t.manifestRefresh),t.manifestRefresh=-1),s?t._inBandEnd=t.mediaToUtc(i.mediaPresentationDuration):t.manifestLoadBinding&&(t.manifestRefresh=setInterval(Jl.bind(null,t),Kl)),t.afterRefreshFn&&t.afterRefreshFn()}function Zl(t){if(t.removeFirstPlayingEvent(),t.element&&Number.isFinite(t._manifestDuration)){const e=t.earliestSeek,i=t.startEnd&&t.startEnd.start;t.currentTime=Number.isFinite(i)?Math.max(e,i):e}}function tu(t){if(t&&t.href){return(""+t.supplier).indexOf("_bidi")<0}return!1}class eu{constructor(t){this._connections=t,this._index=-1}next(){return this._index++,this._index>=this._connections.length?{done:!0}:this._connections[this._index]}get remaining(){return this._connections.length-(this._index+1)}}class iu{constructor(t){var e;this.strategies=[],this.pool=new WeakMap,(e=this).newStrategy(Ql),e.newStrategy(gl),e.newStrategy(Cl),e.newStrategy(Sl),e.newStrategy(Ol),this.playback=t}newStrategy(t){this.strategies.unshift(t)}makeFormatList(t,e){let i=null;const s=[];let n=-1;for(let o=0;o<t.length;o++)for(const a of this.strategies)if(t[o].live=e.isLive,a.canPlay(t[o])){t[o].Strategy=a,a===i?s[n].push(t[o]):(s.push([t[o]]),n++,i=a);break}return new eu(s)}make(t,e,i){if(!this.pool.has(t)&&e){const s=new t(e);this.pool.set(t,s),i&&(s.domEventTarget=i)}else if(!e){const e=new t(null,this.playback);return i&&(e.domEventTarget=i),e}return this.pool.get(t)}delete(t){this.pool.has(t.constructor)&&this.pool.delete(t.constructor)}}class su{static isValidData(t){return!(!t||!(t.accurateStartTime||t.accurateEndTime||t.scheduledStartTime||t.scheduledEndTime||t.rewindTo||t.availableTime))}constructor(t,e){this.strategy=t,this.accurateStartTime=e.accurateStartTime,this.accurateEndTime=e.accurateEndTime,this.scheduledStartTime=e.scheduledStartTime,this.scheduledEndTime=e.scheduledEndTime,this.isSimulcast=e.isSimulcast,this.ignoreJoinTime=e.ignoreJoinTime,this.rewindTo=e.rewindTo,this.availableTime=e.availableTime;let i=this.accurateStartTime||this.scheduledStartTime,s=this.accurateEndTime||this.scheduledEndTime;if(Number.isFinite(i)&&Number.isFinite(s)){s-i>72e3&&(delete this.accurateEndTime,delete this.scheduledEndTime)}}get currentTime(){return this.strategy.currentTime}set currentTime(t){t=xe(t,this.earliestSeek,this.latestSeek),this.strategy.currentTime=t}get duration(){return this.streamEnd-this.streamStart}get earliestSeek(){let t,e=this.accurateStartTime||this.scheduledStartTime;if(e)if(isNaN(this.strategy.joinTime))t=e;else{let i=this.ignoreJoinTime?this.strategy.currentTime:this.strategy.joinTime;t=Math.min(e,i)}else this.isSimulcast||isNaN(this.strategy.joinTime)||(t=this.strategy.joinTime);return Number.isFinite(t)?Math.max(t,this.strategy.streamStart):this.strategy.streamStart}get latestSeek(){let t=this.strategy.latestSeek,e=this.availableTime&&this.availableTime.end;return e&&e>this.streamStart&&(t=Math.min(e,this.strategy.latestSeek)),this.accurateEndTime<t?this.accurateEndTime:t}get canSeek(){return this.latestSeek-this.earliestSeek<=90?this.streamEnd-this.streamStart>90&&this.strategy.canSeek:this.strategy.canSeek}get canSeekForwards(){return this.currentTime<this.latestSeek-2}get blockSeekToEnd(){return!!this.strategy.liveEdgeEnded||!!(this.accurateEndTime&&this.accurateEndTime<this.strategy.latestSeek+2)}get liveReStartTime(){return this.rewindTo||this.accurateStartTime||this.scheduledStartTime}get canSeekToLiveReStart(){const t=this.liveReStartTime;if(Number.isFinite(t)){const e=this.earliestSeek,i=this.currentTime;if(t<=this.latestSeek&&i>e&&i!=t)return!0}return!1}get streamStart(){return this.strategy.streamStart}get joinTime(){return this.strategy.joinTime}get streamEnd(){const t=this.strategy.streamEnd;let e=1/0;return isNaN(this.strategy.inBandEnd)||(e=this.strategy.inBandEnd),this.accurateEndTime?Math.min(this.accurateEndTime,e):this.scheduledEndTime?Math.min(Math.max(this.scheduledEndTime,t),e):Math.min(t,e)}get neverCanSeek(){return this.strategy.neverCanSeek&&!this.canSeek}}class nu extends su{get currentTime(){return this.strategy.currentTime-this.accurateStartTime}set currentTime(t){t=xe(t+=this.accurateStartTime,this.earliestSeek,this.latestSeek),this.strategy.currentTime=t}get streamStart(){return Math.max(this.strategy.streamStart,this.accurateStartTime)}get streamEnd(){return this.accurateEndTime?this.accurateEndTime-this.accurateStartTime:this.accurateStartTime>0?this.strategy.streamEnd-this.accurateStartTime:this.strategy.streamEnd}get canSeek(){return this.strategy.canSeek}}class ou{constructor(t){this.element=t,lu(t),this.endingOneShots=new Set,this.cues=new Map,this.endingCueFired=!1,t.addEventListener("durationchange",au.bind(null,this)),!isNaN(t.duration)&&t.duration>0&&!t.notInterestedInEvents&&au(this)}addEndingOneShot(t){this.endingOneShots.has(t)||this.endingOneShots.add(t)}addCue(t,e,i){if(this.cues.has(t))isNaN(e)?(lu(this.element).removeCue(this.cues.get(t)),this.cues.delete(t)):this.cues.get(t).startTime=e;else if(e>=0){let s=new VTTCue(e,e,t);s.onenter=i.bind(),this.cues.set(t,s),lu(this.element).addCue(s)}}}function au(t){const e=t.element;Number.isFinite(e.duration)&&(e.notInterestedInEvents||(t.endingCueFired=!1,t.endingCue?(t.endingCue.startTime=Math.max(0,e.duration-15),t.endingCue.endTime=e.duration):(t.endingCue=new VTTCue(Math.max(0,e.duration-15),e.duration,""),t.endingCue.onenter=ru.bind(null,t),lu(e).addCue(t.endingCue))))}function ru(t){t.endingOneShots.forEach(e=>{t.endingCueFired=!0,e(),t.endingOneShots.delete(e)})}function lu(t){var e=t.textTracks;for(let t=0;t<e.length;t++)if("Metadata"==e[t].label)return e[t];t.addTextTrack("metadata","Metadata").mode="hidden"}const uu=new WeakMap,cu=new WeakMap,du=new WeakMap;class hu extends le{constructor(t,e){super({stylesheet:":host{height:100%;object-fit:inherit;object-position:inherit;position:absolute;width:100%}*{object-fit:inherit;object-position:inherit}:host(.audio) video{opacity:0}"}),this.settings=t||{},this._playbackController=e,this._strategyFactory=new iu(this)}reset(){if(cu.has(this)){cu.get(this).disconnect()}delete this.lastTimeupdate}_setDashDebug(t){if(cu.has(this)){cu.get(this).debug=t}}get isLive(){if(cu.has(this)){return cu.get(this).live}return!1}get duration(){if(du.has(this))return Eu(du.get(this).duration)}get streamStart(){return du.has(this)?Eu(du.get(this).streamStart):0}get earliestSeek(){return du.has(this)?Eu(du.get(this).earliestSeek):0}get latestSeek(){if(du.has(this))return Eu(du.get(this).latestSeek)}get joinTime(){if(du.has(this))return Eu(du.get(this).joinTime)}get canSeek(){return!!du.has(this)&&du.get(this).canSeek}get neverCanSeek(){return!!du.has(this)&&du.get(this).neverCanSeek}get canSeekForwards(){return this.canSeek&&this.currentTime<this.latestSeek-2}get blockSeekToEnd(){return!!du.has(this)&&du.get(this).blockSeekToEnd}get canSeekToLiveReStart(){return!!du.has(this)&&(this.canSeek&&du.get(this).canSeekToLiveReStart)}get streamEnd(){if(du.has(this))return Eu(du.get(this).streamEnd)}get played(){return cu.has(this)?cu.get(this).played:null}get ended(){return!!cu.has(this)&&cu.get(this).ended}get seeking(){return!!cu.has(this)&&cu.get(this).seeking}get currentTime(){return du.has(this)?Eu(du.get(this).currentTime):isNaN(this._config.startTime)?0:this._config.startTime}set currentTime(t){du.has(this)?du.get(this).currentTime=t:(this._config.startTime=t,this.mediaItem&&(this.mediaItem.startTime=t))}get mediaItem(){return this._playbackController.mediaItem}get statsProvider(){return cu.has(this)&&cu.get(this).connected?cu.get(this).statsProvider:null}get canChangeQuality(){return!!cu.has(this)&&"dash"==cu.get(this).connection.transferFormat}get quality(){return cu.has(this)&&cu.get(this).quality?cu.get(this).quality.config:null}set quality(t){cu.has(this)&&cu.get(this).quality&&(cu.get(this).quality.config=t,this.dispatchEvent(new CustomEvent("playbackQualityChanged",{detail:t})))}async play(){let t=this._playbackController.mediaItem.history;if(t.since("setup","active")){t.since("autoplay-failed","start")&&!t.since("playing","autoplay-failed")&&t.push("restart");cu.get(this)&&await cu.get(this).play()}else await function(t){const e=t.mediaItem;e.history.since("start","active")||e.history.push("start");e.history.push("setup");let i=t._videoElement;i.removeAttribute("aria-hidden");const s=t._strategyFactory,n=e.connections[e.contentType];if(t.formatList=s.makeFormatList(n,e),!t.formatList||0===t.formatList.remaining){const e=P.ALL_ITEMS_FILTERED;return t.dispatchEvent(new CustomEvent("error",{detail:e})),Promise.reject(e)}return i.loop=t.settings.loop,t.timeCallbacks.addEndingOneShot(()=>{t.dispatchEvent(new CustomEvent("readyNextItem"))}),vu(t)}(this)}pause(){cu.has(this)?cu.get(this).pause():this.dispatchEvent(new CustomEvent("pause"))}stop(){cu.has(this)&&cu.get(this).reset()}get _videoElement(){if(uu.has(this))return uu.get(this);{const i=function(t){const e=document.createElement("video");return e.id="smpVideoElement",e.setAttribute("aria-hidden","true"),e.setAttribute("playsinline","playsinline"),function(t,e){const i=["loadedmetadata","play","playing","seeking","seeked","pause","ended","waiting","canplay","bitrateChanged"];for(var s=0;s<i.length;s++)e.addEventListener(i[s],pu.bind(t),!0);t.addEventListener("timeupdate",fu.bind(null,t),!0),t.addEventListener("pause",mu.bind(null,t),!0),e.addEventListener("play",bu.bind(null,t),!0),e.addEventListener("durationchange",gu.bind(null,t),!0),e.addEventListener("ratechange",function(){e.notInterestedInEvents||(t.playbackRate=e.playbackRate)})}(t,e),e}(this);return uu.set(this,i),t=this.shadowRoot,e=i,t.appendChild(e),e.style.cssText="width: 100%; height:100%;",this.timeCallbacks=new ou(i),i}var t,e}get videoHeight(){return this._videoElement.videoHeight}get videoWidth(){return this._videoElement.videoWidth}get containerHeight(){return this.offsetHeight}get containerWidth(){return this.offsetWidth}get playbackRate(){return this._videoElement.defaultPlaybackRate}set playbackRate(t){this._videoElement.defaultPlaybackRate=t,this._videoElement.playbackRate=t}setInterestedAgain(){this._videoElement.notInterestedInEvents=!1}get audioTrack(){if(cu.has(this)){return cu.get(this).audioTrack}}set audioTrack(t){if(cu.has(this)){cu.get(this).audioTrack=t}}get audioTracks(){if(cu.has(this)){return cu.get(this).audioTracks}}_captureIntent(){if(this._hasIntent)return Promise.resolve();if(""!==this._videoElement.src)return this._hasIntent=!0,Promise.resolve();let e=this;return new Promise((i,s)=>{if(!d.needsSafariCaptureIntent&&!0!==this.settings.useBlankMP4&&"MediaSource"in window){const t=new MediaSource;new Promise(e=>{t.addEventListener("sourceopen",()=>{let i=t.addSourceBuffer('video/mp4; codecs="avc1.42E01E, mp4a.40.2"');t.duration=999,i.appendBuffer(new ArrayBuffer(100)),e()})}).then(()=>{e._videoElement.play().then(()=>{e._hasIntent=!0,i()}).catch(t=>{"NotAllowedError"===t.name||"AbortError"===t.name?s():(e._hasIntent=!0,i())})}),e._videoElement.notInterestedInEvents=!0,e._videoElement.src=window.URL.createObjectURL(t)}else{const n="https://emp.bbci.co.uk/emp/media/blankv2.mp4";t,e._videoElement.notInterestedInEvents=!0,e._videoElement.src=n,e._videoElement.play().then(()=>{e._videoElement.src==n&&(e.ignoreNextPause=!0,e._videoElement.pause(),e._videoElement.removeAttribute("src")),e._hasIntent=!0,i()}).catch(t=>{e._videoElement.src==n&&e._videoElement.removeAttribute("src"),"AbortError"===t.name?i():"NotAllowedError"===t.name?s():(e._hasIntent=!0,i())})}})}get settings(){return this._config}set settings(t){this._config=t,this._config.intentNotRequired&&(this._hasIntent=!0),cu.has(this)&&(cu.get(this).config=t)}set volume(t){this._videoElement.volume=t,cu.has(this)&&cu.get(this).domEventTarget||this.dispatchEvent(new CustomEvent("volumechange"))}get volume(){return this._videoElement.volume}set muted(t){this._videoElement.muted=!!t,cu.has(this)&&cu.get(this).domEventTarget||this.dispatchEvent(new CustomEvent("volumechange"))}get muted(){return this._videoElement.muted}get shouldReadyNextItem(){return this.timeCallbacks.endingCueFired}get webcastData(){return this._webcastData}set webcastData(t){if(this._webcastData=t,cu.has(this)){ku(this,cu.get(this))}fu(this,new j("timeupdate",{fake:!0}))}utcToMedia(t){return cu.has(this)?cu.get(this).utcToMedia(t):NaN}get _subtitleConnectionBase(){const t=this.mediaItem.originalConnections&&this.mediaItem.originalConnections.video;if(t&&t.length>0){const e=t.filter(t=>"dash"===t.transferFormat&&"https"===t.protocol);if(e.length>0){const t=""+e[0].href,i=t.lastIndexOf("/");if(i>0)return t.substring(0,i+1)}}return null}get canPreload(){return!0}swappingItem(){du.has(this)&&du.delete(this)}async preload(t,e){if(t.strategy)return;const i=this._strategyFactory;if(!t.connections)return void 0;const s=t.connections[t.contentType];if(t.formatList=i.makeFormatList(s,t),!t.formatList||0===t.formatList.remaining)throw"No Media";const n=i.make(s[0].Strategy,null,this);if(n.canPreload||n.canPreloadWithElement&&!this.elementInUse){if(cu.set(t,n),t.strategy=n,n.startTime=t.startTime,n.config=this._config,n.segmentedSubs=Tu(t.connections.captions),n.onPlaybackError=function(t){n.storedErrors.push(t)},n.canPreloadWithElement){const i=this._videoElement;!e&&this._config.enableHlsMediaPreload?i.setAttribute("preload","media"):(i.setAttribute("preload","metadata"),e||function(t){const e=t.history.first("preload");if(e){const t=e.detail;t&&"high"==t.preload&&(t.preload="medium")}}(t)),n.tryingToPlay=!1,n.element=i,i.preloadingMediaItem=t}if(!0!==t.preferAD&&!1!==t.preferAD||(n.preferAD=t.preferAD),n.connectionSet=t.formatList.next(),n.mediaset=t.mediaset,n._onlyPreloadManifest=!!e,await n.makeReady(),!e&&n.preload){const t={};cu.has(this)&&(t.initial=cu.get(this).currentBitrates),n.preload(t)}}}get elementInUse(){const t=cu.get(this);return!!t&&t.element===this._videoElement}}function pu(t){let e=this.mediaItem,i=t.target;if(!e&&i.preloadingMediaItem&&(e=i.preloadingMediaItem),!i.notInterestedInEvents){let s={};if(i.preloadingMediaItem||(s.mediaTime=this.currentTime,"seeking"==t.type&&(s.mediaTime=this.previousTime)),"bitrateChanged"==t.type&&(s.streamType=t.streamType,s.bitrate=t.newBitrate,s.index=t.newIndex,this.statsProvider?s.bitrates=this.statsProvider.bitrates:e.strategy&&e.strategy.statsProvider&&(s.bitrates=e.strategy.statsProvider.bitrates)),this.ignoreNextPause&&"pause"==t.type)return;e.history.push(t.type,s)}}function mu(t){if(t.ignoreNextPause)return void(t.ignoreNextPause=!1);let e=t._videoElement;e.ended||e.currentTime==e.duration||t.dispatchEvent(new CustomEvent("tryingToPlay",{detail:!1}))}function gu(e){let i=e._videoElement;if(!i.preloadingMediaItem&&!i.notInterestedInEvents&&i.duration==1/0&&cu.has(e)){let i=cu.get(e);if(!i.live){t;const s=e._strategyFactory,n=e._playbackController.mediaItem;n.consumptionMode="live";const o=n.connections[n.contentType];e.formatList=s.makeFormatList(o,n);const a=P.LIVE_NOT_INDICATED_LIVE;return e.dispatchEvent(new CustomEvent("error",{detail:a})),vu(e),e._strategyFactory.delete(i),!0}}}function bu(t,e){e.target.src==t.intentSrc||e.target.ignorePlay||t.dispatchEvent(new CustomEvent("tryingToPlay",{detail:!0}))}function fu(t){const e=t.currentTime;if(!t.statsProvider)return void 0;t.previousTime=e;const i=t._lastSignificantTimeupdate;if(i){const s=t._config.significantTime||10,n=e-i.currentTime;if(n>s||-n>s){const e=yu(t);t._lastSignificantTimeupdate=e,t.mediaItem.history.push("significantTimeupdate",e),t.dispatchEvent(new CustomEvent("significantTimeupdate",{detail:e}))}}else t._lastSignificantTimeupdate=yu(t)}function yu(t){const e=t.statsProvider;return{currentTime:e.currentTime,duration:e.liveEdgeTimestamp}}async function vu(t){const e=cu.get(t);let i;e&&e.disconnect();const s=t.mediaItem,n=t._videoElement;if(delete n.preloadingMediaItem,s.strategy&&!s.strategy.formatErrorHappened){if(t.formatList=s.formatList,i=s.strategy,delete s.formatList,delete s.strategy,cu.has(s)&&cu.delete(s),i.element&&gu(t))return;n.autoplay=!1,i.startTime=s.startTime||t._config.startTime,i.setElementAndTarget(n,t)}else{s.strategy&&s.strategy.disconnect();const e=t._strategyFactory,o=t.formatList.next();i=e.make(o[0].Strategy,n,t),i.startTime=s.startTime||t._config.startTime,s.connections&&(i.segmentedSubs=Tu(s.connections.captions)),i.connectionSet=o,i.mediaset=s.mediaset}for(cu.set(t,i),ku(t,i),i.config=t._config,!0!==s.preferAD&&!1!==s.preferAD||(i.preferAD=s.preferAD),i.onPlaybackError=_u.bind(null,t);i.storedErrors.length;)_u(t,i.storedErrors.shift());if(i.makeReady&&await i.makeReady(),t._playbackController._tryingToPlay)try{await i.play()}catch(e){t.dispatchEvent(new CustomEvent("tryingToPlay",{detail:!1})),t._playbackController._started=!1}else await i.setupPaused()}function _u(t,e){if(e){let i,s=t._playbackController;if(e.code==P.PLAY_PROMISE_REJECTED.code&&(s._tryingToPlay=!1),e.code==P.ONLINE_AFTER_LONG.code)return void t.dispatchEvent(new CustomEvent("error",{detail:e}));const n=s.mediaItem;if(e.mediaTime=t.currentTime,!e.handled&&("critical"===e.severity||"error"===e.severity))if(navigator.onLine)if(n&&n.failSilent)s._playlistModel.moreRemainingOrAnotherPlaylist&&(e.severity="error",i=function(){setTimeout(function(){n.history.push("skipMinor"),s._playlistModel.next(!s._tryingToPlay)},0)});else{let s=cu.get(t);!s&&n&&(s=cu.get(n)),s&&(!function(t){const e=t.mediaItem.history.has("playing");if(t.formatList){const i=t.formatList.remaining;return!e&&i>0}return!1}(t)||n.failFast?(d.supportsHLS||d.supportsDash||e.code!=P.NO_ALTERNATIVE_CONNECTIONS.code||(e=P.NO_PLAYBACK_START),s.reset(),e.severity="critical"):(e.severity="error",i=function(){n.history.push("changeTransferFormat"),s.reset(),vu(t)}))}else e=P.NETWORK_UNAVAILABLE;t.dispatchEvent(new CustomEvent("error",{detail:e})),i&&i()}}function ku(t,e){su.isValidData(t._webcastData)?wu(t,e):e.live||e._config?.ondemandWebcastData?(t._webcastData={},wu(t,e)):du.set(t,e)}function wu(t,e){let i;e.live?(i=new su(e,t._webcastData),i.isSimulcast=t._playbackController.isSimulcast):i=new nu(e,t._webcastData),du.set(t,i),(i.accurateStartTime||i.accurateEndTime)&&e.setStartEndTime({start:i.accurateStartTime,end:i.accurateEndTime})}function Tu(t){return t&&t.length>0&&"dash"==t[0].transferFormat}function Eu(t){if(!isNaN(t))return t}customElements.get("smp-playback")||customElements.define("smp-playback",hu);class Cu{constructor(t,e){var i;this._eventBus=t._eventBus,this._config=t.settings,this._itemChangeCallback=e,(i=this)._eventBus.bind("ended",Iu.bind(null,i)),i._eventBus.bind("setData",Pu.bind(null,i)),this.playlistHistory=[]}beforeItemChange(t){this._eventBus.trigger("beforeMediaItemChanged",{detail:t})}get playlist(){return this._playlist}set playlist(t){!function(t){const e=t._mediaItem;e&&(e.history.push("inactive"),t.beforeItemChange(e));t._mediaItem=null}(this),this.stateHistory=new u,this.playlistHistory.push({playlist:t,state:this.stateHistory}),this._playlist=t,this.stateHistory.push("playlistLoading"),t.items?this._filteredItems=t.items.filter(t=>!t.isPlaceholderItem):this._filteredItems=[]}get items(){return this._filteredItems}get mediaItem(){return this._mediaItem}get length(){return this.items.length}get index(){return this.items.indexOf(this._mediaItem)}get remaining(){return this.length-this.index-1}get moreRemainingOrAnotherPlaylist(){return this.remaining>0||this._playlist.queued&&!this._config.noAutomaticNextQueued}get moreRemainingOrAnotherPlaylistAvailable(){return this.remaining>0||this._playlist.queued}get previousItemsOrPlaylistAvailable(){return this.index>0||this._playlist.previous}get nextMediaItem(){return this.items[this.index+1]}next(t){const e=Su(this,1,t);return this.stateHistory.push("next",e),e||this.playlist.queued&&(t&&(this.playlist.queued.options?this.playlist.queued.options.autoplay=!1:this.playlist.queued.options={autoplay:!1}),this._eventBus.trigger("playbackChangePlaylist",{detail:this.playlist.queued})),e}previous(){const t=Su(this,-1);return this.stateHistory.push("previous",t),t||this.playlist.previous&&this._eventBus.trigger("playbackChangePlaylist",{detail:this.playlist.previous}),t}restart(){this._playlist&&this.length>0&&xu(this,this.items[0])}peekNextItem(){return Bu(this,1)}forceToItem(t){if(this.items){this.items.indexOf(t)>=0&&(this._mediaItem=t)}}}function Su(t,e,i){const s=Bu(t,e);return s?(xu(t,s,i),s):null}function Bu(t,e){if(!t._playlist)return null;const i=t.mediaItem,s=t.items;let n=0;return i&&(n=s.indexOf(i)+e),n<s.length&&n>=0?s[n]:null}function xu(t,e,i){const s=t._mediaItem;s&&(s.history.push("inactive"),t.beforeItemChange(t._mediaItem)),t._mediaItem=e,e.history.push("active"),t._itemChangeCallback(e,i)}function Pu(t,e){let i=e.data;"SMP.jwtTokens"==i.name&&(Array.isArray(i.data)?i.data.forEach(e=>{Lu(e,t)}):Lu(i.data,t))}function Lu(t,e){Au(e.items,t),e.playlist.queued&&e.playlist.queued.items&&Au(e.playlist.queued.items,t)}function Au(t,e){t.forEach(t=>{t.vpid==e.vpid&&(t.jwtToken=e.token,t.jwtTokenRequired=!1)})}function Iu(t){t.remaining>0?window.requestAnimationFrame(Su.bind(null,t,1,!1)):t._eventBus.asyncDelay(Ou,[t])}function Ou(t){t.stateHistory.push("playlistEnded",t._playlist);let e=!t._config.noAutomaticNextQueued&&t.playlist.queued;t._eventBus.trigger("playlistEnded",{detail:t._playlist}),e&&t._eventBus.delayedTrigger("playbackChangePlaylist",{detail:t.playlist.queued})}class Nu{static async request(t,e){let i,s,n;e&&(n={headers:e});try{i=await fetch(t,n)}catch(t){const e=P.MEDIATOR_REQUEST_ERROR;throw e.extra=t,e}try{s=await i.json()}catch(t){const e=P.MEDIATOR_PARSE_ERROR;throw e.extra=i.status+"_"+t,e}return s}static addUrlOptions(t){return t.cors="1",t}}let Ru=0;class Fu{static request(t,e,i){e&&e.Authorization&&(t+="?jwt_auth="+e.Authorization.replace("Bearer ",""));return new Promise(function(e,s){window[i]=function(t){e(t)};const n=document.createElement("script");n.src=t,n.onerror=function(t){s(t)},document.head.appendChild(n)})}static addUrlOptions(t){const e="JS_callbacks"+Ru;return Ru++,t.jsfunc=e,t}static resetRequestNumber(){Ru=0}}const Du=["canSeek","atLiveEdge","canSeekBackwards","canSeekForwards","canSeekToLiveReStart","underFiveSecsElapsed"];class Mu{constructor(t){this._previous={},this._started=!1,this.toucanPlayer=t,this.eventBus=t._eventBus,this.playbacks={},this._playlistModel=new Cu(t,zu.bind(null,this)),this._mediator=L,t.settings.allowCasting&&window.chrome&&(this.playbacks.chromecast=new Zs(t,this),Ku(this.playbacks.chromecast,t),function(t,e){let i=e._eventBus;["chromecastConnected","chromecastDisconnected","chromecastStateChange"].forEach(e=>{t.addEventListener(e,t=>{i.trigger(e,t)})})}(this.playbacks.chromecast,t),this.playbacks.chromecast.addEventListener("chromecastConnected",()=>{this.mediaItem&&this.mediaItem.history.push("casting");let t=this.currentTime;this.isSimulcast&&(this.currentTime!==this.latestSeek?this.playbacks.chromecast.transferTime=this.currentTime-this.earliestSeek-5:t=void 0),this.playbacks.chromecast.transferTime=t,this.pause(),this.playbacks.chromecast.muted=this.playbacks.standard.muted,this.toucanPlayer.toggleRDot(!1),this.currentPlayback=this.playbacks.chromecast,this.eventBus.trigger("volumechange"),"preplay"!=this.toucanPlayer._layoutChooser.currentState&&this.play()}),this.playbacks.chromecast.addEventListener("chromecastDisconnected",e=>{this.playbacks.standard._config.startTime=e.detail.lastKnownTime,this.playbacks.standard.currentTime=e.detail.lastKnownTime,this.currentPlayback=this.playbacks.standard,this.toucanPlayer.toggleRDot(!0),this.mediaItem&&this.mediaItem.history.push("cast-disconnected"),this.eventBus.trigger("volumechange"),t.subtitles.isOn=e.detail.subsOn;let i=e.detail.lastKnownPlayerState;"PLAYING"===i?this.currentPlayback.play():"PAUSED"===i?this.currentPlayback.pause():this.tryingToPlay?this.currentPlayback.play():this.currentPlayback.pause()}));const e=new hu(t.settings,this);this.playbacks.standard=e,Ku(e,t),t.shadowRoot.appendChild(e),this._currentPlayback=this.playbacks.standard,this.attachEventBusListeners()}get currentPlayback(){return this._currentPlayback}set currentPlayback(t){this._currentPlayback=t,this.eventBus.trigger("currentPlaybackChange")}get _config(){return this.toucanPlayer.settings||{}}attachEventBusListeners(){this.eventBus.bind("play-toggle",()=>{this.paused?this.play():this.pause()}),this.eventBus.bind("seek-requested",t=>{isNaN(t.time)?t.interval&&(this.currentTime+=Number(t.interval)):this.currentTime=t.time}),this.eventBus.bind("live-restart-seek-requested",()=>{this.webcastData&&Number.isFinite(this.webcastData.rewindTo)?this.currentTime=this.webcastData.rewindTo:this.currentTime=this.currentPlayback.earliestSeek}),this.eventBus.bind("live-edge-seek-requested",()=>{this.currentTime=this.currentPlayback.latestSeek}),this.eventBus.bind("queueChanged",()=>{this.queueChanged()}),this.eventBus.bind("pluginRegister",t=>{t.pluginObject&&t.pluginObject.interruptPlayback&&(this.playbackInterruptionPlugin=t.pluginObject)}),this.eventBus.bind("playlistEnded",()=>{this._tryingToPlay=!1,$u(this)}),this.eventBus.bind("error",t=>{const e=this.mediaItem;e&&(t.mediaTime||(t.mediaTime=this.currentTime),"error"==t.type&&t.code==P.PLAY_PROMISE_REJECTED.code&&e.history.push("autoplay-failed"),e.history.push("error",t),t.code==P.ONLINE_AFTER_LONG.code&&this.clearItem(e))}),this.eventBus.bind("playlistLoading",()=>{this.stop(),this.playbacks.standard.reset()},!0)}get playlist(){return this._playlistModel.playlist}set playlist(e){if(this.cancelPreloadPlaylist(),this.interrupted)try{this.playbackInterruptionPlugin.unInterruptPlayback(),Vu(this)}catch(e){t}$u(this),this._playlistModel.playlist=e,this.eventBus.trigger("playlistLoaded",e),e.autoplay?Gu(e,this):e.preload&&this.currentPlayback.canPreload&&async function(e,i){const s=i.preload,n=e._playlistModel.peekNextItem();if(n&&!n.isLive){const t={playlist:i,mediaItem:n,preload:s,date:Date.now(),timestamp:performance.now()};s&&(n.history.push("preload",t),e.eventBus.trigger("preload",t)),i.preloadStartTime&&(n.startTime=i.preloadStartTime);try{"low"==s?await Uu(e,n):"medium"==s?await e.readyNextItem(!0):"high"==s&&await e.readyNextItem(!1)}catch(t){console.error("preload failed",t)}}else t}(this,e)}cancelPreloadPlaylist(){if(this._playlistModel.playlist&&this._playlistModel.playlist.items){const t=this._playlistModel.playlist.items.find(t=>t.isProgramme);t&&t.strategy&&(t.strategy.disconnect(),t.strategy.reset())}}get mediaItem(){return this._playlistModel.mediaItem}get currentItemIndex(){return this._playlistModel.index}async play(e){if(this.interrupted)return void this.eventBus.trigger("error",P.PLAY_PROMISE_REJECTED_INTERRUPTED);if(!this._playlistModel.playlist)return void 0;this._tryingToPlay=!0;let i=this.mediaItem;if(i||(i=this._playlistModel.next(!0)),i&&(e||this.eventBus.trigger("userPlay"),function(t){if(t.blockPlayback){const e=t.mediaItem;return e&&e.history.push("playback-blocked"),t.eventBus.trigger("playbackBlock"),!1}if(!t._started){t._started=!0;const e={mediaItem:t.mediaItem};t.eventBus.trigger("playbackBegin",e)}return!0}(this)&&(i.history.has("playback-blocked")&&!i.history.has("playback-unblocked")&&i.history.push("playback-unblocked"),Qu(i),this._config.ondemandWebcastData&&Number.isFinite(i.in)&&(this.webcastData={accurateStartTime:i.in,accurateEndTime:i.out},(isNaN(this.currentPlayback._config.startTime)||this.currentPlayback._config.startTime<i.in)&&(this.currentPlayback._config.startTime=i.in)),await Promise.all([Wu(this,e),Uu(this,i)]).catch(t=>{throw qu(this,i,t),t}),Qu(i),this._tryingToPlay&&i.history.push("start"),await function(e){const i=e.mediaItem;if(i.interruptPromise)return i.interruptPromise;if(e.playbackInterruptionPlugin&&!i.history.has("preroll-interrupt")&&e._tryingToPlay)return i.interruptPromise=async function(e){if(e.interrupted)return;const i=e.mediaItem.history;i.push("preroll-interrupt"),e.eventBus.trigger("playbackInterrupted"),t;e.interrupted=!0,await e.playbackInterruptionPlugin.interruptPlayback(),Vu(e)}(e),i.interruptPromise.finally(()=>{i.interruptPromise=null}),i.interruptPromise;return Promise.resolve()}(this),Qu(i),this._tryingToPlay)))try{await this.currentPlayback.play()}catch(e){t}}pause(){this.interrupted||(this._tryingToPlay=!1,this.currentPlayback.pause())}get paused(){return!this._tryingToPlay}stop(){this.interrupted||(this.mediaItem&&(this.mediaItem.history.push("stopped"),this.eventBus.trigger("mediaStopped")),this._tryingToPlay=!1,this._started=!1,this.currentPlayback.stop())}clearItem(t){const e=t.history;let i=null;e.has("error")&&(i=e.last("error").detail.mediaTime),this.currentPlayback&&(this.currentPlayback._config.startTime=i),e.has("premediated")?t.history.events=t.history.all("premediated"):(t.history=new u,delete t.mediationPromise)}restart(){this.readyToRestart(),this.play()}readyToRestart(t,e){const i=this.mediaItem;i&&(this.clearItem(i),e||i.history.push("active"),Number.isFinite(t)&&(i.startTime=t)),this._started=!1}get audioTrack(){return this.currentPlayback.audioTrack}set audioTrack(t){this.currentPlayback.audioTrack=t}get audioTracks(){return this.currentPlayback.audioTracks}get currentTime(){return this.currentPlayback.currentTime}set currentTime(t){let e=!1;this.ended&&(e=!0),this.currentPlayback.currentTime=t,e&&this.play()}get duration(){return this.currentPlayback.duration}get earliestSeek(){return this.currentPlayback.earliestSeek}get latestSeek(){return this.currentPlayback.latestSeek}get streamStart(){return this.currentPlayback.streamStart}get streamEnd(){return this.currentPlayback.streamEnd}get joinTime(){return this.currentPlayback.joinTime}get ended(){return this.currentPlayback.ended}get seeking(){return this.currentPlayback.seeking}get canSeek(){return this.currentPlayback.canSeek}get underFiveSecsElapsed(){return this.earliestSeek+5<this.currentTime}get neverCanSeek(){return this.currentPlayback.neverCanSeek}get canSeekBackwards(){return this.currentTime>this.earliestSeek+.2}get canSeekForwards(){return this.currentPlayback.canSeekForwards}get blockSeekToEnd(){return this.currentPlayback.blockSeekToEnd}get canSeekToLiveReStart(){return this.currentPlayback.canSeekToLiveReStart}get canChangeQuality(){return this.currentPlayback.canChangeQuality}get quality(){return this.currentPlayback.quality}set quality(t){this.currentPlayback.quality=t}get played(){return this.currentPlayback.played}set settings(t){this.currentPlayback&&(this.currentPlayback.settings=t)}get settings(){return this.currentPlayback.settings}get videoHeight(){return this.currentPlayback.videoHeight}get videoWidth(){return this.currentPlayback.videoWidth}get containerHeight(){return this.currentPlayback.containerHeight}get containerWidth(){return this.currentPlayback.containerWidth}get webcastData(){return this.currentPlayback.webcastData}set webcastData(t){this.currentPlayback.webcastData=t}get volume(){return this.currentPlayback.volume}set volume(t){0!=t?(this.muted=!1,!isNaN(t)&&t>0&&(t>1?t=1:t<0?t=0:t<.09&&(t=.09),this.currentPlayback.volume=t,this.currentPlayback===this.playbacks.chromecast&&(this.playbacks.standard.volume=this.volume))):this.muted=!0}set muted(t){this.currentPlayback.muted=t,this.currentPlayback===this.playbacks.chromecast&&(this.playbacks.standard.muted=this.muted)}get muted(){return this.currentPlayback.muted}get playbackRate(){return this.currentPlayback.playbackRate}set playbackRate(t){this.currentPlayback.playbackRate=t}get started(){return this._started}get isSimulcast(){return!!this.mediaItem&&(this.mediaItem.isLive&&this._playlistModel.playlist.simulcast)}set playbackInterruptionPlugin(t){this._playbackInterruptionPlugin=t}get playbackInterruptionPlugin(){return this._playbackInterruptionPlugin}get tryingToPlay(){return this._tryingToPlay}get blockPlayback(){return this._blockPlayback}set blockPlayback(t){this._blockPlayback=t}get statsProvider(){return this.currentPlayback.statsProvider}get subtitleConnectionBase(){return this.currentPlayback._subtitleConnectionBase}utcToMedia(t){return this.currentPlayback.utcToMedia(t)}queueChanged(){this.currentPlayback.shouldReadyNextItem&&this.readyNextItem(!1)}async readyNextItem(t){const e=this._playlistModel,i=e.nextMediaItem;if(i){if(i.history.has("pre-error"))return void 0;await Uu(this,i),await Hu(this,i,t)}else if(e.playlist.queued){let i=e.playlist.queued,s=i.playlist.items;for(let e=0;e<s.length;e++){let n=q.createMediaItem(s[e]);i.options&&i.options.startTime&&(n.startTime=i.options.startTime),!n.isPlaceholderItem&&I.verify(n)&&(await Uu(this,n),await Hu(this,n,t))}}}captureIntent(){this.playbacks.standard._captureIntent()}setDashDebug(t){this.playbacks.standard._setDashDebug(t)}}async function Hu(t,e,i){t._config.disablePreload||await t.currentPlayback.preload(e,i)}function qu(t,e,i){if(!e.history.since("error-handled","error")){if(e.history.push("error-handled"),e.history.has("pre-error")){let i=e.failSilent&&!t._playlistModel.moreRemainingOrAnotherPlaylist;const s=e.history.last("pre-error").detail.errorEvent;i?s.severity="critical":e.failSilent&&"critical"==s.severity&&(s.severity="error"),t.eventBus.triggerEvent(s)}e.failSilent?t.mediaItem==e&&t._playlistModel.moreRemainingOrAnotherPlaylist&&t._playlistModel.next(!t._tryingToPlay):$u(t,i)}}function zu(t,e,i){let s=t._playlistModel.playlist;t._lastSignificantTimeupdate=null,t.currentPlayback.swappingItem(),t.eventBus.trigger("mediaItemChanged",{detail:e}),!t.webcastData&&t._config.webcastData&&(t.webcastData=t._config.webcastData),t._config.webcastData=null,Du.forEach(e=>{t._previous[e]=null}),i||Uu(t,e).then(()=>{s.autoplayPromise?Gu(s,t):t.play()}).catch(i=>{t.interrupted||qu(t,e,i)})}async function Uu(t,e){const i=e.history;if(i.has("pre-error"))throw"Item errored during preload";if(e.mediationPromise)try{return void await e.mediationPromise}catch(t){e.mediationPromise=null}i.push("preload"),e.mediationPromise=function(t,e){if(e){const i=e.history;if(i.has("pre-error")){const e=i.first("pre-error");t.eventBus.triggerEvent(e.detail.errorEvent)}if(i.has("premediated")||i.has("mediated"))return Promise.resolve();if(i.has("mediating")){return i.last("mediating").detail.promise}{let i,s=Nu;t._config.disableMediaSelectorFetch&&(s=Fu),i=e.jwtTokenRequired?function(t,e){return new Promise((i,s)=>{const n=setTimeout(()=>{t.jwtTokenRequired=!1;let i=P.TIMEOUT_WAITING_TOKEN;e.eventBus.unbind("setData",o);try{ju(i,t,e)}catch(t){}s(i)},e._config.tokenTimeout||3e4),o=function(){t.jwtTokenRequired||(e.eventBus.unbind("setData",o),clearTimeout(n),i())};let a=new X("tokenRequired",{vpid:t.vpid});e.eventBus.bind("setData",o,!0),e.eventBus.triggerEvent(a)})}(e,t):Promise.resolve();const n=i.then(async()=>{await async function(t,e,i){try{await e._mediator.mediate(t,e._config.mediator,i),t.history.push("mediated"),e.mediaItem==t&&e.eventBus.trigger("mediated",{mediaItem:t})}catch(i){e.mediaItem==t?ju(i,t,e):t.history.has("preload")&&t.history.push("pre-error",{errorEvent:i})}}(e,t,s)});return e.history.push("mediating",{promise:n}),n}}return Promise.reject("Playback tried to mediate a null mediaitem")}(t,e),await e.mediationPromise,e==t.mediaItem&&t.eventBus.trigger("mediaItemInfoChanged")}function Wu(t,e){if(t.preparePromise)return t.preparePromise;if(!e&&d.needsSafariCaptureIntent||t.playbackInterruptionPlugin){const e=t.playbacks.standard;return t.preparePromise=e._captureIntent(),t.preparePromise.catch(()=>{t._tryingToPlay=!1,t.eventBus.trigger("error",P.PLAY_PROMISE_REJECTED),t.preparePromise=null}),t.preparePromise}return Promise.resolve()}function Vu(t){t.mediaItem&&t.mediaItem.history.push("post-preroll-interrupt"),t.interrupted=!1,t.eventBus.trigger("playbackUnInterrupted",{tryingToPlay:t._tryingToPlay})}function ju(t,e,i){if(t){let s;t instanceof x||((t=P.MEDIATOR_REQUEST_ERROR).extra="catch"),e.failSilent&&i._playlistModel.moreRemainingOrAnotherPlaylist&&(t.severity="error",e.history.push("skipMinor"),s=function(){i._playlistModel.next(!i._tryingToPlay)}),i.mediaItem==e?(i.eventBus.triggerEvent(t),e.history.push("error-handled"),s&&i.mediaItem==e&&s()):e.history.push("pre-error",{errorEvent:t})}throw t}function Gu(e,i){i.interrupted||(e.autoplayPromise=i.play(e.nonUserBypass),e.autoplayPromise.catch(e=>{if(!(e instanceof Yu)){t;let s=i._playlistModel.mediaItem;qu(i,s,e)}}).finally(()=>{e.autoplayPromise=null}),i.eventBus.trigger("autoplayingPlaylist",{detail:e.autoplayPromise}))}function $u(t,e){if(t._started){t._started=!1;const i={};e&&(i.error=e),t.eventBus.trigger("playbackEnd",{detail:i})}}function Ku(t,e){let i=e._eventBus;["muted","durationchange","playing","play","pause","ended","significantTimeupdate","seeking","seeked","loadedmetadata","canplay","waiting","volumechange","statsBuffering","resize","playbackQualityChanged","multipleaudiotracks","trackchanged"].forEach(e=>{t.addEventListener(e,t=>{i.trigger(e,t)})}),t.addEventListener("supplierchange",e=>{t.mediaItem.history.push("supplierchange",e.detail)}),t.addEventListener("readyNextItem",()=>{e.playbackController.readyNextItem(!1)}),t.addEventListener("tryingToPlay",t=>{e.playbackController._tryingToPlay=t.detail}),t.addEventListener("timeupdate",t=>{const s=i.trigger("timeupdate",t);Du.some(t=>e.playbackController._previous[t]!=s[t])&&(Du.forEach(t=>{e.playbackController._previous[t]=s[t]}),i.trigger("notableTimechange"))}),t.addEventListener("ratechange",t=>{0!=e.playbackController.playbackRate&&i.trigger("ratechange",t)}),t.addEventListener("error",e=>{i.trigger("error",e.detail),e.detail.code==P.LIVE_NOT_INDICATED_LIVE.code&&i.trigger("mediaItemChanged",{detail:t.mediaItem,changingMetadata:!0})})}function Qu(t){if(!t||t.history.since("inactive","active"))throw new Yu("Preparing Item no longer required")}class Yu extends Error{constructor(t,...e){super(t||"",...e)}}class Ju{constructor(t){this._toucanPlayer=t,this._throttled=!1,document.addEventListener("visibilitychange",this.visibilityChange.bind(this)),t.addEventListener("volumechange",this.volumeChange.bind(this)),t._eventBus.bind("picInPicStarted",this.picInPic.bind(this)),t._eventBus.bind("picInPicStopped",this.picInPic.bind(this)),this.lastInterval=performance.now(),this.throttleCount=0,this.notThrottledCount=0,this._visible=!document.hidden,setInterval(this.interval.bind(this),15e3)}set visible(t){this._visible!=t&&(this._visible=t,clearTimeout(this._timer),t||this.checkWarning())}get visible(){return this._visible}set throttled(e){if(this._throttled!=e){this._throttled=e;let i=e?"throttled":"unthrottled";t,this._toucanPlayer._eventBus.triggerEvent(new Y(i))}}get throttled(){return this._throttled}visibilityChange(){this.visible=!document.hidden,this.visible&&(this.throttled=!1)}volumeChange(){this.toucanPlayer.muted?this.checkWarning():clearTimeout(this._timer)}picInPic(){this._toucanPlayer.picInPicActive?clearTimeout(this._timer):this.checkWarning()}checkWarning(){this.visible||this.throttled||!this._toucanPlayer.muted||this._toucanPlayer.picInPicActive||(clearTimeout(this._timer),this._timer=setTimeout(this.throttleWarning.bind(this),12e4))}throttleWarning(){this._toucanPlayer._eventBus.triggerEvent(new Y("throttlewarning"))}interval(){let t=performance.now(),e=t-this.lastInterval;this.lastInterval=t,e>3e4?(++this.throttleCount>3&&(this.throttled=!0),this.notThrottledCount=0):this.throttled&&(++this.notThrottledCount>3&&(this.throttled=!1),this.throttleCount=0)}}class Xu{constructor(t){this.toucanPlayer=t,this.eventBus=t._eventBus,this.playbackController=t.playbackController,this.listeners={},this._addEventBusListeners()}_addEventBusListeners(){this.eventBus.bind("uiConfigUpdated",this._uiSettingsUpdate.bind(this)),this.eventBus.bind("playing",()=>{this._hideBuffer()}),this.eventBus.bind("playbackInterrupted",()=>{this._hideBuffer()}),this.eventBus.bind("playbackUnInterrupted",t=>{t.tryingToPlay&&this._showBuffer()}),this.eventBus.bind("playbackBegin",()=>{this._showBuffer()}),this.eventBus.bind("pause",()=>{this._hideBuffer()}),this.eventBus.bind("ended",()=>{this._hideBuffer()}),this.eventBus.bind("showCta",()=>{this._hideBuffer()}),this.eventBus.bind("playlistEnded",()=>{this._hideBuffer()}),this.eventBus.bind("waiting",()=>{this.playbackController.paused||this._showBuffer()}),this.eventBus.bind("seeking",()=>{this._showBuffer()}),this.eventBus.bind("seeked",t=>{t.tryingToPlay||this._hideBuffer()}),this.eventBus.bind("waitingForPlugins",()=>{this._showBuffer()}),this.eventBus.bind("pluginsLoadedAfterWaiting",()=>{this._hideBuffer()})}_showBuffer(t){this.showBufferTimer||(t||(this.isInBufferingState=!0),this.showBufferTimer=setTimeout(()=>{this._clearTimer(),this.toucanPlayer.uiSettings.buffer.enabled&&this.eventBus.trigger("showBuffer")},750))}_hideBuffer(t){t||(this.isInBufferingState=!1),this.toucanPlayer.uiSettings.buffer.enabled&&this.toucanPlayer.uiSettings.buffer.forceShow||(this._clearTimer(),this.eventBus.trigger("hideBuffer"))}_clearTimer(){clearTimeout(this.showBufferTimer),delete this.showBufferTimer}_uiSettingsUpdate(t){if(t&&t.buffer){let e=t.buffer;e.enabled&&(e.forceShow||this.isInBufferingState)?this.showBufferTimer||this._showBuffer(!0):this._hideBuffer(!0)}}}class Zu{constructor(t){this.toucanPlayer=t,this.eventBus=this.toucanPlayer._eventBus}get fullPipActive(){return!(!("documentPictureInPicture"in window)||!documentPictureInPicture.window)&&!!documentPictureInPicture.window}get pipActive(){return document.pictureInPictureElement===this.toucanPlayer||this.fullPipActive||document.pictureInPictureElement==this.toucanPlayer.videoElement}togglePictureInPicture(){var t;"documentPictureInPicture"in window&&documentPictureInPicture.window?documentPictureInPicture.window.close():document.pictureInPictureElement==this.toucanPlayer||document.pictureInPictureElement==this.toucanPlayer.videoElement?this.exitPictureInPicture():(this.eventBus.trigger("toggleFullscreenRequested"),this.toucanPlayer._uiConfig.pictureInPicture.full&&"documentPictureInPicture"in window?(t=this,new Promise(async function(e){let i=t.toucanPlayer._uiinfo;t.toucanPlayer.picInPicActive=!0;const s=await documentPictureInPicture.requestWindow({initialAspectRatio:i.containerWidth/i.containerHeight}),n=t.toucanPlayer.parentElement;s.document.body.appendChild(t.toucanPlayer),s.document.body.style.margin="0px",s.document.body.style.overflow="hidden",t.toucanPlayer.isAudioSkin&&(t.toucanPlayer.style.paddingTop="2em",t.toucanPlayer.style.backgroundColor="var(--smp-colour-on-base-colour)"),s.addEventListener("unload",()=>{t.toucanPlayer.picInPicActive=!1,t.eventBus.trigger("picInPicStopped"),n.appendChild(t.toucanPlayer),setTimeout(function(){t.eventBus.trigger("fullToucanPiPtoggled")},250),t.toucanPlayer.isAudioSkin&&(t.toucanPlayer.style.backgroundColor="")}),t.eventBus.trigger("fullToucanPiPtoggled"),e()})).catch(t=>{console.log(t)}):this.toucanPlayer.videoElement.requestPictureInPicture().catch(t=>{console.log(t)}))}exitPictureInPicture(){this.pipActive&&document.exitPictureInPicture().catch(t=>{console.log(t)})}}class tc extends le{constructor(){super({stylesheet:"*{font-family:ReithSans,Arial,Helvetica,freesans,sans-serif;text-rendering:optimizeLegibility}smp-audio-layout,smp-error-layout,smp-playback,smp-preplay-layout,smp-video-layout{direction:ltr;object-fit:contain}smp-audio-layout.fullscreen,smp-error-layout.fullscreen,smp-playback.fullscreen,smp-preplay-layout.fullscreen,smp-video-layout.fullscreen{--smp-holding-image-fit:contain}.holdingImage,smp-playback{background-color:#000}.holdingImage{height:100%;position:absolute;top:0;width:100%;z-index:0}.holdingImage.swipe{pointer-events:none}.background{background-color:#000;height:100%;position:absolute;width:100%}:host(.audio) .background,:host(.audio) smp-playback{background-color:transparent}:host(.displayCover) smp-error-layout,:host(.displayCover) smp-holding-image,:host(.displayCover) smp-playback,:host(.displayCover) smp-video-layout{object-fit:cover;object-position:center}:host(.displayCover) smp-holding-image.swipe,smp-holding-image.swipe{object-fit:contain;object-position:center}:host(.videoPositionTop) smp-error-layout,:host(.videoPositionTop) smp-holding-image,:host(.videoPositionTop) smp-playback,:host(.videoPositionTop) smp-video-layout{object-position:0 0}:host(.videoPositionBottom) smp-error-layout,:host(.videoPositionBottom) smp-holding-image,:host(.videoPositionBottom) smp-playback,:host(.videoPositionBottom) smp-video-layout{object-position:0 100%}smp-plugin{pointer-events:none}"}),this.plugins=[],this._datastore=new Mi,this._config={},this._uiConfig=Ni,this.picInPicActive=!1,this._registeredControls=[],this._buttonNames=[],this.addEventListener("takeFocusNames",t=>{this._buttonNames=this._buttonNames.concat(t.detail.names),t.stopPropagation()})}create(){super.create();const t=new U;t.annotator=new ut(this),this._eventBus=t;const e=new $e(this);if(this._uiinfo=e,d.supportsDash){const t=document.createElement("link");t.setAttribute("rel","modulepreload"),t.setAttribute("href","https://emp.bbci.co.uk/emp/dashjs/3.2.0-14/dash.all.min.js"),this.shadowRoot.appendChild(t)}const i=document.createElement("div");i.className="background",this.shadowRoot.appendChild(i),this.playbackController=new Mu(this),this.bufferController=new Xu(this),Fs.isSupported()&&(this.mediaSessionApi=new Fs(this)),function(t){t._echoReporter=(new Ri).get(t),t._statsProvider=new Vt(t),t.settings.enableRdotReporting&&t.toggleRDot(!0)}(this),function(t){const e=new Fe(t._uiinfo,new Zt(t));t.subtitles=e,t._subtitlesAdapter=new je(t,e);const i=new Zu(t);t.pictureInPicture=i,t._debugAdapter=new ri(t),t._layoutChooser="audio"==t._uiConfig.skin?new Qr(t):new Wr(t),t._layoutChooser.defaultLayouts(t.settings)}(this),function(t,e){new ResizeObserver(i=>{for(let n of i){let i=n.contentRect.width,o=n.contentRect.height;0==i&&(i=640,o=360);let a=n.contentRect.width<n.contentRect.height;var s=0;for(let t=1;t<Ms.length;t++)Ms[t]<=i&&s++;let r=i>1280,l=i>600||a&&o>450,u=i<700,c=!1;o<120&&s>0&&(c=!0,u=!0,s=3);let d=!1;(o<140||i<180)&&(d=!0);let h=!1;o<97&&(h=!0);const p=Hs.get(t)||{};if(Ds[s]!=p.breakpoint||a!=p.isPortrait||u!=p.smallMarkers||c!=p.minimode||d!=p.tiny||h!=p.slimHeight||r!=p.playerWidthBreakpoint||l!=p.titleHeaderFits){const n={breakpoint:Ds[s],previousBreakpoint:p.breakpoint,all:Ds,smallMarkers:u,isPortrait:a,minimode:c,tiny:d,slimHeight:h,playerWidthBreakpoint:r,titleHeaderFits:l,width:i,height:o};Hs.set(t,n),e.trigger("breakpointchange",n)}e.trigger("playerSizeChange",{breakpoint:Ds[s],isPortrait:a,width:i,height:o,slimHeight:h})}window.requestAnimationFrame(function(){window.requestAnimationFrame(e.trigger.bind(e,"fixSize"))})}).observe(t)}(i,t),function(t,e){e.bind("play-requested",()=>{t.playbackController.blockPlayback||e.trigger("forceShowPlayback"),t.play()}),e.bind("tryAgainClicked",()=>{t.playbackController.restart()}),e.bind("playbackQualityChanged",e=>{const i=e.detail.quality;t._config.quality=e.detail.quality,t._eventBus.triggerPublic("configFromPlayer",new J({quality:i}))}),e.bind("playbackBlock",()=>{t.exitFullscreen(),e.triggerEvent(new X("guidanceShow",{guidance:t.playlist.guidance,title:t.playlist.title}))}),e.bind(["throttlewarning","throttled"],()=>{t.isStandardPlayback&&!t.paused&&t.pause()}),e.bind("playbackChangePlaylist",e=>{let i=e.detail.playlist,s=e.detail.options;t.resetForPlaylist();let n=!0;s?(t.settings=s,n=!1!==s.autoplay):t.playbackController.settings=t._config,t.settings.autoplay=n,i.fromQueue=!0,t.playlist=i}),e.bind("playbackRateChangeRequested",e=>{t.playbackController.playbackRate=e.value}),e.bind("showCta",()=>{t.isFullscreen&&t.exitFullscreen()}),e.bind("skip-back-requested",e=>{e.isLive?t.currentTime=t.currentPlayback.earliestSeek:t.previous(null,e.method)}),e.bind("skip-forward-requested",e=>{t.next(null,null,e.method)}),e.bind("togglePictureInPictureRequested",()=>{t.pictureInPicture.togglePictureInPicture()}),e.bind("exitPictureInPictureRequested",()=>{t.pictureInPicture.exitPictureInPicture()}),e.bind("toggleFullscreenRequested",()=>{t.isFullscreen&&t.toggleFullscreen()}),e.bind("ad-toggle",()=>{let e=t.audioTracks,i=t.audioTrack;const s=!i.audioDescription;if(e&&i){let i=e.findIndex(t=>t.audioDescription==s);t.audioTrack=i}t._eventBus.triggerEvent(new X("audioDescriptionChange",{status:s}))}),e.bind("playerDestroying",()=>{t.pageShow&&window.removeEventListener("pageshow",t.pageshow),t.pageShow=e=>{e.persisted&&"playback"==t._beforeDestroyState.state&&(t.playbackController.readyToRestart(t._beforeDestroyState.time,!0),t._layoutChooser.currentState="preplay")},window.addEventListener("pageshow",t.pageShow)})}(this,t),function(t,e){let i=function(i){e.trigger("fullscreenchange",i),t.isRealFullscreen?e.trigger("fullscreenEnter"):e.trigger("fullscreenExit")};t.addEventListener("fullscreenchange",i),t.addEventListener("webkitfullscreenchange",i),t.addEventListener("fullscreenerror",t=>{console.error("ToucanPlayer encountered an error while transitioning into or out of full-screen mode",t)})}(this,t),window.matchMedia("(forced-colors : active)").onchange=Pi.bind(null,this,this._uiConfig),function(t){t.videoElement.addEventListener("enterpictureinpicture",()=>{t.picInPicActive=!0,t._eventBus.trigger("picInPicStarted")}),t.videoElement.addEventListener("leavepictureinpicture",()=>{t.picInPicActive=!1,t._eventBus.trigger("picInPicStopped")})}(this),qs(this),this.applySettings(),this.applyUiSettings(),this.throttleAvoider=new Ju(this),this.addEventListener("focusout",function(t){return function(){t.isFullscreen&&setTimeout(function(){t._eventBus.trigger("focusOnPlayPause")},0)}}(this),!0),this.__bumpInit&&(this.__bumpInit(),delete this.__bumpInit),this.__reapplySettings&&(this.applySettings(),this.applyUiSettings(),delete this.__reapplySettings),this._waitingPromise&&(this._pluginLoadPromise?(this._eventBus.trigger("waitingForPlugins"),this._pluginLoadPromise.then(()=>{this._waitingResolve(),this._waitingResolve=null,this._pluginLoadPromise=null})):(this._waitingResolve(),this._waitingResolve=null));const s=this;this.addEventListener("disablingWithFocus",t=>{document.activeElement==s&&s._eventBus.trigger("focusOnPlayPause"),t.stopPropagation()}),this.addEventListener("focusGroup",t=>{this._eventBus.trigger("focusButton",{group:t.detail.group}),t.stopPropagation()})}preplay(){this.playbackController.stop()}play(){this.playbackController.play()}pause(){this.playbackController.pause()}suspend(){this.pause()}stop(t){this.pictureInPicture.exitPictureInPicture(),this.isFullscreen&&this.exitFullscreen(),t&&t.destroy?(this._beforeDestroyState={time:this.currentTime,state:this._layoutChooser.currentState},this._eventBus.trigger("playerDestroying"),this.playbackController.stop()):(this.playbackController.stop(),this._eventBus.trigger("playerDisconnected"))}toggle(){const t=this.playbackController;t.paused?t.play():t.pause()}loadPlugin(t){if(t){const e=new si;e.toucanPlayer=this,this.plugins.push(e),this.shadowRoot.appendChild(e),this.setData(t.data);let i=new Promise(t=>{let i=setTimeout(()=>{t()},1e4);e.addEventListener("done",()=>{clearTimeout(i),t()},{once:!0})});this._pluginLoadPromise?this._pluginLoadPromise=Promise.all([this._pluginLoadPromise,i]):this._pluginLoadPromise=i,e.loadPlugin(t.url,t.require||!t.module,t.data)}}dispatchEventToPlugins(t,e){this.plugins.forEach(i=>{i.triggerEvent(t,e)})}setDashDebug(t){this.playbackController.setDashDebug(t)}next(t,e,i){!e&&this._uiConfig.swipable.enabled&&"audio"!==this._uiConfig.skin?this._eventBus.trigger("swipeNext",{method:i}):(i=i||"api",this._eventBus.trigger("statsNavigation",{direction:"next",method:i}),this.playbackController._playlistModel.next(!1===t)&&t&&this.play())}previous(t,e){!t&&this._uiConfig.swipable.enabled&&"audio"!==this._uiConfig.skin?this._eventBus.trigger("swipePrevious",{method:e}):(e=e||"api",this._eventBus.trigger("statsNavigation",{direction:"previous",method:e}),this.playbackController._playlistModel.previous())}setData(t){if(Array.isArray(t))for(let e=0;e<t.length;e++)ec(t[e],this);else ec(t,this)}get subtitlesOn(){return this.isStandardPlayback?this.subtitles&&this.subtitles.isOn:this.playbackController.playbacks.chromecast&&this.playbackController.playbacks.chromecast._subsOn}set subtitlesOn(t){this.isStandardPlayback?this.subtitles&&(this.subtitles.isOn=t):this.playbackController.playbacks.chromecast&&(this.playbackController.playbacks.chromecast._subsOn=t)}get audioDescriptionOn(){let t=this.audioTrack;return t&&t.audioDescription||!1}get audioDescriptionAvailable(){let t=this.audioTracks;if(t){if(-1!=t.findIndex(t=>1==t.audioDescription))return!0}return!1}get subtitlesAvailable(){return this.isStandardPlayback?this.subtitles&&this.subtitles.available:this.playbackController.playbacks.chromecast&&this.playbackController.playbacks.chromecast.subsAvailable}showSubtitles(t){this.subtitlesOn=t}get isCasting(){return this.playbackController.currentPlayback instanceof Zs}get isAudioSkin(){return"audio"==this._uiConfig.skin}get fullscreenSupported(){return this.requestFullscreen||this.webkitRequestFullscreen||this.settings.supportFakeFullscreen}requestFakeFullscreen(){this._eventBus.trigger("beforeFakeFullscreen"),this.style.position="fixed",this.style.top=0,this.style.bottom=0,this.style.zIndex=2147483600,this._fakeFullscreen=!0,this._eventBus.trigger("enterFakeFullscreen"),this._eventBus.trigger("fullscreenEnter"),this._eventBus.trigger("fullscreenchange"),this.classList.add("fakeFullscreen")}get isFullscreen(){let t=!1;return(document.fullscreenElement&&document.fullscreenElement===this||document.webkitFullscreenElement&&document.webkitFullscreenElement===this||this._fakeFullscreen)&&(t=!0),t}get isRealFullscreen(){return document.fullscreenElement&&document.fullscreenElement===this||document.webkitFullscreenElement&&document.webkitFullscreenElement===this}toggleFullscreen(){if(this.isFullscreen)this.exitFullscreen();else{this._eventBus.trigger("beforeFullscreenEnter");const t=d.swipeDownNotInFullscreen&&this._uiConfig.swipable.enabled&&"Y"==this._uiConfig.swipable.direction;!t&&this.requestFullscreen?this.requestFullscreen():!t&&this.webkitRequestFullscreen?this.webkitRequestFullscreen():this.settings.supportFakeFullscreen&&this.requestFakeFullscreen()}}exitFullscreen(){var t;this._fakeFullscreen&&((t=this).style.position="absolute",t.style.removeProperty("z-index"),t.classList.remove("fakeFullscreen"),t._fakeFullscreen=!1,t._eventBus.trigger("exitFakeFullscreen"),t._eventBus.trigger("fullscreenExit"),t._eventBus.trigger("fullscreenchange")),this.isRealFullscreen&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}get shortVersion(){return i+(this._config._inExperiment?".x":"")}get version(){return"SMPToucan "+this.shortVersion}get paused(){return this.playbackController.paused}get ended(){return this.playbackController.ended}get seeking(){return this.playbackController.seeking}get playlist(){return this._playlist}get holdingImageURL(){return this._playlist?this._playlist.holdingImageURL:this._fallbackHoldingImage}get currentTime(){return this.playbackController.currentTime}set currentTime(t){this.playbackController.currentTime=t}get audioTrack(){return this.playbackController.audioTrack}set audioTrack(t){this.playbackController.audioTrack=t}get audioTracks(){return this.playbackController.audioTracks}get earliestSeek(){return this.playbackController.earliestSeek}get duration(){return this.playbackController.duration}get contentAspectRatio(){let t;return this.videoElement&&(t=this.videoElement.videoWidth/this.videoElement.videoHeight),isNaN(t)&&(t=16/9),t}get queuedItem(){if(this.playlist)return this.playlist.queued}set queuedItem(t){this.playlist&&(this.playlist.queued=t,this._eventBus.delayedTrigger("queueChanged"))}get previousItem(){if(this.playlist)return this.playlist.previous}set previousItem(t){this.playlist&&(this.playlist.previous=t,this._eventBus.delayedTrigger("queueChanged"))}set playlist(t){if(this._waitingPromise){this._waitingPlaylist=t;let e=this;return void this._waitingPromise.then(()=>{e._waitingPlaylist&&(e._waitingPromise=null,e.playlist=e._waitingPlaylist,e._waitingPlaylist=null)})}this._eventBus.trigger("playlistLoading",t),this.webcastData=null,this._datastore.get("SMP.markers")&&this.setData({name:"SMP.markers",data:null});const e=new q(t,this._config);this.isStandardPlayback||(e._filterIdentAndWarning=!0);let i=null,s=!1,n=!1;e.blank?n=!0:s=q.verify(e,t=>{i=t}),this._playlist=e,t&&t.queueCurrentPlaylist&&this._readyToBeQueued&&(this._playlist.queued=this._readyToBeQueued),delete this._readyToBeQueued,this._config.autoplay&&(this._playlist.autoplay=!0),this._config.disallowPreload||!this._config.preload||this._config.startTime&&!this._config.allowPreloadWithStartTime||["high","medium","low","none"].includes(this._config.preload)&&(this._playlist.preload=this._config.preload,this._playlist.preloadStartTime=this._config.startTime),!0===this._config.nonUserBypass&&(this._playlist.nonUserBypass=!0,this._config.nonUserBypass=!1),this.playbackController.blockPlayback=!this.guidanceOkayToPlay,this.playbackController.playlist=s?this._playlist:{},i?this._eventBus.trigger("error",i):n&&this._eventBus.trigger("reset",i)}get settings(){return this._config}set settings(t){const e=this._config.counterName,i=this._config.continuousPlay;this._config=Ei(this._config,t);let s=function(){const t=Si("ckps_smpSettings");if(t)try{const e=JSON.parse(t);return!(!e||!e.quality)}catch(t){return!1}}();if(this._config.hasQualityCookie=s,this.needToCreate){if(this.__bumpInit&&(this.__reapplySettings=!0),this._config.waitOnPluginLoad){let t=this;this._waitingPromise=new Promise(e=>{t._waitingResolve=e}).then(()=>{t._eventBus.trigger("pluginsLoadedAfterWaiting")})}}else{if(e&&e!==this._config.counterName){const t={counterName:this._config.counterName};this._eventBus.trigger("statsConfigChanged",t)}i!==this._config.continuousPlay&&this._eventBus.triggerEvent(new X("continuousPlayChange",{status:this._config.continuousPlay})),this.applySettings()}}get hasGuidancePassed(){const t=this._config.guidance||{};return(t.guidanceSkipped||t.guidancePINPassed)&&!t.isGuidanceLocked&&(!this._config.under16||this._config.under16&&t.under16permissionConfirmed)}get guidanceOkayToPlay(){return this.hasGuidancePassed||!this.playlist||""===this.playlist.guidance||!this._uiConfig.guidance.pinRequired}updateGuidance(t){this._config.guidance=Ei(this._config.guidance,t),this.playbackController.blockPlayback=!this.guidanceOkayToPlay}guidanceClosed(t){!t[0]&&this.playbackController.blockPlayback&&(this._layoutChooser.currentState="preplay"),this._eventBus.trigger("focusOnPlayPause")}applySettings(){this.playbackController.settings=this._config,this._eventBus.trigger("settingsUpdated",this._config),isNaN(this._config.skipInterval)||this._config.skipInterval==this.uiSettings.skipInterval||(this.uiSettings={skipInterval:this._config.skipInterval})}get chromecastAvailable(){return!(!this.playbackController.playbacks.chromecast||this.playbackController.playbacks.chromecast.castState===Zs.STATE.NO_DEVICES_AVAILABLE)}get isStandardPlayback(){return this.playbackController.currentPlayback===this.inPagePlayback}get uiSettings(){return this._uiConfig}set uiSettings(t){this._uiConfig=Ei(this._uiConfig,t),this.needToCreate||this.applyUiSettings()}applyUiSettings(){if(Pi(this,this._uiConfig),this.subtitles.config=this._uiConfig.subtitles,this._eventBus.trigger("uiConfigUpdated",this._uiConfig),this._uiConfig.video.transform){const t=/[^\s\w\(\),\.\%\-]*/gi;this.playbackController.playbacks.standard.style.transform=""+this._uiConfig.video.transform.replace(t,""),this._uiConfig.video.transformTransition&&(this.playbackController.playbacks.standard.style.transition="transform "+this._uiConfig.video.transformTransition.replace(t,""))}else this.playbackController.playbacks.standard.style.transform="",this.playbackController.playbacks.standard.style.transition=""}get mediaItem(){return this.playbackController&&this.playbackController.mediaItem}get isLive(){return this.playbackController&&this.playbackController.mediaItem&&this.playbackController.mediaItem.isLive}get webcastData(){return this.playbackController?this.playbackController.webcastData:this._webcastData}set webcastData(t){this._webcastData=t,this.playbackController&&(this.playbackController.webcastData=t),this.isAudioSkin&&this._eventBus.trigger("webcastDataUpdated",t)}get debugText(){return this._statsProvider?Jt.multiline(this._statsProvider):""}get alstonScore(){const t=this._statsProvider.stoppedTimes;t.alston&&t.alston.video>=0&&t.alston.stalling>=0&&t.alston.video<=1&&t.alston.stalling<=1&&console.log("Alston Score",t.alston)}get inPagePlayback(){return this.playbackController.playbacks.standard}bind(t,e){this._eventBus.bind(t,e)}unbind(t,e){this._eventBus.unbind(t,e)}get videoElement(){return this.playbackController.playbacks.standard._videoElement}set language(t){if(t)for(let e of Object.keys(t))E[e]=t[e]}get language(){return E}set volume(t){0==t?this.muted=!0:this.playbackController.volume=t}get volume(){return this.playbackController.volume}set muted(t){this.playbackController.muted=t}get muted(){return this.playbackController.muted}get playbackRate(){return this.playbackController.playbackRate}set playbackRate(t){this.playbackController.playbackRate=t}pauseAt(){t}get shouldEchoReport(){return this.mediaItem&&!this.mediaItem.isIdentOrWarning&&this.isStandardPlayback}get contentType(){return this.mediaItem?this.mediaItem.contentType:"video"}registerControl(t){t&&t.hasAttribute,this._registeredControls.includes(t)||this._registeredControls.push(t)}toggleRDot(t){t?(this._rdotAdapter||(this._rdotAdapter=new Ct(this._eventBus,this._config,this._statsProvider)),this._rdotAdapter.on()):this._rdotAdapter&&this._rdotAdapter.off()}readyCurrentPlaylistForQueuing(){const t=this._config;this.playlist&&(this._readyToBeQueued={options:{statsObject:t.statsObject,counterName:t.counterName,startTime:this.currentTime||t.startTime},playlist:this.playlist})}resetForPlaylist(){let t={overrideHoldingImage:null,overrideCtaDuration:null,webcastData:{},statsObject:{episodePID:void 0,clipPID:void 0,brandPID:void 0,seriesPID:void 0,playlistLabels:void 0,playlistName:void 0},startTime:0};this._config=Ei(this._config,t)}captureIntent(){this.playbackController.captureIntent()}getControlsPositioning(){return this._layoutChooser.getControlsPositioning()}focusButton(t){let e=(t=t||{}).name,i=t.after;-1!=this._buttonNames.indexOf(e)?this._eventBus.trigger("focusButton",{name:e,after:i}):this._eventBus.trigger("focusOnPlayPause")}get shouldSendUIInfoEvents(){return this._layoutChooser&&this._layoutChooser.shouldSendUIInfoEvents}get stoppedStateOnPause(){let t=this.playbackController.neverCanSeek;const e=this._uiConfig.stoppedStateOnPause;return!1!==e&&!0!==e||(t=e),t}elementHasFocusInShadowDOM(t){let e;e=Array.isArray(t)?t:[t];let i=document.activeElement;for(;i;){if(e.includes(i))return!0;if(!i.shadowRoot)break;i=i.shadowRoot.activeElement}return!1}}function ec(t,e){if(t){if(e._datastore.set(t),e._eventBus.trigger("setData",new W(t)),"SMP.webcastData"==t.name){let i=t.data,s={};i&&(s.accurateStartTime=i.accurateStartTime,s.accurateEndTime=i.accurateEndTime,s.scheduledEndTime=i.scheduledEndTime,s.scheduledStartTime=i.scheduledStartTime,s.ignoreJoinTime=i.ignoreJoinTime,s.rewindTo=i.rewindTo),e.webcastData=s}if("SMP.availableTime"==t.name){let i=t.data,s=e.webcastData||{};i&&(s.availableTime=i),e.webcastData=s}if("SMP.audioTrack"==t.name){let i=t.data,s=e.audioTracks;if(i&&s)if(i.index)e.audioTracks[i.index]&&(e.audioTrack=i.index);else if(!0===i.audioDescription||!1===i.audioDescription){let t=s.findIndex(t=>t.audioDescription==i.audioDescription);e.audioTrack=t}}}}customElements.get("smp-toucan-player")||customElements.define("smp-toucan-player",tc);
